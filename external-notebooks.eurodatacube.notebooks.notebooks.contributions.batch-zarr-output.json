{"version":1,"kind":"Notebook","sha256":"99642f98740d417e224585112cbd15049e0a98f231d98ed63c5d68306a0e2114","slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.batch-zarr-output","location":"/external_notebooks/eurodatacube/notebooks/notebooks/contributions/Batch_Zarr_output.ipynb","dependencies":[],"frontmatter":{"title":"Generating Zarr data cubes with Sentinel Hub Batch API","content_includes_title":false,"kernelspec":{"name":"pip_base","display_name":"pip_base","language":"python"},"github":"https://github.com/eoxhub-workspaces/documentation/","numbering":{"title":{"offset":5}},"edit_url":"https://github.com/eoxhub-workspaces/documentation//blob/main/external_notebooks/eurodatacube/notebooks/notebooks/contributions/Batch_Zarr_output.ipynb","thumbnail":"/notebooks_test/build/68dffbf744fa42f4bf3d35e55684984e.png","exports":[{"format":"ipynb","filename":"Batch_Zarr_output.ipynb","url":"/notebooks_test/build/Batch_Zarr_output-b295ada27314ff3fe434fa70c8b8ed94.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this notebook, we will first create Zarr data cube using Sentinel Hub Batch Processing API. The results (zarr group) will be first be stored on S3 and then we will download them and read them into xarray dataset.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YaSNn3VWbp"}],"key":"Q8ShQCMf9r"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"You will need an EDC Sentinel Hub Enterprise subscription to execute this notebook as well as your own object storage (S3).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cxv8xsACXT"}],"key":"EsApPdgY5T"}],"key":"NEwzSwdnrg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports and authentication","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AgJtAbqV55"}],"identifier":"imports-and-authentication","label":"Imports and authentication","html_id":"imports-and-authentication","implicit":true,"key":"mvbhH4Fbx4"}],"key":"FFpZaA9wED"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"First, let’s import all pacakges we will be using and authenticate at Sentinel Hub.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jktC4C6O9C"}],"key":"XdpofLTF2I"}],"key":"dwMkhZsG6F"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"from oauthlib.oauth2 import BackendApplicationClient\nfrom requests_oauthlib import OAuth2Session\nimport os\nimport fsspec\nimport xarray as xr\n\n# Your client credentials\nclient_id = os.environ[\"SH_CLIENT_ID\"]\nclient_secret = os.environ[\"SH_CLIENT_SECRET\"]\n\n# Create a session\nclient = BackendApplicationClient(client_id=client_id)\noauth = OAuth2Session(client=client)\n\n# Get token for the session\ntoken = oauth.fetch_token(token_url='https://services.sentinel-hub.com/oauth/token',\n                          client_secret=client_secret)","key":"rsKN5kAR9U"},{"type":"output","id":"7DIFbFgP_J1SH7jcGTSju","data":[],"key":"eHXTutmGEu"}],"key":"SHJsRrcEtI"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create Batch Processing request to calculate maximum NDVI in for three months","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XStWNeOmFy"}],"identifier":"create-batch-processing-request-to-calculate-maximum-ndvi-in-for-three-months","label":"Create Batch Processing request to calculate maximum NDVI in for three months","html_id":"create-batch-processing-request-to-calculate-maximum-ndvi-in-for-three-months","implicit":true,"key":"XvO1SmfEox"}],"key":"APQgXuOL3r"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This example is taken from the official Sentinel Hub documentation: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pEy2urinMY"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/api/batch/examples/#option-2-zarr-format-output","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​docs​.sentinel​-hub​.com​/api​/latest​/api​/batch​/examples​/​#option​-2​-zarr​-format​-output","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hDI8Kw4HMV"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/api/batch/examples/#option-2-zarr-format-output","key":"TGVcHJQbbz"},{"type":"text","value":". To run it, please replace a placeholder ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XOijv6GP1g"},{"type":"inlineCode","value":"<your-bucket>","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZzqsVAX6b2"},{"type":"text","value":" with your value (e.g. “s3://my-bucket/batch-zarr-demo”). Your object storage has to be configured as described here: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n8dxaPYUqF"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/api/batch/#aws-bucket-settings","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​docs​.sentinel​-hub​.com​/api​/latest​/api​/batch​/​#aws​-bucket​-settings","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Mi5e0LLrms"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/api/batch/#aws-bucket-settings","key":"vh2g8F4Ran"}],"key":"m9IUSIVCMS"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The example requests all Sentinel-2 data acquired between April 2019 and June 2019 for the selected AOI, which is an island of Corsica in this example. The request returns the maximum value of NDVI in this period as well as values of bands 4 and 8 based on which the max NDVI was calculated. The output is stored on selected S3 storage in a Zarr format.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hUqg2gfEuQ"}],"key":"v15fDg3lit"}],"key":"p5gaFhEeW6"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"url = \"https://services.sentinel-hub.com/api/v1/batch/process\"\n\nevalscript = \"\"\"\n    //VERSION=3\n    function setup() {\n        return {\n            input: [{\n                bands: [\"B04\", \"B08\"]\n            }],\n            output: [{\n                id: \"maxNDVI\",\n                sampleType: \"FLOAT32\",\n                bands: 1\n            },\n            {\n                id: \"band04\",\n                sampleType: \"UINT16\",\n                bands: 1\n            },\n            {\n                id: \"band08\",\n                sampleType: \"UINT16\",\n                bands: 1\n            }],\n            mosaicking: Mosaicking.ORBIT\n        }\n    }\n\n    function calcNDVI(sample) {\n        var denom = sample.B04 + sample.B08\n        return ((denom != 0) ? (sample.B08 - sample.B04) / denom : 0.0)\n    }\n\n    function evaluatePixel(samples) {\n        var maxNDVI = 0\n        var band04 = 0\n        var band08 = 0\n        for (var i = 0; i < samples.length; i++) {\n            var ndvi = calcNDVI(samples[i])\n            if (ndvi > maxNDVI){\n                maxNDVI = ndvi\n                band04 = samples[i].B04\n                band08 = samples[i].B08\n            }\n        }\n\n        return {\n            maxNDVI: [maxNDVI],\n            band04: [band04],\n            band08: [band08]\n        }\n    }\n\"\"\"\n\npayload = {\n    \"processRequest\": {\n        \"input\": {\n            \"bounds\": {\n                \"bbox\": [\n                    8.44,\n                    41.31,\n                    9.66,\n                    43.1\n                ],\n                \"properties\": {\n                    \"crs\": \"http://www.opengis.net/def/crs/OGC/1.3/CRS84\"\n                }\n            },\n            \"data\": [{\n                \"dataFilter\": {\n                    \"timeRange\": {\n                        \"from\": \"2019-04-01T00:00:00Z\",\n                        \"to\": \"2019-06-30T00:00:00Z\"\n                    },\n                \"maxCloudCoverage\": 70.0\n                },\n                \"type\": \"sentinel-2-l2a\"\n            }]\n        },\n        \"output\": {\n            \"responses\": [{\n                \"identifier\": \"band08\",\n                \"format\": {\n                    \"type\": \"zarr/array\"\n                }\n            },\n                {\n                \"identifier\": \"band04\",\n                \"format\": {\n                    \"type\": \"zarr/array\"\n                }\n            },\n                {\n                \"identifier\": \"maxNDVI\",\n                \"format\": {\n                    \"type\": \"zarr/array\"\n                }\n            }]\n        },\n        \"evalscript\": evalscript\n    },\n    \"tilingGrid\": {\n        \"id\": 6,\n        \"resolution\": 100.0\n    },\n    \"zarrOutput\": {\n        \"path\": \"<your-bucket>/<requestId>\",\n        \"group\": {\n            \"zarr_format\": 2\n        },\n        \"arrayParameters\": {\n            \"dtype\": \"<u2\",\n            \"order\": \"C\",\n            \"chunks\": [1, 1000, 1000],\n            \"fill_value\": 0\n        },\n        \"arrayOverrides\": {\n            \"maxNDVI\": {\n                \"dtype\": \"<f4\",\n                \"fill_value\": \"NaN\"\n            },\n        }\n    },\n    \"description\": \"Max NDVI over Corsica with Zarr format output\"\n}\n\nheaders = {\n  'Content-Type': 'application/json'\n}\n\nresponse = oauth.request(\"POST\", url, headers=headers, json = payload)","key":"B1qhopqxQC"},{"type":"output","id":"5kXz_dL1IgQrCXu9ngf0T","data":[],"key":"Opl5viEsXc"}],"key":"IXr2RgL7Kl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From the response, we will extract a request id and store it in a separate variable:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uWpWDds9wN"}],"key":"HFLtqzmBaB"}],"key":"esnChXtIly"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"batch_request_id = response.json()['id']\nbatch_request_id","key":"SM5qZh201N"},{"type":"output","id":"wPIJZpKWiiQrPjjoB2zF8","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"'9920066c-5336-4129-9e49-583dd6088ac3'","content_type":"text/plain"}}}],"key":"pbkT8U2EqH"}],"key":"oobBrg6rpB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We could request an analysis of the batch request in order to ensure that everything will run smoothly. However, to shorten the process for this demo, we will simply request start of the processing:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G9twiHGx34"}],"key":"zgEKr61NlI"}],"key":"e9qwGMPQYe"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Start processing\nurl = f\"https://services.sentinel-hub.com/api/v1/batch/process/{batch_request_id}/start\"\n\nresponse = oauth.request(\"POST\", url)\n\nresponse.status_code","key":"v7IwZjyH79"},{"type":"output","id":"R0bH_p69b43h7bfg8jGJo","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"204","content_type":"text/plain"}}}],"key":"YvSCIEE5ET"}],"key":"YWEzrTCMcQ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we have to wait until the processing is DONE. We can check the status of the request with running:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x2xVPgnedW"}],"key":"XXkiasHMOk"}],"key":"FHahoL9JUZ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Check status\nurl = f\"https://services.sentinel-hub.com/api/v1/batch/process/{batch_request_id}\"\n\nresponse = oauth.request(\"GET\", url)\n\nresponse.json()[\"status\"]","key":"y44rqUnDu6"},{"type":"output","id":"00phreHq4yhatRhcKolAh","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"'DONE'","content_type":"text/plain"}}}],"key":"s0LAc1FvgR"}],"key":"nrSdXUkwrk"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The processing is DONE and the results are available in my object storage as shown below. Note that the folder name is batch request id, since we used a placeholder ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PGkoInXcgF"},{"type":"inlineCode","value":"<requestId>","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GmKX8cM9TF"},{"type":"text","value":" in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HOfrPVYFJQ"},{"type":"inlineCode","value":"path","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SJaVNlHyF2"},{"type":"text","value":" parameter earlier.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zkLW52pFUr"}],"key":"W4kUVWh1ip"}],"key":"B5COnM8aSW"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"image","url":"/notebooks_test/build/68dffbf744fa42f4bf3d35e55684984e.png","alt":"image.png","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OEpfJoH5Bw","urlSource":"data:image/png;base64,iVBORw0KGg...5ErkJggg=="}],"key":"bWbEwqZ63l"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Explore the results with xarray","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sZoRnBn45K"}],"identifier":"explore-the-results-with-xarray","label":"Explore the results with xarray","html_id":"explore-the-results-with-xarray","implicit":true,"key":"X5XpH6kh61"}],"key":"L2SZdi61L7"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can now download the results and store them in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bALOQv2dyY"},{"type":"inlineCode","value":"./results","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pgtVEyIAgi"},{"type":"text","value":" folder. Note that you will have to set up your AWS credentials correctly in order to execute this command.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lGvkHcaUwW"}],"key":"etkPHbQKCj"}],"key":"THd4pTlM1H"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"!aws s3 cp <your-bucket>/9920066c-5336-4129-9e49-583dd6088ac3 ./results --recursive ","key":"KUcsu6jLxd"},{"type":"output","id":"wdY3XQJTxvZxCds2wkj8e","data":[{"name":"stdout","output_type":"stream","text":"Completed 460 Bytes/23.3 MiB (1.6 KiB/s) with 36 file(s) remaining\nCompleted 483 Bytes/23.3 MiB (1.7 KiB/s) with 36 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/.zattrs to results\\.zattrs\nCompleted 483 Bytes/23.3 MiB (1.7 KiB/s) with 35 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/.zgroup to results\\.zgroup\nCompleted 483 Bytes/23.3 MiB (1.7 KiB/s) with 34 file(s) remaining\nCompleted 798 Bytes/23.3 MiB (2.5 KiB/s) with 34 file(s) remaining\nCompleted 846 Bytes/23.3 MiB (2.7 KiB/s) with 34 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/band04/.zarray to results\\band04\\.zarray\nCompleted 846 Bytes/23.3 MiB (2.7 KiB/s) with 33 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/band04/.zattrs to results\\band04\\.zattrs\nCompleted 846 Bytes/23.3 MiB (2.7 KiB/s) with 32 file(s) remaining\nCompleted 894 Bytes/23.3 MiB (2.6 KiB/s) with 32 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/band08/.zattrs to results\\band08\\.zattrs\nCompleted 894 Bytes/23.3 MiB (2.6 KiB/s) with 31 file(s) remaining\nCompleted 17.0 KiB/23.3 MiB (49.2 KiB/s) with 31 file(s) remaining\nCompleted 17.3 KiB/23.3 MiB (49.9 KiB/s) with 31 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/band04/0.1.1 to results\\band04\\0.1.1\nCompleted 17.3 KiB/23.3 MiB (49.9 KiB/s) with 30 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/band08/.zarray to results\\band08\\.zarray\nCompleted 17.3 KiB/23.3 MiB (49.9 KiB/s) with 29 file(s) remaining\nCompleted 62.7 KiB/23.3 MiB (178.0 KiB/s) with 29 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/band04/0.2.0 to results\\band04\\0.2.0\nCompleted 62.7 KiB/23.3 MiB (178.0 KiB/s) with 28 file(s) remaining\nCompleted 103.9 KiB/23.3 MiB (249.7 KiB/s) with 28 file(s) remaining\nCompleted 174.7 KiB/23.3 MiB (419.8 KiB/s) with 28 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/band08/0.1.1 to results\\band08\\0.1.1\nCompleted 174.7 KiB/23.3 MiB (419.8 KiB/s) with 27 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/band04/0.0.1 to results\\band04\\0.0.1\nCompleted 174.7 KiB/23.3 MiB (419.8 KiB/s) with 26 file(s) remaining\nCompleted 280.1 KiB/23.3 MiB (659.7 KiB/s) with 26 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/band04/0.1.0 to results\\band04\\0.1.0\nCompleted 280.1 KiB/23.3 MiB (659.7 KiB/s) with 25 file(s) remaining\nCompleted 355.5 KiB/23.3 MiB (821.5 KiB/s) with 25 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/band04/0.2.1 to results\\band04\\0.2.1\nCompleted 355.5 KiB/23.3 MiB (821.5 KiB/s) with 24 file(s) remaining\nCompleted 471.7 KiB/23.3 MiB (1.0 MiB/s) with 24 file(s) remaining  \ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/band04/0.0.0 to results\\band04\\0.0.0\nCompleted 471.7 KiB/23.3 MiB (1.0 MiB/s) with 23 file(s) remaining\nCompleted 525.2 KiB/23.3 MiB (1.2 MiB/s) with 23 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/band08/0.2.0 to results\\band08\\0.2.0\nCompleted 525.2 KiB/23.3 MiB (1.2 MiB/s) with 22 file(s) remaining\nCompleted 651.8 KiB/23.3 MiB (1.4 MiB/s) with 22 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/band08/0.0.0 to results\\band08\\0.0.0\nCompleted 651.8 KiB/23.3 MiB (1.4 MiB/s) with 21 file(s) remaining\nCompleted 730.2 KiB/23.3 MiB (1.6 MiB/s) with 21 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/band08/0.0.1 to results\\band08\\0.0.1\nCompleted 730.2 KiB/23.3 MiB (1.6 MiB/s) with 20 file(s) remaining\nCompleted 730.3 KiB/23.3 MiB (1.6 MiB/s) with 20 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/maxNDVI/.zattrs to results\\maxNDVI\\.zattrs\nCompleted 730.3 KiB/23.3 MiB (1.6 MiB/s) with 19 file(s) remaining\nCompleted 823.6 KiB/23.3 MiB (1.7 MiB/s) with 19 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/band08/0.2.1 to results\\band08\\0.2.1\nCompleted 823.6 KiB/23.3 MiB (1.7 MiB/s) with 18 file(s) remaining\nCompleted 824.0 KiB/23.3 MiB (1.7 MiB/s) with 18 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/maxNDVI/.zarray to results\\maxNDVI\\.zarray\nCompleted 824.0 KiB/23.3 MiB (1.7 MiB/s) with 17 file(s) remaining\nCompleted 937.4 KiB/23.3 MiB (1.8 MiB/s) with 17 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/band08/0.1.0 to results\\band08\\0.1.0\nCompleted 937.4 KiB/23.3 MiB (1.8 MiB/s) with 16 file(s) remaining\nCompleted 940.7 KiB/23.3 MiB (1.8 MiB/s) with 16 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/request-9920066c-5336-4129-9e49-583dd6088ac3.json to results\\request-9920066c-5336-4129-9e49-583dd6088ac3.json\nCompleted 940.7 KiB/23.3 MiB (1.8 MiB/s) with 15 file(s) remaining\nCompleted 940.7 KiB/23.3 MiB (1.8 MiB/s) with 15 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/x/.zattrs to results\\x\\.zattrs\nCompleted 940.7 KiB/23.3 MiB (1.8 MiB/s) with 14 file(s) remaining\nCompleted 940.7 KiB/23.3 MiB (1.7 MiB/s) with 14 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/time/0 to results\\time\\0\nCompleted 940.7 KiB/23.3 MiB (1.7 MiB/s) with 13 file(s) remaining\nCompleted 940.9 KiB/23.3 MiB (1.7 MiB/s) with 13 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/time/.zarray to results\\time\\.zarray\nCompleted 940.9 KiB/23.3 MiB (1.7 MiB/s) with 12 file(s) remaining\nCompleted 949.1 KiB/23.3 MiB (1.6 MiB/s) with 12 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/x/0 to results\\x\\0\nCompleted 949.1 KiB/23.3 MiB (1.6 MiB/s) with 11 file(s) remaining\nCompleted 949.4 KiB/23.3 MiB (1.5 MiB/s) with 11 file(s) remaining\nCompleted 949.5 KiB/23.3 MiB (1.5 MiB/s) with 11 file(s) remaining\nCompleted 962.1 KiB/23.3 MiB (1.5 MiB/s) with 11 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/y/.zarray to results\\y\\.zarray\nCompleted 962.1 KiB/23.3 MiB (1.5 MiB/s) with 10 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/y/0 to results\\y\\0\nCompleted 962.1 KiB/23.3 MiB (1.5 MiB/s) with 9 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/time/.zattrs to results\\time\\.zattrs\nCompleted 962.1 KiB/23.3 MiB (1.5 MiB/s) with 8 file(s) remaining\nCompleted 1.2 MiB/23.3 MiB (1.8 MiB/s) with 8 file(s) remaining  \nCompleted 1.2 MiB/23.3 MiB (1.7 MiB/s) with 8 file(s) remaining  \nCompleted 1.2 MiB/23.3 MiB (1.7 MiB/s) with 8 file(s) remaining  \nCompleted 1.4 MiB/23.3 MiB (2.1 MiB/s) with 8 file(s) remaining  \ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/y/.zattrs to results\\y\\.zattrs\nCompleted 1.4 MiB/23.3 MiB (2.1 MiB/s) with 7 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/x/.zarray to results\\x\\.zarray\nCompleted 1.4 MiB/23.3 MiB (2.1 MiB/s) with 6 file(s) remaining\nCompleted 1.7 MiB/23.3 MiB (2.2 MiB/s) with 6 file(s) remaining\nCompleted 1.9 MiB/23.3 MiB (2.5 MiB/s) with 6 file(s) remaining\nCompleted 2.2 MiB/23.3 MiB (2.8 MiB/s) with 6 file(s) remaining\nCompleted 2.4 MiB/23.3 MiB (3.1 MiB/s) with 6 file(s) remaining\nCompleted 2.7 MiB/23.3 MiB (3.3 MiB/s) with 6 file(s) remaining\nCompleted 2.9 MiB/23.3 MiB (3.3 MiB/s) with 6 file(s) remaining\nCompleted 3.2 MiB/23.3 MiB (3.5 MiB/s) with 6 file(s) remaining\nCompleted 3.4 MiB/23.3 MiB (3.8 MiB/s) with 6 file(s) remaining\nCompleted 3.7 MiB/23.3 MiB (4.1 MiB/s) with 6 file(s) remaining\nCompleted 3.9 MiB/23.3 MiB (4.3 MiB/s) with 6 file(s) remaining\nCompleted 4.2 MiB/23.3 MiB (4.5 MiB/s) with 6 file(s) remaining\nCompleted 4.4 MiB/23.3 MiB (4.4 MiB/s) with 6 file(s) remaining\nCompleted 4.7 MiB/23.3 MiB (4.6 MiB/s) with 6 file(s) remaining\nCompleted 4.9 MiB/23.3 MiB (4.8 MiB/s) with 6 file(s) remaining\nCompleted 5.2 MiB/23.3 MiB (5.0 MiB/s) with 6 file(s) remaining\nCompleted 5.4 MiB/23.3 MiB (5.2 MiB/s) with 6 file(s) remaining\nCompleted 5.7 MiB/23.3 MiB (5.3 MiB/s) with 6 file(s) remaining\nCompleted 5.9 MiB/23.3 MiB (5.4 MiB/s) with 6 file(s) remaining\nCompleted 6.2 MiB/23.3 MiB (5.6 MiB/s) with 6 file(s) remaining\nCompleted 6.4 MiB/23.3 MiB (5.5 MiB/s) with 6 file(s) remaining\nCompleted 6.7 MiB/23.3 MiB (5.7 MiB/s) with 6 file(s) remaining\nCompleted 6.9 MiB/23.3 MiB (5.8 MiB/s) with 6 file(s) remaining\nCompleted 7.2 MiB/23.3 MiB (5.8 MiB/s) with 6 file(s) remaining\nCompleted 7.4 MiB/23.3 MiB (5.9 MiB/s) with 6 file(s) remaining\nCompleted 7.7 MiB/23.3 MiB (6.1 MiB/s) with 6 file(s) remaining\nCompleted 7.9 MiB/23.3 MiB (6.3 MiB/s) with 6 file(s) remaining\nCompleted 8.2 MiB/23.3 MiB (6.3 MiB/s) with 6 file(s) remaining\nCompleted 8.4 MiB/23.3 MiB (6.3 MiB/s) with 6 file(s) remaining\nCompleted 8.7 MiB/23.3 MiB (6.3 MiB/s) with 6 file(s) remaining\nCompleted 8.9 MiB/23.3 MiB (6.4 MiB/s) with 6 file(s) remaining\nCompleted 9.2 MiB/23.3 MiB (6.5 MiB/s) with 6 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/maxNDVI/0.1.1 to results\\maxNDVI\\0.1.1\nCompleted 9.2 MiB/23.3 MiB (6.5 MiB/s) with 5 file(s) remaining\nCompleted 9.4 MiB/23.3 MiB (6.7 MiB/s) with 5 file(s) remaining\nCompleted 9.7 MiB/23.3 MiB (6.6 MiB/s) with 5 file(s) remaining\nCompleted 9.9 MiB/23.3 MiB (6.6 MiB/s) with 5 file(s) remaining\nCompleted 10.2 MiB/23.3 MiB (6.7 MiB/s) with 5 file(s) remaining\nCompleted 10.4 MiB/23.3 MiB (6.7 MiB/s) with 5 file(s) remaining\nCompleted 10.7 MiB/23.3 MiB (6.7 MiB/s) with 5 file(s) remaining\n"},{"name":"stdout","output_type":"stream","text":"Completed 10.9 MiB/23.3 MiB (6.8 MiB/s) with 5 file(s) remaining\nCompleted 11.2 MiB/23.3 MiB (6.9 MiB/s) with 5 file(s) remaining\nCompleted 11.4 MiB/23.3 MiB (6.8 MiB/s) with 5 file(s) remaining\nCompleted 11.7 MiB/23.3 MiB (6.9 MiB/s) with 5 file(s) remaining\nCompleted 11.9 MiB/23.3 MiB (7.0 MiB/s) with 5 file(s) remaining\nCompleted 12.2 MiB/23.3 MiB (7.1 MiB/s) with 5 file(s) remaining\nCompleted 12.4 MiB/23.3 MiB (7.1 MiB/s) with 5 file(s) remaining\nCompleted 12.7 MiB/23.3 MiB (7.1 MiB/s) with 5 file(s) remaining\nCompleted 12.9 MiB/23.3 MiB (7.2 MiB/s) with 5 file(s) remaining\nCompleted 13.2 MiB/23.3 MiB (7.2 MiB/s) with 5 file(s) remaining\nCompleted 13.4 MiB/23.3 MiB (7.2 MiB/s) with 5 file(s) remaining\nCompleted 13.7 MiB/23.3 MiB (7.3 MiB/s) with 5 file(s) remaining\nCompleted 13.9 MiB/23.3 MiB (7.3 MiB/s) with 5 file(s) remaining\nCompleted 14.2 MiB/23.3 MiB (7.4 MiB/s) with 5 file(s) remaining\nCompleted 14.4 MiB/23.3 MiB (7.4 MiB/s) with 5 file(s) remaining\nCompleted 14.7 MiB/23.3 MiB (7.5 MiB/s) with 5 file(s) remaining\nCompleted 14.9 MiB/23.3 MiB (7.5 MiB/s) with 5 file(s) remaining\nCompleted 15.2 MiB/23.3 MiB (7.5 MiB/s) with 5 file(s) remaining\nCompleted 15.4 MiB/23.3 MiB (7.6 MiB/s) with 5 file(s) remaining\nCompleted 15.7 MiB/23.3 MiB (7.5 MiB/s) with 5 file(s) remaining\nCompleted 15.9 MiB/23.3 MiB (7.6 MiB/s) with 5 file(s) remaining\nCompleted 16.2 MiB/23.3 MiB (7.7 MiB/s) with 5 file(s) remaining\nCompleted 16.4 MiB/23.3 MiB (7.8 MiB/s) with 5 file(s) remaining\nCompleted 16.7 MiB/23.3 MiB (7.8 MiB/s) with 5 file(s) remaining\nCompleted 16.9 MiB/23.3 MiB (7.7 MiB/s) with 5 file(s) remaining\nCompleted 17.2 MiB/23.3 MiB (7.8 MiB/s) with 5 file(s) remaining\nCompleted 17.4 MiB/23.3 MiB (7.9 MiB/s) with 5 file(s) remaining\nCompleted 17.7 MiB/23.3 MiB (7.8 MiB/s) with 5 file(s) remaining\nCompleted 17.9 MiB/23.3 MiB (7.9 MiB/s) with 5 file(s) remaining\nCompleted 18.2 MiB/23.3 MiB (8.0 MiB/s) with 5 file(s) remaining\nCompleted 18.2 MiB/23.3 MiB (8.0 MiB/s) with 5 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/maxNDVI/0.2.1 to results\\maxNDVI\\0.2.1\nCompleted 18.2 MiB/23.3 MiB (8.0 MiB/s) with 4 file(s) remaining\nCompleted 18.5 MiB/23.3 MiB (8.1 MiB/s) with 4 file(s) remaining\nCompleted 18.7 MiB/23.3 MiB (8.0 MiB/s) with 4 file(s) remaining\nCompleted 19.0 MiB/23.3 MiB (8.0 MiB/s) with 4 file(s) remaining\nCompleted 19.2 MiB/23.3 MiB (8.1 MiB/s) with 4 file(s) remaining\nCompleted 19.5 MiB/23.3 MiB (8.1 MiB/s) with 4 file(s) remaining\nCompleted 19.7 MiB/23.3 MiB (8.1 MiB/s) with 4 file(s) remaining\nCompleted 20.0 MiB/23.3 MiB (8.1 MiB/s) with 4 file(s) remaining\nCompleted 20.2 MiB/23.3 MiB (8.2 MiB/s) with 4 file(s) remaining\nCompleted 20.3 MiB/23.3 MiB (8.2 MiB/s) with 4 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/maxNDVI/0.0.1 to results\\maxNDVI\\0.0.1\nCompleted 20.3 MiB/23.3 MiB (8.2 MiB/s) with 3 file(s) remaining\nCompleted 20.6 MiB/23.3 MiB (8.2 MiB/s) with 3 file(s) remaining\nCompleted 20.8 MiB/23.3 MiB (8.3 MiB/s) with 3 file(s) remaining\nCompleted 21.1 MiB/23.3 MiB (8.2 MiB/s) with 3 file(s) remaining\nCompleted 21.3 MiB/23.3 MiB (8.2 MiB/s) with 3 file(s) remaining\nCompleted 21.6 MiB/23.3 MiB (8.2 MiB/s) with 3 file(s) remaining\nCompleted 21.8 MiB/23.3 MiB (8.2 MiB/s) with 3 file(s) remaining\nCompleted 22.1 MiB/23.3 MiB (8.2 MiB/s) with 3 file(s) remaining\nCompleted 22.1 MiB/23.3 MiB (8.2 MiB/s) with 3 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/maxNDVI/0.1.0 to results\\maxNDVI\\0.1.0\nCompleted 22.1 MiB/23.3 MiB (8.2 MiB/s) with 2 file(s) remaining\nCompleted 22.3 MiB/23.3 MiB (8.2 MiB/s) with 2 file(s) remaining\nCompleted 22.6 MiB/23.3 MiB (8.3 MiB/s) with 2 file(s) remaining\nCompleted 22.7 MiB/23.3 MiB (8.2 MiB/s) with 2 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/maxNDVI/0.0.0 to results\\maxNDVI\\0.0.0\nCompleted 22.7 MiB/23.3 MiB (8.2 MiB/s) with 1 file(s) remaining\nCompleted 23.0 MiB/23.3 MiB (8.2 MiB/s) with 1 file(s) remaining\nCompleted 23.2 MiB/23.3 MiB (8.0 MiB/s) with 1 file(s) remaining\nCompleted 23.3 MiB/23.3 MiB (8.0 MiB/s) with 1 file(s) remaining\ndownload: s3://anja-sh-testing/batch-zarr-demo/9920066c-5336-4129-9e49-583dd6088ac3/maxNDVI/0.2.0 to results\\maxNDVI\\0.2.0\n"}],"key":"ua29XzIAXu"}],"key":"AYRG97f0Gk"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can now open and explore the date with xarray:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Le3Rfs1jlh"}],"key":"caQ1WSLS0I"}],"key":"ruZv4hzPjx"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"cube_before = xr.open_zarr(\"./results\")\ncube_before","key":"UkxlGpZpL3"},{"type":"output","id":"jCzAWeDClIu8Yb2chnQn5","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=dark],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1F1F1F;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 20px 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: none;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: '►';\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: '▼';\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: '(';\n}\n\n.xr-dim-list:after {\n  content: ')';\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: ',';\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2 {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;\nDimensions:  (time: 1, x: 2000, y: 3000)\nCoordinates:\n  * time     (time) datetime64[ns] 2019-04-01\n  * x        (x) float64 4.1e+06 4.1e+06 4.1e+06 ... 4.3e+06 4.3e+06 4.3e+06\n  * y        (y) float64 2.3e+06 2.3e+06 2.3e+06 2.3e+06 ... 2e+06 2e+06 2e+06\nData variables:\n    band04   (time, y, x) float32 ...\n    band08   (time, y, x) float32 ...\n    maxNDVI  (time, y, x) float32 ...\nAttributes:\n    geospatial_lat_max:         2300000.0\n    date_modified:              2022-11-21T11:47:57.644625Z\n    geospatial_lat_units:       degrees_north\n    time_coverage_end:          2019-06-30T00:00:00Z\n    geospatial_lat_resolution:  100.0\n    geospatial_lon_min:         4100000.0\n    geospatial_lon_max:         4300000.0\n    geospatial_lon_units:       degrees_east\n    geospatial_lon_resolution:  100.0\n    time_coverage_start:        2019-04-01T00:00:00Z\n    geospatial_lat_min:         2000000.0</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-ffa37616-8f3e-44ca-a3b1-e174daca0f38' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ffa37616-8f3e-44ca-a3b1-e174daca0f38' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1</li><li><span class='xr-has-index'>x</span>: 2000</li><li><span class='xr-has-index'>y</span>: 3000</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f363ac83-2d22-41bc-a8bb-96deede7798b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f363ac83-2d22-41bc-a8bb-96deede7798b' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2019-04-01</div><input id='attrs-0e141ddc-6a20-4519-82b1-e1674f2202de' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0e141ddc-6a20-4519-82b1-e1674f2202de' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0807216b-9171-41b6-9e80-a54d1c616d93' class='xr-var-data-in' type='checkbox'><label for='data-0807216b-9171-41b6-9e80-a54d1c616d93' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2019-04-01T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.1e+06 4.1e+06 ... 4.3e+06 4.3e+06</div><input id='attrs-085c2f11-5afe-4c65-8419-61b420b0453f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-085c2f11-5afe-4c65-8419-61b420b0453f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-47e43369-ccd7-431e-87dd-2c7ecddf7567' class='xr-var-data-in' type='checkbox'><label for='data-47e43369-ccd7-431e-87dd-2c7ecddf7567' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([4100050., 4100150., 4100250., ..., 4299750., 4299850., 4299950.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.3e+06 2.3e+06 ... 2e+06 2e+06</div><input id='attrs-06648f8f-ba41-4162-86fa-b6521596170d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-06648f8f-ba41-4162-86fa-b6521596170d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-53b58dd9-d2c0-47cf-bb63-50dd4463b07c' class='xr-var-data-in' type='checkbox'><label for='data-53b58dd9-d2c0-47cf-bb63-50dd4463b07c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2299950., 2299850., 2299750., ..., 2000250., 2000150., 2000050.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-890baced-c024-4a87-967d-2d50a550b54f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-890baced-c024-4a87-967d-2d50a550b54f' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>band04</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a9696d08-2a7e-4a8f-82af-26ffa2d2c30b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a9696d08-2a7e-4a8f-82af-26ffa2d2c30b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b9d5ee02-deb2-4219-8277-6381e31065ff' class='xr-var-data-in' type='checkbox'><label for='data-b9d5ee02-deb2-4219-8277-6381e31065ff' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[6000000 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>band08</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-939a93cf-523b-4934-9886-781c5ed85d80' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-939a93cf-523b-4934-9886-781c5ed85d80' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d4f7bd95-1085-4f3f-af45-3320832c232f' class='xr-var-data-in' type='checkbox'><label for='data-d4f7bd95-1085-4f3f-af45-3320832c232f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[6000000 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>maxNDVI</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-03caab7a-c7f4-4a78-906b-12aec1c4387d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-03caab7a-c7f4-4a78-906b-12aec1c4387d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6f19d396-96ee-44e3-add9-497fcd936714' class='xr-var-data-in' type='checkbox'><label for='data-6f19d396-96ee-44e3-add9-497fcd936714' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[6000000 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-915024ed-5c73-4a44-b0fa-e5cdd57200cd' class='xr-section-summary-in' type='checkbox'  ><label for='section-915024ed-5c73-4a44-b0fa-e5cdd57200cd' class='xr-section-summary' >Attributes: <span>(11)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>geospatial_lat_max :</span></dt><dd>2300000.0</dd><dt><span>date_modified :</span></dt><dd>2022-11-21T11:47:57.644625Z</dd><dt><span>geospatial_lat_units :</span></dt><dd>degrees_north</dd><dt><span>time_coverage_end :</span></dt><dd>2019-06-30T00:00:00Z</dd><dt><span>geospatial_lat_resolution :</span></dt><dd>100.0</dd><dt><span>geospatial_lon_min :</span></dt><dd>4100000.0</dd><dt><span>geospatial_lon_max :</span></dt><dd>4300000.0</dd><dt><span>geospatial_lon_units :</span></dt><dd>degrees_east</dd><dt><span>geospatial_lon_resolution :</span></dt><dd>100.0</dd><dt><span>time_coverage_start :</span></dt><dd>2019-04-01T00:00:00Z</dd><dt><span>geospatial_lat_min :</span></dt><dd>2000000.0</dd></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.Dataset>\nDimensions:  (time: 1, x: 2000, y: 3000)\nCoordinates:\n  * time     (time) datetime64[ns] 2019-04-01\n  * x        (x) float64 4.1e+06 4.1e+06 4.1e+06 ... 4.3e+06 4.3e+06 4.3e+06\n  * y        (y) float64 2.3e+06 2.3e+06 2.3e+06 2.3e+06 ... 2e+06 2e+06 2e+06\nData variables:\n    band04   (time, y, x) float32 ...\n    band08   (time, y, x) float32 ...\n    maxNDVI  (time, y, x) float32 ...\nAttributes:\n    geospatial_lat_max:         2300000.0\n    date_modified:              2022-11-21T11:47:57.644625Z\n    geospatial_lat_units:       degrees_north\n    time_coverage_end:          2019-06-30T00:00:00Z\n    geospatial_lat_resolution:  100.0\n    geospatial_lon_min:         4100000.0\n    geospatial_lon_max:         4300000.0\n    geospatial_lon_units:       degrees_east\n    geospatial_lon_resolution:  100.0\n    time_coverage_start:        2019-04-01T00:00:00Z\n    geospatial_lat_min:         2000000.0","content_type":"text/plain"}}}],"key":"labxOiXA65"}],"key":"pqh9i0HMGw"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"cube_before.maxNDVI.isel(time=0).plot(figsize=[12,12], vmax=1.0)","key":"iXOLb1AEde"},{"type":"output","id":"miICPSIiCNwqv-ChNbSop","data":[{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"eb7c004b7108aab0f1cde28a4c6a2289","path":"/notebooks_test/build/eb7c004b7108aab0f1cde28a4c6a2289.png"},"text/plain":{"content":"<Figure size 864x864 with 2 Axes>","content_type":"text/plain"}}}],"key":"dqLQfpjyxS"}],"key":"JKN3ONkyZy"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Ingest results to Sentinel Hub with Zarr import API","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ji7QecjWUD"}],"identifier":"ingest-results-to-sentinel-hub-with-zarr-import-api","label":"Ingest results to Sentinel Hub with Zarr import API","html_id":"ingest-results-to-sentinel-hub-with-zarr-import-api","implicit":true,"key":"r0dwJoKzye"}],"key":"JVC9sigDaq"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The results can also be ingested back to the Sentinel Hub:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iqPGDAm0Os"}],"key":"xEasuGdzEY"}],"key":"dz7IWFKLEp"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"collection = {\n  'name': 'My Zarr Test Nov',\n  's3Bucket': <your-bucket-name>,\n  'path': f'<folder-in-your-bucket>/{batch_request_id}/',\n  \"crs\":\"http://www.opengis.net/def/crs/EPSG/0/3035\"\n}\n\nresponse = oauth.post('https://services.sentinel-hub.com/api/v1/zarr/collections', json=collection)\nresponse.raise_for_status()","key":"bLFCy05kN7"},{"type":"output","id":"dBuR6sP01aB110bmDdIKi","data":[],"key":"UsUhjrkc3P"}],"key":"xuRmGqLLWq"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This create a data collection. To get its id, run ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YgwuYunM1A"},{"type":"inlineCode","value":"response.json()[\"data\"][\"id\"]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wGPvRUFB78"},{"type":"text","value":". Form here on, we can use all Sentinel Hub funcionalites when working with this data collection.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s3BrHardQ1"}],"key":"E74nAYupoa"}],"key":"AHx62RV6oJ"}],"key":"z2Ouk4oMeJ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Aerosol Optical Thickness (AOT) Anomaly Detection Using Sentinel-2","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/aot-covid19","group":"Contributions"},"next":{"title":"Important notes","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/client-side-processing-using-mass-sh","group":"Contributions"}}},"domain":"http://localhost:3000"}