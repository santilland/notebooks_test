{"version":1,"kind":"Notebook","sha256":"c328540f29519ab298d88648ddabe9bbc9e4bc556ea3532c9f9d04b5fea2d47d","slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.openeo-client-demo","location":"/external_notebooks/eurodatacube/notebooks/notebooks/contributions/openeo-client-demo.ipynb","dependencies":[],"frontmatter":{"title":"openEO Client Demo","content_includes_title":false,"kernelspec":{"name":"edc","display_name":"EDC 2022.02 (Python3)","language":"python"},"github":"https://github.com/eoxhub-workspaces/documentation/","numbering":{"title":{"offset":5}},"edit_url":"https://github.com/eoxhub-workspaces/documentation//blob/main/external_notebooks/eurodatacube/notebooks/notebooks/contributions/openeo-client-demo.ipynb","exports":[{"format":"ipynb","filename":"openeo-client-demo.ipynb","url":"/notebooks_test/build/openeo-client-demo-132d99ebfc1e294f5b0ef729222f3fa4.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This notebook demonstrates how an openEO job execution can be managed from Python.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hjq1iRzxxU"}],"key":"ATz3rHGHsD"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"To run this notebook, an ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MK7MOme3QC"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"openEO","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"k50YW96JL9"}],"key":"o89EVn8Rzn"},{"type":"text","value":" early adopters account is necessary. Please obtain one via this link:\n","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FKcISjJRFZ"},{"type":"link","url":"https://openeo.cloud/early-adopters/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"https://​openeo​.cloud​/early​-adopters/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oVvdegvmBI"}],"urlSource":"https://openeo.cloud/early-adopters/","key":"l1qwDJNUr4"}],"key":"ap3o4G1fdH"}],"key":"nB20qxS5Ev"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"import openeo","key":"zz6UNVT9b0"},{"type":"output","id":"IkM8HDi18kf6AP7fV-xGt","data":[],"key":"EUROJ6coX8"}],"key":"N8xfkJ2abF"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"connection = openeo.connect('https://openeo.cloud').authenticate_oidc()","visibility":"show","key":"HJYpjh7wuj"},{"type":"output","id":"UvqnYJxxTahZx14gupIkf","data":[{"name":"stdout","output_type":"stream","text":"Authenticated using refresh token.\n"}],"visibility":"show","key":"xf2CcLa2Yn"}],"visibility":"show","key":"n7CH1E9XaY"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"process_graph = {\n    \"1\": {\n      \"arguments\": {\n        \"bands\": [\n          \"B04\",\n          \"B02\",\n          \"B03\"\n        ],\n        \"id\": \"SENTINEL2_L2A_SENTINELHUB\",\n        \"spatial_extent\": {\n          \"east\": 84.30320684519523,\n          \"north\": 28.28834175540571,\n          \"south\": 28.268476701871247,\n          \"west\": 84.25171700124623\n        },\n        \"temporal_extent\": [\n          \"2019-05-01T00:01:00Z\",\n          \"2019-05-15T00:01:00Z\"\n        ]\n      },\n      \"position\": [\n        0,\n        0\n      ],\n      \"process_id\": \"load_collection\"\n    },\n    \"2\": {\n      \"arguments\": {\n        \"data\": {\n          \"from_node\": \"1\"\n        },\n        \"format\": \"GTIFF\"\n      },\n      \"position\": [\n        240,\n        0\n      ],\n      \"process_id\": \"save_result\",\n      \"result\": True\n    }\n}\n","key":"oqcY6sVzqg"},{"type":"output","id":"B5eYZseMUUaIfAQqIle7M","data":[],"key":"tH08HfCfQ8"}],"key":"yVJdQsMDWv"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"job = connection.create_job(process_graph)","key":"Y8v3moJaL0"},{"type":"output","id":"gyDtcD1SDYBEIEWydZ9gZ","data":[],"key":"VjkAo6yULG"}],"key":"c8mmQhppS0"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"job.start_and_wait()","key":"YG05hVfNEi"},{"type":"output","id":"v7RBSMs738eGKv8jkr3fI","data":[{"name":"stdout","output_type":"stream","text":"0:00:00 Job 'vito-b852223e-cef6-4742-88b3-09a262efe440': send 'start'\n0:01:09 Job 'vito-b852223e-cef6-4742-88b3-09a262efe440': queued (progress N/A)\n0:01:15 Job 'vito-b852223e-cef6-4742-88b3-09a262efe440': queued (progress N/A)\n0:01:22 Job 'vito-b852223e-cef6-4742-88b3-09a262efe440': queued (progress N/A)\n0:01:31 Job 'vito-b852223e-cef6-4742-88b3-09a262efe440': queued (progress N/A)\n0:01:42 Job 'vito-b852223e-cef6-4742-88b3-09a262efe440': queued (progress N/A)\n0:01:54 Job 'vito-b852223e-cef6-4742-88b3-09a262efe440': queued (progress N/A)\n0:02:11 Job 'vito-b852223e-cef6-4742-88b3-09a262efe440': queued (progress N/A)\n0:02:31 Job 'vito-b852223e-cef6-4742-88b3-09a262efe440': queued (progress N/A)\n0:02:55 Job 'vito-b852223e-cef6-4742-88b3-09a262efe440': running (progress N/A)\n0:03:26 Job 'vito-b852223e-cef6-4742-88b3-09a262efe440': running (progress N/A)\n0:04:05 Job 'vito-b852223e-cef6-4742-88b3-09a262efe440': running (progress N/A)\n0:04:52 Job 'vito-b852223e-cef6-4742-88b3-09a262efe440': running (progress N/A)\n0:05:52 Job 'vito-b852223e-cef6-4742-88b3-09a262efe440': finished (progress N/A)\n"},{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/html":{"content":"\n    <script>\n    if (!window.customElements || !window.customElements.get('openeo-job')) {\n        var el = document.createElement('script');\n        el.src = \"https://cdn.jsdelivr.net/npm/@openeo/vue-components@2/assets/openeo.min.js\";\n        document.head.appendChild(el);\n\n        var font = document.createElement('font');\n        font.as = \"font\";\n        font.type = \"font/woff2\";\n        font.crossOrigin = true;\n        font.href = \"https://use.fontawesome.com/releases/v5.13.0/webfonts/fa-solid-900.woff2\"\n        document.head.appendChild(font);\n    }\n    </script>\n    <openeo-job>\n        <script type=\"application/json\">{\"currency\": \"EUR\", \"job\": {\"created\": \"2022-04-05T11:57:10Z\", \"id\": \"vito-b852223e-cef6-4742-88b3-09a262efe440\", \"process\": {\"process_graph\": {\"1\": {\"arguments\": {\"bands\": [\"B04\", \"B02\", \"B03\"], \"id\": \"SENTINEL2_L2A_SENTINELHUB\", \"spatial_extent\": {\"east\": 84.30320684519523, \"north\": 28.28834175540571, \"south\": 28.268476701871247, \"west\": 84.25171700124623}, \"temporal_extent\": [\"2019-05-01T00:01:00Z\", \"2019-05-15T00:01:00Z\"]}, \"position\": [0, 0], \"process_id\": \"load_collection\"}, \"2\": {\"arguments\": {\"data\": {\"from_node\": \"1\"}, \"format\": \"GTIFF\"}, \"position\": [240, 0], \"process_id\": \"save_result\", \"result\": true}}}, \"status\": \"finished\", \"updated\": \"2022-04-05T11:58:16Z\", \"usage\": {\"cpu\": {\"unit\": \"cpu-seconds\", \"value\": 2475}, \"duration\": {\"unit\": \"seconds\", \"value\": 213}, \"memory\": {\"unit\": \"mb-seconds\", \"value\": 6675242}}}}</script>\n    </openeo-job>\n    ","content_type":"text/html"},"text/plain":{"content":"<RESTJob job_id='vito-b852223e-cef6-4742-88b3-09a262efe440'>","content_type":"text/plain"}}}],"key":"awizAdS5Ig"}],"key":"diVJdgT6tR"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"job.describe_job()","key":"t6nyziTZ8B"},{"type":"output","id":"J26ALWhGcIDWCvbQoiLj0","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"{'created': '2022-04-05T11:57:10Z',\n 'id': 'vito-b852223e-cef6-4742-88b3-09a262efe440',\n 'process': {'process_graph': {'1': {'arguments': {'bands': ['B04',\n      'B02',\n      'B03'],\n     'id': 'SENTINEL2_L2A_SENTINELHUB',\n     'spatial_extent': {'east': 84.30320684519523,\n      'north': 28.28834175540571,\n      'south': 28.268476701871247,\n      'west': 84.25171700124623},\n     'temporal_extent': ['2019-05-01T00:01:00Z', '2019-05-15T00:01:00Z']},\n    'position': [0, 0],\n    'process_id': 'load_collection'},\n   '2': {'arguments': {'data': {'from_node': '1'}, 'format': 'GTIFF'},\n    'position': [240, 0],\n    'process_id': 'save_result',\n    'result': True}}},\n 'status': 'finished',\n 'updated': '2022-04-05T11:58:16Z',\n 'usage': {'cpu': {'unit': 'cpu-seconds', 'value': 2475},\n  'duration': {'unit': 'seconds', 'value': 213},\n  'memory': {'unit': 'mb-seconds', 'value': 6675242}}}","content_type":"text/plain"}}}],"key":"YpWXzvRQQE"}],"key":"loyYWHAKhD"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"job_results = job.get_results()","key":"O3cmViyhIU"},{"type":"output","id":"1HCP7hEGWrJktGUN1dHBM","data":[],"key":"GnAYkTloDU"}],"key":"nJZsPYW4Q4"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"job_results.get_assets()","key":"I2xGAL2YmR"},{"type":"output","id":"NHo4pO5N6cazdylpyWN5I","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"[<ResultAsset 'openEO_2019-05-01Z.tif' (type image/tiff; application=geotiff) at 'https://openeo.vito.be/openeo/1.0/jobs/b852223e-cef6-4742-88b3-09a262efe440/results/ZmNlYmNiZDNhZTMxMjZjOTNkNTY3OWM4ZWEzNDg0MjcxMTA1YTM2MTU4MTBmNDAwMzY5MWI0Mjk5ZWU3N2U5YkBlZ2kuZXU%3D/619185bc5adf90f25960d545eb99a2cc/openEO_2019-05-01Z.tif?expires=1649764986'>,\n <ResultAsset 'openEO_2019-05-06Z.tif' (type image/tiff; application=geotiff) at 'https://openeo.vito.be/openeo/1.0/jobs/b852223e-cef6-4742-88b3-09a262efe440/results/ZmNlYmNiZDNhZTMxMjZjOTNkNTY3OWM4ZWEzNDg0MjcxMTA1YTM2MTU4MTBmNDAwMzY5MWI0Mjk5ZWU3N2U5YkBlZ2kuZXU%3D/7bae35f54f40d9134448d4d9818bada4/openEO_2019-05-06Z.tif?expires=1649764986'>,\n <ResultAsset 'openEO_2019-05-11Z.tif' (type image/tiff; application=geotiff) at 'https://openeo.vito.be/openeo/1.0/jobs/b852223e-cef6-4742-88b3-09a262efe440/results/ZmNlYmNiZDNhZTMxMjZjOTNkNTY3OWM4ZWEzNDg0MjcxMTA1YTM2MTU4MTBmNDAwMzY5MWI0Mjk5ZWU3N2U5YkBlZ2kuZXU%3D/e9c64b8c2a5323fd01b02000f145f62e/openEO_2019-05-11Z.tif?expires=1649764986'>]","content_type":"text/plain"}}}],"key":"w7nuSaiceO"}],"key":"bfCEn7yVli"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"downloaded_files = job_results.download_files(\"/home/jovyan/results\")\ndownloaded_files","key":"imQOUxvqpT"},{"type":"output","id":"YLOHTFYo3HtFl3u7v-3d1","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"[PosixPath('/home/jovyan/results/openEO_2019-05-01Z.tif'),\n PosixPath('/home/jovyan/results/openEO_2019-05-06Z.tif'),\n PosixPath('/home/jovyan/results/openEO_2019-05-11Z.tif')]","content_type":"text/plain"}}}],"key":"dmqPYRneRb"}],"key":"IgF95oYeu5"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"import rasterio\nfrom rasterio.plot import show\n\nfor path in downloaded_files:\n    img = rasterio.open(path)\n    show(img)","key":"TMks15z3KS"},{"type":"output","id":"maQHnJ9k--xBYhiiKggJS","data":[{"name":"stderr","output_type":"stream","text":"Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).\n"},{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"ae00fae35503895fe450b63cae286471","path":"/notebooks_test/build/ae00fae35503895fe450b63cae286471.png"},"text/plain":{"content":"<Figure size 432x288 with 1 Axes>","content_type":"text/plain"}}},{"name":"stderr","output_type":"stream","text":"Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).\n"},{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"5abd2614cbef69668deea24961d71d11","path":"/notebooks_test/build/5abd2614cbef69668deea24961d71d11.png"},"text/plain":{"content":"<Figure size 432x288 with 1 Axes>","content_type":"text/plain"}}},{"name":"stderr","output_type":"stream","text":"Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).\n"},{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"577ab80527560cd6177980c84656780f","path":"/notebooks_test/build/577ab80527560cd6177980c84656780f.png"},"text/plain":{"content":"<Figure size 432x288 with 1 Axes>","content_type":"text/plain"}}}],"key":"WC25RBBVqn"}],"key":"iLvnyMth2y"}],"key":"QoulWntL4n"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Important notes","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/ogc-edc","group":"Contributions"},"next":{"title":"Finished Goods Inventory indicator for RACE","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/race-finishedgoodsinventory-inidcator","group":"Contributions"}}},"domain":"http://localhost:3000"}