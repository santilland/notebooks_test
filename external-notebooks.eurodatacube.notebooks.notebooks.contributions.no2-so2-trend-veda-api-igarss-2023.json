{"version":1,"kind":"Notebook","sha256":"b72780245b4da5f3c320e0ebef0f4c1005f0491401965745f8459cf35b63c4b8","slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.no2-so2-trend-veda-api-igarss-2023","location":"/external_notebooks/eurodatacube/notebooks/notebooks/contributions/no2-so2-trend-veda-api-igarss-2023.ipynb","dependencies":[],"frontmatter":{"title":"Using the NASA VEDA EOAPI","content_includes_title":false,"kernelspec":{"name":"python3","display_name":".venv","language":"python"},"github":"https://github.com/eoxhub-workspaces/documentation/","numbering":{"title":{"offset":5}},"edit_url":"https://github.com/eoxhub-workspaces/documentation//blob/main/external_notebooks/eurodatacube/notebooks/notebooks/contributions/no2-so2-trend-veda-api-igarss-2023.ipynb","exports":[{"format":"ipynb","filename":"no2-so2-trend-veda-api-igarss-2023.ipynb","url":"/notebooks_test/build/no2-so2-trend-veda-a-e397efb2666aef13eaa8bd3280981c3d.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This notebook is divided into two parts, each demonstrating the functionalities of the VEDA Earth Observation API (EOAPI).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Lv2brssYuW"}],"key":"fAVkwZI2fo"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Reading and visualizing one of the datasets from the VEDA data catalog","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"QqTHC0eble"}],"key":"j7QynE40sW"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Using the EOAPI to generate a time-series of OMI (ozone monitoring instrument) NOâ‚‚ and SOâ‚‚ datasets","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lPyrzQR3q6"}],"key":"yghX8cz7hu"}],"key":"VIsONiiDIr"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Author: Slesa Adhikari","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"msdCC0Aa07"}],"key":"o6frq4S8Zp"}],"key":"IxJZPyspM3"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1. Reading and visualizing one of the datasets from the VEDA data catalog","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p4QCkOAeDe"}],"identifier":"id-1-reading-and-visualizing-one-of-the-datasets-from-the-veda-data-catalog","label":"1. Reading and visualizing one of the datasets from the VEDA data catalog","html_id":"id-1-reading-and-visualizing-one-of-the-datasets-from-the-veda-data-catalog","implicit":true,"key":"VaYDpZSx83"}],"key":"sHwwcYTmJG"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import all the necesssary libraries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K0iOiQF8j9"}],"key":"OSuWsNS6ip"}],"key":"wuilniXxpc"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Make sure you install these first using:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vdhWbSA6v6"}],"key":"uvHZWrUlFj"},{"type":"code","lang":"bash","value":"pip install pystac_client folium seaborn pandas","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"key":"TlmeQc8XUq"}],"key":"P8X1JuTJM7"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# imports\nimport requests\nfrom pystac_client import Client\nimport folium\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport pandas as pd","key":"sCwOjvG4cq"},{"type":"output","id":"UnSvaaIWNglCNmwk8JlBK","data":[],"key":"EOWs2Xj7Bc"}],"key":"kbVRCkohDh"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the API endpoints","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aJgDAZ7cs6"}],"key":"be77MU4hU3"}],"key":"PXZlZwRcU5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The EOAPI is a combination of two components.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"X02KtpEkK4"}],"key":"r96PFk9JMs"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Data catalog - the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"GQWzrM85Fe"},{"type":"link","url":"https://stacspec.org/en/","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"SpatioTemporal Asset Catalog (STAC)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"lU7Kt3zfLL"}],"urlSource":"https://stacspec.org/en/","key":"dvvL9lVSet"},{"type":"text","value":" specification is used to catalog the available datasets","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"EwKwcfMZ6w"}],"key":"FYzP1BszJA"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Dynamic tile server - ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QkRJBqFmVM"},{"type":"link","url":"https://developmentseed.org/titiler/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"TiTiler","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wkSilBnAm4"}],"urlSource":"https://developmentseed.org/titiler/","key":"etCBosRKbX"},{"type":"text","value":" is used to dynamically serve cloud optimized geotiff (raster) data files","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"OJogcq264b"}],"key":"rGOinz6WnC"}],"key":"DbHEPz1YfM"}],"key":"ZrW8h1Fjap"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"STAC_API_URL = \"https://staging-stac.delta-backend.com/\"\nRASTER_API_URL = \"https://staging-raster.delta-backend.com\"","key":"ArFH2NdhLY"},{"type":"output","id":"htS4urBqHPDINBIN15MUR","data":[],"key":"RpTV3X3J9H"}],"key":"ruicaKi9u5"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HMR0IPLcu7"},{"type":"inlineCode","value":"pystac_client","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zx3qOs1R4w"},{"type":"text","value":" library to interact with the STAC data catalog","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DRrEtzT6YO"}],"key":"x1lwOCwBOv"}],"key":"CgO3tqt9F8"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"catalog = Client.open(STAC_API_URL)","key":"VJnqB0RPoU"},{"type":"output","id":"ZjrIKwT-CM9Gq5oe4tjxS","data":[],"key":"S6tNeomkuk"}],"key":"JAEl5adl4G"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"List all the datasets (collections) in the catalog","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gHChMFVvV0"}],"key":"dbCV9ldDVq"}],"key":"gbPPAU4XeX"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"for collection in list(catalog.get_collections()):\n    print(f\"{collection.id} - {collection.title}\")","key":"lHCI6FVzts"},{"type":"output","id":"ZX61NLZtO0VukTF54y8dd","data":[{"name":"stdout","output_type":"stream","text":"EPA-annual-emissions_6D_Composting - Gridded 2012 EPA Methane Emissions - Composting\nnightlights-500m-daily - Black Marble 500m Nightlights Daily Dataset\nlandsat-c2l2-sr-antarctic-glaciers-thwaites - Selected Landsat 7 through 9 Surface Reflectance Scenes for the Thwaites Glacier\nlandsat-c2l2-sr-antarctic-glaciers-pine-island - Selected Landsat 7 through 9 Surface Reflectance Scenes for the Pine Island Glacier\nsocial-vulnerability-index-household - Social Vulnerability Index (Household)\nno2-monthly - NOâ‚‚\nno2-monthly-diff - NOâ‚‚ (Diff)\nsport-lis-vsm0_100cm-percentile - 0-100 cm Volumetric Soil Moisture (%)\nlis-global-da-gws - Groundwater Storage - LIS 10km Global DA\nmtbs-burn-severity - MTBS Burn Severity\necco-surface-height-change - ECCO sea-surface height change from 1992 to 2017\neis_fire_fireline - Active Fire Line\noco2-geos-l3-daily - Gridded Daily OCO-2 Carbon Dioxide assimilated dataset\nlis-global-da-evap - Evapotranspiration - LIS 10km Global DA\neis_fire_newfirepix - VIIRs Fire Detections\nlis-tws-trend - Trend in Terrestrial Water Storage (TWS) Anomalies\nhouston-lst-day - Houston land surface temperature during daytime - decadal average\nlis-global-da-gpp - Gross Primary Productivity - LIS 10km Global DA\nhouston-urbanization - New Urbanization from 2001-2019 (NLCD)\nsocial-vulnerability-index-housing - Social Vulnerability Index (Housing)\neis_fire_perimeter - Fire Perimeters\ngrdi-imr-raster - GRDI IMR Constituent Raster\nbangladesh-landcover-2001-2020 - Annual land cover maps for 2001 and 2020\nnceo_africa_2017 - NCEO Africa Aboveground Woody Biomass 2017\nlis-global-da-swe - Snow Water Equivalent - LIS 10km Global DA\ngeoglam - GEOGLAM Crop Monitor\nhls-l30-002-ej-reprocessed - HLSL30.002 Environmental Justice Events\nlis-global-da-qs - Surface runoff - LIS 10km Global DA\nlis-tvegsuppression - Change in transpiration for 2020 fires using LIS outputs\nCMIP245-winter-median-pr - Projected changes to winter (January, February, and March) cumulative daily precipitation\nEPA-annual-emissions_1B2b_Natural_Gas_Processing - Gridded 2012 EPA Methane Emissions - Natural Gas Processing\nEPA-annual-emissions_6B_Wastewater_Treatment_Domestic - Gridded 2012 EPA Methane Emissions - Domestic Wastewater Treatment\nhouston-aod-diff - Houston AOD: Difference Between 2000-2009 & 2010-2019\nCMIP245-winter-median-ta - Projected changes to winter (January, February, and March) average daily air temperature\nEPA-annual-emissions_6B_Wastewater_Treatment_Industrial - Gridded 2012 EPA Methane Emissions - Industrial Wastewater Treatment\nEPA-annual-emissions_1B2a_Petroleum - Gridded 2012 EPA Methane Emissions - Petroleum\nEPA-annual-emissions_1B1a_Coal_Mining_Surface - Gridded 2012 EPA Methane Emissions - Surface Coal Mines\nEPA-annual-emissions_1A_Combustion_Mobile - Gridded 2012 EPA Methane Emissions - Mobile Combustion\nEPA-annual-emissions_4F_Field_Burning - Gridded 2012 EPA Methane Emissions - Field Burning\nlis-tws-anomaly - Terrestrial Water Storage (TWS) Anomalies\nCMIP585-winter-median-pr - Projected changes to winter (January, February, and March) cumulative daily precipitation\nbarc-thomasfire - Burn Area Reflectance Classification for Thomas Fire\nEPA-annual-emissions_2B5_Petrochemical_Production - Gridded 2012 EPA Methane Emissions - Petrochemical Production\ncaldor-fire-behavior - Caldor Fire Behavior\nconus-reach - Stream network across the Contiguous United States\nIS2SITMOGR4-cog - ICESat-2 L4 Monthly Gridded Sea Ice Thickness (COGs)\ncaldor-fire-burn-severity - Caldor Fire Burn Severity\nEPA-monthly-emissions_1B2b_Natural_Gas_Production - Gridded 2012 EPA Methane Emissions - Natural Gas Production (monthly)\ndisalexi-etsuppression - disalexi-etsuppression\nCMIP585-winter-median-ta - Projected changes to winter (January, February, and March) average daily air temperature\nfrp-max-thomasfire - Maximum Fire Radiative Power for Thomas Fire\nco2-mean - COâ‚‚ (Avg)\nlis-tws-nonstationarity-index - Global TWS Non-Stationarity Index\nhouston-lst-diff - Houston LST (Diff)\nlis-global-da-tws - Terrestrial Water Storage - LIS 10km Global DA\nOMI_trno2-COG - OMI_trno2 - 0.10 x 0.10 Annual as Cloud-Optimized GeoTIFFs (COGs)\nmodis-annual-lai-2003-2020 - Annual LAI maps for 2003 and 2021 (Bangladesh)\nlandsat-c2l2-sr-lakes-lake-balaton - Selected Landsat 7 through 9 Surface Reflectance Scenes for Lake Balaton\nlis-global-da-tws-trend - Terrestrial Water Storage Trend - LIS 10km Global DA\nsnow-projections-median - Projections of Snow Water Equivalent (SWE)\nhouston-landcover - Houston Land Cover\nlandsat-c2l2-sr-lakes-lake-biwa - Selected Landsat 7 through 9 Surface Reflectance Scenes for Lake Biwa\nhouston-lst-night - Houston land surface temperature at night time - decadal average\nsnow-projections-diff - Projections of Snow Water Equivalent (SWE) losses\nlandsat-c2l2-sr-lakes-tonle-sap - Selected Landsat 7 through 9 Surface Reflectance Scenes for TonlÃ© Sap\nhouston-aod - Aerosol Optical Depth (AOD)\nsnow-projections-diff-245 - Projections of Snow Water Equivalent (SWE) Losses - SSP2-4.5\nhouston-ndvi - Houston NDVI: decadal average\nlandsat-c2l2-sr-lakes-vanern - Selected Landsat 7 through 9 Surface Reflectance Scenes for VÃ¤nern\nsnow-projections-diff-585 - Projections of Snow Water Equivalent (SWE) Losses - SSP5-8.5\nlis-global-da-gpp-trend - Gross Primary Productivity Trend - LIS 10km Global DA\nlis-global-da-qsb - Subsurface Runoff - LIS 10km Global DA\nlandsat-c2l2-sr-lakes-aral-sea - Selected Landsat 7 through 9 Surface Reflectance Scenes for the Aral Sea\nsnow-projections-median-245 - Projections of Snow Water Equivalent (SWE) - SSP2-4.5\nlis-global-da-streamflow - Streamflow - LIS 10km Global DA\nrecovery-proxy-maps-covid-19 - Recovery Proxy Maps\nlis-etsuppression - Change in ET for 2020 fires using LIS outputs\nsnow-projections-median-585 - Projections of Snow Water Equivalent (SWE) - SSP5-8.5\nlis-global-da-totalprecip - Total Precipitation - LIS 10km Global DA\nls8-covid-19-example-data - \nslowdown-proxy-covid-19-changing-landscapes - Slowdown Proxy Maps\nnightlights-hd-monthly - Black Marble High Definition Nightlights Monthly Dataset\ngrdi-vnl-raster - GRDI VNL Constituent Raster\nsocial-vulnerability-index-housing-nopop - Social Vulnerability Index (Housing) (Masked)\nsocial-vulnerability-index-household-nopop - Social Vulnerability Index (Household) (Masked)\nsocial-vulnerability-index-socioeconomic - Social Vulnerability Index (SocioEconomic)\nsocial-vulnerability-index-socioeconomic-nopop - Social Vulnerability Index (SocioEconomic) (Masked)\ngrdi-filled-missing-values-count - GRDI Filled Missing Values Count\nsocial-vulnerability-index-overall - Social Vulnerability Index (Overall)\nsocial-vulnerability-index-minority-nopop - Social Vulnerability Index (Minority) (Masked)\ngrdi-cdr-raster - GRDI CDR Constituent Raster\nMO_NPP_npp_vgpm - \nsocial-vulnerability-index-overall-nopop - Social Vulnerability Index (Overall) (Masked)\ngrdi-v1-raster - GRDI V1 raster\ngrdi-shdi-raster - GRDI SHDI Constituent Raster\nblue-tarp-planetscope - Hurricane Ida - Blue Tarps PlanetScope Image\nnightlights-hd-1band - Black Marble High Definition Nightlights 1 band Dataset\nsocial-vulnerability-index-minority - Social Vulnerability Index (Minority)\nOMSO2PCA-COG - OMI/Aura Sulfur Dioxide (SO2) Total Column L3 1 day Best Pixel in 0.25 degree x 0.25 degree V3 as Cloud-Optimized GeoTIFFs (COGs)\nEPA-annual-emissions_1B1a_Coal_Mining_Underground - Gridded 2012 EPA Methane Emissions - Underground Coal Mines\nhls-s30-002-ej-reprocessed - HLSS30.002 Environmental Justice Events\ngrdi-v1-built - GRDI BUILT Constituent Raster\ngrdi-vnl-slope-raster - GRDI VNL Slope Constituent Raster\nfacebook_population_density - Population Density Maps using satellite imagery built by Meta\nEPA-annual-emissions_1B1a_Abandoned_Coal - Gridded 2012 EPA Methane Emissions - Abandoned Coal Mines\nEPA-annual-emissions_4B_Manure_Management - Gridded 2012 EPA Methane Emissions - Manure Management\nEPA-annual-emissions_1A_Combustion_Stationary - Gridded 2012 EPA Methane Emissions - Stationary Combustion\nEPA-annual-emissions_1B2b_Natural_Gas_Production - Gridded 2012 EPA Methane Emissions - Natural Gas Production\nEPA-annual-emissions_6A_Landfills_Industrial - Gridded 2012 EPA Methane Emissions - Industrial Landfills\nEPA-annual-emissions_2C2_Ferroalloy_Production - Gridded 2012 EPA Methane Emissions - Ferroalloy Production\nEPA-annual-emissions_4A_Enteric_Fermentation - Gridded 2012 EPA Methane Emissions - Enteric Fermentation\nEPA-annual-emissions_6A_Landfills_Municipal - Gridded 2012 EPA Methane Emissions - Municipal Landfills\nEPA-annual-emissions_1B2b_Natural_Gas_Transmission - Gridded 2012 EPA Methane Emissions - Natural Gas Transmission\nEPA-annual-emissions_5_Forest_Fires - Gridded 2012 EPA Methane Emissions - Forest Fires\nEPA-annual-emissions_1B2b_Natural_Gas_Distribution - Gridded 2012 EPA Methane Emissions - Natural Gas Distribution\nEPA-annual-emissions_4C_Rice_Cultivation - Gridded 2012 EPA Methane Emissions - Rice Cultivation\nEPA-daily-emissions_5_Forest_Fires - Gridded 2012 EPA Methane Emissions - Forest Fires (daily)\nEPA-monthly-emissions_1A_Combustion_Stationary - Gridded 2012 EPA Methane Emissions - Stationary Combustion (monthly)\nEPA-monthly-emissions_4F_Field_Burning - Gridded 2012 EPA Methane Emissions - Field Burning (monthly)\nEPA-monthly-emissions_4B_Manure_Management - Gridded 2012 EPA Methane Emissions - Manure Management (monthly)\nEPA-monthly-emissions_1B2a_Petroleum - Gridded 2012 EPA Methane Emissions - Petroleum (monthly)\nblue-tarp-detection - Hurricane Ida - Detected Blue Tarps\nEPA-monthly-emissions_4C_Rice_Cultivation - Gridded 2012 EPA Methane Emissions - Rice Cultivation (monthly)\nco2-diff - COâ‚‚ (Diff)\n"}],"key":"ryWt2sthlm"}],"key":"BSwYU1Kei4"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Choose a collection to work with. Weâ€™ll choose the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A38vAyo6yC"},{"type":"inlineCode","value":"no2-monthly","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TbYZjG26jo"},{"type":"text","value":" dataset for this example.\nThis is the global nitrogen dioxide data organized into monthly metrics.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ghlXTEvmLC"}],"key":"wtqILTrqBc"}],"key":"XJP81ZPlXr"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"collection_id = \"no2-monthly\"","key":"Akv74Y5HT3"},{"type":"output","id":"0A78e-ZsqoG2ZRGMMVeQ6","data":[],"key":"TqRV6g91EP"}],"key":"y1OWBhVu70"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Search all the items in the collection.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W2Nek009Fq"}],"key":"QNXQ8uOpyJ"}],"key":"YqSgwWSlXW"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"search = catalog.search(collections=[collection_id])\nitems = list(search.items())\nitems","key":"IDeee0wO5d"},{"type":"output","id":"21qhhhX4onJrR8SfI0xj6","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/plain":{"content":"[<Item id=OMI_trno2_0.10x0.10_202212_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202211_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202210_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202209_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202208_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202207_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202206_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202205_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202204_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202203_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202202_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202201_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202112_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202111_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202110_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202109_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202108_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202107_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202106_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202105_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202104_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202103_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202102_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202101_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202012_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202011_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202010_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202009_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202008_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202007_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202006_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202005_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202004_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202003_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202002_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202001_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201912_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201911_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201910_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201909_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201908_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201907_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201906_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201905_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201904_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201903_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201902_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201901_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201812_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201811_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201810_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201809_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201808_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201807_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201806_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201805_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201804_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201803_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201802_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201801_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201712_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201711_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201710_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201709_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201708_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201707_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201706_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201705_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201704_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201703_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201702_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201701_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201612_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201611_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201610_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201609_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201608_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201607_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201606_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201605_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201604_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201603_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201602_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201601_Col3_V4.nc>]","content_type":"text/plain"}}}],"key":"Ri3EQTp0M3"}],"key":"p4Isj9uFST"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load and inspect one of the itemâ€™s assets. In the catalog, the cloud optimized geotiffs (COG) are indexed under ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m3YcYIsBsa"},{"type":"inlineCode","value":"cog_default","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GAOrE63Hv5"},{"type":"text","value":" asset.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N4CTvDGW3g"}],"key":"kBg7r7FW0A"}],"key":"iYSwWqY4pP"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"s3_uri = items[0].assets[\"cog_default\"].href","key":"rJiO7W5jK1"},{"type":"output","id":"Bg-0R9-lWcUYHp377eh_j","data":[],"key":"V408MxxgbF"}],"key":"ofpSdue0jt"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Get statistics for the COG file using the TiTiler api endpoint ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jFpeOuJxKd"},{"type":"inlineCode","value":"/cog/statistics","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IjpHy7Ntnp"}],"key":"BuGinl6phv"}],"key":"cNZjOrYWj0"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"stats = requests.get(\n    f\"{RASTER_API_URL}/cog/statistics\",\n    params={\"url\": s3_uri}\n).json()\nstats","key":"Gxi9aojbU2"},{"type":"output","id":"evQ66LNy0jspRPGV_pD9G","data":[{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/plain":{"content":"{'1': {'min': -6707683428139008.0,\n  'max': 3.884375294450074e+16,\n  'mean': 423085978017950.7,\n  'count': 434008.0,\n  'sum': 1.8362269914761475e+20,\n  'std': 971153921053730.1,\n  'median': 245577371615232.0,\n  'majority': 121884402253824.0,\n  'minority': -6187472157409280.0,\n  'unique': 334278.0,\n  'histogram': [[58.0,\n    423787.0,\n    8532.0,\n    1008.0,\n    339.0,\n    199.0,\n    79.0,\n    4.0,\n    0.0,\n    2.0],\n   [-6707683428139008.0,\n    -2152539764031488.0,\n    2402603900076032.0,\n    6957747698401280.0,\n    1.151289069142016e+16,\n    1.6068035295051776e+16,\n    2.062317882494157e+16,\n    2.517832235483136e+16,\n    2.973346588472115e+16,\n    3.4288609414610944e+16,\n    3.884375294450074e+16]],\n  'valid_percent': 82.78,\n  'masked_pixels': 90280.0,\n  'valid_pixels': 434008.0,\n  'percentile_2': -178728386691072.0,\n  'percentile_98': 2662192260317184.0}}","content_type":"text/plain"}}}],"key":"vPtXvBqXrk"}],"key":"qe8U3TzW6s"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Display the COG in a map","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vL7MGHfQiQ"}],"key":"voqN7z67Y9"}],"key":"gSmTBfZNSj"}],"key":"EqSH2axhcx"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, weâ€™ll make a request for imagery tiles to the raster API.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AYdyZnS62G"}],"key":"k2YnEBvCn8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Define the query parameters for the request:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gD59PjwvPT"}],"key":"MIxpGtwBSo"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"collection","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rOYitXhzE3"}],"key":"GISXTvepku"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"item","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ILA3Ggxaft"}],"key":"grthstr0Lp"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"rescale","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"AWE0PI1ASu"}],"key":"uJSS2QSp2n"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"colormap","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"hZ9Eysldf5"}],"key":"q2loNGJ4fA"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"assets","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"MuBrsffHsN"}],"key":"aOtGpD7biC"}],"key":"cODZLPsdLX"}],"key":"KkJisit5xe"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"collection = collection_id\nitem = items[0].id\ncolormap = \"rainbow\"\nassets = \"cog_default\"\nrescale = f\"{stats['1']['min']},{stats['1']['max']}\"","key":"NZ8Zmje9wU"},{"type":"output","id":"Q3fSAB4MGsEPdOTFqoubk","data":[],"key":"cz84cBInel"}],"key":"NYUVRnt74J"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Get the tileset json for the relevant item.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LCqxjYjldc"}],"key":"HQTaslPdv0"}],"key":"CIyWFhSl51"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"tiles = requests.get(\n    f\"{RASTER_API_URL}/stac/tilejson.json?collection={collection}&item={item}&assets={assets}&colormap_name={colormap}&rescale={rescale}\"\n).json()","key":"UyDxuTvMXP"},{"type":"output","id":"56g35U_VT3OAtMNEiAgSO","data":[],"key":"mGpHNObIWr"}],"key":"mmI25gzPTe"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"tiles","key":"clCgDcuYpi"},{"type":"output","id":"usDmWqERkmiaNxqC-_1JV","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/plain":{"content":"{'tilejson': '2.2.0',\n 'version': '1.0.0',\n 'scheme': 'xyz',\n 'tiles': ['https://staging-raster.delta-backend.com/stac/tiles/WebMercatorQuad/{z}/{x}/{y}@1x?collection=no2-monthly&item=OMI_trno2_0.10x0.10_202212_Col3_V4.nc&assets=cog_default&colormap_name=rainbow&rescale=-6707683428139008.0%2C3.884375294450074e+16'],\n 'minzoom': 0,\n 'maxzoom': 24,\n 'bounds': [-180.0, -90.0, 180.0, 90.0],\n 'center': [0.0, 0.0, 0]}","content_type":"text/plain"}}}],"key":"cvlrYFzV9S"}],"key":"EA3niD4IVX"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GhkostQYGk"},{"type":"inlineCode","value":"/tiles","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HyJpkCyMqj"},{"type":"text","value":" endpoint to visualize the file in a map","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UpLq4Ql7jD"}],"key":"K2tTi8RdJF"}],"key":"mOagkwvJWG"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"m = folium.Map(\n    zoom_start=10,\n    scroll_wheel_zoom=True, \n    tiles=tiles[\"tiles\"][0],\n    attr=\"VEDA\", \n    minzoom=0, \n    maxzoom=18,\n)","key":"ltGMoYyp0F"},{"type":"output","id":"aKznhz3QNTeUDoM8pdjU-","data":[],"key":"HubRTE54E9"}],"key":"HkviMviwQe"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"m","key":"Fz3IBTgTmy"},{"type":"output","id":"hWBecjPDw4iXFKxB15v8s","data":[{"output_type":"execute_result","execution_count":89,"metadata":{},"data":{"text/html":{"content":"<div style=\"width:100%;\"><div style=\"position:relative;width:100%;height:0;padding-bottom:60%;\"><span style=\"color:#565656\">Make this Notebook Trusted to load map: File -> Trust Notebook</span><iframe srcdoc=\"&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    \n    &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;\n    \n        &lt;script&gt;\n            L_NO_TOUCH = false;\n            L_DISABLE_3D = false;\n        &lt;/script&gt;\n    \n    &lt;style&gt;html, body {width: 100%;height: 100%;margin: 0;padding: 0;}&lt;/style&gt;\n    &lt;style&gt;#map {position:absolute;top:0;bottom:0;right:0;left:0;}&lt;/style&gt;\n    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://code.jquery.com/jquery-1.12.4.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;&gt;&lt;/script&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/&gt;\n    \n            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,\n                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; /&gt;\n            &lt;style&gt;\n                #map_6b1058c0a78452c16c2bf32505192993 {\n                    position: relative;\n                    width: 100.0%;\n                    height: 100.0%;\n                    left: 0.0%;\n                    top: 0.0%;\n                }\n                .leaflet-container { font-size: 1rem; }\n            &lt;/style&gt;\n        \n&lt;/head&gt;\n&lt;body&gt;\n    \n    \n            &lt;div class=&quot;folium-map&quot; id=&quot;map_6b1058c0a78452c16c2bf32505192993&quot; &gt;&lt;/div&gt;\n        \n&lt;/body&gt;\n&lt;script&gt;\n    \n    \n            var map_6b1058c0a78452c16c2bf32505192993 = L.map(\n                &quot;map_6b1058c0a78452c16c2bf32505192993&quot;,\n                {\n                    center: [0, 0],\n                    crs: L.CRS.EPSG3857,\n                    zoom: 1,\n                    zoomControl: true,\n                    preferCanvas: false,\n                    scrollWheelZoom: true,\n                    minzoom: 0,\n                    maxzoom: 18,\n                }\n            );\n\n            \n\n        \n    \n            var tile_layer_551065a2ecf6b4683533df070a836004 = L.tileLayer(\n                &quot;https://staging-raster.delta-backend.com/stac/tiles/WebMercatorQuad/{z}/{x}/{y}@1x?collection=no2-monthly\\u0026item=OMI_trno2_0.10x0.10_202212_Col3_V4.nc\\u0026assets=cog_default\\u0026colormap_name=rainbow\\u0026rescale=-6707683428139008.0%2C3.884375294450074e+16&quot;,\n                {&quot;attribution&quot;: &quot;VEDA&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 18, &quot;maxZoom&quot;: 18, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}\n            ).addTo(map_6b1058c0a78452c16c2bf32505192993);\n        \n&lt;/script&gt;\n&lt;/html&gt;\" style=\"position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;\" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div>","content_type":"text/html"},"text/plain":{"content":"<folium.folium.Map at 0x165780b10>","content_type":"text/plain"}}}],"key":"WJxfTvhFjC"}],"key":"YuPMZGSgNm"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2. Using the EOAPI to generate a time-series of OMI NOâ‚‚ and SOâ‚‚ datasets","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Mg8coktuxa"}],"identifier":"id-2-using-the-eoapi-to-generate-a-time-series-of-omi-no-and-so-datasets","label":"2. Using the EOAPI to generate a time-series of OMI NOâ‚‚ and SOâ‚‚ datasets","html_id":"id-2-using-the-eoapi-to-generate-a-time-series-of-omi-no-and-so-datasets","implicit":true,"key":"vn4oQ7vMZK"}],"key":"JXZ0sr3Ntq"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Thereâ€™s a story published in the EODashboard with the following title:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PJcLlaTlgv"}],"key":"bqkyVZcPAk"},{"type":"blockquote","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Air pollution in India, China and the U.S. have changed significantly over the past two decades","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iVsTdIXmsT"}],"key":"JQ3idO1ttb"}],"key":"MZsEEnPxU9"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Link: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dkKKxk3188"},{"type":"link","url":"https://eodashboard.org/story?id=air-pollution-us-india-china","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"https://â€‹eodashboardâ€‹.orgâ€‹/storyâ€‹?idâ€‹=â€‹airâ€‹-pollutionâ€‹-usâ€‹-indiaâ€‹-china","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"inJpcFXWBv"}],"urlSource":"https://eodashboard.org/story?id=air-pollution-us-india-china","key":"jj3bAM3dCp"}],"key":"BuRcPJ9Wuh"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The story talks about the trend of air pollution in India, China and the U.S. using the NO","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"DbsXqskAv0"},{"type":"subscript","children":[{"type":"text","value":"2","key":"qvOOSfVs0o"}],"key":"zGd7bRiFtS"},{"type":"text","value":" and SO","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xzbdDTqMRS"},{"type":"subscript","children":[{"type":"text","value":"2","key":"xXSrhGRbUE"}],"key":"JUn0OnqUaO"},{"type":"text","value":" readings taken from the OMI instrument","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FSvPyOJTye"}],"key":"aFxC2oN5Cl"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Here, weâ€™ll recreate the analysis using the EOAPI.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Mlq8YFg4tA"}],"key":"n7mzTa3InN"}],"key":"CKm8cyLsJ3"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Here, we find the relevant collection ID for the dataset\ncollections = {\n    \"no2\": \"OMI_trno2-COG\",\n    \"so2\": \"OMSO2PCA-COG\",\n}","key":"VGKuvHL4Sk"},{"type":"output","id":"sz3Pe8DRoKZsoJHFrlVnT","data":[],"key":"qt7655yhJy"}],"key":"Nw8gmKde3E"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the roughly similar Area of Interest (AOI) for each of the countries as seen in the story.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iwDzPTSPc3"}],"key":"fip36tSmHk"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Disclaimer: Since the AOI is roughly similar, but not exactly the same, the results may differe slightly, but should maintain similar trends.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sY09mRc2a4"}],"key":"qu4svnOfrP"}],"key":"EbT3XVETS0"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"aois = {\n    \"india\": {\n      \"type\": \"Feature\",\n      \"properties\": {},\n      \"geometry\": {\n        \"coordinates\": [\n          [\n            [\n              84.44227371801799,\n              25.276852788244952\n            ],\n            [\n              81.73331688510166,\n              25.379576397063317\n            ],\n            [\n              81.40290450746915,\n              20.640781701865322\n            ],\n            [\n              84.09079123546121,\n              20.59296261766137\n            ],\n            [\n              84.44227371801799,\n              25.276852788244952\n            ]\n          ]\n        ],\n        \"type\": \"Polygon\"\n      }\n    },\n    \"china\": {\n      \"type\": \"Feature\",\n      \"properties\": {},\n      \"geometry\": {\n        \"coordinates\": [\n          [\n            [\n              118.14487188674968,\n              40.38237805885373\n            ],\n            [\n              112.59679754686567,\n              40.39197699341523\n            ],\n            [\n              112.78712023622006,\n              32.015052150835814\n            ],\n            [\n              117.937454307721,\n              32.102440507249895\n            ],\n            [\n              118.14487188674968,\n              40.38237805885373\n            ]\n          ]\n        ],\n        \"type\": \"Polygon\"\n      }\n    },\n    \"usa\": {\n        \"type\": \"Feature\",\n        \"properties\": {},\n        \"geometry\": {\n            \"coordinates\": [\n            [\n                [\n                -80.16702521343733,\n                41.73420113945659\n                ],\n                [\n                -83.56446680395005,\n                38.599369254919566\n                ],\n                [\n                -82.00280661075571,\n                37.54658260550103\n                ],\n                [\n                -78.28140359718638,\n                40.450899619800595\n                ],\n                [\n                -80.16702521343733,\n                41.73420113945659\n                ]\n            ]\n            ],\n            \"type\": \"Polygon\"\n        }\n    },\n}","key":"Xf4WcEaXZ1"},{"type":"output","id":"LmDSBVyh-iLIZCSfmQBmT","data":[],"key":"Egb65eNNEW"}],"key":"Jr8XJjnMl9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define a function that takes the following params:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"foo8VdAHIG"}],"key":"f6LlEEhpY7"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"inlineCode","value":"item","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"o9ioORLglU"},{"type":"text","value":": a STAC item","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Mn0vFP8nre"}],"key":"BJ29zVzRPk"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"inlineCode","value":"geojson","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"utFDjHXMsN"},{"type":"text","value":": the geojson of the AOI","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tfN4UP2CLD"}],"key":"xzhIszXDL0"}],"key":"I9mNPmADId"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Using the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bF4klgkgWN"},{"type":"inlineCode","value":"/cog/statistics/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"awA6M36UqT"},{"type":"text","value":" endpoint of the raster API, we get back the statistics of the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jq9GuqdM8n"},{"type":"inlineCode","value":"item","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XweZUH5U0R"},{"type":"text","value":" (which corresponds to one COG file) within the given ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MhmkDJBL4E"},{"type":"inlineCode","value":"geojson","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"rFM7IlgGfk"},{"type":"text","value":" AOI.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"eYR1ckeOHZ"}],"key":"SiVxnsTpIl"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The statistics includes ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"cQLDLMKZYb"},{"type":"inlineCode","value":"min","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Y9c12opLXn"},{"type":"text","value":", ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"hWLrLkYyhT"},{"type":"inlineCode","value":"max","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"dMTvoI8NYr"},{"type":"text","value":", ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FdWAzZLaGm"},{"type":"inlineCode","value":"mean","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"lz2YKda9Ek"},{"type":"text","value":", ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"TQhmrPAE8U"},{"type":"inlineCode","value":"std","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FleMSoSpRq"},{"type":"text","value":", etc.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"lmY2Tg1PBm"}],"key":"c66FRygD67"}],"key":"WSCgnMeApn"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# the bounding box should be passed to the geojson param as a geojson Feature or FeatureCollection\ndef generate_stats(item, geojson):\n    result = requests.post(\n        f\"{RASTER_API_URL}/cog/statistics\", \n        params={\n            \"url\": item.assets[\"cog_default\"].href\n        },\n        json=geojson\n    ).json()\n    return {\n        **result[\"properties\"],\n        \"start_datetime\": str(item.properties.get(\"datetime\", item.properties.get(\"start_datetime\")))[:4],\n        \"collection\": item.collection_id\n    }","key":"ZpcCNzOnmD"},{"type":"output","id":"PNOCYrEYFgl5WWUuxOyzO","data":[],"key":"qUzN2zsVH2"}],"key":"N5K5NMcjIV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Letâ€™s start out with the US ðŸ‡ºðŸ‡¸ !","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h0dQQTeHH0"}],"key":"ahkSU0DUzW"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Weâ€™ll get all the items in the NO2 and SO2 collections and generate the statistics from them for the Ohio River Valley region of the United States.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fzesQv3Ha5"}],"key":"QJsaqUIvCy"}],"key":"UZrzKTakyB"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"usa_aoi = aois[\"usa\"]\nitems = list(catalog.search(collections=[collections[\"no2\"], collections[\"so2\"]]).items())\nusa_stats = [\n    generate_stats(item, usa_aoi)\n    for item in items\n]","key":"MxPHrPYCA2"},{"type":"output","id":"5DrH7ZM6V2CDC7-vLCer8","data":[],"key":"WDGzd4GJHY"}],"key":"aBSOrZ1mXF"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a function that takes the statistics (which is a json) and converts it to a pandas dataframe in a format thatâ€™ll make it easy to read and visualize.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fZA6UV0xuq"}],"key":"LkmIUkavXF"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We are only concerned with the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ujiiiwFWkS"},{"type":"inlineCode","value":"mean","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dOYhOTMgAc"},{"type":"text","value":" statistics for this example. Specifically the change from the year 2005 as a percentage. Weâ€™ll use pandas to calculate this change percentage and assign it to the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ntAnawVK8U"},{"type":"inlineCode","value":"change","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"avxrZLIgmY"},{"type":"text","value":" column.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"imvCEJ9Axw"}],"key":"zX7uNtCnDH"}],"key":"kQd6y6Z2AS"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"def clean_stats(stats_json) -> pd.DataFrame:\n    # convert the stats_json as is to pandas dataframe\n    df = pd.json_normalize(stats_json)\n    # simple renaming for readability\n    df.columns = [col.replace(\"statistics.1.\", \"\") for col in df.columns]\n    # create a date column from the start_datetime column\n    df[\"date\"] = pd.to_datetime(df[\"start_datetime\"], format=\"mixed\")\n    # rename the collection to a more friendly name\n    df[\"collection\"] = df[\"collection\"].map(lambda x: next(key for key, value in collections.items() if value == x))\n    # sort the dataframe by the date column\n    df = df.sort_values(by=[\"date\"])\n    # create a change column that calculates the change of the mean values from the value in 2005\n    df[\"change\"] = df.groupby(\"collection\", group_keys=False)[\"mean\"].apply(lambda x: x.div(x.iloc[0]).subtract(1).mul(100))\n    return df","key":"feS3acmWhf"},{"type":"output","id":"onZCv0BYU3hSEhG20apyC","data":[],"key":"qpdfnEwLjz"}],"key":"ueK8kGKs5f"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"cleaned_stats_df = clean_stats(usa_stats)","key":"imqAj0jJqv"},{"type":"output","id":"Hbvrj6ejEUHlFdryPe03q","data":[],"key":"mlWPSmGG1G"}],"key":"qLFImZZLeK"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Weâ€™ll now create a time-series of the change in mean values for NO2 and SO2 for the area in the US.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CFowiUjAaw"}],"key":"bNycaw52uQ"}],"key":"G0wogywzem"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"plt.xticks([i for i in range(0, 21, 2)])\nsns.set_style(\"darkgrid\")\nax = sns.lineplot(\n    x=\"start_datetime\",\n    y=\"change\",\n    hue=\"collection\",\n    data=cleaned_stats_df,\n    palette=[\"#2196f3\", \"#ff5722\"],\n    style=\"collection\",\n    markers=[\"*\", \"d\"],\n)\nax.set_title(\"US - Ohio River Valley\")\nax.set_xlabel(\"Years\")\nax.set_ylabel(\"Change from 2005 (%)\")\nplt.legend(frameon=False, ncol=3)\nplt.show()","key":"lvSVT1goF3"},{"type":"output","id":"BJ6vCl5cOalFvO7sTNWBx","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0daf1261d5b4553525e31d60cd7b502a","path":"/notebooks_test/build/0daf1261d5b4553525e31d60cd7b502a.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"xR9ADxUbzd"}],"key":"CwRaitQ6Pl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, letâ€™s create a function that creates this trend graph, given the country.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sg3JqIHzzd"}],"key":"GQjb86PIjt"}],"key":"kQMqKxj6mX"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"def create_chart(country):\n    stats = [generate_stats(item, aois[country]) for item in list(catalog.search(collections=[collections[\"no2\"], collections[\"so2\"]]).items())]\n    df = clean_stats(stats)\n\n    # Create a chart using Seaborn\n    plt.xticks([i for i in range(0, 21, 2)])\n    sns.set_style(\"darkgrid\")\n    ax = sns.lineplot(\n        x=\"start_datetime\",\n        y=\"change\",\n        hue=\"collection\",\n        data=df,\n        palette=[\"#2196f3\", \"#ff5722\"],\n        style=\"collection\",\n        markers=[\"*\", \"d\"],\n        legend=\"full\",\n        # label=[\"no2\", \"so2\"]\n    )\n    ax.set_title(country.title())\n    ax.set_xlabel(\"Years\")\n    ax.set_ylabel(\"Change from 2005 (%)\")\n    ax.legend([\"no2\", \"so2\"])\n    plt.legend(frameon=False, ncol=3)\n    plt.show()","key":"bq82AKi9R0"},{"type":"output","id":"Gqnqq7cRON373DwZQyOuR","data":[],"key":"a70yMwqDR8"}],"key":"pJDM0hxyGl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can use this function to create charts for the rest of the AOIs.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iS8kEOrKmv"}],"key":"QZiKPcgmWa"}],"key":"OHxBtk4eE7"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"India ðŸ‡®ðŸ‡³","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ry4GT4hgPw"}],"key":"bFryjZjvPN"}],"key":"XRZfWjchV2"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"create_chart(\"india\")","key":"nQA80OtJDF"},{"type":"output","id":"RYi7WYIeuyueFUunigttG","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2d8eb241d54c89d0748234dfb653c1f9","path":"/notebooks_test/build/2d8eb241d54c89d0748234dfb653c1f9.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"pDMQ61F9TC"}],"key":"ev7xtCwq8o"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"China ðŸ‡¨ðŸ‡³","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j6RUhXbpbG"}],"key":"bnbjkWsWdZ"}],"key":"vaHrROop93"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"create_chart(\"china\")","key":"EiX3fYiIeM"},{"type":"output","id":"iOo8TRKLBkNGHBHr-_4kr","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bcc0e960399ecbcecb76c8807968906e","path":"/notebooks_test/build/bcc0e960399ecbcecb76c8807968906e.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"qNzOamXwaU"}],"key":"h3y08xYL7c"}],"key":"Wb8Keg4SYN"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Impact of Covid19 induced lockdown on NO2 levels","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/no2-analysis-covid19-lockdowns","group":"Contributions"},"next":{"title":"Important notes","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/ogc-edc","group":"Contributions"}}},"domain":"http://localhost:3000"}