{"version":1,"kind":"Notebook","sha256":"b72780245b4da5f3c320e0ebef0f4c1005f0491401965745f8459cf35b63c4b8","slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.no2-so2-trend-veda-api-igarss-2023","location":"/external_notebooks/eurodatacube/notebooks/notebooks/contributions/no2-so2-trend-veda-api-igarss-2023.ipynb","dependencies":[],"frontmatter":{"title":"Using the NASA VEDA EOAPI","content_includes_title":false,"kernelspec":{"name":"python3","display_name":".venv","language":"python"},"github":"https://github.com/eoxhub-workspaces/documentation/","numbering":{"title":{"offset":5}},"edit_url":"https://github.com/eoxhub-workspaces/documentation//blob/main/external_notebooks/eurodatacube/notebooks/notebooks/contributions/no2-so2-trend-veda-api-igarss-2023.ipynb","exports":[{"format":"ipynb","filename":"no2-so2-trend-veda-api-igarss-2023.ipynb","url":"/notebooks_test/build/no2-so2-trend-veda-a-740f116a4bce1239aea3adb0ee9e4382.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This notebook is divided into two parts, each demonstrating the functionalities of the VEDA Earth Observation API (EOAPI).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"n0AOxAixSM"}],"key":"CpwWFcqcZD"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Reading and visualizing one of the datasets from the VEDA data catalog","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PicHnDPeOs"}],"key":"PKTHsyt4IM"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Using the EOAPI to generate a time-series of OMI (ozone monitoring instrument) NOâ‚‚ and SOâ‚‚ datasets","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VmCyTCAAtD"}],"key":"rfeT76pCAH"}],"key":"XFfhr8eZOI"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Author: Slesa Adhikari","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Fp5zrXfm7w"}],"key":"XidEQDW4ak"}],"key":"wXvp1K7cjW"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1. Reading and visualizing one of the datasets from the VEDA data catalog","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l4tbyc6ISC"}],"identifier":"id-1-reading-and-visualizing-one-of-the-datasets-from-the-veda-data-catalog","label":"1. Reading and visualizing one of the datasets from the VEDA data catalog","html_id":"id-1-reading-and-visualizing-one-of-the-datasets-from-the-veda-data-catalog","implicit":true,"key":"tMdSdasDe3"}],"key":"nIsHLgjaUK"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import all the necesssary libraries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dD3xDbuBVV"}],"key":"GuGj8CfDEX"}],"key":"UBFNwjPM9h"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Make sure you install these first using:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tSMnIjR4MU"}],"key":"kbtN5xEcCZ"},{"type":"code","lang":"bash","value":"pip install pystac_client folium seaborn pandas","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"key":"rOOSa2Hv5z"}],"key":"s27NxBf1zW"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# imports\nimport requests\nfrom pystac_client import Client\nimport folium\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport pandas as pd","key":"aobcNYOd6N"},{"type":"output","id":"qjKq9h5Ff2AEWx6CLF3IO","data":[],"key":"asjHdCKr2X"}],"key":"OZmiCQ5wdJ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the API endpoints","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I5msYhMJaO"}],"key":"QZVNoFd5h3"}],"key":"qHAIhAMs4d"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The EOAPI is a combination of two components.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PRW7r2JDXd"}],"key":"dumUKDsPXz"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Data catalog - the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"tWpwj5ZdxM"},{"type":"link","url":"https://stacspec.org/en/","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"SpatioTemporal Asset Catalog (STAC)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rEPrLj33qe"}],"urlSource":"https://stacspec.org/en/","key":"uUR1tlhxwP"},{"type":"text","value":" specification is used to catalog the available datasets","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"LOm1UR3Cmk"}],"key":"v5LWL9jEX5"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Dynamic tile server - ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KAchauUtpW"},{"type":"link","url":"https://developmentseed.org/titiler/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"TiTiler","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HPTwhpgaDw"}],"urlSource":"https://developmentseed.org/titiler/","key":"uddy7loKno"},{"type":"text","value":" is used to dynamically serve cloud optimized geotiff (raster) data files","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"alXJFgTuFt"}],"key":"jdlBhIg2MH"}],"key":"IiwJHUGlBy"}],"key":"WdSv6bJFLF"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"STAC_API_URL = \"https://staging-stac.delta-backend.com/\"\nRASTER_API_URL = \"https://staging-raster.delta-backend.com\"","key":"mJU6GlyIlh"},{"type":"output","id":"rc5BDYBqruJ3-loejppzg","data":[],"key":"gKko3rrN5E"}],"key":"p2QWZglEHH"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OwHWfz9pmc"},{"type":"inlineCode","value":"pystac_client","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DJq5wrPeqX"},{"type":"text","value":" library to interact with the STAC data catalog","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CYXjcMCk0s"}],"key":"U9CTPOwlw2"}],"key":"QbYa4WLvtH"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"catalog = Client.open(STAC_API_URL)","key":"gr0KbwMOaY"},{"type":"output","id":"CSCgPYF67lVqv7VILP4Ps","data":[],"key":"HEaq8cl5LS"}],"key":"wOvooL4SKC"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"List all the datasets (collections) in the catalog","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZtLcvQBzWI"}],"key":"lSFjU1OJ2d"}],"key":"kyjNhAzqL6"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"for collection in list(catalog.get_collections()):\n    print(f\"{collection.id} - {collection.title}\")","key":"S7NYf8tU5I"},{"type":"output","id":"Delu0cc8WkpwHWqJtKW-U","data":[{"name":"stdout","output_type":"stream","text":"EPA-annual-emissions_6D_Composting - Gridded 2012 EPA Methane Emissions - Composting\nnightlights-500m-daily - Black Marble 500m Nightlights Daily Dataset\nlandsat-c2l2-sr-antarctic-glaciers-thwaites - Selected Landsat 7 through 9 Surface Reflectance Scenes for the Thwaites Glacier\nlandsat-c2l2-sr-antarctic-glaciers-pine-island - Selected Landsat 7 through 9 Surface Reflectance Scenes for the Pine Island Glacier\nsocial-vulnerability-index-household - Social Vulnerability Index (Household)\nno2-monthly - NOâ‚‚\nno2-monthly-diff - NOâ‚‚ (Diff)\nsport-lis-vsm0_100cm-percentile - 0-100 cm Volumetric Soil Moisture (%)\nlis-global-da-gws - Groundwater Storage - LIS 10km Global DA\nmtbs-burn-severity - MTBS Burn Severity\necco-surface-height-change - ECCO sea-surface height change from 1992 to 2017\neis_fire_fireline - Active Fire Line\noco2-geos-l3-daily - Gridded Daily OCO-2 Carbon Dioxide assimilated dataset\nlis-global-da-evap - Evapotranspiration - LIS 10km Global DA\neis_fire_newfirepix - VIIRs Fire Detections\nlis-tws-trend - Trend in Terrestrial Water Storage (TWS) Anomalies\nhouston-lst-day - Houston land surface temperature during daytime - decadal average\nlis-global-da-gpp - Gross Primary Productivity - LIS 10km Global DA\nhouston-urbanization - New Urbanization from 2001-2019 (NLCD)\nsocial-vulnerability-index-housing - Social Vulnerability Index (Housing)\neis_fire_perimeter - Fire Perimeters\ngrdi-imr-raster - GRDI IMR Constituent Raster\nbangladesh-landcover-2001-2020 - Annual land cover maps for 2001 and 2020\nnceo_africa_2017 - NCEO Africa Aboveground Woody Biomass 2017\nlis-global-da-swe - Snow Water Equivalent - LIS 10km Global DA\ngeoglam - GEOGLAM Crop Monitor\nhls-l30-002-ej-reprocessed - HLSL30.002 Environmental Justice Events\nlis-global-da-qs - Surface runoff - LIS 10km Global DA\nlis-tvegsuppression - Change in transpiration for 2020 fires using LIS outputs\nCMIP245-winter-median-pr - Projected changes to winter (January, February, and March) cumulative daily precipitation\nEPA-annual-emissions_1B2b_Natural_Gas_Processing - Gridded 2012 EPA Methane Emissions - Natural Gas Processing\nEPA-annual-emissions_6B_Wastewater_Treatment_Domestic - Gridded 2012 EPA Methane Emissions - Domestic Wastewater Treatment\nhouston-aod-diff - Houston AOD: Difference Between 2000-2009 & 2010-2019\nCMIP245-winter-median-ta - Projected changes to winter (January, February, and March) average daily air temperature\nEPA-annual-emissions_6B_Wastewater_Treatment_Industrial - Gridded 2012 EPA Methane Emissions - Industrial Wastewater Treatment\nEPA-annual-emissions_1B2a_Petroleum - Gridded 2012 EPA Methane Emissions - Petroleum\nEPA-annual-emissions_1B1a_Coal_Mining_Surface - Gridded 2012 EPA Methane Emissions - Surface Coal Mines\nEPA-annual-emissions_1A_Combustion_Mobile - Gridded 2012 EPA Methane Emissions - Mobile Combustion\nEPA-annual-emissions_4F_Field_Burning - Gridded 2012 EPA Methane Emissions - Field Burning\nlis-tws-anomaly - Terrestrial Water Storage (TWS) Anomalies\nCMIP585-winter-median-pr - Projected changes to winter (January, February, and March) cumulative daily precipitation\nbarc-thomasfire - Burn Area Reflectance Classification for Thomas Fire\nEPA-annual-emissions_2B5_Petrochemical_Production - Gridded 2012 EPA Methane Emissions - Petrochemical Production\ncaldor-fire-behavior - Caldor Fire Behavior\nconus-reach - Stream network across the Contiguous United States\nIS2SITMOGR4-cog - ICESat-2 L4 Monthly Gridded Sea Ice Thickness (COGs)\ncaldor-fire-burn-severity - Caldor Fire Burn Severity\nEPA-monthly-emissions_1B2b_Natural_Gas_Production - Gridded 2012 EPA Methane Emissions - Natural Gas Production (monthly)\ndisalexi-etsuppression - disalexi-etsuppression\nCMIP585-winter-median-ta - Projected changes to winter (January, February, and March) average daily air temperature\nfrp-max-thomasfire - Maximum Fire Radiative Power for Thomas Fire\nco2-mean - COâ‚‚ (Avg)\nlis-tws-nonstationarity-index - Global TWS Non-Stationarity Index\nhouston-lst-diff - Houston LST (Diff)\nlis-global-da-tws - Terrestrial Water Storage - LIS 10km Global DA\nOMI_trno2-COG - OMI_trno2 - 0.10 x 0.10 Annual as Cloud-Optimized GeoTIFFs (COGs)\nmodis-annual-lai-2003-2020 - Annual LAI maps for 2003 and 2021 (Bangladesh)\nlandsat-c2l2-sr-lakes-lake-balaton - Selected Landsat 7 through 9 Surface Reflectance Scenes for Lake Balaton\nlis-global-da-tws-trend - Terrestrial Water Storage Trend - LIS 10km Global DA\nsnow-projections-median - Projections of Snow Water Equivalent (SWE)\nhouston-landcover - Houston Land Cover\nlandsat-c2l2-sr-lakes-lake-biwa - Selected Landsat 7 through 9 Surface Reflectance Scenes for Lake Biwa\nhouston-lst-night - Houston land surface temperature at night time - decadal average\nsnow-projections-diff - Projections of Snow Water Equivalent (SWE) losses\nlandsat-c2l2-sr-lakes-tonle-sap - Selected Landsat 7 through 9 Surface Reflectance Scenes for TonlÃ© Sap\nhouston-aod - Aerosol Optical Depth (AOD)\nsnow-projections-diff-245 - Projections of Snow Water Equivalent (SWE) Losses - SSP2-4.5\nhouston-ndvi - Houston NDVI: decadal average\nlandsat-c2l2-sr-lakes-vanern - Selected Landsat 7 through 9 Surface Reflectance Scenes for VÃ¤nern\nsnow-projections-diff-585 - Projections of Snow Water Equivalent (SWE) Losses - SSP5-8.5\nlis-global-da-gpp-trend - Gross Primary Productivity Trend - LIS 10km Global DA\nlis-global-da-qsb - Subsurface Runoff - LIS 10km Global DA\nlandsat-c2l2-sr-lakes-aral-sea - Selected Landsat 7 through 9 Surface Reflectance Scenes for the Aral Sea\nsnow-projections-median-245 - Projections of Snow Water Equivalent (SWE) - SSP2-4.5\nlis-global-da-streamflow - Streamflow - LIS 10km Global DA\nrecovery-proxy-maps-covid-19 - Recovery Proxy Maps\nlis-etsuppression - Change in ET for 2020 fires using LIS outputs\nsnow-projections-median-585 - Projections of Snow Water Equivalent (SWE) - SSP5-8.5\nlis-global-da-totalprecip - Total Precipitation - LIS 10km Global DA\nls8-covid-19-example-data - \nslowdown-proxy-covid-19-changing-landscapes - Slowdown Proxy Maps\nnightlights-hd-monthly - Black Marble High Definition Nightlights Monthly Dataset\ngrdi-vnl-raster - GRDI VNL Constituent Raster\nsocial-vulnerability-index-housing-nopop - Social Vulnerability Index (Housing) (Masked)\nsocial-vulnerability-index-household-nopop - Social Vulnerability Index (Household) (Masked)\nsocial-vulnerability-index-socioeconomic - Social Vulnerability Index (SocioEconomic)\nsocial-vulnerability-index-socioeconomic-nopop - Social Vulnerability Index (SocioEconomic) (Masked)\ngrdi-filled-missing-values-count - GRDI Filled Missing Values Count\nsocial-vulnerability-index-overall - Social Vulnerability Index (Overall)\nsocial-vulnerability-index-minority-nopop - Social Vulnerability Index (Minority) (Masked)\ngrdi-cdr-raster - GRDI CDR Constituent Raster\nMO_NPP_npp_vgpm - \nsocial-vulnerability-index-overall-nopop - Social Vulnerability Index (Overall) (Masked)\ngrdi-v1-raster - GRDI V1 raster\ngrdi-shdi-raster - GRDI SHDI Constituent Raster\nblue-tarp-planetscope - Hurricane Ida - Blue Tarps PlanetScope Image\nnightlights-hd-1band - Black Marble High Definition Nightlights 1 band Dataset\nsocial-vulnerability-index-minority - Social Vulnerability Index (Minority)\nOMSO2PCA-COG - OMI/Aura Sulfur Dioxide (SO2) Total Column L3 1 day Best Pixel in 0.25 degree x 0.25 degree V3 as Cloud-Optimized GeoTIFFs (COGs)\nEPA-annual-emissions_1B1a_Coal_Mining_Underground - Gridded 2012 EPA Methane Emissions - Underground Coal Mines\nhls-s30-002-ej-reprocessed - HLSS30.002 Environmental Justice Events\ngrdi-v1-built - GRDI BUILT Constituent Raster\ngrdi-vnl-slope-raster - GRDI VNL Slope Constituent Raster\nfacebook_population_density - Population Density Maps using satellite imagery built by Meta\nEPA-annual-emissions_1B1a_Abandoned_Coal - Gridded 2012 EPA Methane Emissions - Abandoned Coal Mines\nEPA-annual-emissions_4B_Manure_Management - Gridded 2012 EPA Methane Emissions - Manure Management\nEPA-annual-emissions_1A_Combustion_Stationary - Gridded 2012 EPA Methane Emissions - Stationary Combustion\nEPA-annual-emissions_1B2b_Natural_Gas_Production - Gridded 2012 EPA Methane Emissions - Natural Gas Production\nEPA-annual-emissions_6A_Landfills_Industrial - Gridded 2012 EPA Methane Emissions - Industrial Landfills\nEPA-annual-emissions_2C2_Ferroalloy_Production - Gridded 2012 EPA Methane Emissions - Ferroalloy Production\nEPA-annual-emissions_4A_Enteric_Fermentation - Gridded 2012 EPA Methane Emissions - Enteric Fermentation\nEPA-annual-emissions_6A_Landfills_Municipal - Gridded 2012 EPA Methane Emissions - Municipal Landfills\nEPA-annual-emissions_1B2b_Natural_Gas_Transmission - Gridded 2012 EPA Methane Emissions - Natural Gas Transmission\nEPA-annual-emissions_5_Forest_Fires - Gridded 2012 EPA Methane Emissions - Forest Fires\nEPA-annual-emissions_1B2b_Natural_Gas_Distribution - Gridded 2012 EPA Methane Emissions - Natural Gas Distribution\nEPA-annual-emissions_4C_Rice_Cultivation - Gridded 2012 EPA Methane Emissions - Rice Cultivation\nEPA-daily-emissions_5_Forest_Fires - Gridded 2012 EPA Methane Emissions - Forest Fires (daily)\nEPA-monthly-emissions_1A_Combustion_Stationary - Gridded 2012 EPA Methane Emissions - Stationary Combustion (monthly)\nEPA-monthly-emissions_4F_Field_Burning - Gridded 2012 EPA Methane Emissions - Field Burning (monthly)\nEPA-monthly-emissions_4B_Manure_Management - Gridded 2012 EPA Methane Emissions - Manure Management (monthly)\nEPA-monthly-emissions_1B2a_Petroleum - Gridded 2012 EPA Methane Emissions - Petroleum (monthly)\nblue-tarp-detection - Hurricane Ida - Detected Blue Tarps\nEPA-monthly-emissions_4C_Rice_Cultivation - Gridded 2012 EPA Methane Emissions - Rice Cultivation (monthly)\nco2-diff - COâ‚‚ (Diff)\n"}],"key":"zawYji2XBM"}],"key":"DLFK2BLu6A"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Choose a collection to work with. Weâ€™ll choose the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UyeGga3g94"},{"type":"inlineCode","value":"no2-monthly","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nWAahM8Zp9"},{"type":"text","value":" dataset for this example.\nThis is the global nitrogen dioxide data organized into monthly metrics.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FVoIxOBv4Z"}],"key":"RQOblq58o9"}],"key":"skhDjwCnWv"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"collection_id = \"no2-monthly\"","key":"FswBlNDvb5"},{"type":"output","id":"QxtZp2WSG3QxHnL1byIZS","data":[],"key":"xHXXdkSoG7"}],"key":"B9A8szvTbQ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Search all the items in the collection.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pukKVWrK9N"}],"key":"tMcg2kmDRr"}],"key":"pMPEmaf98j"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"search = catalog.search(collections=[collection_id])\nitems = list(search.items())\nitems","key":"QALTn1Ku1p"},{"type":"output","id":"ZDNNDyZWihJEFfCPonXjo","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/plain":{"content":"[<Item id=OMI_trno2_0.10x0.10_202212_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202211_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202210_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202209_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202208_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202207_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202206_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202205_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202204_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202203_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202202_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202201_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202112_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202111_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202110_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202109_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202108_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202107_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202106_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202105_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202104_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202103_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202102_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202101_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202012_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202011_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202010_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202009_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202008_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202007_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202006_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202005_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202004_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202003_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202002_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_202001_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201912_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201911_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201910_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201909_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201908_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201907_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201906_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201905_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201904_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201903_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201902_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201901_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201812_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201811_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201810_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201809_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201808_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201807_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201806_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201805_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201804_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201803_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201802_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201801_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201712_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201711_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201710_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201709_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201708_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201707_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201706_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201705_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201704_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201703_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201702_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201701_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201612_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201611_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201610_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201609_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201608_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201607_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201606_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201605_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201604_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201603_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201602_Col3_V4.nc>,\n <Item id=OMI_trno2_0.10x0.10_201601_Col3_V4.nc>]","content_type":"text/plain"}}}],"key":"jP7mgzo8hj"}],"key":"PX9tLMoMMC"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load and inspect one of the itemâ€™s assets. In the catalog, the cloud optimized geotiffs (COG) are indexed under ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"R4wNC5bSzG"},{"type":"inlineCode","value":"cog_default","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t6w2rIgis4"},{"type":"text","value":" asset.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"e1a93nZALE"}],"key":"skEbO27Kwe"}],"key":"TPvk290HNm"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"s3_uri = items[0].assets[\"cog_default\"].href","key":"nvQqwtCZBQ"},{"type":"output","id":"uCmGVOhiMek97tDV_hu8F","data":[],"key":"B68wZKzbM7"}],"key":"IZRh1vgmZa"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Get statistics for the COG file using the TiTiler api endpoint ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pJIIufJeEf"},{"type":"inlineCode","value":"/cog/statistics","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NVakNlByk1"}],"key":"bZTdnJUABe"}],"key":"qqmdvdSAdc"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"stats = requests.get(\n    f\"{RASTER_API_URL}/cog/statistics\",\n    params={\"url\": s3_uri}\n).json()\nstats","key":"mVsSH1InAg"},{"type":"output","id":"2Yy03AfNdsRxI4phTHGPH","data":[{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/plain":{"content":"{'1': {'min': -6707683428139008.0,\n  'max': 3.884375294450074e+16,\n  'mean': 423085978017950.7,\n  'count': 434008.0,\n  'sum': 1.8362269914761475e+20,\n  'std': 971153921053730.1,\n  'median': 245577371615232.0,\n  'majority': 121884402253824.0,\n  'minority': -6187472157409280.0,\n  'unique': 334278.0,\n  'histogram': [[58.0,\n    423787.0,\n    8532.0,\n    1008.0,\n    339.0,\n    199.0,\n    79.0,\n    4.0,\n    0.0,\n    2.0],\n   [-6707683428139008.0,\n    -2152539764031488.0,\n    2402603900076032.0,\n    6957747698401280.0,\n    1.151289069142016e+16,\n    1.6068035295051776e+16,\n    2.062317882494157e+16,\n    2.517832235483136e+16,\n    2.973346588472115e+16,\n    3.4288609414610944e+16,\n    3.884375294450074e+16]],\n  'valid_percent': 82.78,\n  'masked_pixels': 90280.0,\n  'valid_pixels': 434008.0,\n  'percentile_2': -178728386691072.0,\n  'percentile_98': 2662192260317184.0}}","content_type":"text/plain"}}}],"key":"WONIl0jFYI"}],"key":"v1hTX6v6k2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Display the COG in a map","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pbW1h7iLCb"}],"key":"ikLpnSNkpp"}],"key":"PtpMh2zLia"}],"key":"NDfPSGoJwa"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, weâ€™ll make a request for imagery tiles to the raster API.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RUxrIiuIPB"}],"key":"YNng5dlfIv"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Define the query parameters for the request:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"q69RKyhXfZ"}],"key":"CPBKdpOjtP"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"collection","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"u5J4lS8F73"}],"key":"ZQEElGUuOl"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"item","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jF7DRw05We"}],"key":"sAMruy6UVY"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"rescale","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"y8XTbe1Toc"}],"key":"B3VkCc9SeR"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"colormap","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"uo45bE7Y6z"}],"key":"ZCzitnOHFN"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"assets","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"qyMje4lR1F"}],"key":"LX13NrIv4Y"}],"key":"PLrOBqvdBK"}],"key":"x0pD6ryvpn"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"collection = collection_id\nitem = items[0].id\ncolormap = \"rainbow\"\nassets = \"cog_default\"\nrescale = f\"{stats['1']['min']},{stats['1']['max']}\"","key":"PJjmgrICq8"},{"type":"output","id":"voDzOb3B6N0FwuS27a8L9","data":[],"key":"j09Mv6Gg04"}],"key":"dbfmYA0kcB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Get the tileset json for the relevant item.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hD3tc6ZoB4"}],"key":"lN106HGr26"}],"key":"e6hYt4BcbB"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"tiles = requests.get(\n    f\"{RASTER_API_URL}/stac/tilejson.json?collection={collection}&item={item}&assets={assets}&colormap_name={colormap}&rescale={rescale}\"\n).json()","key":"H05Y0TyWAL"},{"type":"output","id":"zcHIZYGqyCk-cRySGnxM-","data":[],"key":"uJqRFDUn3v"}],"key":"iNt7YeVEbS"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"tiles","key":"IiRStE6KE5"},{"type":"output","id":"9kxX5_O-vGVaq72SkMWFZ","data":[{"output_type":"execute_result","execution_count":83,"metadata":{},"data":{"text/plain":{"content":"{'tilejson': '2.2.0',\n 'version': '1.0.0',\n 'scheme': 'xyz',\n 'tiles': ['https://staging-raster.delta-backend.com/stac/tiles/WebMercatorQuad/{z}/{x}/{y}@1x?collection=no2-monthly&item=OMI_trno2_0.10x0.10_202212_Col3_V4.nc&assets=cog_default&colormap_name=rainbow&rescale=-6707683428139008.0%2C3.884375294450074e+16'],\n 'minzoom': 0,\n 'maxzoom': 24,\n 'bounds': [-180.0, -90.0, 180.0, 90.0],\n 'center': [0.0, 0.0, 0]}","content_type":"text/plain"}}}],"key":"eWzJ30EwjK"}],"key":"ky8jdsK53l"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Gdsrucjb9B"},{"type":"inlineCode","value":"/tiles","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ug8DuDsJLw"},{"type":"text","value":" endpoint to visualize the file in a map","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q5QUHWXNhx"}],"key":"qB1ibBhoFM"}],"key":"p8ZdDTlkjS"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"m = folium.Map(\n    zoom_start=10,\n    scroll_wheel_zoom=True, \n    tiles=tiles[\"tiles\"][0],\n    attr=\"VEDA\", \n    minzoom=0, \n    maxzoom=18,\n)","key":"LoBl8WWtXX"},{"type":"output","id":"zIix0sYvtpmiEWTQJFm7A","data":[],"key":"V6HpB0Jk5J"}],"key":"XOWSYFKmLU"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"m","key":"Up5AQtwcKJ"},{"type":"output","id":"n0z2pLtyIko2o-xh6wu3P","data":[{"output_type":"execute_result","execution_count":89,"metadata":{},"data":{"text/html":{"content":"<div style=\"width:100%;\"><div style=\"position:relative;width:100%;height:0;padding-bottom:60%;\"><span style=\"color:#565656\">Make this Notebook Trusted to load map: File -> Trust Notebook</span><iframe srcdoc=\"&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    \n    &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;\n    \n        &lt;script&gt;\n            L_NO_TOUCH = false;\n            L_DISABLE_3D = false;\n        &lt;/script&gt;\n    \n    &lt;style&gt;html, body {width: 100%;height: 100%;margin: 0;padding: 0;}&lt;/style&gt;\n    &lt;style&gt;#map {position:absolute;top:0;bottom:0;right:0;left:0;}&lt;/style&gt;\n    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://code.jquery.com/jquery-1.12.4.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;&gt;&lt;/script&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/&gt;\n    \n            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,\n                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; /&gt;\n            &lt;style&gt;\n                #map_6b1058c0a78452c16c2bf32505192993 {\n                    position: relative;\n                    width: 100.0%;\n                    height: 100.0%;\n                    left: 0.0%;\n                    top: 0.0%;\n                }\n                .leaflet-container { font-size: 1rem; }\n            &lt;/style&gt;\n        \n&lt;/head&gt;\n&lt;body&gt;\n    \n    \n            &lt;div class=&quot;folium-map&quot; id=&quot;map_6b1058c0a78452c16c2bf32505192993&quot; &gt;&lt;/div&gt;\n        \n&lt;/body&gt;\n&lt;script&gt;\n    \n    \n            var map_6b1058c0a78452c16c2bf32505192993 = L.map(\n                &quot;map_6b1058c0a78452c16c2bf32505192993&quot;,\n                {\n                    center: [0, 0],\n                    crs: L.CRS.EPSG3857,\n                    zoom: 1,\n                    zoomControl: true,\n                    preferCanvas: false,\n                    scrollWheelZoom: true,\n                    minzoom: 0,\n                    maxzoom: 18,\n                }\n            );\n\n            \n\n        \n    \n            var tile_layer_551065a2ecf6b4683533df070a836004 = L.tileLayer(\n                &quot;https://staging-raster.delta-backend.com/stac/tiles/WebMercatorQuad/{z}/{x}/{y}@1x?collection=no2-monthly\\u0026item=OMI_trno2_0.10x0.10_202212_Col3_V4.nc\\u0026assets=cog_default\\u0026colormap_name=rainbow\\u0026rescale=-6707683428139008.0%2C3.884375294450074e+16&quot;,\n                {&quot;attribution&quot;: &quot;VEDA&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 18, &quot;maxZoom&quot;: 18, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}\n            ).addTo(map_6b1058c0a78452c16c2bf32505192993);\n        \n&lt;/script&gt;\n&lt;/html&gt;\" style=\"position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;\" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div>","content_type":"text/html"},"text/plain":{"content":"<folium.folium.Map at 0x165780b10>","content_type":"text/plain"}}}],"key":"JXiGDRxcF0"}],"key":"qO4C5P48iz"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2. Using the EOAPI to generate a time-series of OMI NOâ‚‚ and SOâ‚‚ datasets","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KWnRa0UrCw"}],"identifier":"id-2-using-the-eoapi-to-generate-a-time-series-of-omi-no-and-so-datasets","label":"2. Using the EOAPI to generate a time-series of OMI NOâ‚‚ and SOâ‚‚ datasets","html_id":"id-2-using-the-eoapi-to-generate-a-time-series-of-omi-no-and-so-datasets","implicit":true,"key":"SMKyKGddbR"}],"key":"S93Eos3OHO"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Thereâ€™s a story published in the EODashboard with the following title:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FPGIwSIj92"}],"key":"pP60BOM9gP"},{"type":"blockquote","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Air pollution in India, China and the U.S. have changed significantly over the past two decades","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"X9gXFCII16"}],"key":"JCQAA3rZdW"}],"key":"hDDWi7FZcy"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Link: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"EYPZEs3ACE"},{"type":"link","url":"https://eodashboard.org/story?id=air-pollution-us-india-china","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"https://â€‹eodashboardâ€‹.orgâ€‹/storyâ€‹?idâ€‹=â€‹airâ€‹-pollutionâ€‹-usâ€‹-indiaâ€‹-china","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XrE3CceDFj"}],"urlSource":"https://eodashboard.org/story?id=air-pollution-us-india-china","key":"wNHX68vZKq"}],"key":"lSEe6Q4y63"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The story talks about the trend of air pollution in India, China and the U.S. using the NO","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"J5OkhNr2JW"},{"type":"subscript","children":[{"type":"text","value":"2","key":"RZEgiMyp7g"}],"key":"jeqCpnvnB7"},{"type":"text","value":" and SO","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"YzwNQ00WSS"},{"type":"subscript","children":[{"type":"text","value":"2","key":"WIJkRgdqXR"}],"key":"vUYaVHiF3Z"},{"type":"text","value":" readings taken from the OMI instrument","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vOYKGO7cBn"}],"key":"KBMPNJ4aUE"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Here, weâ€™ll recreate the analysis using the EOAPI.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"BO1sFtu2Sb"}],"key":"m9yK3aZefp"}],"key":"MwzMj7IKju"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Here, we find the relevant collection ID for the dataset\ncollections = {\n    \"no2\": \"OMI_trno2-COG\",\n    \"so2\": \"OMSO2PCA-COG\",\n}","key":"bBxboW34z4"},{"type":"output","id":"bRPGQUnvXH-xaeqSCX__M","data":[],"key":"OdYIJqr0kf"}],"key":"vduWFgZfc2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the roughly similar Area of Interest (AOI) for each of the countries as seen in the story.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NotmiiahrR"}],"key":"bsYs0knxoM"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Disclaimer: Since the AOI is roughly similar, but not exactly the same, the results may differe slightly, but should maintain similar trends.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"k29juRlEUc"}],"key":"d9upTPREs3"}],"key":"TECDc6Bnul"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"aois = {\n    \"india\": {\n      \"type\": \"Feature\",\n      \"properties\": {},\n      \"geometry\": {\n        \"coordinates\": [\n          [\n            [\n              84.44227371801799,\n              25.276852788244952\n            ],\n            [\n              81.73331688510166,\n              25.379576397063317\n            ],\n            [\n              81.40290450746915,\n              20.640781701865322\n            ],\n            [\n              84.09079123546121,\n              20.59296261766137\n            ],\n            [\n              84.44227371801799,\n              25.276852788244952\n            ]\n          ]\n        ],\n        \"type\": \"Polygon\"\n      }\n    },\n    \"china\": {\n      \"type\": \"Feature\",\n      \"properties\": {},\n      \"geometry\": {\n        \"coordinates\": [\n          [\n            [\n              118.14487188674968,\n              40.38237805885373\n            ],\n            [\n              112.59679754686567,\n              40.39197699341523\n            ],\n            [\n              112.78712023622006,\n              32.015052150835814\n            ],\n            [\n              117.937454307721,\n              32.102440507249895\n            ],\n            [\n              118.14487188674968,\n              40.38237805885373\n            ]\n          ]\n        ],\n        \"type\": \"Polygon\"\n      }\n    },\n    \"usa\": {\n        \"type\": \"Feature\",\n        \"properties\": {},\n        \"geometry\": {\n            \"coordinates\": [\n            [\n                [\n                -80.16702521343733,\n                41.73420113945659\n                ],\n                [\n                -83.56446680395005,\n                38.599369254919566\n                ],\n                [\n                -82.00280661075571,\n                37.54658260550103\n                ],\n                [\n                -78.28140359718638,\n                40.450899619800595\n                ],\n                [\n                -80.16702521343733,\n                41.73420113945659\n                ]\n            ]\n            ],\n            \"type\": \"Polygon\"\n        }\n    },\n}","key":"AAt7BJlCvz"},{"type":"output","id":"UYWqTL96FhHVSi3sgYZly","data":[],"key":"CGKOjB6tse"}],"key":"bq9VPXKqmP"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define a function that takes the following params:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ejdS9vzmKD"}],"key":"D83HStyPr4"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"inlineCode","value":"item","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RLZC18TFlo"},{"type":"text","value":": a STAC item","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"gbYIi0KDiB"}],"key":"aUJVFYh669"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"inlineCode","value":"geojson","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Pf611HMt8t"},{"type":"text","value":": the geojson of the AOI","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VK0rNjG8GJ"}],"key":"ctUgR5V2nj"}],"key":"hpzKGTFp87"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Using the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"OJHe8QGxKM"},{"type":"inlineCode","value":"/cog/statistics/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JGZLOvsm8p"},{"type":"text","value":" endpoint of the raster API, we get back the statistics of the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NHmeQeeJh7"},{"type":"inlineCode","value":"item","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"E2NDtm3n4M"},{"type":"text","value":" (which corresponds to one COG file) within the given ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KG1R3quw6f"},{"type":"inlineCode","value":"geojson","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lUyedUCD3v"},{"type":"text","value":" AOI.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"f5DnPpixLR"}],"key":"vrOThNU9GF"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The statistics includes ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ks42EhXqi3"},{"type":"inlineCode","value":"min","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"sq0xPBJbg7"},{"type":"text","value":", ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mHh8sM7OkL"},{"type":"inlineCode","value":"max","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"slYU1IyZce"},{"type":"text","value":", ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Jx7aePVSbr"},{"type":"inlineCode","value":"mean","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ioZGEvHtRO"},{"type":"text","value":", ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"z6MyVKibtl"},{"type":"inlineCode","value":"std","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nCHYs84Z0Z"},{"type":"text","value":", etc.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xgOpwYK51g"}],"key":"dD8lDVpOcs"}],"key":"hbe0Pmg6jR"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# the bounding box should be passed to the geojson param as a geojson Feature or FeatureCollection\ndef generate_stats(item, geojson):\n    result = requests.post(\n        f\"{RASTER_API_URL}/cog/statistics\", \n        params={\n            \"url\": item.assets[\"cog_default\"].href\n        },\n        json=geojson\n    ).json()\n    return {\n        **result[\"properties\"],\n        \"start_datetime\": str(item.properties.get(\"datetime\", item.properties.get(\"start_datetime\")))[:4],\n        \"collection\": item.collection_id\n    }","key":"BZAD2MIrRK"},{"type":"output","id":"Xy18ygwG-QjjO4vYzn43b","data":[],"key":"rL5wH09ZQB"}],"key":"pNcURCXdAq"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Letâ€™s start out with the US ðŸ‡ºðŸ‡¸ !","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kK4pVNMmRB"}],"key":"hCURwGgNJF"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Weâ€™ll get all the items in the NO2 and SO2 collections and generate the statistics from them for the Ohio River Valley region of the United States.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OzSoVmPJgk"}],"key":"UMfxVkeI3S"}],"key":"L64CWvC8or"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"usa_aoi = aois[\"usa\"]\nitems = list(catalog.search(collections=[collections[\"no2\"], collections[\"so2\"]]).items())\nusa_stats = [\n    generate_stats(item, usa_aoi)\n    for item in items\n]","key":"pQZ7pQevKH"},{"type":"output","id":"-Uof1GCnhw7XyM7gkAulS","data":[],"key":"C1hgnCjFfs"}],"key":"pGULh03AvM"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a function that takes the statistics (which is a json) and converts it to a pandas dataframe in a format thatâ€™ll make it easy to read and visualize.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q2X1M5xJ3J"}],"key":"FHajgwZfMR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We are only concerned with the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IYB6DpcIUo"},{"type":"inlineCode","value":"mean","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CodKSa8z3g"},{"type":"text","value":" statistics for this example. Specifically the change from the year 2005 as a percentage. Weâ€™ll use pandas to calculate this change percentage and assign it to the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wg2iEJBoew"},{"type":"inlineCode","value":"change","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pMYToaF8XP"},{"type":"text","value":" column.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"atyJ6kSqV2"}],"key":"zpWzID519O"}],"key":"RT35JS7cbh"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"def clean_stats(stats_json) -> pd.DataFrame:\n    # convert the stats_json as is to pandas dataframe\n    df = pd.json_normalize(stats_json)\n    # simple renaming for readability\n    df.columns = [col.replace(\"statistics.1.\", \"\") for col in df.columns]\n    # create a date column from the start_datetime column\n    df[\"date\"] = pd.to_datetime(df[\"start_datetime\"], format=\"mixed\")\n    # rename the collection to a more friendly name\n    df[\"collection\"] = df[\"collection\"].map(lambda x: next(key for key, value in collections.items() if value == x))\n    # sort the dataframe by the date column\n    df = df.sort_values(by=[\"date\"])\n    # create a change column that calculates the change of the mean values from the value in 2005\n    df[\"change\"] = df.groupby(\"collection\", group_keys=False)[\"mean\"].apply(lambda x: x.div(x.iloc[0]).subtract(1).mul(100))\n    return df","key":"sXiDYeEVlI"},{"type":"output","id":"uCfY2oGjDCfk-I215Hg8x","data":[],"key":"CCFfeyk6pd"}],"key":"an0z9xu5gp"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"cleaned_stats_df = clean_stats(usa_stats)","key":"iKnx017Dvo"},{"type":"output","id":"p8pu8aKHO4RWQAMyC6cV1","data":[],"key":"ITQwPkkPkj"}],"key":"OIRTIfocLB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Weâ€™ll now create a time-series of the change in mean values for NO2 and SO2 for the area in the US.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V7w0VVt5uj"}],"key":"y7j7qSrF4D"}],"key":"Ho7ZLrmW7q"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"plt.xticks([i for i in range(0, 21, 2)])\nsns.set_style(\"darkgrid\")\nax = sns.lineplot(\n    x=\"start_datetime\",\n    y=\"change\",\n    hue=\"collection\",\n    data=cleaned_stats_df,\n    palette=[\"#2196f3\", \"#ff5722\"],\n    style=\"collection\",\n    markers=[\"*\", \"d\"],\n)\nax.set_title(\"US - Ohio River Valley\")\nax.set_xlabel(\"Years\")\nax.set_ylabel(\"Change from 2005 (%)\")\nplt.legend(frameon=False, ncol=3)\nplt.show()","key":"yVov83LnzF"},{"type":"output","id":"T_TXeZaQO7B1j9Qzq5o2Z","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0daf1261d5b4553525e31d60cd7b502a","path":"/notebooks_test/build/0daf1261d5b4553525e31d60cd7b502a.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"TRYszoJYGo"}],"key":"I1UdLC1mon"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, letâ€™s create a function that creates this trend graph, given the country.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qLyB1G3aPg"}],"key":"Pgvx1UArzU"}],"key":"aqjYx3QL9O"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"def create_chart(country):\n    stats = [generate_stats(item, aois[country]) for item in list(catalog.search(collections=[collections[\"no2\"], collections[\"so2\"]]).items())]\n    df = clean_stats(stats)\n\n    # Create a chart using Seaborn\n    plt.xticks([i for i in range(0, 21, 2)])\n    sns.set_style(\"darkgrid\")\n    ax = sns.lineplot(\n        x=\"start_datetime\",\n        y=\"change\",\n        hue=\"collection\",\n        data=df,\n        palette=[\"#2196f3\", \"#ff5722\"],\n        style=\"collection\",\n        markers=[\"*\", \"d\"],\n        legend=\"full\",\n        # label=[\"no2\", \"so2\"]\n    )\n    ax.set_title(country.title())\n    ax.set_xlabel(\"Years\")\n    ax.set_ylabel(\"Change from 2005 (%)\")\n    ax.legend([\"no2\", \"so2\"])\n    plt.legend(frameon=False, ncol=3)\n    plt.show()","key":"uNfAaAmc3z"},{"type":"output","id":"BdpGoZSCQa0MFltBDRNuk","data":[],"key":"AsNkrzSK8h"}],"key":"DbdQu0zBug"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can use this function to create charts for the rest of the AOIs.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ICfeFjWtCS"}],"key":"BixW7aYaci"}],"key":"wafuOyB3uf"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"India ðŸ‡®ðŸ‡³","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vs7I0NXK8H"}],"key":"f0FV4co8Gf"}],"key":"hvO9HsV0zG"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"create_chart(\"india\")","key":"y93LOfuFOe"},{"type":"output","id":"CeBugWfiE0O8CPuUWFPxC","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2d8eb241d54c89d0748234dfb653c1f9","path":"/notebooks_test/build/2d8eb241d54c89d0748234dfb653c1f9.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"oDLw9pJpIq"}],"key":"LIIbmuV8sV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"China ðŸ‡¨ðŸ‡³","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IyX3wJT1GQ"}],"key":"pxJWo0J0qP"}],"key":"xtaAc83l32"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"create_chart(\"china\")","key":"HcwQRlvS6T"},{"type":"output","id":"wMOgwhNT-eOt8ueZoYLlZ","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bcc0e960399ecbcecb76c8807968906e","path":"/notebooks_test/build/bcc0e960399ecbcecb76c8807968906e.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"jkZxiYmotP"}],"key":"DxJG5oznou"}],"key":"brozdTnjgk"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Impact of Covid19 induced lockdown on NO2 levels","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/no2-analysis-covid19-lockdowns","group":"Contributions"},"next":{"title":"Important notes","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/ogc-edc","group":"Contributions"}}},"domain":"http://localhost:3000"}