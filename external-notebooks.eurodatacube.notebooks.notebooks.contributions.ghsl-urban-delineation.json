{"version":1,"kind":"Notebook","sha256":"604c411f759f425f1fca70a9509700fdc28bc03b8085df793db343a99ecd4209","slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.ghsl-urban-delineation","location":"/external_notebooks/eurodatacube/notebooks/notebooks/contributions/GHSL_Urban_Delineation.ipynb","dependencies":[],"frontmatter":{"title":"<b>Urban delineation<b>","content_includes_title":true,"kernelspec":{"name":"conda-env-edc-default-2022.10-14-py","display_name":"Python [conda env:edc-default-2022.10-14]","language":"python"},"github":"https://github.com/eoxhub-workspaces/documentation/","numbering":{"title":{"offset":5}},"edit_url":"https://github.com/eoxhub-workspaces/documentation//blob/main/external_notebooks/eurodatacube/notebooks/notebooks/contributions/GHSL_Urban_Delineation.ipynb","thumbnail":"/notebooks_test/build/7bbf545a5eae1d9ebdb91ae42b261063.png","exports":[{"format":"ipynb","filename":"GHSL_Urban_Delineation.ipynb","url":"/notebooks_test/build/GHSL_Urban_Delineati-7af3218e7994b25565ee83176f8e1be9.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:31.332732Z","iopub.status.busy":"2023-03-22T12:55:31.329186Z","iopub.status.idle":"2023-03-22T12:55:31.500649Z","shell.execute_reply":"2023-03-22T12:55:31.498627Z"},"papermill":{"duration":0.247886,"end_time":"2023-03-22T12:55:31.505769","exception":false,"start_time":"2023-03-22T12:55:31.257883","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from eoxhub import check_compatibility\ncheck_compatibility(\"user-2023.03-02\", dependencies=[\"GEODB\"])","visibility":"show","key":"ZKSQs9kxXj"},{"type":"output","id":"73g23HYkwARq7lJxt-Rz0","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<script type=\"text/javascript\">\n        function toggle(id) {\n            el = document.getElementById(id);\n            el.style.display = el.style.display === \"none\" ? \"block\" : \"none\";\n        }\n    </script>","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"This notebook is compatible with this base image version (user-2023.03-02).","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/markdown":{"content":"\n\n---------\n\nThe following environment variables are available:\n\n* `GEODB_AUTH_AUD`, `GEODB_AUTH_CLIENT_ID`, `GEODB_AUTH_DOMAIN`, `GEODB_API_SERVER_URL`, `GEODB_AUTH_CLIENT_SECRET`, `GEODB_API_SERVER_PORT`\n","content_type":"text/markdown"},"text/plain":{"content":"<IPython.core.display.Markdown object>","content_type":"text/plain"}}}],"visibility":"show","key":"euo3dJCcgQ"}],"visibility":"show","key":"P5gsSKOskZ"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.031985,"end_time":"2023-03-22T12:55:31.570269","exception":false,"start_time":"2023-03-22T12:55:31.538284","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","children":[],"key":"CJfsnCkHtd"},{"type":"text","value":"Urban delineation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WWp92hPhi5"},{"type":"strong","children":[],"key":"ssyDZTWXlI"}],"identifier":"urban-delineation","label":"Urban delineation","html_id":"urban-delineation","implicit":true,"key":"f6S1gGZNfk"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"This notebook implements a GHSL settlement model algorithm as defined by the stage I of the Degree of Urbanisation (European Commission & Statistical Office of the European Union, 2021) and recommended by the UN STAT COM.\nModel uses the population and built-up surface grid - European Commission, Joint Research Centre (JRC)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BHwT5HWCDF"},{"type":"break","key":"wBVCeJm38u"},{"type":"text","value":"\nThe method here implemented is described in detail bellow.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FTYntENxdN"}],"key":"v6A9rOgTiJ"}],"visibility":"show","key":"XibGMBhg1h"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.03013,"end_time":"2023-03-22T12:55:31.631621","exception":false,"start_time":"2023-03-22T12:55:31.601491","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","children":[],"key":"FWg2JB06hB"},{"type":"text","value":" GHSL - settlement model ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C4ZAHTpCbe"},{"type":"strong","children":[],"key":"pjWwS8LFK3"}],"identifier":"ghsl-settlement-model","label":" GHSL - settlement model ","html_id":"ghsl-settlement-model","implicit":true,"key":"whemAEOwR7"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Delineate and classify settlement by typologies","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ZSMnHp6t29"}],"key":"aKs2njITmE"}],"visibility":"show","key":"NHvq8fBvuv"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.031901,"end_time":"2023-03-22T12:55:31.695520","exception":false,"start_time":"2023-03-22T12:55:31.663619","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Setlment L1 nomenclature:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VE6wuRuCxV"}],"identifier":"setlment-l1-nomenclature","label":"Setlment L1 nomenclature:","html_id":"setlment-l1-nomenclature","implicit":true,"key":"eIR7cV2CyI"},{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Urban Centre - High Density Cluster (HDC)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"PSHb66HRnX"}],"identifier":"urban-centre-high-density-cluster-hdc","label":"Urban Centre - High Density Cluster (HDC)","html_id":"urban-centre-high-density-cluster-hdc","implicit":true,"key":"IflL9rAOtr"},{"type":"heading","depth":3,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Urban Cluster - Moderate Density Cluster (MDC)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HNAOE2U3Sh"}],"identifier":"urban-cluster-moderate-density-cluster-mdc","label":"Urban Cluster - Moderate Density Cluster (MDC)","html_id":"urban-cluster-moderate-density-cluster-mdc","implicit":true,"key":"zozK23F0O8"}],"visibility":"show","key":"V27QYyeld1"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.032631,"end_time":"2023-03-22T12:55:31.760686","exception":false,"start_time":"2023-03-22T12:55:31.728055","status":"completed"},"tags":[]},"children":[{"type":"image","url":"/notebooks_test/build/7bbf545a5eae1d9ebdb91ae42b261063.png","alt":"image.png","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VOjjb2nFz3","urlSource":"data:image/png;base64,iVBORw0KGg...lFTkSuQmCC"},{"type":"image","url":"/notebooks_test/build/5d9ed6542f287f79b0a02b8c9a7429fd.png","alt":"image.png","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hUuw12s7kE","urlSource":"data:image/png;base64,iVBORw0KGg...5ErkJggg=="}],"visibility":"show","key":"gzIYmLTIWs"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.035842,"end_time":"2023-03-22T12:55:31.827079","exception":false,"start_time":"2023-03-22T12:55:31.791237","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Setlment L2 nomenclature:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SIodnaZ07g"}],"identifier":"setlment-l2-nomenclature","label":"Setlment L2 nomenclature:","html_id":"setlment-l2-nomenclature","implicit":true,"key":"BCJaI3APP8"},{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Urban Centre - High Density Cluster (HDC)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"g0YbgG69jM"}],"identifier":"urban-centre-high-density-cluster-hdc","label":"Urban Centre - High Density Cluster (HDC)","html_id":"urban-centre-high-density-cluster-hdc-1","implicit":true,"key":"bFP9Ae4Bfb"},{"type":"heading","depth":3,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Dense Urban Cluster (DUC)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"M08mL736AI"}],"identifier":"dense-urban-cluster-duc","label":"Dense Urban Cluster (DUC)","html_id":"dense-urban-cluster-duc","implicit":true,"key":"uHwdJnN9vT"},{"type":"heading","depth":3,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"SemiDense Urban Cluster (SDUC)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"RYPfVsOTsw"}],"identifier":"semidense-urban-cluster-sduc","label":"SemiDense Urban Cluster (SDUC)","html_id":"semidense-urban-cluster-sduc","implicit":true,"key":"yWHxO9zowa"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Peri-Urban Cluster (PUC)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"U5gWI8h26u"}],"identifier":"peri-urban-cluster-puc","label":"Peri-Urban Cluster (PUC)","html_id":"peri-urban-cluster-puc","implicit":true,"key":"b0GUGqZEdb"}],"visibility":"show","key":"WItS8N7Y3H"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.030983,"end_time":"2023-03-22T12:55:31.890402","exception":false,"start_time":"2023-03-22T12:55:31.859419","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"image","url":"/notebooks_test/build/6afbabbcb8110a51d59cc60ec6417ae0.png","alt":"image.png","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ON5gQXtMh5","urlSource":"data:image/png;base64,iVBORw0KGg...VORK5CYII="},{"type":"text","value":"\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rSPsBtC7Pg"},{"type":"image","url":"/notebooks_test/build/18ac3c1dd60273849534fede6130e6ad.png","alt":"image.png","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TSJLcJNIn6","urlSource":"data:image/png;base64,iVBORw0KGg...5ErkJggg=="}],"key":"qr3YgyhSJ3"}],"visibility":"show","key":"yXd4J9Pq9Z"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.029711,"end_time":"2023-03-22T12:55:31.953152","exception":false,"start_time":"2023-03-22T12:55:31.923441","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"GHSL data packages for settlement model:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YEjncOrHBy"}],"key":"C4rYe8e3UN"},{"type":"break","key":"HxwOaoreWe"},{"type":"text","value":"\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GlNEbUbmpa"},{"type":"break","key":"qslin49SpY"},{"type":"text","value":"\nbuilt-up:\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HCHjK5jVFQ"},{"type":"link","url":"https://ghsl.jrc.ec.europa.eu/download.php?ds=bu","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​ghsl​.jrc​.ec​.europa​.eu​/download​.php​?ds​=bu","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cafoLdpuvl"}],"urlSource":"https://ghsl.jrc.ec.europa.eu/download.php?ds=bu","key":"SPTgkiz4fP"},{"type":"text","value":"\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"paGeBHe0Y5"},{"type":"break","key":"FsK1Q0q6NE"},{"type":"text","value":"\npopulation:\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LKxa9DMChI"},{"type":"link","url":"https://ghsl.jrc.ec.europa.eu/download.php?ds=pop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​ghsl​.jrc​.ec​.europa​.eu​/download​.php​?ds​=​pop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nlMdekqQPp"}],"urlSource":"https://ghsl.jrc.ec.europa.eu/download.php?ds=pop","key":"mAb1OBvbVy"},{"type":"text","value":"\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i3XrACiEmB"},{"type":"break","key":"Ip26Ej6h8X"},{"type":"text","value":"\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hwQp2sJM62"},{"type":"break","key":"VQE9ULna93"},{"type":"text","value":"\nReference years: from 1975 to 2020, 5 years interval","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MFOuEwDq7U"},{"type":"break","key":"nhtGTfJzGD"},{"type":"text","value":"\nResolution: 1km","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l2dmdD8MqW"},{"type":"break","key":"GATDqggrOW"},{"type":"text","value":"\nCoord. system: Mollweide","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"prLMaZbwUS"},{"type":"break","key":"Ys3kjo0woo"},{"type":"text","value":"\nComplete information about GHSL open data are available at:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QgiS8q73wQ"},{"type":"break","key":"XAcbzTOIrJ"},{"type":"text","value":"\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZwL8NHueQb"},{"type":"link","url":"https://ghsl.jrc.ec.europa.eu/documents/GHSL_Data_Package_2022.pdf?t=1655995832","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​ghsl​.jrc​.ec​.europa​.eu​/documents​/GHSL​_Data​_Package​_2022​.pdf​?t​=​1655995832","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"US6GD7uGRQ"}],"urlSource":"https://ghsl.jrc.ec.europa.eu/documents/GHSL_Data_Package_2022.pdf?t=1655995832","key":"kgOXTiHuZa"},{"type":"text","value":"\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JikFmMmeKH"},{"type":"break","key":"jki6sBe8KI"},{"type":"text","value":"\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O339Zpz196"},{"type":"break","key":"HzCFZVhgpZ"}],"key":"boYlBV92Zc"}],"visibility":"show","key":"UrmshzQG2t"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.033327,"end_time":"2023-03-22T12:55:32.017728","exception":false,"start_time":"2023-03-22T12:55:31.984401","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","children":[],"key":"uwiOfqM3YK"},{"type":"text","value":"Parameters by definition of GHSL settlement model L1 and L2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zY6hx9RL9T"},{"type":"strong","children":[],"key":"gnGfNtxbij"}],"identifier":"parameters-by-definition-of-ghsl-settlement-model-l1-and-l2","label":"Parameters by definition of GHSL settlement model L1 and L2","html_id":"parameters-by-definition-of-ghsl-settlement-model-l1-and-l2","implicit":true,"key":"YmlHrf8gsa"},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Threshold for total population per square kilometer : HDC_Pdens / MDC_Pdens","key":"dhcwEaxBsf"}],"key":"viObmQTA92"}],"key":"hhvJFnhRZE"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Threshold for population per cluster : HDC_Pmin / MDC_Pmin","key":"iKMEHR8OfB"}],"key":"X2OU7dPECj"}],"key":"rzumkQqu3e"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Threshold for % of built-up area : HDC_Bdens","key":"Harzq1XQe0"}],"key":"ZLqccBfObI"}],"key":"TYjPOgoj3D"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Cluster connectivity : HDC_Tcon / MDC_Tcon","key":"KRl0W63Rbl"}],"key":"xeStRL9aAV"}],"key":"FuqctkLoIb"}],"key":"hfqt97tKfN"}],"visibility":"show","key":"bAAoawl6nH"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.030457,"end_time":"2023-03-22T12:55:32.082334","exception":false,"start_time":"2023-03-22T12:55:32.051877","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","children":[],"key":"tWa9RnqjgV"},{"type":"text","value":"Constants : Pdens, Bdens, Pmin, Tcon","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"avF2rAtXuc"},{"type":"strong","children":[],"key":"mTeiPeFQpR"}],"identifier":"constants-pdens-bdens-pmin-tcon","label":"Constants : Pdens, Bdens, Pmin, Tcon","html_id":"constants-pdens-bdens-pmin-tcon","implicit":true,"key":"k1atddXnLb"}],"visibility":"show","key":"OPqslbpI62"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:32.145592Z","iopub.status.busy":"2023-03-22T12:55:32.145216Z","iopub.status.idle":"2023-03-22T12:55:32.154638Z","shell.execute_reply":"2023-03-22T12:55:32.152323Z"},"papermill":{"duration":0.046443,"end_time":"2023-03-22T12:55:32.159260","exception":false,"start_time":"2023-03-22T12:55:32.112817","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# local population density (HDC: 1500 people/km2, MDC: 300 people/km2)\nHDC_Pdens=1500\nMDC_Pdens =300\n\n# built-up area share > then\nHDC_Bdens=500000 # (share of built-up area/km2: 0.5 => 500000 m2/km2)\n\n# cluster populatin > then   (HDC: 50000 people, MDC: 5000 people)\nHDC_Pmin=50000\nMDC_Pmin=5000\n\n# connectivity clusters\n# Tcon=1 for 4-connectivity clusters, Tcon=2 for 8-connectivity clusters\nHDC_Tcon=1 \nMDC_Tcon=2 \n\n# gap filling (<15km2)\nHDC_GAPfill=15","visibility":"show","key":"CDQwPfYdKs"},{"type":"output","id":"zqPxDLWtgzySxgL9aArqv","data":[],"visibility":"show","key":"ng9xfCUm3C"}],"visibility":"show","key":"TPcsCN0A1l"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.039058,"end_time":"2023-03-22T12:55:32.229983","exception":false,"start_time":"2023-03-22T12:55:32.190925","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","children":[],"key":"No6FdvybBq"},{"type":"text","value":"Load libraries:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LkCPxPSWA1"},{"type":"strong","children":[],"key":"hmLTGscaYY"}],"identifier":"load-libraries","label":"Load libraries:","html_id":"load-libraries","implicit":true,"key":"Jze4C0EbtZ"}],"visibility":"show","key":"nNh6zxf1ZR"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:32.297199Z","iopub.status.busy":"2023-03-22T12:55:32.296749Z","iopub.status.idle":"2023-03-22T12:55:36.688391Z","shell.execute_reply":"2023-03-22T12:55:36.686641Z"},"papermill":{"duration":4.43459,"end_time":"2023-03-22T12:55:36.697875","exception":false,"start_time":"2023-03-22T12:55:32.263285","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from xcube.core.store import new_data_store\n\nimport os\nfrom glob import glob\nfrom pathlib import Path\n\nimport numpy as np\nimport pandas as pd\nimport geopandas as gpd\nfrom shapely.geometry import shape, box\n\nimport xarray as xr\nimport rioxarray as rxr\n\nimport rasterio\nimport rasterio.features\nfrom rasterio.features import shapes\n\nfrom skimage import measure, morphology\nfrom skimage.morphology import square\nimport scipy\n\nimport ipywidgets as widgets\nimport matplotlib.pyplot as plt\n\nimport folium\nfrom folium import plugins\n","visibility":"show","key":"NpgAgkI5gi"},{"type":"output","id":"RjGKMKJogevMwHBGiWu4G","data":[],"visibility":"show","key":"fI3W7oGD7N"}],"visibility":"show","key":"md5mohIN9F"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.031684,"end_time":"2023-03-22T12:55:36.764368","exception":false,"start_time":"2023-03-22T12:55:36.732684","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","children":[],"key":"ZNgi2GUhxs"},{"type":"text","value":"Select reference year and area of interest: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ohw5AwRpTc"},{"type":"strong","children":[],"key":"E8beiFCKTU"}],"identifier":"select-reference-year-and-area-of-interest","label":"Select reference year and area of interest: ","html_id":"select-reference-year-and-area-of-interest","implicit":true,"key":"W1kjV97vrK"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Before starts, the reference year and the area of interest needs to be defined.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"SItUmAeUdA"}],"key":"jwt1yhnPlb"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","children":[],"key":"F3fsg7iQsG"},{"type":"text","value":"Reference year ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Q743h3yjBS"},{"type":"strong","children":[],"key":"qas6DdcU4Y"}],"identifier":"reference-year","label":"Reference year ","html_id":"reference-year","implicit":true,"key":"cVxKeKDv9w"}],"visibility":"show","key":"fAG4BembP0"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:36.842726Z","iopub.status.busy":"2023-03-22T12:55:36.833738Z","iopub.status.idle":"2023-03-22T12:55:36.850692Z","shell.execute_reply":"2023-03-22T12:55:36.848816Z"},"papermill":{"duration":0.056657,"end_time":"2023-03-22T12:55:36.853704","exception":false,"start_time":"2023-03-22T12:55:36.797047","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select reference year:\n# from 1975 to 2020, 5 years interval:\n# valid values are: 1975, 1980, 1985, 1990, 1995, 2000, 2005, 2010, 2015, 2020\n\nREFyear=2020\n","visibility":"show","key":"qoaqB0bL1t"},{"type":"output","id":"9hBFbGb8bE1vnN8rqwzdN","data":[],"visibility":"show","key":"E4TAEdyovn"}],"visibility":"show","key":"fL22S1Ett0"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.043468,"end_time":"2023-03-22T12:55:36.937837","exception":false,"start_time":"2023-03-22T12:55:36.894369","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","children":[],"key":"x5ZmzpSYUz"},{"type":"text","value":"Area of interest ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UPkYURnfre"},{"type":"strong","children":[],"key":"kiurtmQVW2"}],"identifier":"area-of-interest","label":"Area of interest ","html_id":"area-of-interest","implicit":true,"key":"T7QvkTp8yZ"}],"visibility":"show","key":"kXxYKHiFFn"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:37.062315Z","iopub.status.busy":"2023-03-22T12:55:37.061930Z","iopub.status.idle":"2023-03-22T12:55:37.094755Z","shell.execute_reply":"2023-03-22T12:55:37.088127Z"},"papermill":{"duration":0.111848,"end_time":"2023-03-22T12:55:37.097467","exception":false,"start_time":"2023-03-22T12:55:36.985619","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select AOI by lat/lon coordinates -  example for area of Poland, Czechia and Slovakia:\nx1 = 10  # degree (E-W)\ny1 = 47 # degree (N-S)\nx2 = 25  # degree (E-W)\ny2 = 55 # degree (N-S)\n\naoi_centre = [(y2+y1)/2,(x2+x1)/2]\nprint(aoi_centre)\n\nbbox = x1, y1, x2, y2\nprint(bbox)","visibility":"show","key":"PtYbz6DOLq"},{"type":"output","id":"xuPI7JnoaM4IGP7YZtyP0","data":[{"name":"stdout","output_type":"stream","text":"[51.0, 17.5]\n(10, 47, 25, 55)\n"}],"visibility":"show","key":"hpC66egJca"}],"visibility":"show","key":"DlSgF2GHTU"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:37.166019Z","iopub.status.busy":"2023-03-22T12:55:37.165649Z","iopub.status.idle":"2023-03-22T12:55:37.219520Z","shell.execute_reply":"2023-03-22T12:55:37.217681Z"},"papermill":{"duration":0.089078,"end_time":"2023-03-22T12:55:37.222723","exception":false,"start_time":"2023-03-22T12:55:37.133645","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"geom = box(*bbox)\nAOI = gpd.GeoDataFrame({\"id\":1,\"geometry\":[geom]})\nAOI.set_crs(epsg=4326, inplace=True)  # WGS84\nAOI54009 = AOI.to_crs(crs='ESRI:54009')","visibility":"show","key":"LEX1NAvNrn"},{"type":"output","id":"KDBkNQ3-xT7YW-KCYDi6h","data":[],"visibility":"show","key":"ZxWKtMSol5"}],"visibility":"show","key":"P5JdxMpt4j"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:37.325684Z","iopub.status.busy":"2023-03-22T12:55:37.324981Z","iopub.status.idle":"2023-03-22T12:55:40.769187Z","shell.execute_reply":"2023-03-22T12:55:40.766977Z"},"papermill":{"duration":3.507601,"end_time":"2023-03-22T12:55:40.777786","exception":false,"start_time":"2023-03-22T12:55:37.270185","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from branca.element import Figure\nfig = Figure(width=600, height=600)\n\nm = folium.Map(aoi_centre, zoom_start=5, tiles='cartodbpositron')  # ,width=500, height=500\nlat_interval = 1\nlon_interval = 1\n\n# parallels:\nfor lat in range(-90, 91, lat_interval):\n     folium.PolyLine([[lat, -180],[lat, 180]], weight=0.5).add_to(m)\n# meridianss:\nfor lon in range(-180, 181, lon_interval):\n    folium.PolyLine([[-90, lon],[90, lon]], weight=0.5).add_to(m)\n\nAOI54009.explore(m=m,style_kwds=dict(color='blue',fillColor='None', opacity=0.7))\nfig.add_child(m)\nm","visibility":"show","key":"u6PX7dk38t"},{"type":"output","id":"WNHVvDMrLSAx5y25Iqr8z","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"b38f3bb1aef28126004ef5840903df07","path":"/notebooks_test/build/b38f3bb1aef28126004ef5840903df07.html"},"text/plain":{"content":"<folium.folium.Map at 0x7f7e707d9910>","content_type":"text/plain"}}}],"visibility":"show","key":"YfZFshMIDV"}],"visibility":"show","key":"k3xzEafOw5"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.039754,"end_time":"2023-03-22T12:55:40.859957","exception":false,"start_time":"2023-03-22T12:55:40.820203","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","children":[],"key":"GYvPR7UFhE"},{"type":"text","value":"Input data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uPluGElTsD"},{"type":"strong","children":[],"key":"EAZioFEWOa"}],"identifier":"input-data","label":"Input data","html_id":"input-data","implicit":true,"key":"zvLeTON6Kb"}],"visibility":"show","key":"z4R8KVnSL1"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.039319,"end_time":"2023-03-22T12:55:40.935282","exception":false,"start_time":"2023-03-22T12:55:40.895963","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Open GHS built-up surface","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ptgUAu6yzm"}],"identifier":"open-ghs-built-up-surface","label":"Open GHS built-up surface","html_id":"open-ghs-built-up-surface","implicit":true,"key":"MEZbUESFZs"}],"visibility":"show","key":"sUrfLpt1tB"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:41.024334Z","iopub.status.busy":"2023-03-22T12:55:41.022822Z","iopub.status.idle":"2023-03-22T12:55:41.402322Z","shell.execute_reply":"2023-03-22T12:55:41.400107Z"},"papermill":{"duration":0.430709,"end_time":"2023-03-22T12:55:41.406682","exception":false,"start_time":"2023-03-22T12:55:40.975973","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"BTU_data_store = new_data_store(\"s3\", root=\"xcube-dcfs/GHSL/GHS-BUILT-S/\",\n                            storage_options=dict(anon=True) # anon=True - anonymous access (default False)\n                           )","visibility":"show","key":"gVn1wAm11n"},{"type":"output","id":"Z9zQWJ9HT2CRuLYXNJQqe","data":[],"visibility":"show","key":"Q1E4DAR0nm"}],"visibility":"show","key":"fxIh45VHeB"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:41.488617Z","iopub.status.busy":"2023-03-22T12:55:41.487123Z","iopub.status.idle":"2023-03-22T12:55:41.838307Z","shell.execute_reply":"2023-03-22T12:55:41.837159Z"},"papermill":{"duration":0.397406,"end_time":"2023-03-22T12:55:41.844936","exception":false,"start_time":"2023-03-22T12:55:41.447530","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"BTU_data_store_info = list(BTU_data_store.get_data_ids())\nBTU_data_store_info","visibility":"show","key":"pAipdde010"},{"type":"output","id":"LTbzIn8sR2__rdZQ7606g","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"['GHS_BUILT_S_E1975_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'GHS_BUILT_S_E1980_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'GHS_BUILT_S_E1985_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'GHS_BUILT_S_E1990_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'GHS_BUILT_S_E1995_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'GHS_BUILT_S_E2000_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'GHS_BUILT_S_E2005_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'GHS_BUILT_S_E2010_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'GHS_BUILT_S_E2015_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'GHS_BUILT_S_E2020_GLOBE_R2022A_54009_1000_V1_0.tif']","content_type":"text/plain"}}}],"visibility":"show","key":"yA3Uv5jdKC"}],"visibility":"show","key":"sWREObW4Rx"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:41.930912Z","iopub.status.busy":"2023-03-22T12:55:41.929548Z","iopub.status.idle":"2023-03-22T12:55:41.941520Z","shell.execute_reply":"2023-03-22T12:55:41.939541Z"},"papermill":{"duration":0.060745,"end_time":"2023-03-22T12:55:41.944367","exception":false,"start_time":"2023-03-22T12:55:41.883622","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select built-up data for Reference year\nBTU_REFyear= '\\n'.join(s for s in BTU_data_store_info if str(REFyear) in s)\n# BTU_REFyear","visibility":"show","key":"ufgfOTn2kJ"},{"type":"output","id":"q1EyLj18DzRG7Tr3oQi7g","data":[],"visibility":"show","key":"bXmlQGlImB"}],"visibility":"show","key":"s2jDYLBzSB"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:42.044858Z","iopub.status.busy":"2023-03-22T12:55:42.044377Z","iopub.status.idle":"2023-03-22T12:55:42.701981Z","shell.execute_reply":"2023-03-22T12:55:42.699589Z"},"papermill":{"duration":0.706357,"end_time":"2023-03-22T12:55:42.706102","exception":false,"start_time":"2023-03-22T12:55:41.999745","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Info about built-up data for Reference year\nBTU_data_store.describe_data(BTU_REFyear).to_dict()","visibility":"show","key":"eHchkP4R2w"},{"type":"output","id":"I2qVEYpymJXGbU3YIxYHr","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"{'data_id': 'GHS_BUILT_S_E2020_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'data_type': 'mldataset',\n 'bbox': [-18041000.0, -9000000.0, 18041000.0, 9000000.0],\n 'time_range': [None, None],\n 'dims': {'x': 36082, 'y': 18000},\n 'spatial_res': 1000.0,\n 'coords': {'x': {'name': 'x', 'dtype': 'float64', 'dims': ['x']},\n  'y': {'name': 'y', 'dtype': 'float64', 'dims': ['y']},\n  'spatial_ref': {'name': 'spatial_ref',\n   'dtype': 'int64',\n   'dims': [],\n   'attrs': {'crs_wkt': 'PROJCS[\"World_Mollweide\",GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Mollweide\"],PARAMETER[\"central_meridian\",0],PARAMETER[\"false_easting\",0],PARAMETER[\"false_northing\",0],UNIT[\"metre\",1,AUTHORITY[\"EPSG\",\"9001\"]],AXIS[\"Easting\",EAST],AXIS[\"Northing\",NORTH]]',\n    'spatial_ref': 'PROJCS[\"World_Mollweide\",GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Mollweide\"],PARAMETER[\"central_meridian\",0],PARAMETER[\"false_easting\",0],PARAMETER[\"false_northing\",0],UNIT[\"metre\",1,AUTHORITY[\"EPSG\",\"9001\"]],AXIS[\"Easting\",EAST],AXIS[\"Northing\",NORTH]]',\n    'GeoTransform': '-18041000.0 1000.0 0.0 9000000.0 0.0 -1000.0'}}},\n 'data_vars': {'band_1': {'name': 'band_1',\n   'dtype': 'uint32',\n   'dims': ['y', 'x'],\n   'chunks': [512, 512],\n   'attrs': {'AREA_OR_POINT': 'Area',\n    '_FillValue': 4294967295,\n    'scale_factor': 1.0,\n    'add_offset': 0.0,\n    'grid_mapping': 'spatial_ref'}}},\n 'attrs': {'source': 's3://xcube-dcfs/GHSL/GHS-BUILT-S/GHS_BUILT_S_E2020_GLOBE_R2022A_54009_1000_V1_0.tif'},\n 'num_levels': 6}","content_type":"text/plain"}}}],"visibility":"show","key":"RI2t6ZFqC9"}],"visibility":"show","key":"c9FdzQodSC"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:42.815018Z","iopub.status.busy":"2023-03-22T12:55:42.814392Z","iopub.status.idle":"2023-03-22T12:55:42.823688Z","shell.execute_reply":"2023-03-22T12:55:42.821704Z"},"papermill":{"duration":0.068853,"end_time":"2023-03-22T12:55:42.827823","exception":false,"start_time":"2023-03-22T12:55:42.758970","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# # Info about population data for Reference year\n# print(BTU_data_store.open_data(BTU_REFyear).num_levels, '\\n')\n# print(BTU_data_store.open_data(BTU_REFyear).datasets, '\\n')\n# BTU_data_store.open_data(BTU_REFyear).grid_mapping","visibility":"show","key":"QBx0VqlngD"},{"type":"output","id":"yAsNd5Fo2HgBdmkntp2L5","data":[],"visibility":"show","key":"ETr7Ghcrg9"}],"visibility":"show","key":"PkeYRokw8x"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:42.915121Z","iopub.status.busy":"2023-03-22T12:55:42.914661Z","iopub.status.idle":"2023-03-22T12:55:48.043649Z","shell.execute_reply":"2023-03-22T12:55:48.041665Z"},"papermill":{"duration":5.180159,"end_time":"2023-03-22T12:55:48.052237","exception":false,"start_time":"2023-03-22T12:55:42.872078","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"level = 0   # this is the highest resolution, which corresponds to 1km\n\n# Build-up dataset for selected Reference year - clipped by AOI\nBTU_ds_0 = BTU_data_store.open_data(BTU_REFyear).get_dataset(level).rio.clip(AOI54009.geometry, AOI54009.crs)\nBTU_ds_0 = BTU_ds_0.rename({\"band_1\": \"built-up\"})\n#BTU_ds_0","visibility":"show","key":"XZvU4nk7NF"},{"type":"output","id":"e6eGHq8ubJMKOPNLc5anL","data":[],"visibility":"show","key":"j6tD5xIg9o"}],"visibility":"show","key":"BnTBkidg0A"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:48.207328Z","iopub.status.busy":"2023-03-22T12:55:48.206881Z","iopub.status.idle":"2023-03-22T12:55:48.217138Z","shell.execute_reply":"2023-03-22T12:55:48.213869Z"},"papermill":{"duration":0.085931,"end_time":"2023-03-22T12:55:48.219856","exception":false,"start_time":"2023-03-22T12:55:48.133925","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# # Info AOI coordinates in the world projection Mollweide (ESRI:54009)\n# print(BTU_ds_0.x.min().values, BTU_ds_0.x.max().values)\n# print(BTU_ds_0.y.min().values, BTU_ds_0.y.max().values)","visibility":"show","key":"umfj98yMUz"},{"type":"output","id":"QuUTXN6Q38IPibCrMtuiM","data":[],"visibility":"show","key":"hx0AhS2JGe"}],"visibility":"show","key":"uR5DbJ9vZO"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.040653,"end_time":"2023-03-22T12:55:48.299676","exception":false,"start_time":"2023-03-22T12:55:48.259023","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Open GHS population grid","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZixsRjMeAZ"}],"identifier":"open-ghs-population-grid","label":"Open GHS population grid","html_id":"open-ghs-population-grid","implicit":true,"key":"UMkYkOPViW"}],"visibility":"show","key":"npWcvKhuNd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:48.401675Z","iopub.status.busy":"2023-03-22T12:55:48.400994Z","iopub.status.idle":"2023-03-22T12:55:48.419572Z","shell.execute_reply":"2023-03-22T12:55:48.417635Z"},"papermill":{"duration":0.062324,"end_time":"2023-03-22T12:55:48.424037","exception":false,"start_time":"2023-03-22T12:55:48.361713","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"POP_data_store = new_data_store(\"s3\", \n                            root=\"xcube-dcfs/GHSL/GHS-POP/\",\n                            storage_options=dict(anon=True)\n                           )","visibility":"show","key":"YmsjlSu4TM"},{"type":"output","id":"B2CKQHUbunJKoc3yLkfxP","data":[],"visibility":"show","key":"mZJEfrI0OE"}],"visibility":"show","key":"KsrdwEpOcB"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.052493,"end_time":"2023-03-22T12:55:48.527327","exception":false,"start_time":"2023-03-22T12:55:48.474834","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"OP_data_store info:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BcgnYB2v0i"}],"key":"irHUulgHx6"}],"visibility":"show","key":"nadgeQB1Td"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:48.634194Z","iopub.status.busy":"2023-03-22T12:55:48.633373Z","iopub.status.idle":"2023-03-22T12:55:48.772725Z","shell.execute_reply":"2023-03-22T12:55:48.770776Z"},"papermill":{"duration":0.192847,"end_time":"2023-03-22T12:55:48.776150","exception":false,"start_time":"2023-03-22T12:55:48.583303","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"POP_data_store_info=list(POP_data_store.get_data_ids())\nPOP_data_store_info","visibility":"show","key":"aLPN4JprTJ"},{"type":"output","id":"HdaLvEe_ty_6RNxF_E6di","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"['GHS_POP_E1975_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'GHS_POP_E1980_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'GHS_POP_E1985_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'GHS_POP_E1990_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'GHS_POP_E1995_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'GHS_POP_E2000_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'GHS_POP_E2005_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'GHS_POP_E2010_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'GHS_POP_E2015_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'GHS_POP_E2020_GLOBE_R2022A_54009_1000_V1_0.tif']","content_type":"text/plain"}}}],"visibility":"show","key":"H1iJFHZtOY"}],"visibility":"show","key":"WQgnW8hize"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:48.891566Z","iopub.status.busy":"2023-03-22T12:55:48.890483Z","iopub.status.idle":"2023-03-22T12:55:48.898823Z","shell.execute_reply":"2023-03-22T12:55:48.896694Z"},"papermill":{"duration":0.074402,"end_time":"2023-03-22T12:55:48.903201","exception":false,"start_time":"2023-03-22T12:55:48.828799","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select population data for Reference year\nPOP_REFyear= '\\n'.join(s for s in POP_data_store_info if str(REFyear) in s)\n#POP_REFyear","visibility":"show","key":"Hltg8i8HJb"},{"type":"output","id":"n4HRnPB1Bmtg3MDkXlcIY","data":[],"visibility":"show","key":"PWJF3mcBiw"}],"visibility":"show","key":"EIQUg6cd41"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:49.008900Z","iopub.status.busy":"2023-03-22T12:55:49.006617Z","iopub.status.idle":"2023-03-22T12:55:49.818464Z","shell.execute_reply":"2023-03-22T12:55:49.816978Z"},"papermill":{"duration":0.870224,"end_time":"2023-03-22T12:55:49.822565","exception":false,"start_time":"2023-03-22T12:55:48.952341","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Info about built-up data for Reference year\nPOP_data_store.describe_data(POP_REFyear).to_dict()","visibility":"show","key":"CFLBp4nwE7"},{"type":"output","id":"XCgbqjxga7SsaBmzFnoNe","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/plain":{"content":"{'data_id': 'GHS_POP_E2020_GLOBE_R2022A_54009_1000_V1_0.tif',\n 'data_type': 'mldataset',\n 'bbox': [-18041000.0, -9000000.0, 18041000.0, 9000000.0],\n 'time_range': [None, None],\n 'dims': {'x': 36082, 'y': 18000},\n 'spatial_res': 1000.0,\n 'coords': {'x': {'name': 'x', 'dtype': 'float64', 'dims': ['x']},\n  'y': {'name': 'y', 'dtype': 'float64', 'dims': ['y']},\n  'spatial_ref': {'name': 'spatial_ref',\n   'dtype': 'int64',\n   'dims': [],\n   'attrs': {'crs_wkt': 'PROJCS[\"World_Mollweide\",GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Mollweide\"],PARAMETER[\"central_meridian\",0],PARAMETER[\"false_easting\",0],PARAMETER[\"false_northing\",0],UNIT[\"metre\",1,AUTHORITY[\"EPSG\",\"9001\"]],AXIS[\"Easting\",EAST],AXIS[\"Northing\",NORTH]]',\n    'spatial_ref': 'PROJCS[\"World_Mollweide\",GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Mollweide\"],PARAMETER[\"central_meridian\",0],PARAMETER[\"false_easting\",0],PARAMETER[\"false_northing\",0],UNIT[\"metre\",1,AUTHORITY[\"EPSG\",\"9001\"]],AXIS[\"Easting\",EAST],AXIS[\"Northing\",NORTH]]',\n    'GeoTransform': '-18041000.0 1000.0 0.0 9000000.0 0.0 -1000.0'}}},\n 'data_vars': {'band_1': {'name': 'band_1',\n   'dtype': 'float64',\n   'dims': ['y', 'x'],\n   'chunks': [512, 512],\n   'attrs': {'AREA_OR_POINT': 'Area',\n    'STATISTICS_COVARIANCES': 330985.3282731281,\n    'STATISTICS_MAXIMUM': 615756.8270821,\n    'STATISTICS_MEAN': 56.450798856297,\n    'STATISTICS_MEDIAN': 0.0,\n    'STATISTICS_MINIMUM': 0,\n    'STATISTICS_SKIPFACTORX': 1,\n    'STATISTICS_SKIPFACTORY': 1,\n    'STATISTICS_STDDEV': 575.31324361006,\n    'STATISTICS_VALID_PERCENT': 21.26,\n    '_FillValue': -200.0,\n    'scale_factor': 1.0,\n    'add_offset': 0.0,\n    'grid_mapping': 'spatial_ref'}}},\n 'attrs': {'source': 's3://xcube-dcfs/GHSL/GHS-POP/GHS_POP_E2020_GLOBE_R2022A_54009_1000_V1_0.tif'},\n 'num_levels': 6}","content_type":"text/plain"}}}],"visibility":"show","key":"ehmrWMw6AE"}],"visibility":"show","key":"ecmr3hDhiz"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:49.941829Z","iopub.status.busy":"2023-03-22T12:55:49.941401Z","iopub.status.idle":"2023-03-22T12:55:49.951250Z","shell.execute_reply":"2023-03-22T12:55:49.949817Z"},"papermill":{"duration":0.071908,"end_time":"2023-03-22T12:55:49.954826","exception":false,"start_time":"2023-03-22T12:55:49.882918","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# # Info about population data for Reference year\n# print(POP_data_store.open_data(POP_REFyear).num_levels, '\\n')\n# print(POP_data_store.open_data(POP_REFyear).datasets, '\\n')\n# POP_data_store.open_data(POP_REFyear).grid_mapping","visibility":"show","key":"NJ0GMYBvkD"},{"type":"output","id":"jg_zOJEcKWcqySmPOqHpL","data":[],"visibility":"show","key":"dT2gHoeJ1F"}],"visibility":"show","key":"VA09PE0AT8"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:50.073185Z","iopub.status.busy":"2023-03-22T12:55:50.071855Z","iopub.status.idle":"2023-03-22T12:55:55.915339Z","shell.execute_reply":"2023-03-22T12:55:55.913585Z"},"papermill":{"duration":5.895095,"end_time":"2023-03-22T12:55:55.918364","exception":false,"start_time":"2023-03-22T12:55:50.023269","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"level = 0   # this is the highest resolution, which corresponds to 1km\n\n# Population dataset  for selected Reference year - clipped by AOI\nPOP_ds_0 = POP_data_store.open_data(POP_REFyear).get_dataset(level).rio.clip(AOI54009.geometry, AOI54009.crs)\nPOP_ds_0 = POP_ds_0.rename({\"band_1\": \"population_grid\"})\n#POP_ds_0","visibility":"show","key":"tEtbVaVWuk"},{"type":"output","id":"EutOfZagjtdbxGB0L1VLa","data":[],"visibility":"show","key":"rCWn8jtng9"}],"visibility":"show","key":"ckeRUGHqqK"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.058536,"end_time":"2023-03-22T12:55:56.026149","exception":false,"start_time":"2023-03-22T12:55:55.967613","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Dataset to DataArray","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"otEJuCk4OW"}],"identifier":"dataset-to-dataarray","label":"Dataset to DataArray","html_id":"dataset-to-dataarray","implicit":true,"key":"g4LJddEzfe"}],"visibility":"show","key":"OlGoJXAhGJ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:56.106534Z","iopub.status.busy":"2023-03-22T12:55:56.105623Z","iopub.status.idle":"2023-03-22T12:55:57.207857Z","shell.execute_reply":"2023-03-22T12:55:57.203517Z"},"papermill":{"duration":1.147389,"end_time":"2023-03-22T12:55:57.212179","exception":false,"start_time":"2023-03-22T12:55:56.064790","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"BTU_da=(BTU_ds_0['built-up']).squeeze()\nBTU_da = BTU_da.load()\nBTU_da=BTU_da.where(BTU_da != BTU_da.attrs['_FillValue']).fillna(0)\nBTU_da","visibility":"show","key":"ij658M2crc"},{"type":"output","id":"ZMZHgoGBABsQQRF5iAPOA","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=dark],\nbody[data-theme=dark],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1F1F1F;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 20px 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: none;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: '►';\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: '▼';\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: '(';\n}\n\n.xr-dim-list:after {\n  content: ')';\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: ',';\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;built-up&#x27; (y: 831, x: 1266)&gt;\narray([[   0.,    0.,    0., ...,    0.,    0.,    0.],\n       [   0.,    0.,    0., ...,    0.,    0.,    0.],\n       [1203.,    0.,    0., ...,    0.,    0.,    0.],\n       ...,\n       [   0.,    0.,    0., ...,    0.,    0.,    0.],\n       [   0.,    0.,    0., ...,    0.,    0.,    0.],\n       [   0.,    0.,    0., ...,    0.,    0.,    0.]])\nCoordinates:\n  * x            (x) float64 7.085e+05 7.095e+05 ... 1.972e+06 1.974e+06\n  * y            (y) float64 6.386e+06 6.386e+06 ... 5.558e+06 5.556e+06\n    spatial_ref  int64 0\nAttributes:\n    AREA_OR_POINT:  Area\n    scale_factor:   1.0\n    add_offset:     0.0\n    grid_mapping:   spatial_ref\n    _FillValue:     4294967295</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'built-up'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 831</li><li><span class='xr-has-index'>x</span>: 1266</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-36d7c00b-590d-482d-a6de-cf84fc86b559' class='xr-array-in' type='checkbox' checked><label for='section-36d7c00b-590d-482d-a6de-cf84fc86b559' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0</span></div><div class='xr-array-data'><pre>array([[   0.,    0.,    0., ...,    0.,    0.,    0.],\n       [   0.,    0.,    0., ...,    0.,    0.,    0.],\n       [1203.,    0.,    0., ...,    0.,    0.,    0.],\n       ...,\n       [   0.,    0.,    0., ...,    0.,    0.,    0.],\n       [   0.,    0.,    0., ...,    0.,    0.,    0.],\n       [   0.,    0.,    0., ...,    0.,    0.,    0.]])</pre></div></div></li><li class='xr-section-item'><input id='section-ca8bfbfa-ad41-4c99-a2bf-732121badef8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ca8bfbfa-ad41-4c99-a2bf-732121badef8' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>7.085e+05 7.095e+05 ... 1.974e+06</div><input id='attrs-61f0d1b2-0932-4483-b465-1ac0af7fe2a3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-61f0d1b2-0932-4483-b465-1ac0af7fe2a3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-077dc242-5234-4904-ba8d-42f852b72602' class='xr-var-data-in' type='checkbox'><label for='data-077dc242-5234-4904-ba8d-42f852b72602' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>x coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd></dl></div><div class='xr-var-data'><pre>array([ 708500.,  709500.,  710500., ..., 1971500., 1972500., 1973500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>6.386e+06 6.386e+06 ... 5.556e+06</div><input id='attrs-3795a79e-8dfb-4adc-93a5-b5e399ea8d8a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3795a79e-8dfb-4adc-93a5-b5e399ea8d8a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fc2adafb-aa5c-467c-bb0b-fb76a82beac5' class='xr-var-data-in' type='checkbox'><label for='data-fc2adafb-aa5c-467c-bb0b-fb76a82beac5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>y coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd></dl></div><div class='xr-var-data'><pre>array([6386500., 6385500., 6384500., ..., 5558500., 5557500., 5556500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-64f5b56e-46da-4690-bf4b-45186c319dcc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-64f5b56e-46da-4690-bf4b-45186c319dcc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-89ae460e-1932-482e-b2d4-c317523fe8d8' class='xr-var-data-in' type='checkbox'><label for='data-89ae460e-1932-482e-b2d4-c317523fe8d8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>PROJCS[&quot;World_Mollweide&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;Degree&quot;,0.0174532925199433]],PROJECTION[&quot;Mollweide&quot;],PARAMETER[&quot;central_meridian&quot;,0],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH]]</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS[&quot;World_Mollweide&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;Degree&quot;,0.0174532925199433]],PROJECTION[&quot;Mollweide&quot;],PARAMETER[&quot;central_meridian&quot;,0],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH]]</dd><dt><span>GeoTransform :</span></dt><dd>708000.0 1000.0 0.0 6387000.0 0.0 -1000.0</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1a1006e2-b0a8-4681-bf46-cc18a2ebc1f5' class='xr-section-summary-in' type='checkbox'  ><label for='section-1a1006e2-b0a8-4681-bf46-cc18a2ebc1f5' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-eadf05a0-0885-4468-a7a5-cb11334d078b' class='xr-index-data-in' type='checkbox'/><label for='index-eadf05a0-0885-4468-a7a5-cb11334d078b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([ 708500.0,  709500.0,  710500.0,  711500.0,  712500.0,  713500.0,\n               714500.0,  715500.0,  716500.0,  717500.0,\n              ...\n              1964500.0, 1965500.0, 1966500.0, 1967500.0, 1968500.0, 1969500.0,\n              1970500.0, 1971500.0, 1972500.0, 1973500.0],\n             dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=1266))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b70dc3c4-f47c-4b3e-8a6e-5371555b60f6' class='xr-index-data-in' type='checkbox'/><label for='index-b70dc3c4-f47c-4b3e-8a6e-5371555b60f6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([6386500.0, 6385500.0, 6384500.0, 6383500.0, 6382500.0, 6381500.0,\n              6380500.0, 6379500.0, 6378500.0, 6377500.0,\n              ...\n              5565500.0, 5564500.0, 5563500.0, 5562500.0, 5561500.0, 5560500.0,\n              5559500.0, 5558500.0, 5557500.0, 5556500.0],\n             dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=831))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f7bbca14-2b7a-41a0-b82c-66c91b6b56e3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f7bbca14-2b7a-41a0-b82c-66c91b6b56e3' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>scale_factor :</span></dt><dd>1.0</dd><dt><span>add_offset :</span></dt><dd>0.0</dd><dt><span>grid_mapping :</span></dt><dd>spatial_ref</dd><dt><span>_FillValue :</span></dt><dd>4294967295</dd></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray 'built-up' (y: 831, x: 1266)>\narray([[   0.,    0.,    0., ...,    0.,    0.,    0.],\n       [   0.,    0.,    0., ...,    0.,    0.,    0.],\n       [1203.,    0.,    0., ...,    0.,    0.,    0.],\n       ...,\n       [   0.,    0.,    0., ...,    0.,    0.,    0.],\n       [   0.,    0.,    0., ...,    0.,    0.,    0.],\n       [   0.,    0.,    0., ...,    0.,    0.,    0.]])\nCoordinates:\n  * x            (x) float64 7.085e+05 7.095e+05 ... 1.972e+06 1.974e+06\n  * y            (y) float64 6.386e+06 6.386e+06 ... 5.558e+06 5.556e+06\n    spatial_ref  int64 0\nAttributes:\n    AREA_OR_POINT:  Area\n    scale_factor:   1.0\n    add_offset:     0.0\n    grid_mapping:   spatial_ref\n    _FillValue:     4294967295","content_type":"text/plain"}}}],"visibility":"show","key":"H0GbdrgQzD"}],"visibility":"show","key":"pG24VFpsdI"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:57.355816Z","iopub.status.busy":"2023-03-22T12:55:57.355273Z","iopub.status.idle":"2023-03-22T12:55:59.010719Z","shell.execute_reply":"2023-03-22T12:55:58.997384Z"},"papermill":{"duration":1.752247,"end_time":"2023-03-22T12:55:59.019065","exception":false,"start_time":"2023-03-22T12:55:57.266818","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"POP_da=(POP_ds_0['population_grid']).squeeze()\nPOP_da = POP_da.load()\nPOP_da=POP_da.where(POP_da != POP_da.attrs['_FillValue']).fillna(0)\nPOP_da","visibility":"show","key":"InCUTibCzz"},{"type":"output","id":"5W1OBVEeqfanfiwz1Y-q0","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=dark],\nbody[data-theme=dark],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1F1F1F;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 20px 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: none;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: '►';\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: '▼';\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: '(';\n}\n\n.xr-dim-list:after {\n  content: ')';\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: ',';\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;population_grid&#x27; (y: 831, x: 1266)&gt;\narray([[0.        , 0.        , 0.        , ..., 0.        , 0.        ,\n        0.        ],\n       [0.        , 0.        , 0.        , ..., 0.        , 0.        ,\n        0.        ],\n       [5.30303578, 0.        , 0.        , ..., 0.        , 0.        ,\n        0.        ],\n       ...,\n       [0.        , 0.        , 0.        , ..., 0.        , 0.        ,\n        0.        ],\n       [0.        , 0.        , 0.        , ..., 0.        , 0.        ,\n        0.        ],\n       [0.        , 0.        , 0.        , ..., 0.        , 0.        ,\n        0.        ]])\nCoordinates:\n  * x            (x) float64 7.085e+05 7.095e+05 ... 1.972e+06 1.974e+06\n  * y            (y) float64 6.386e+06 6.386e+06 ... 5.558e+06 5.556e+06\n    spatial_ref  int64 0\nAttributes: (12/14)\n    AREA_OR_POINT:             Area\n    STATISTICS_COVARIANCES:    330985.3282731281\n    STATISTICS_MAXIMUM:        615756.8270821\n    STATISTICS_MEAN:           56.450798856297\n    STATISTICS_MEDIAN:         0.0\n    STATISTICS_MINIMUM:        0\n    ...                        ...\n    STATISTICS_STDDEV:         575.31324361006\n    STATISTICS_VALID_PERCENT:  21.26\n    scale_factor:              1.0\n    add_offset:                0.0\n    grid_mapping:              spatial_ref\n    _FillValue:                -200.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'population_grid'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 831</li><li><span class='xr-has-index'>x</span>: 1266</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-79b73e76-f488-4461-9039-e8ceae08709e' class='xr-array-in' type='checkbox' checked><label for='section-79b73e76-f488-4461-9039-e8ceae08709e' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0</span></div><div class='xr-array-data'><pre>array([[0.        , 0.        , 0.        , ..., 0.        , 0.        ,\n        0.        ],\n       [0.        , 0.        , 0.        , ..., 0.        , 0.        ,\n        0.        ],\n       [5.30303578, 0.        , 0.        , ..., 0.        , 0.        ,\n        0.        ],\n       ...,\n       [0.        , 0.        , 0.        , ..., 0.        , 0.        ,\n        0.        ],\n       [0.        , 0.        , 0.        , ..., 0.        , 0.        ,\n        0.        ],\n       [0.        , 0.        , 0.        , ..., 0.        , 0.        ,\n        0.        ]])</pre></div></div></li><li class='xr-section-item'><input id='section-f618e6af-001e-4ce1-bb33-7eb3c8b2c09e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f618e6af-001e-4ce1-bb33-7eb3c8b2c09e' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>7.085e+05 7.095e+05 ... 1.974e+06</div><input id='attrs-f605fc64-0a6a-4b8a-9fe2-994073fccc27' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f605fc64-0a6a-4b8a-9fe2-994073fccc27' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2666e3f4-1eef-485d-a520-eec571b10505' class='xr-var-data-in' type='checkbox'><label for='data-2666e3f4-1eef-485d-a520-eec571b10505' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>x coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd></dl></div><div class='xr-var-data'><pre>array([ 708500.,  709500.,  710500., ..., 1971500., 1972500., 1973500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>6.386e+06 6.386e+06 ... 5.556e+06</div><input id='attrs-5b3eca8c-76dc-454f-9f54-71ea0720d8a3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5b3eca8c-76dc-454f-9f54-71ea0720d8a3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-12843276-3bf4-4283-8296-f26e465bffad' class='xr-var-data-in' type='checkbox'><label for='data-12843276-3bf4-4283-8296-f26e465bffad' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>y coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd></dl></div><div class='xr-var-data'><pre>array([6386500., 6385500., 6384500., ..., 5558500., 5557500., 5556500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-bdeb094c-65de-44dc-bc6c-00eb3dc02c56' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bdeb094c-65de-44dc-bc6c-00eb3dc02c56' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c1ee8fda-deaa-4f20-a145-ef877cae0127' class='xr-var-data-in' type='checkbox'><label for='data-c1ee8fda-deaa-4f20-a145-ef877cae0127' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>PROJCS[&quot;World_Mollweide&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;Degree&quot;,0.0174532925199433]],PROJECTION[&quot;Mollweide&quot;],PARAMETER[&quot;central_meridian&quot;,0],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH]]</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS[&quot;World_Mollweide&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;Degree&quot;,0.0174532925199433]],PROJECTION[&quot;Mollweide&quot;],PARAMETER[&quot;central_meridian&quot;,0],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH]]</dd><dt><span>GeoTransform :</span></dt><dd>708000.0 1000.0 0.0 6387000.0 0.0 -1000.0</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3294ef7a-1855-4672-91d2-2b1f12576270' class='xr-section-summary-in' type='checkbox'  ><label for='section-3294ef7a-1855-4672-91d2-2b1f12576270' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c4622588-9968-48e0-b078-5aa5d1995275' class='xr-index-data-in' type='checkbox'/><label for='index-c4622588-9968-48e0-b078-5aa5d1995275' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([ 708500.0,  709500.0,  710500.0,  711500.0,  712500.0,  713500.0,\n               714500.0,  715500.0,  716500.0,  717500.0,\n              ...\n              1964500.0, 1965500.0, 1966500.0, 1967500.0, 1968500.0, 1969500.0,\n              1970500.0, 1971500.0, 1972500.0, 1973500.0],\n             dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=1266))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-23e114e2-2e38-4386-8467-3c4252555f28' class='xr-index-data-in' type='checkbox'/><label for='index-23e114e2-2e38-4386-8467-3c4252555f28' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([6386500.0, 6385500.0, 6384500.0, 6383500.0, 6382500.0, 6381500.0,\n              6380500.0, 6379500.0, 6378500.0, 6377500.0,\n              ...\n              5565500.0, 5564500.0, 5563500.0, 5562500.0, 5561500.0, 5560500.0,\n              5559500.0, 5558500.0, 5557500.0, 5556500.0],\n             dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=831))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d9b75835-9ef7-4e60-8ffc-bf9bcda0109b' class='xr-section-summary-in' type='checkbox'  ><label for='section-d9b75835-9ef7-4e60-8ffc-bf9bcda0109b' class='xr-section-summary' >Attributes: <span>(14)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>STATISTICS_COVARIANCES :</span></dt><dd>330985.3282731281</dd><dt><span>STATISTICS_MAXIMUM :</span></dt><dd>615756.8270821</dd><dt><span>STATISTICS_MEAN :</span></dt><dd>56.450798856297</dd><dt><span>STATISTICS_MEDIAN :</span></dt><dd>0.0</dd><dt><span>STATISTICS_MINIMUM :</span></dt><dd>0</dd><dt><span>STATISTICS_SKIPFACTORX :</span></dt><dd>1</dd><dt><span>STATISTICS_SKIPFACTORY :</span></dt><dd>1</dd><dt><span>STATISTICS_STDDEV :</span></dt><dd>575.31324361006</dd><dt><span>STATISTICS_VALID_PERCENT :</span></dt><dd>21.26</dd><dt><span>scale_factor :</span></dt><dd>1.0</dd><dt><span>add_offset :</span></dt><dd>0.0</dd><dt><span>grid_mapping :</span></dt><dd>spatial_ref</dd><dt><span>_FillValue :</span></dt><dd>-200.0</dd></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray 'population_grid' (y: 831, x: 1266)>\narray([[0.        , 0.        , 0.        , ..., 0.        , 0.        ,\n        0.        ],\n       [0.        , 0.        , 0.        , ..., 0.        , 0.        ,\n        0.        ],\n       [5.30303578, 0.        , 0.        , ..., 0.        , 0.        ,\n        0.        ],\n       ...,\n       [0.        , 0.        , 0.        , ..., 0.        , 0.        ,\n        0.        ],\n       [0.        , 0.        , 0.        , ..., 0.        , 0.        ,\n        0.        ],\n       [0.        , 0.        , 0.        , ..., 0.        , 0.        ,\n        0.        ]])\nCoordinates:\n  * x            (x) float64 7.085e+05 7.095e+05 ... 1.972e+06 1.974e+06\n  * y            (y) float64 6.386e+06 6.386e+06 ... 5.558e+06 5.556e+06\n    spatial_ref  int64 0\nAttributes: (12/14)\n    AREA_OR_POINT:             Area\n    STATISTICS_COVARIANCES:    330985.3282731281\n    STATISTICS_MAXIMUM:        615756.8270821\n    STATISTICS_MEAN:           56.450798856297\n    STATISTICS_MEDIAN:         0.0\n    STATISTICS_MINIMUM:        0\n    ...                        ...\n    STATISTICS_STDDEV:         575.31324361006\n    STATISTICS_VALID_PERCENT:  21.26\n    scale_factor:              1.0\n    add_offset:                0.0\n    grid_mapping:              spatial_ref\n    _FillValue:                -200.0","content_type":"text/plain"}}}],"visibility":"show","key":"pAz0aGFkfN"}],"visibility":"show","key":"TosPGUIuVm"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:59.169574Z","iopub.status.busy":"2023-03-22T12:55:59.169149Z","iopub.status.idle":"2023-03-22T12:55:59.179753Z","shell.execute_reply":"2023-03-22T12:55:59.177720Z"},"papermill":{"duration":0.086146,"end_time":"2023-03-22T12:55:59.183854","exception":false,"start_time":"2023-03-22T12:55:59.097708","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# # Info about  DataArray\n# print(type(POP_da),'\\n')\n# print(type(POP_da.data))\n# print(POP_da.name), print()\n# print(\"The shape of data is:\\n\", POP_da.shape,'\\n')\n# print(POP_da.coords), print()\n# print(\"the minimum raster value is:\\n\", np.nanmin(POP_da.values))\n# print(\"the maximum raster value is:\\n\", np.nanmax(POP_da.values),'\\n')\n# print('dim:',POP_da.dims,'\\n')\n# print('attributes/metadata:\\n',POP_da.attrs,'\\n')\n# print('----------------')\n# # View generate metadata associated with the raster file\n# # World Mollweide  ESRI:54009, \n# print(\"The crs of data is:\\n\", POP_da.rio.crs,'\\n')\n# print('transform:\\n',POP_da.rio.transform(),'\\n')\n# print(\"The spatial extent is:\\n\", POP_da.rio.bounds(),'\\n')\n# print(\"The nodatavalue of data is:\\n\", POP_da.rio.nodata,'\\n')\n# print(\"The spatial resolution of data is:\\n\", POP_da.rio.resolution(),'\\n')\n\n# print(BTU_da.data.min(), BTU_da.data.max())\n# print(POP_da.data.min(), POP_da.data.max().round(0))\n# POP_da.data","visibility":"show","key":"UuCb96ovyp"},{"type":"output","id":"T428n9dKZWlJliSaAVei8","data":[],"visibility":"show","key":"mtG0PwbP3h"}],"visibility":"show","key":"WVgaJpZKAH"},{"type":"block","kind":"notebook-code","data":{"papermill":{"duration":0.056326,"end_time":"2023-03-22T12:55:59.302356","exception":false,"start_time":"2023-03-22T12:55:59.246030","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"","visibility":"show","key":"qcsk1C4rHh"},{"type":"output","id":"XLck6fZAwtr7m_GRNgHC6","data":[],"visibility":"show","key":"k7fxnbckWO"}],"visibility":"show","key":"cCKkWCRAy9"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.066947,"end_time":"2023-03-22T12:55:59.421115","exception":false,"start_time":"2023-03-22T12:55:59.354168","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","children":[],"key":"r7SUR9Cjeu"},{"type":"text","value":"L1: Urban Centre (HDC) and Urban Cluster (MDC)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EHNS8BVZRV"},{"type":"strong","children":[],"key":"k9RGK7FowR"}],"identifier":"l1-urban-centre-hdc-and-urban-cluster-mdc","label":"L1: Urban Centre (HDC) and Urban Cluster (MDC)","html_id":"l1-urban-centre-hdc-and-urban-cluster-mdc","implicit":true,"key":"exaRMndA1D"}],"visibility":"show","key":"LWPR8gNtue"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.0568,"end_time":"2023-03-22T12:55:59.545815","exception":false,"start_time":"2023-03-22T12:55:59.489015","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"step1: built-up and population data - binary masks  by model definition","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SYru9aue2l"}],"identifier":"step1-built-up-and-population-data-binary-masks-by-model-definition","label":"step1: built-up and population data - binary masks  by model definition","html_id":"step1-built-up-and-population-data-binary-masks-by-model-definition","implicit":true,"key":"GbZBVHP544"}],"visibility":"show","key":"bWvNVjdBt1"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:59.676805Z","iopub.status.busy":"2023-03-22T12:55:59.674956Z","iopub.status.idle":"2023-03-22T12:55:59.753734Z","shell.execute_reply":"2023-03-22T12:55:59.750478Z"},"papermill":{"duration":0.1492,"end_time":"2023-03-22T12:55:59.757559","exception":false,"start_time":"2023-03-22T12:55:59.608359","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# HDC\n# built-up area\nHDC_BTU_mask = 1 * np.ones_like(BTU_da) * (BTU_da > HDC_Bdens).astype(np.int8)  # HDC_Bdens (share of built-up area/km2: 0.5 => 500000 m2/km2)\n# population\nHDC_POP_mask = 1 * np.ones_like(POP_da) * (POP_da > HDC_Pdens).astype(np.int8) # HDC_Pdens >=1500 inh/km2\nHDC_UC01_mask = HDC_BTU_mask + HDC_POP_mask\n\n# MDC\nMDC_POP_mask = 1 * np.ones_like(POP_da) * (POP_da > MDC_Pdens).astype(np.int8) # MDC_Pdens >=300  inh/km2","visibility":"show","key":"V1Rr5gBIY2"},{"type":"output","id":"8-z8BEdao1IMxaMIVomMz","data":[],"visibility":"show","key":"Ck4fAIIuFL"}],"visibility":"show","key":"sBRTOQLedF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:55:59.864977Z","iopub.status.busy":"2023-03-22T12:55:59.862881Z","iopub.status.idle":"2023-03-22T12:55:59.885016Z","shell.execute_reply":"2023-03-22T12:55:59.882581Z"},"papermill":{"duration":0.081899,"end_time":"2023-03-22T12:55:59.888438","exception":false,"start_time":"2023-03-22T12:55:59.806539","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# BINARY MASK:\nHDC_UC01_mask = 1 * np.ones_like(HDC_UC01_mask) * (HDC_UC01_mask> 0).astype(np.int8)\nMDC_UC01_mask = MDC_POP_mask","visibility":"show","key":"grQGtvkiY3"},{"type":"output","id":"ZUPZnsN_9Pbs1wws7gx6O","data":[],"visibility":"show","key":"Gvqdo8cxce"}],"visibility":"show","key":"tc7JwFdoIp"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.046709,"end_time":"2023-03-22T12:55:59.987477","exception":false,"start_time":"2023-03-22T12:55:59.940768","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"step2: cluster connectivity","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Svu7EybrEX"}],"identifier":"step2-cluster-connectivity","label":"step2: cluster connectivity","html_id":"step2-cluster-connectivity","implicit":true,"key":"oGqLlAUFMR"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"link","url":"https://scikit-image.org/docs/dev/api/skimage.measure.html#skimage.measure.label","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"https://​scikit​-image​.org​/docs​/dev​/api​/skimage​.measure​.html​#skimage​.measure​.label","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"OwbhY1pZC8"}],"urlSource":"https://scikit-image.org/docs/dev/api/skimage.measure.html#skimage.measure.label","key":"taHBsn3XxP"}],"key":"eF8HKzeHl4"}],"visibility":"show","key":"iaFRrL39PK"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:56:00.103360Z","iopub.status.busy":"2023-03-22T12:56:00.102344Z","iopub.status.idle":"2023-03-22T12:56:00.148141Z","shell.execute_reply":"2023-03-22T12:56:00.144082Z"},"papermill":{"duration":0.110379,"end_time":"2023-03-22T12:56:00.154346","exception":false,"start_time":"2023-03-22T12:56:00.043967","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# 4/8-connectivity regions:\n# HDC_Tcon=1 for 4-connectivity clusters\n# MDC_Tcon=2 for 8-connectivity clusters\n\nHDC_UC02_4conn = measure.label(HDC_UC01_mask, background=0, return_num=False, connectivity=HDC_Tcon)\n# print('HDC number of regions:', HDC_UC02_4conn.max())\n\nMDC_UC02_8conn = measure.label(MDC_UC01_mask, background=0, return_num=False, connectivity=MDC_Tcon)\n# print('MDC number of regions:', MDC_UC02_8conn.max())","visibility":"show","key":"TPfsYfTl7w"},{"type":"output","id":"AcTEY2d-Dvq9iRZRb1YhN","data":[],"visibility":"show","key":"cVfqSqlpDa"}],"visibility":"show","key":"vrQS0OsmQa"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.052199,"end_time":"2023-03-22T12:56:00.262171","exception":false,"start_time":"2023-03-22T12:56:00.209972","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"step3: total population in cluster","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jXqzf8zivP"}],"identifier":"step3-total-population-in-cluster","label":"step3: total population in cluster","html_id":"step3-total-population-in-cluster","implicit":true,"key":"xyOZHTlkEc"}],"visibility":"show","key":"itcixmgMan"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:56:00.374512Z","iopub.status.busy":"2023-03-22T12:56:00.373339Z","iopub.status.idle":"2023-03-22T12:56:17.796901Z","shell.execute_reply":"2023-03-22T12:56:17.794805Z"},"papermill":{"duration":17.482045,"end_time":"2023-03-22T12:56:17.800833","exception":false,"start_time":"2023-03-22T12:56:00.318788","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"HDC_UC03=np.zeros_like(HDC_POP_mask).astype('int')\n\nPOPregionIDsum=[]\nPOPregionSUM=[]\nfor regionID in range(1, HDC_UC02_4conn.max()):\n    POPregionID=((HDC_UC02_4conn == regionID).astype('int')) * POP_da.data    \n    # threshold for population in cluster > 50000\n    if POPregionID.sum() > HDC_Pmin:\n        POPregionSUM.append(int(round(POPregionID.sum())))\n        POPregionIDsum.append(regionID)\n        HDC_UC03=HDC_UC03+np.where(HDC_UC02_4conn == regionID, HDC_UC02_4conn, 0)","visibility":"show","key":"Q2oCwUSIAR"},{"type":"output","id":"citxlY6ZeP8etYef3Yi0s","data":[],"visibility":"show","key":"l4YgkLAeMm"}],"visibility":"show","key":"feCTYqXgBk"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:56:17.917230Z","iopub.status.busy":"2023-03-22T12:56:17.916862Z","iopub.status.idle":"2023-03-22T12:57:49.985950Z","shell.execute_reply":"2023-03-22T12:57:49.981851Z"},"papermill":{"duration":92.139676,"end_time":"2023-03-22T12:57:49.995230","exception":false,"start_time":"2023-03-22T12:56:17.855554","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"MDC_UC03=np.zeros_like(MDC_POP_mask).astype('int')\n\nPOPregionIDsum=[]\nPOPregionSUM=[]\nfor regionID in range(1, MDC_UC02_8conn.max()):\n    POPregionID=((MDC_UC02_8conn == regionID).astype('int')) * POP_da.data    \n    # threshold for population in cluster > 5000\n    if POPregionID.sum() > MDC_Pmin:\n        POPregionSUM.append(int(round(POPregionID.sum())))\n        POPregionIDsum.append(regionID)\n        MDC_UC03=MDC_UC03+np.where(MDC_UC02_8conn == regionID, MDC_UC02_8conn, 0)","visibility":"show","key":"fk25Yb70uR"},{"type":"output","id":"THOVQUmNSMR_Ujx-fZnx2","data":[],"visibility":"show","key":"j1UqMU3xnT"}],"visibility":"show","key":"M3ZPplnNxM"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.043796,"end_time":"2023-03-22T12:57:50.096123","exception":false,"start_time":"2023-03-22T12:57:50.052327","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"L1: Urban Center (HDC)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hzHLGieDs2"}],"identifier":"l1-urban-center-hdc","label":"L1: Urban Center (HDC)","html_id":"l1-urban-center-hdc","implicit":true,"key":"SOA395Tuai"}],"visibility":"show","key":"CBsCb1aFTD"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.059405,"end_time":"2023-03-22T12:57:50.203708","exception":false,"start_time":"2023-03-22T12:57:50.144303","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"step4: Urban Centre (HDC) - gaps filling < 15km2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zzhmhbsQIz"}],"identifier":"step4-urban-centre-hdc-gaps-filling-15km2","label":"step4: Urban Centre (HDC) - gaps filling < 15km2","html_id":"step4-urban-centre-hdc-gaps-filling-15km2","implicit":true,"key":"PyoQrI4W8O"}],"visibility":"show","key":"Ag1Sth6qN7"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.052089,"end_time":"2023-03-22T12:57:50.311378","exception":false,"start_time":"2023-03-22T12:57:50.259289","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"inverse raster / gaps","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AABueQUdtH"}],"key":"dsebw66Ss8"}],"visibility":"show","key":"hSSt7tvE0t"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:57:50.417483Z","iopub.status.busy":"2023-03-22T12:57:50.417011Z","iopub.status.idle":"2023-03-22T12:57:50.476675Z","shell.execute_reply":"2023-03-22T12:57:50.475064Z"},"papermill":{"duration":0.113971,"end_time":"2023-03-22T12:57:50.480086","exception":false,"start_time":"2023-03-22T12:57:50.366115","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"HDC_UC03_BIN=np.where(HDC_UC03 > 0, 1, 0)\nHDC_UC03_INV=np.where(HDC_UC03_BIN == 1, 0, 1)\n\nHDC_UC03_INV = measure.label(HDC_UC03_INV, background=0, connectivity=2) # 8-connectivity\n# number of holes\n# HDC_UC03_INV.max()","visibility":"show","key":"tSoap0ysrl"},{"type":"output","id":"i1IWit05pvRUUw1PNmDXi","data":[],"visibility":"show","key":"WDIPNRv31L"}],"visibility":"show","key":"wnTaAdfeji"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.047952,"end_time":"2023-03-22T12:57:50.582861","exception":false,"start_time":"2023-03-22T12:57:50.534909","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"gaps filling","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IQeEg3IuRB"}],"key":"AAQaDiMAFY"}],"visibility":"show","key":"EW2qe7hrX9"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:57:50.679730Z","iopub.status.busy":"2023-03-22T12:57:50.679216Z","iopub.status.idle":"2023-03-22T12:57:50.999769Z","shell.execute_reply":"2023-03-22T12:57:50.997968Z"},"papermill":{"duration":0.369219,"end_time":"2023-03-22T12:57:51.005475","exception":false,"start_time":"2023-03-22T12:57:50.636256","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"unique, counts = np.unique(HDC_UC03_INV, return_counts=True,)\ngaps=list(zip(unique, counts)) \n#print(gaps)\n\nfor gap in gaps:\n    if gap[1] < HDC_GAPfill:\n        gapID=(HDC_UC03_INV == gap[0]).astype(int)        \n        HDC_UC03_BIN=HDC_UC03_BIN+gapID","visibility":"show","key":"UaJ5YnJBao"},{"type":"output","id":"HkD51XVopMbNw0EMQiBHk","data":[],"visibility":"show","key":"rtBk12A14Z"}],"visibility":"show","key":"yVE9fHUVfx"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.041855,"end_time":"2023-03-22T12:57:51.110031","exception":false,"start_time":"2023-03-22T12:57:51.068176","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"regions where POP > 50000 with filled gaps < 15km2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TeLoZ3BiSK"}],"key":"JxQFkQdeKH"}],"visibility":"show","key":"vHsskmMJID"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:57:51.197238Z","iopub.status.busy":"2023-03-22T12:57:51.194797Z","iopub.status.idle":"2023-03-22T12:57:51.238462Z","shell.execute_reply":"2023-03-22T12:57:51.236943Z"},"papermill":{"duration":0.089754,"end_time":"2023-03-22T12:57:51.242025","exception":false,"start_time":"2023-03-22T12:57:51.152271","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"HDC_UC03_4conn = measure.label(HDC_UC03_BIN, background=0, connectivity=HDC_Tcon)  # connectivity=HDC_Tcon\nprint(HDC_UC03_4conn.min(),HDC_UC03_4conn.max())","visibility":"show","key":"VioDqbplwA"},{"type":"output","id":"SnC2zumLytOzREhbxVgbV","data":[{"name":"stdout","output_type":"stream","text":"0 123\n"}],"visibility":"show","key":"juOZXFA8Jm"}],"visibility":"show","key":"apnM1zontQ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:57:51.349327Z","iopub.status.busy":"2023-03-22T12:57:51.348437Z","iopub.status.idle":"2023-03-22T12:57:51.362090Z","shell.execute_reply":"2023-03-22T12:57:51.360465Z"},"papermill":{"duration":0.065228,"end_time":"2023-03-22T12:57:51.367464","exception":false,"start_time":"2023-03-22T12:57:51.302236","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# binary raster\nHDC_UC04_BIN=np.where(HDC_UC03_4conn >= 1, 1, 0)\nprint(HDC_UC04_BIN.sum())","visibility":"show","key":"DascecO6Bn"},{"type":"output","id":"QOR_nTkW03qDWV1aqe7fl","data":[{"name":"stdout","output_type":"stream","text":"8165\n"}],"visibility":"show","key":"hblNAaTAoB"}],"visibility":"show","key":"esDGntSOgh"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.056221,"end_time":"2023-03-22T12:57:51.509510","exception":false,"start_time":"2023-03-22T12:57:51.453289","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"step5: Urban Centre (HDC) - morphology","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hr4TZo5pAM"}],"identifier":"step5-urban-centre-hdc-morphology","label":"step5: Urban Centre (HDC) - morphology","html_id":"step5-urban-centre-hdc-morphology","implicit":true,"key":"r2DdPVpu9t"}],"visibility":"show","key":"uKNoI6W6MD"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.039691,"end_time":"2023-03-22T12:57:51.592399","exception":false,"start_time":"2023-03-22T12:57:51.552708","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"closing, erosion, dilatation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QzzsmYiIBA"}],"key":"pqrjfEv8UC"}],"visibility":"show","key":"dj1FBys7n4"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:57:51.678442Z","iopub.status.busy":"2023-03-22T12:57:51.678056Z","iopub.status.idle":"2023-03-22T12:57:58.515830Z","shell.execute_reply":"2023-03-22T12:57:58.514409Z"},"papermill":{"duration":6.884347,"end_time":"2023-03-22T12:57:58.518868","exception":false,"start_time":"2023-03-22T12:57:51.634521","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"HDC_UC04=np.zeros_like(HDC_UC03_BIN).astype('int')\n# regiony sa vyhodnocuju sekvencne v cykle:\nPOPregionIDsum=[]\nPOPregionSUM=[]\nfor regionID in range(1, HDC_UC03_4conn.max()):\n    # mask 0-1 for region, # POP in region\n    POPregionID=((HDC_UC03_4conn == regionID).astype('int'))  \n    #print(POPregionID.min(), POPregionID.max(), POPregionID.sum())\n    POPregionID = morphology.binary_closing(POPregionID, square(3))\n    POPregionID= morphology.binary_dilation(POPregionID)\n    POPregionID= morphology.binary_erosion(POPregionID)\n    #POPregionID = skimage.morphology.binary_closing(POPregionID, square(3))\n    HDC_UC04=HDC_UC04+POPregionID\n    #print(HDC_UC05.sum())","visibility":"show","key":"xMiDXtnecA"},{"type":"output","id":"CriqjofP3t9aFg4IB7_0o","data":[],"visibility":"show","key":"SD6cKqkpdN"}],"visibility":"show","key":"GugwACnZN9"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:57:58.613099Z","iopub.status.busy":"2023-03-22T12:57:58.611254Z","iopub.status.idle":"2023-03-22T12:57:58.690835Z","shell.execute_reply":"2023-03-22T12:57:58.685306Z"},"papermill":{"duration":0.131383,"end_time":"2023-03-22T12:57:58.697241","exception":false,"start_time":"2023-03-22T12:57:58.565858","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# gaps filling after morphology:\nHDC_UC04_INV=np.where(HDC_UC04 == 1, 0, 1)\nHDC_UC04_INV = measure.label(HDC_UC04_INV, background=0, connectivity=2)\n# number of holes\nHDC_UC04_INV.max()","visibility":"show","key":"TBymq0wQoO"},{"type":"output","id":"zuGllF31u1QkqK64CTkSl","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/plain":{"content":"2","content_type":"text/plain"}}}],"visibility":"show","key":"PRJsf9xj0z"}],"visibility":"show","key":"WeDtEwdQxu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:57:58.804038Z","iopub.status.busy":"2023-03-22T12:57:58.803542Z","iopub.status.idle":"2023-03-22T12:57:58.841124Z","shell.execute_reply":"2023-03-22T12:57:58.839003Z"},"papermill":{"duration":0.085959,"end_time":"2023-03-22T12:57:58.845764","exception":false,"start_time":"2023-03-22T12:57:58.759805","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"unique1, counts1 = np.unique(HDC_UC04_INV, return_counts=True,)\ngaps1 = [x for x in zip(unique1, counts1) if x[1] < HDC_GAPfill]\n#print(gaps1)\n\nfor gap1 in gaps1:\n    gapID1=(HDC_UC04_INV == gap1[0]).astype(int)\n    HDC_UC04=HDC_UC04+gapID1","visibility":"show","key":"NlAnj62rhI"},{"type":"output","id":"T4Q5b0JNLJRL_L2rHLqGw","data":[],"visibility":"show","key":"UICUNuT7FB"}],"visibility":"show","key":"UmiUtOPirw"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:57:58.936709Z","iopub.status.busy":"2023-03-22T12:57:58.936186Z","iopub.status.idle":"2023-03-22T12:57:58.978346Z","shell.execute_reply":"2023-03-22T12:57:58.976875Z"},"papermill":{"duration":0.092934,"end_time":"2023-03-22T12:57:58.981725","exception":false,"start_time":"2023-03-22T12:57:58.888791","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"HDC_UC04_4conn = measure.label(HDC_UC04, background=0, connectivity=HDC_Tcon)\nHDC_UC04_4conn.max()","visibility":"show","key":"mS764IgB6r"},{"type":"output","id":"87DdrDkqulEp1HzwU7ExX","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/plain":{"content":"121","content_type":"text/plain"}}}],"visibility":"show","key":"itdi8XmxSQ"}],"visibility":"show","key":"vs1dY4CDNM"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:57:59.070744Z","iopub.status.busy":"2023-03-22T12:57:59.069725Z","iopub.status.idle":"2023-03-22T12:57:59.096204Z","shell.execute_reply":"2023-03-22T12:57:59.094620Z"},"papermill":{"duration":0.075397,"end_time":"2023-03-22T12:57:59.099823","exception":false,"start_time":"2023-03-22T12:57:59.024426","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# binary raster\nHDC_UC04_4conn_BIN=np.where(HDC_UC04_4conn >= 1, 1, 0)\nHDC_UC04_4conn_BIN.sum()","visibility":"show","key":"n0Rx0nryBn"},{"type":"output","id":"orWxVjNc0qaiXl7GSAAJR","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/plain":{"content":"9193","content_type":"text/plain"}}}],"visibility":"show","key":"aoZRIcOjgT"}],"visibility":"show","key":"Ln7kHUzJxX"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.049032,"end_time":"2023-03-22T12:57:59.217311","exception":false,"start_time":"2023-03-22T12:57:59.168279","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"L1: Urban Cluster (MDC)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MjZVDaz2Wz"}],"identifier":"l1-urban-cluster-mdc","label":"L1: Urban Cluster (MDC)","html_id":"l1-urban-cluster-mdc","implicit":true,"key":"Mag6bMtA8L"}],"visibility":"show","key":"jCOOwKtj89"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:57:59.322660Z","iopub.status.busy":"2023-03-22T12:57:59.321686Z","iopub.status.idle":"2023-03-22T12:57:59.352843Z","shell.execute_reply":"2023-03-22T12:57:59.341968Z"},"papermill":{"duration":0.094435,"end_time":"2023-03-22T12:57:59.358682","exception":false,"start_time":"2023-03-22T12:57:59.264247","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# binary\nMDC_UC03=np.where(MDC_UC03 > 0, 1, 0)\n# \nMDC_UC04=MDC_UC03-HDC_UC04\nMDC_UC04=np.where(MDC_UC04 == 1, 1, 0)","visibility":"show","key":"dTb2zEVUqV"},{"type":"output","id":"0UBxC4EftLTnzOk8BczSs","data":[],"visibility":"show","key":"nxtKmiJhi1"}],"visibility":"show","key":"oyom0LTIws"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:57:59.462375Z","iopub.status.busy":"2023-03-22T12:57:59.456904Z","iopub.status.idle":"2023-03-22T12:57:59.501477Z","shell.execute_reply":"2023-03-22T12:57:59.494120Z"},"papermill":{"duration":0.101743,"end_time":"2023-03-22T12:57:59.507094","exception":false,"start_time":"2023-03-22T12:57:59.405351","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"MDC_UC04_8conn = measure.label(MDC_UC04, background=0, connectivity=MDC_Tcon)\nprint(MDC_UC04_8conn.min(),MDC_UC04_8conn.max())","visibility":"show","key":"r3KEMNMC5a"},{"type":"output","id":"Gt_wn5dq_m7IGyt4EMdqo","data":[{"name":"stdout","output_type":"stream","text":"0 1909\n"}],"visibility":"show","key":"G0yK8zjuWt"}],"visibility":"show","key":"NX8weyJ7qz"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.049026,"end_time":"2023-03-22T12:57:59.614453","exception":false,"start_time":"2023-03-22T12:57:59.565427","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"je5VcLYuEz"},{"type":"text","value":"HDC and MDC to vector","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f4b48K87hR"}],"key":"Ij0zmD6nqh"}],"visibility":"show","key":"esIH0rCsbo"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.062194,"end_time":"2023-03-22T12:57:59.725903","exception":false,"start_time":"2023-03-22T12:57:59.663709","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"HDC:  numpy.ndarray to DataArray","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MeanBShueB"}],"key":"eLjLtvGyr6"}],"visibility":"show","key":"PEdZZCI8UN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:57:59.846397Z","iopub.status.busy":"2023-03-22T12:57:59.842472Z","iopub.status.idle":"2023-03-22T12:57:59.893274Z","shell.execute_reply":"2023-03-22T12:57:59.891700Z"},"papermill":{"duration":0.128757,"end_time":"2023-03-22T12:57:59.909967","exception":false,"start_time":"2023-03-22T12:57:59.781210","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"HDC_UC05 = xr.DataArray(\n    data=HDC_UC04_4conn,\n    dims=BTU_da.dims,\n    coords=BTU_da.coords,\n    name='urban_centre',\n    )\n\nHDC_UC05=HDC_UC05.astype(np.int16)\nHDC_UC05","visibility":"show","key":"eNTCNNcBwk"},{"type":"output","id":"YKoxfKswbS5EzFjNHUZkp","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=dark],\nbody[data-theme=dark],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1F1F1F;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 20px 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: none;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: '►';\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: '▼';\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: '(';\n}\n\n.xr-dim-list:after {\n  content: ')';\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: ',';\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;urban_centre&#x27; (y: 831, x: 1266)&gt;\narray([[0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       ...,\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0]], dtype=int16)\nCoordinates:\n  * x            (x) float64 7.085e+05 7.095e+05 ... 1.972e+06 1.974e+06\n  * y            (y) float64 6.386e+06 6.386e+06 ... 5.558e+06 5.556e+06\n    spatial_ref  int64 0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'urban_centre'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 831</li><li><span class='xr-has-index'>x</span>: 1266</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-309aff0f-1f6d-4572-8e2f-e731ffd55cdd' class='xr-array-in' type='checkbox' checked><label for='section-309aff0f-1f6d-4572-8e2f-e731ffd55cdd' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></div><div class='xr-array-data'><pre>array([[0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       ...,\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0]], dtype=int16)</pre></div></div></li><li class='xr-section-item'><input id='section-c5196e48-bd50-4268-81bd-148f23275eae' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c5196e48-bd50-4268-81bd-148f23275eae' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>7.085e+05 7.095e+05 ... 1.974e+06</div><input id='attrs-1e27b0f3-5a3c-44d4-9e1b-70f7ebd269a7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1e27b0f3-5a3c-44d4-9e1b-70f7ebd269a7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-35e3de73-d8c9-4455-84a6-6cdc20a3ac2a' class='xr-var-data-in' type='checkbox'><label for='data-35e3de73-d8c9-4455-84a6-6cdc20a3ac2a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>x coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd></dl></div><div class='xr-var-data'><pre>array([ 708500.,  709500.,  710500., ..., 1971500., 1972500., 1973500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>6.386e+06 6.386e+06 ... 5.556e+06</div><input id='attrs-18581103-e4b2-4a92-815a-35c212e3c1cc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-18581103-e4b2-4a92-815a-35c212e3c1cc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6919b215-c7cb-49f3-9bc6-3828850d3191' class='xr-var-data-in' type='checkbox'><label for='data-6919b215-c7cb-49f3-9bc6-3828850d3191' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>y coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd></dl></div><div class='xr-var-data'><pre>array([6386500., 6385500., 6384500., ..., 5558500., 5557500., 5556500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-b397a33b-8904-4a80-9b6a-f4c1cf0e3dc7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b397a33b-8904-4a80-9b6a-f4c1cf0e3dc7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8cd9aa70-0377-473a-850e-41f44c24e706' class='xr-var-data-in' type='checkbox'><label for='data-8cd9aa70-0377-473a-850e-41f44c24e706' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>PROJCS[&quot;World_Mollweide&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;Degree&quot;,0.0174532925199433]],PROJECTION[&quot;Mollweide&quot;],PARAMETER[&quot;central_meridian&quot;,0],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH]]</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS[&quot;World_Mollweide&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;Degree&quot;,0.0174532925199433]],PROJECTION[&quot;Mollweide&quot;],PARAMETER[&quot;central_meridian&quot;,0],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH]]</dd><dt><span>GeoTransform :</span></dt><dd>708000.0 1000.0 0.0 6387000.0 0.0 -1000.0</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-424c44ed-4b8a-4bdc-b5da-31d98f2ab94f' class='xr-section-summary-in' type='checkbox'  ><label for='section-424c44ed-4b8a-4bdc-b5da-31d98f2ab94f' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-bfab7357-e653-4a42-b837-a3dadb2e60bb' class='xr-index-data-in' type='checkbox'/><label for='index-bfab7357-e653-4a42-b837-a3dadb2e60bb' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([ 708500.0,  709500.0,  710500.0,  711500.0,  712500.0,  713500.0,\n               714500.0,  715500.0,  716500.0,  717500.0,\n              ...\n              1964500.0, 1965500.0, 1966500.0, 1967500.0, 1968500.0, 1969500.0,\n              1970500.0, 1971500.0, 1972500.0, 1973500.0],\n             dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=1266))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-96e3a5da-cd43-4a3d-a07c-79235cb12a10' class='xr-index-data-in' type='checkbox'/><label for='index-96e3a5da-cd43-4a3d-a07c-79235cb12a10' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([6386500.0, 6385500.0, 6384500.0, 6383500.0, 6382500.0, 6381500.0,\n              6380500.0, 6379500.0, 6378500.0, 6377500.0,\n              ...\n              5565500.0, 5564500.0, 5563500.0, 5562500.0, 5561500.0, 5560500.0,\n              5559500.0, 5558500.0, 5557500.0, 5556500.0],\n             dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=831))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-be643c2c-9248-4059-87ee-abe53adda95b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-be643c2c-9248-4059-87ee-abe53adda95b' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray 'urban_centre' (y: 831, x: 1266)>\narray([[0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       ...,\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0]], dtype=int16)\nCoordinates:\n  * x            (x) float64 7.085e+05 7.095e+05 ... 1.972e+06 1.974e+06\n  * y            (y) float64 6.386e+06 6.386e+06 ... 5.558e+06 5.556e+06\n    spatial_ref  int64 0","content_type":"text/plain"}}}],"visibility":"show","key":"Axm1lJNqpW"}],"visibility":"show","key":"V3o0W17cQH"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:00.017051Z","iopub.status.busy":"2023-03-22T12:58:00.016018Z","iopub.status.idle":"2023-03-22T12:58:00.032917Z","shell.execute_reply":"2023-03-22T12:58:00.029571Z"},"papermill":{"duration":0.09231,"end_time":"2023-03-22T12:58:00.052773","exception":false,"start_time":"2023-03-22T12:57:59.960463","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# # Info about HDC DataArray\n# print('type:',type(HDC_UC05))\n# print('name:',HDC_UC05.name)\n# print('shape:',HDC_UC05.shape)\n# #print(HDC_UC05.coords)\n# print('dim:',HDC_UC05.dims,'\\n')\n# # World Mollweide  ESRI:54009\n# print(\"The crs is: \", HDC_UC05.rio.crs)\n# print('transform: ',HDC_UC05.rio.transform())\n# print(\"The spatial extent is: \", HDC_UC05.rio.bounds())\n# print(\"The nodatavalue of data is: \", HDC_UC05.rio.nodata)\n# print(\"The shape of data is: \", HDC_UC05.shape)\n# print(\"The spatial resolution of data is: \", HDC_UC05.rio.resolution())\n# print(\"the minimum raster value is: \", np.nanmin(HDC_UC05.values))\n# print(\"the maximum raster value is: \", np.nanmax(HDC_UC05.values))\n# print(\"The metadata of data is: \", HDC_UC05.attrs)","visibility":"show","key":"zHk83RlCEJ"},{"type":"output","id":"6DoabKtszxSkyzFbAbIr8","data":[],"visibility":"show","key":"HH7ZUvyTDN"}],"visibility":"show","key":"aiOvIeCbcT"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.044271,"end_time":"2023-03-22T12:58:00.145132","exception":false,"start_time":"2023-03-22T12:58:00.100861","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"HDC: export to vector","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dPFJI7wB9H"}],"key":"QZ9izMHIeC"}],"visibility":"show","key":"IKsfYzGKzX"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:00.244380Z","iopub.status.busy":"2023-03-22T12:58:00.243900Z","iopub.status.idle":"2023-03-22T12:58:00.305354Z","shell.execute_reply":"2023-03-22T12:58:00.303925Z"},"papermill":{"duration":0.116057,"end_time":"2023-03-22T12:58:00.310565","exception":false,"start_time":"2023-03-22T12:58:00.194508","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# mask=None\nmask=HDC_UC05.data != 0\nwith HDC_UC05 as src:\n    image = src.data # first band\n    results = (\n    {'properties': {'raster_val': v}, 'geometry': s}\n    for i, (s, v) \n    in enumerate(\n        shapes(image, mask=mask, connectivity=4, transform=HDC_UC05.rio.transform())))\n\ngeoms = list(results)\n# first feature\n# print(geoms[0])","visibility":"show","key":"cBRART5zoj"},{"type":"output","id":"u2HRq_Vbbyf8Mc5c6cMbs","data":[],"visibility":"show","key":"Rjd7N0vhnQ"}],"visibility":"show","key":"DnZFGaBouy"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:00.433690Z","iopub.status.busy":"2023-03-22T12:58:00.424834Z","iopub.status.idle":"2023-03-22T12:58:00.491630Z","shell.execute_reply":"2023-03-22T12:58:00.489308Z"},"papermill":{"duration":0.119707,"end_time":"2023-03-22T12:58:00.495327","exception":false,"start_time":"2023-03-22T12:58:00.375620","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"HDC_UrbanCentre  = gpd.GeoDataFrame.from_features(geoms)\nHDC_UrbanCentre.crs=HDC_UC05.rio.crs\nHDC_UrbanCentre.raster_val=HDC_UrbanCentre.raster_val.astype('int')\nHDC_UrbanCentre.rename(columns={'raster_val':'hdcid'}, inplace=True)\nHDC_UrbanCentre['area_km2'] = HDC_UrbanCentre['geometry'].area/ 10**6\nHDC_UrbanCentre['code']=3\nHDC_UrbanCentre.sort_values(['area_km2'],ascending=False).head(3)","visibility":"show","key":"hGGh7GcoiW"},{"type":"output","id":"SfBMe7Y-bxYFX7FWmSJs6","data":[{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>geometry</th>\n      <th>hdcid</th>\n      <th>area_km2</th>\n      <th>code</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>32</th>\n      <td>POLYGON ((991000.000 6151000.000, 994000.000 6...</td>\n      <td>29</td>\n      <td>729.0</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>70</th>\n      <td>POLYGON ((1423000.000 5916000.000, 1424000.000...</td>\n      <td>69</td>\n      <td>478.0</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>39</th>\n      <td>POLYGON ((1542000.000 6118000.000, 1551000.000...</td>\n      <td>36</td>\n      <td>457.0</td>\n      <td>3</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"                                             geometry  hdcid  area_km2  code\n32  POLYGON ((991000.000 6151000.000, 994000.000 6...     29     729.0     3\n70  POLYGON ((1423000.000 5916000.000, 1424000.000...     69     478.0     3\n39  POLYGON ((1542000.000 6118000.000, 1551000.000...     36     457.0     3","content_type":"text/plain"}}}],"visibility":"show","key":"Qgk01ZKMEQ"}],"visibility":"show","key":"CcX8pJswuU"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.057521,"end_time":"2023-03-22T12:58:00.618742","exception":false,"start_time":"2023-03-22T12:58:00.561221","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"MDC:  numpy.ndarray to DataArray","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gqGhPgAhSs"}],"key":"DeSlQ2eChR"}],"visibility":"show","key":"qYzYuIr3In"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:00.738438Z","iopub.status.busy":"2023-03-22T12:58:00.737831Z","iopub.status.idle":"2023-03-22T12:58:00.785138Z","shell.execute_reply":"2023-03-22T12:58:00.783565Z"},"papermill":{"duration":0.109648,"end_time":"2023-03-22T12:58:00.789003","exception":false,"start_time":"2023-03-22T12:58:00.679355","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"MDC_UC05 = xr.DataArray(\n    data=MDC_UC04_8conn,\n    dims=BTU_da.dims,\n    coords=BTU_da.coords,\n    name='urban_cluster',\n    )\n\nMDC_UC05=MDC_UC05.astype(np.int16)\nMDC_UC05","visibility":"show","key":"FW6UsqT2gh"},{"type":"output","id":"D2e93Kt315LHhksnSpATp","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=dark],\nbody[data-theme=dark],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1F1F1F;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 20px 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: none;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: '►';\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: '▼';\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: '(';\n}\n\n.xr-dim-list:after {\n  content: ')';\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: ',';\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;urban_cluster&#x27; (y: 831, x: 1266)&gt;\narray([[0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       ...,\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0]], dtype=int16)\nCoordinates:\n  * x            (x) float64 7.085e+05 7.095e+05 ... 1.972e+06 1.974e+06\n  * y            (y) float64 6.386e+06 6.386e+06 ... 5.558e+06 5.556e+06\n    spatial_ref  int64 0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'urban_cluster'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 831</li><li><span class='xr-has-index'>x</span>: 1266</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-e03bfd71-737d-4452-be57-c581f69af378' class='xr-array-in' type='checkbox' checked><label for='section-e03bfd71-737d-4452-be57-c581f69af378' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></div><div class='xr-array-data'><pre>array([[0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       ...,\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0]], dtype=int16)</pre></div></div></li><li class='xr-section-item'><input id='section-a31104da-f3fb-4557-82f2-c8c17cf980dc' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a31104da-f3fb-4557-82f2-c8c17cf980dc' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>7.085e+05 7.095e+05 ... 1.974e+06</div><input id='attrs-443004b6-2d7f-4412-93c5-da640a4d0a42' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-443004b6-2d7f-4412-93c5-da640a4d0a42' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2f8d8492-971f-4d21-88ac-27c950ef55ea' class='xr-var-data-in' type='checkbox'><label for='data-2f8d8492-971f-4d21-88ac-27c950ef55ea' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>x coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd></dl></div><div class='xr-var-data'><pre>array([ 708500.,  709500.,  710500., ..., 1971500., 1972500., 1973500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>6.386e+06 6.386e+06 ... 5.556e+06</div><input id='attrs-4cc2c316-2000-42c2-8ed2-4757c45c367d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4cc2c316-2000-42c2-8ed2-4757c45c367d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3a1e2dbc-40b3-4c11-bd19-b341f632a9f6' class='xr-var-data-in' type='checkbox'><label for='data-3a1e2dbc-40b3-4c11-bd19-b341f632a9f6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>y coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd></dl></div><div class='xr-var-data'><pre>array([6386500., 6385500., 6384500., ..., 5558500., 5557500., 5556500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-4a85087e-db8b-40e9-ba91-cd7a5668f73e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4a85087e-db8b-40e9-ba91-cd7a5668f73e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9ce7ff6a-855f-4ac6-8ed0-e5e18a4fc1a4' class='xr-var-data-in' type='checkbox'><label for='data-9ce7ff6a-855f-4ac6-8ed0-e5e18a4fc1a4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>PROJCS[&quot;World_Mollweide&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;Degree&quot;,0.0174532925199433]],PROJECTION[&quot;Mollweide&quot;],PARAMETER[&quot;central_meridian&quot;,0],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH]]</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS[&quot;World_Mollweide&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;Degree&quot;,0.0174532925199433]],PROJECTION[&quot;Mollweide&quot;],PARAMETER[&quot;central_meridian&quot;,0],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH]]</dd><dt><span>GeoTransform :</span></dt><dd>708000.0 1000.0 0.0 6387000.0 0.0 -1000.0</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a3bd27e8-3f45-44c1-a9e2-49e83f17f5ab' class='xr-section-summary-in' type='checkbox'  ><label for='section-a3bd27e8-3f45-44c1-a9e2-49e83f17f5ab' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-5ffa30da-4d72-489e-aa5a-cf5b9694ea7b' class='xr-index-data-in' type='checkbox'/><label for='index-5ffa30da-4d72-489e-aa5a-cf5b9694ea7b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([ 708500.0,  709500.0,  710500.0,  711500.0,  712500.0,  713500.0,\n               714500.0,  715500.0,  716500.0,  717500.0,\n              ...\n              1964500.0, 1965500.0, 1966500.0, 1967500.0, 1968500.0, 1969500.0,\n              1970500.0, 1971500.0, 1972500.0, 1973500.0],\n             dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=1266))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a2b350e2-ceed-4f48-8786-203885cc6e13' class='xr-index-data-in' type='checkbox'/><label for='index-a2b350e2-ceed-4f48-8786-203885cc6e13' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([6386500.0, 6385500.0, 6384500.0, 6383500.0, 6382500.0, 6381500.0,\n              6380500.0, 6379500.0, 6378500.0, 6377500.0,\n              ...\n              5565500.0, 5564500.0, 5563500.0, 5562500.0, 5561500.0, 5560500.0,\n              5559500.0, 5558500.0, 5557500.0, 5556500.0],\n             dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=831))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c33ef805-5d93-4fb4-a800-efde69398a97' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-c33ef805-5d93-4fb4-a800-efde69398a97' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray 'urban_cluster' (y: 831, x: 1266)>\narray([[0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       ...,\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0]], dtype=int16)\nCoordinates:\n  * x            (x) float64 7.085e+05 7.095e+05 ... 1.972e+06 1.974e+06\n  * y            (y) float64 6.386e+06 6.386e+06 ... 5.558e+06 5.556e+06\n    spatial_ref  int64 0","content_type":"text/plain"}}}],"visibility":"show","key":"ogOGl4vKvl"}],"visibility":"show","key":"oIvX0Lhq2m"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:00.951940Z","iopub.status.busy":"2023-03-22T12:58:00.950886Z","iopub.status.idle":"2023-03-22T12:58:00.966381Z","shell.execute_reply":"2023-03-22T12:58:00.959356Z"},"papermill":{"duration":0.072114,"end_time":"2023-03-22T12:58:00.970073","exception":false,"start_time":"2023-03-22T12:58:00.897959","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# # BASIC INFO\n# print('type:',type(MDC_UC05))\n# print('name:',MDC_UC05.name)\n# print('shape:',MDC_UC05.shape)\n# #print(MDC_UC05.coords)\n# print('dim:',MDC_UC05.dims,'\\n')\n# # View generate metadata associated with the raster file\n# # World Mollweide  ESRI:54009\n# print(\"The crs is: \", MDC_UC05.rio.crs)\n# print('transform: ',MDC_UC05.rio.transform())\n# print(\"The spatial extent is: \", MDC_UC05.rio.bounds())\n# print(\"The nodatavalue of data is: \", MDC_UC05.rio.nodata)\n# print(\"The shape of data is: \", MDC_UC05.shape)\n# print(\"The spatial resolution of data is: \", MDC_UC05.rio.resolution())\n# print(\"the minimum raster value is: \", np.nanmin(MDC_UC05.values))\n# print(\"the maximum raster value is: \", np.nanmax(MDC_UC05.values))\n# print(\"The metadata of data is: \", MDC_UC05.attrs,'\\n')\n# print(MDC_UC05.data.max())","visibility":"show","key":"RBDuTZEuMD"},{"type":"output","id":"ccKQjYyGL1mlu9AZiazE2","data":[],"visibility":"show","key":"pN0iG8hCKy"}],"visibility":"show","key":"q5Sr4mTzcu"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.049661,"end_time":"2023-03-22T12:58:01.072474","exception":false,"start_time":"2023-03-22T12:58:01.022813","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"MDC: export to vector","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RMoLtGJdS1"}],"key":"iWSTAq2gkE"}],"visibility":"show","key":"xqJOkqg59x"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:01.210634Z","iopub.status.busy":"2023-03-22T12:58:01.210035Z","iopub.status.idle":"2023-03-22T12:58:01.365652Z","shell.execute_reply":"2023-03-22T12:58:01.362963Z"},"papermill":{"duration":0.240109,"end_time":"2023-03-22T12:58:01.370484","exception":false,"start_time":"2023-03-22T12:58:01.130375","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# mask=None\nmask=MDC_UC05.data != 0\nwith MDC_UC05 as src:\n    image = src.data # first band\n    results = (\n    {'properties': {'raster_val': v}, 'geometry': s}\n    for i, (s, v) \n    in enumerate(\n        shapes(image, mask=mask, connectivity=8, transform=MDC_UC05.rio.transform())))\n\ngeoms = list(results)","visibility":"show","key":"TWARqZgC9L"},{"type":"output","id":"Yft5OvSMGnIz3oa9DCaQr","data":[],"visibility":"show","key":"VdFbQWFViM"}],"visibility":"show","key":"RpH4bUqbMe"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:01.497759Z","iopub.status.busy":"2023-03-22T12:58:01.497347Z","iopub.status.idle":"2023-03-22T12:58:01.862232Z","shell.execute_reply":"2023-03-22T12:58:01.860878Z"},"papermill":{"duration":0.433775,"end_time":"2023-03-22T12:58:01.867000","exception":false,"start_time":"2023-03-22T12:58:01.433225","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"MDC_UrbanCluster  = gpd.GeoDataFrame.from_features(geoms)\nMDC_UrbanCluster.crs=MDC_UC05.rio.crs\nMDC_UrbanCluster.raster_val=MDC_UrbanCluster.raster_val.astype('int')\nMDC_UrbanCluster.rename(columns={'raster_val':'mdcid'}, inplace=True)\nMDC_UrbanCluster[\"area_km2\"] = MDC_UrbanCluster['geometry'].area/ 10**6\nMDC_UrbanCluster['code']=2\nMDC_UrbanCluster.sort_values(['area_km2'],ascending=False).head(3)","visibility":"show","key":"Ysx04ovJeU"},{"type":"output","id":"kqnXrN3fodiX2x4L80G-S","data":[{"output_type":"execute_result","execution_count":47,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>geometry</th>\n      <th>mdcid</th>\n      <th>area_km2</th>\n      <th>code</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1164</th>\n      <td>POLYGON ((1407000.000 5892000.000, 1408000.000...</td>\n      <td>997</td>\n      <td>849.0</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>505</th>\n      <td>POLYGON ((1568000.000 6122000.000, 1569000.000...</td>\n      <td>423</td>\n      <td>632.0</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>1141</th>\n      <td>POLYGON ((1437000.000 5876000.000, 1438000.000...</td>\n      <td>1047</td>\n      <td>538.0</td>\n      <td>2</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"                                               geometry  mdcid  area_km2  code\n1164  POLYGON ((1407000.000 5892000.000, 1408000.000...    997     849.0     2\n505   POLYGON ((1568000.000 6122000.000, 1569000.000...    423     632.0     2\n1141  POLYGON ((1437000.000 5876000.000, 1438000.000...   1047     538.0     2","content_type":"text/plain"}}}],"visibility":"show","key":"G8ZKvU8Bs7"}],"visibility":"show","key":"LUIjTIFcGC"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.063993,"end_time":"2023-03-22T12:58:02.050964","exception":false,"start_time":"2023-03-22T12:58:01.986971","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"HDC and MDC export to shapefiles","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GFHx1wvBw3"}],"identifier":"hdc-and-mdc-export-to-shapefiles","label":"HDC and MDC export to shapefiles","html_id":"hdc-and-mdc-export-to-shapefiles","implicit":true,"key":"jSDVAX5pBQ"}],"visibility":"show","key":"ds4V3iM3LL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:02.186343Z","iopub.status.busy":"2023-03-22T12:58:02.178332Z","iopub.status.idle":"2023-03-22T12:58:02.200371Z","shell.execute_reply":"2023-03-22T12:58:02.197625Z"},"papermill":{"duration":0.088531,"end_time":"2023-03-22T12:58:02.207918","exception":false,"start_time":"2023-03-22T12:58:02.119387","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Create folder for GHSL_results, if it doesn't exist:\nPath(os.path.realpath('GHSL_results')).mkdir(parents=True, exist_ok=True) ","visibility":"show","key":"AQdAz4D5yg"},{"type":"output","id":"8kOd-yqlzn_moXiV5bvvP","data":[],"visibility":"show","key":"Xwk848EHo3"}],"visibility":"show","key":"eMTbB4UXKL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:02.373765Z","iopub.status.busy":"2023-03-22T12:58:02.368906Z","iopub.status.idle":"2023-03-22T12:58:03.174831Z","shell.execute_reply":"2023-03-22T12:58:03.173301Z"},"papermill":{"duration":0.875083,"end_time":"2023-03-22T12:58:03.181188","exception":false,"start_time":"2023-03-22T12:58:02.306105","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# EXPORT 2 shapefile World Mollweide (ESRI:54009)\nHDC_UrbanCentre.to_file(os.path.join(os.path.realpath('GHSL_results'),'HDC_UrbanCentre_'+str(REFyear)+'.shp'))\n# Export to shapefile WGS84 (EPSG:4326 )\n# HDC_UrbanCentre.to_crs(epsg=4326).to_file(os.path.join(os.path.realpath('GHSL_results'),'HDC_UrbanCentre_4326_'+str(REFyear)+'.shp'))\n\n# EXPORT 2 shapefile World Mollweide (ESRI:54009)\nMDC_UrbanCluster.to_file(os.path.join(os.path.realpath('GHSL_results'),'MDC_UrbanCluster_'+str(REFyear)+'.shp'))\n# Export to shapefile WGS84 (EPSG:4326 )\n# MDC_UrbanCentre.to_crs(epsg=4326).to_file(os.path.join(os.path.realpath('GHSL_results'),'MDC_UrbanCluster_4326_'+str(REFyear)+'.shp'))","visibility":"show","key":"OB8oYmiWfq"},{"type":"output","id":"mgMQ6uW2Al1upZ4aZ8rkB","data":[],"visibility":"show","key":"uz2waBTjBR"}],"visibility":"show","key":"uJqH3zElUL"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.049004,"end_time":"2023-03-22T12:58:03.283459","exception":false,"start_time":"2023-03-22T12:58:03.234455","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"L1: Visualization of results","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BodrkA4gYT"}],"identifier":"l1-visualization-of-results","label":"L1: Visualization of results","html_id":"l1-visualization-of-results","implicit":true,"key":"HDgnv4jvqU"}],"visibility":"show","key":"xz1dejC85t"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:03.447453Z","iopub.status.busy":"2023-03-22T12:58:03.446800Z","iopub.status.idle":"2023-03-22T12:58:05.297755Z","shell.execute_reply":"2023-03-22T12:58:05.290401Z"},"papermill":{"duration":1.999645,"end_time":"2023-03-22T12:58:05.337523","exception":false,"start_time":"2023-03-22T12:58:03.337878","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = Figure(width=600, height=600)\n\nm = AOI54009.explore(style_kwds={'fillColor':'None','color':'blue','weight': 1}, name='aoi')\n\n# parallels:\nfor lat in range(-90, 91, lat_interval):\n     folium.PolyLine([[lat, -180],[lat, 180]], weight=0.5).add_to(m)\n# meridianss:\nfor lon in range(-180, 181, lon_interval):\n    folium.PolyLine([[-90, lon],[90, lon]], weight=0.5).add_to(m)\n\nMDC_UrbanCluster.explore(m=m,style_kwds={'fillColor':'orange','color':'orange','weight': 1}, name='MDC_UrbanCluster')\nHDC_UrbanCentre.explore(m=m,style_kwds={'fillColor':'red','color':'red','weight': 1.5}, name='HDC_UrbanCentre')\n\nfolium.LayerControl('topright',collapsed=True).add_to(m)\nminimap = plugins.MiniMap(height=90, width=90, zoom_level_offset=-7)\nm.add_child(minimap)\n\nfig.add_child(m)\nm","visibility":"show","key":"TCGiId4Ou7"},{"type":"output","id":"8S2Phkri5eqSvCbO94PRH","data":[{"output_type":"execute_result","execution_count":50,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"259bf5400abf906a0c61f68f4831b095","path":"/notebooks_test/build/259bf5400abf906a0c61f68f4831b095.html"},"text/plain":{"content":"<folium.folium.Map at 0x7f7dfa969430>","content_type":"text/plain"}}}],"visibility":"show","key":"no1dHQHB1w"}],"visibility":"show","key":"lpvqTPUT3b"},{"type":"block","kind":"notebook-code","data":{"papermill":{"duration":0.095818,"end_time":"2023-03-22T12:58:05.541446","exception":false,"start_time":"2023-03-22T12:58:05.445628","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"","visibility":"show","key":"ORRtEZWTqN"},{"type":"output","id":"gpr27QMkq7yxFjaTRsHO4","data":[],"visibility":"show","key":"wJxbelETH9"}],"visibility":"show","key":"TAbzRZwhfy"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.09727,"end_time":"2023-03-22T12:58:05.727510","exception":false,"start_time":"2023-03-22T12:58:05.630240","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","children":[],"key":"bPO3Ah6ccy"},{"type":"text","value":"L2: Dense Urban Cluster (DUC), Semi-Dense Urban Cluster (SDUC) and  Peri-Urban Cluster (PUC)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zCvqcrzhz0"},{"type":"strong","children":[],"key":"SGv8MMIUgI"}],"identifier":"l2-dense-urban-cluster-duc-semi-dense-urban-cluster-sduc-and-peri-urban-cluster-puc","label":"L2: Dense Urban Cluster (DUC), Semi-Dense Urban Cluster (SDUC) and  Peri-Urban Cluster (PUC)","html_id":"l2-dense-urban-cluster-duc-semi-dense-urban-cluster-sduc-and-peri-urban-cluster-puc","implicit":true,"key":"iD9VGpgT7f"}],"visibility":"show","key":"dcSCMf8Gdq"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.127582,"end_time":"2023-03-22T12:58:05.987574","exception":false,"start_time":"2023-03-22T12:58:05.859992","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"step1: Dense Urban Cluster (DUC)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LJixPQsKXb"}],"identifier":"step1-dense-urban-cluster-duc","label":"step1: Dense Urban Cluster (DUC)","html_id":"step1-dense-urban-cluster-duc","implicit":true,"key":"rP3XdlMyEv"}],"visibility":"show","key":"j4a4wKdf61"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:06.305211Z","iopub.status.busy":"2023-03-22T12:58:06.299979Z","iopub.status.idle":"2023-03-22T12:58:06.318215Z","shell.execute_reply":"2023-03-22T12:58:06.316417Z"},"papermill":{"duration":0.169786,"end_time":"2023-03-22T12:58:06.324575","exception":false,"start_time":"2023-03-22T12:58:06.154789","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# MASK\nDUC_mask=HDC_UC01_mask  \n#print(DUC_mask.sum())","visibility":"show","key":"VlnxPmNCkL"},{"type":"output","id":"IbVLTU2v-nHxmRYoW2VxC","data":[],"visibility":"show","key":"Rr5lSQTwOd"}],"visibility":"show","key":"WjGdPphJXF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:06.584345Z","iopub.status.busy":"2023-03-22T12:58:06.556962Z","iopub.status.idle":"2023-03-22T12:58:06.636205Z","shell.execute_reply":"2023-03-22T12:58:06.634460Z"},"papermill":{"duration":0.208906,"end_time":"2023-03-22T12:58:06.645590","exception":false,"start_time":"2023-03-22T12:58:06.436684","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# CONNECTIVITY\nDUC_4conn = measure.label(DUC_mask, background=0, return_num=False, connectivity=HDC_Tcon) #.squeeze()\nprint('DUC number of regions:', DUC_4conn.max())","visibility":"show","key":"lU3Lwa0LQS"},{"type":"output","id":"DNz9I6edY6fUWFVxkLuIi","data":[{"name":"stdout","output_type":"stream","text":"DUC number of regions: 2437\n"}],"visibility":"show","key":"jLazpHZwls"}],"visibility":"show","key":"nHLZS1ydZw"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:06.893128Z","iopub.status.busy":"2023-03-22T12:58:06.891547Z","iopub.status.idle":"2023-03-22T12:58:28.581469Z","shell.execute_reply":"2023-03-22T12:58:28.580076Z"},"papermill":{"duration":21.839323,"end_time":"2023-03-22T12:58:28.594194","exception":false,"start_time":"2023-03-22T12:58:06.754871","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# TOTAL POPULATION IN CLUSTER\nDUC_UC03=np.zeros_like(HDC_POP_mask).astype('int')\n\nPOPregionIDsum=[]\nPOPregionSUM=[]\nfor regionID in range(1, DUC_4conn.max()):\n    POPregionID=((DUC_4conn == regionID).astype('int')) * POP_da.data    \n    # threshold for population in cluster > 5000\n    if POPregionID.sum() > MDC_Pmin:\n        POPregionSUM.append(int(round(POPregionID.sum())))\n        POPregionIDsum.append(regionID)\n        DUC_UC03=DUC_UC03+np.where(DUC_4conn == regionID, DUC_4conn, 0)","visibility":"show","key":"ely9arWWVb"},{"type":"output","id":"5B8846Zshue-IHKnmLEyk","data":[],"visibility":"show","key":"r48L4d1Csm"}],"visibility":"show","key":"I3Y3rlk2rU"},{"type":"block","kind":"notebook-code","data":{"papermill":{"duration":0.104902,"end_time":"2023-03-22T12:58:28.805711","exception":false,"start_time":"2023-03-22T12:58:28.700809","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"","visibility":"show","key":"THxz8Prc7C"},{"type":"output","id":"3jkHiClw8vdaRsH5aOgHN","data":[],"visibility":"show","key":"n2AgayBVb2"}],"visibility":"show","key":"pZW7sHN4Rt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:29.012144Z","iopub.status.busy":"2023-03-22T12:58:29.011495Z","iopub.status.idle":"2023-03-22T12:58:29.030045Z","shell.execute_reply":"2023-03-22T12:58:29.027498Z"},"papermill":{"duration":0.117866,"end_time":"2023-03-22T12:58:29.033429","exception":false,"start_time":"2023-03-22T12:58:28.915563","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# SUBTRACTION OF HDC\nDUC_UC03_BIN=np.where(DUC_UC03 > 0, 1, 0)\nDUC_UC03_BIN=DUC_UC03_BIN-HDC_UC04_4conn_BIN\nDUC_UC03_BIN=np.where(DUC_UC03_BIN >0, 1, 0)\nprint(DUC_UC03_BIN.sum())","visibility":"show","key":"I3j6wF1o2n"},{"type":"output","id":"KU2oblQctMybY3lA2ncpH","data":[{"name":"stdout","output_type":"stream","text":"4591\n"}],"visibility":"show","key":"pFh53Nuw1D"}],"visibility":"show","key":"eN1Lo0ytHi"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:29.214540Z","iopub.status.busy":"2023-03-22T12:58:29.214102Z","iopub.status.idle":"2023-03-22T12:58:29.238684Z","shell.execute_reply":"2023-03-22T12:58:29.234126Z"},"papermill":{"duration":0.123546,"end_time":"2023-03-22T12:58:29.242091","exception":false,"start_time":"2023-03-22T12:58:29.118545","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# CONNECTIVITY\nDUC_UC04_4conn = measure.label(DUC_UC03_BIN, background=0, connectivity=HDC_Tcon)  # connectivity=HDC_Tcon\nprint(DUC_UC04_4conn.min(),DUC_UC04_4conn.max())","visibility":"show","key":"MIlllH5306"},{"type":"output","id":"OhhTjmPSHNpbSFUreBjiR","data":[{"name":"stdout","output_type":"stream","text":"0 756\n"}],"visibility":"show","key":"xvcwK0Lvhz"}],"visibility":"show","key":"S1gxMSKxxF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:29.471038Z","iopub.status.busy":"2023-03-22T12:58:29.463827Z","iopub.status.idle":"2023-03-22T12:58:29.491313Z","shell.execute_reply":"2023-03-22T12:58:29.489350Z"},"papermill":{"duration":0.144228,"end_time":"2023-03-22T12:58:29.497128","exception":false,"start_time":"2023-03-22T12:58:29.352900","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# BINARY MASK\nDUC_UC04_4conn_BIN=np.where(DUC_UC04_4conn > 0, 1, 0)\nDUC_UC04_4conn_BIN.sum()","visibility":"show","key":"RRy0ekq7Kh"},{"type":"output","id":"yqZ-owlB2Wb-vEVzzComO","data":[{"output_type":"execute_result","execution_count":56,"metadata":{},"data":{"text/plain":{"content":"4591","content_type":"text/plain"}}}],"visibility":"show","key":"LI9Snhc1ab"}],"visibility":"show","key":"RxQmXRAs5h"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.120252,"end_time":"2023-03-22T12:58:29.788928","exception":false,"start_time":"2023-03-22T12:58:29.668676","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"DUC:  numpy.ndarray to DataArray","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l9TfNogdbu"}],"key":"Ji7tkJcKYt"}],"visibility":"show","key":"dywMXnhjDL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:30.008337Z","iopub.status.busy":"2023-03-22T12:58:30.006386Z","iopub.status.idle":"2023-03-22T12:58:30.068095Z","shell.execute_reply":"2023-03-22T12:58:30.066527Z"},"papermill":{"duration":0.171225,"end_time":"2023-03-22T12:58:30.072338","exception":false,"start_time":"2023-03-22T12:58:29.901113","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"DUC_UC05 = xr.DataArray(\n    data=DUC_UC04_4conn,\n    dims=BTU_da.dims,\n    coords=BTU_da.coords,\n    name='dense_urban_cluster',\n    )\n\nDUC_UC05=DUC_UC05.astype(np.int16)\nDUC_UC05","visibility":"show","key":"Aw7VGA5gjG"},{"type":"output","id":"eM3gSVmD37FG2M8kMKS8U","data":[{"output_type":"execute_result","execution_count":57,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=dark],\nbody[data-theme=dark],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1F1F1F;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 20px 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: none;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: '►';\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: '▼';\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: '(';\n}\n\n.xr-dim-list:after {\n  content: ')';\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: ',';\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;dense_urban_cluster&#x27; (y: 831, x: 1266)&gt;\narray([[0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       ...,\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0]], dtype=int16)\nCoordinates:\n  * x            (x) float64 7.085e+05 7.095e+05 ... 1.972e+06 1.974e+06\n  * y            (y) float64 6.386e+06 6.386e+06 ... 5.558e+06 5.556e+06\n    spatial_ref  int64 0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'dense_urban_cluster'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 831</li><li><span class='xr-has-index'>x</span>: 1266</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-a1535cd9-0541-4a8f-aa0e-73c1ddef7c08' class='xr-array-in' type='checkbox' checked><label for='section-a1535cd9-0541-4a8f-aa0e-73c1ddef7c08' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></div><div class='xr-array-data'><pre>array([[0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       ...,\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0]], dtype=int16)</pre></div></div></li><li class='xr-section-item'><input id='section-bb6e96df-2386-4eca-8868-fb52cc66d75a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-bb6e96df-2386-4eca-8868-fb52cc66d75a' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>7.085e+05 7.095e+05 ... 1.974e+06</div><input id='attrs-1bdd373d-1b8f-46ea-b256-6ffe9b6620a3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1bdd373d-1b8f-46ea-b256-6ffe9b6620a3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-70621aaf-2bba-4a00-9a8d-aa02afe85ee3' class='xr-var-data-in' type='checkbox'><label for='data-70621aaf-2bba-4a00-9a8d-aa02afe85ee3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>x coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd></dl></div><div class='xr-var-data'><pre>array([ 708500.,  709500.,  710500., ..., 1971500., 1972500., 1973500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>6.386e+06 6.386e+06 ... 5.556e+06</div><input id='attrs-92c4bd82-a597-4b45-9de1-8dcb63f6d088' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-92c4bd82-a597-4b45-9de1-8dcb63f6d088' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5a660061-1bd4-4f4b-97a9-6fe605b2f5b0' class='xr-var-data-in' type='checkbox'><label for='data-5a660061-1bd4-4f4b-97a9-6fe605b2f5b0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>y coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd></dl></div><div class='xr-var-data'><pre>array([6386500., 6385500., 6384500., ..., 5558500., 5557500., 5556500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-c5b32a19-ace4-4825-8a74-8d62884b317e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c5b32a19-ace4-4825-8a74-8d62884b317e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0cf3e7b6-9aeb-4635-a5b4-f1bcaf039e0a' class='xr-var-data-in' type='checkbox'><label for='data-0cf3e7b6-9aeb-4635-a5b4-f1bcaf039e0a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>PROJCS[&quot;World_Mollweide&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;Degree&quot;,0.0174532925199433]],PROJECTION[&quot;Mollweide&quot;],PARAMETER[&quot;central_meridian&quot;,0],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH]]</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS[&quot;World_Mollweide&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;Degree&quot;,0.0174532925199433]],PROJECTION[&quot;Mollweide&quot;],PARAMETER[&quot;central_meridian&quot;,0],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH]]</dd><dt><span>GeoTransform :</span></dt><dd>708000.0 1000.0 0.0 6387000.0 0.0 -1000.0</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a23fbdfa-bc2a-4087-a77a-8eaa041df24f' class='xr-section-summary-in' type='checkbox'  ><label for='section-a23fbdfa-bc2a-4087-a77a-8eaa041df24f' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-09b69b0c-df3c-4fc2-9291-29f67d7101d9' class='xr-index-data-in' type='checkbox'/><label for='index-09b69b0c-df3c-4fc2-9291-29f67d7101d9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([ 708500.0,  709500.0,  710500.0,  711500.0,  712500.0,  713500.0,\n               714500.0,  715500.0,  716500.0,  717500.0,\n              ...\n              1964500.0, 1965500.0, 1966500.0, 1967500.0, 1968500.0, 1969500.0,\n              1970500.0, 1971500.0, 1972500.0, 1973500.0],\n             dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=1266))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-0df5c502-2d9a-4a6f-87d7-b8e55f00c6d7' class='xr-index-data-in' type='checkbox'/><label for='index-0df5c502-2d9a-4a6f-87d7-b8e55f00c6d7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([6386500.0, 6385500.0, 6384500.0, 6383500.0, 6382500.0, 6381500.0,\n              6380500.0, 6379500.0, 6378500.0, 6377500.0,\n              ...\n              5565500.0, 5564500.0, 5563500.0, 5562500.0, 5561500.0, 5560500.0,\n              5559500.0, 5558500.0, 5557500.0, 5556500.0],\n             dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=831))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f624317b-43ef-4290-bb44-dc00123e2c40' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f624317b-43ef-4290-bb44-dc00123e2c40' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray 'dense_urban_cluster' (y: 831, x: 1266)>\narray([[0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       ...,\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0]], dtype=int16)\nCoordinates:\n  * x            (x) float64 7.085e+05 7.095e+05 ... 1.972e+06 1.974e+06\n  * y            (y) float64 6.386e+06 6.386e+06 ... 5.558e+06 5.556e+06\n    spatial_ref  int64 0","content_type":"text/plain"}}}],"visibility":"show","key":"eQsKIqI80R"}],"visibility":"show","key":"fTcK6h0SQ0"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.10512,"end_time":"2023-03-22T12:58:30.291984","exception":false,"start_time":"2023-03-22T12:58:30.186864","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"DUC: export to vector","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mzsJrDqOT6"}],"key":"fxq4xI3c7Y"}],"visibility":"show","key":"r9JuiZp3pg"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:30.490802Z","iopub.status.busy":"2023-03-22T12:58:30.489985Z","iopub.status.idle":"2023-03-22T12:58:30.765441Z","shell.execute_reply":"2023-03-22T12:58:30.764381Z"},"papermill":{"duration":0.375952,"end_time":"2023-03-22T12:58:30.768168","exception":false,"start_time":"2023-03-22T12:58:30.392216","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# mask=None\nmask=DUC_UC05.data != 0\nwith DUC_UC05 as src:\n    image = src.data # first band\n    results = (\n    {'properties': {'raster_val': v}, 'geometry': s}\n    for i, (s, v) \n    in enumerate(\n        shapes(image, mask=mask, connectivity=4, transform=DUC_UC05.rio.transform())))\n\ngeoms = list(results)","visibility":"show","key":"tjlgtxhTeL"},{"type":"output","id":"0nJt0j-o6Xw9eL6ud_wTe","data":[],"visibility":"show","key":"YM3R7Uv7Nq"}],"visibility":"show","key":"ZZ1APp9KNc"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:30.954484Z","iopub.status.busy":"2023-03-22T12:58:30.954069Z","iopub.status.idle":"2023-03-22T12:58:31.030169Z","shell.execute_reply":"2023-03-22T12:58:31.028058Z"},"papermill":{"duration":0.178806,"end_time":"2023-03-22T12:58:31.033113","exception":false,"start_time":"2023-03-22T12:58:30.854307","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"DUC_DenseUrbanCluster  = gpd.GeoDataFrame.from_features(geoms)\nDUC_DenseUrbanCluster.crs=DUC_UC05.rio.crs\nDUC_DenseUrbanCluster.raster_val=DUC_DenseUrbanCluster.raster_val.astype('int')\nDUC_DenseUrbanCluster.rename(columns={'raster_val':'ducid'}, inplace=True)\nDUC_DenseUrbanCluster['code']=23","visibility":"show","key":"VC1v8jX1Fr"},{"type":"output","id":"5jIo1ckhzgU1VNfMtnP9U","data":[],"visibility":"show","key":"s18oQrKv0f"}],"visibility":"show","key":"pC9NttSH01"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.092116,"end_time":"2023-03-22T12:58:31.227850","exception":false,"start_time":"2023-03-22T12:58:31.135734","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"step2: Semi-Dense Urban Cluster (SDUC)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qDuKxWfSQn"}],"identifier":"step2-semi-dense-urban-cluster-sduc","label":"step2: Semi-Dense Urban Cluster (SDUC)","html_id":"step2-semi-dense-urban-cluster-sduc","implicit":true,"key":"JknwBzn01p"}],"visibility":"show","key":"SHdiGvz2MQ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:31.438514Z","iopub.status.busy":"2023-03-22T12:58:31.437741Z","iopub.status.idle":"2023-03-22T12:58:31.455743Z","shell.execute_reply":"2023-03-22T12:58:31.454302Z"},"papermill":{"duration":0.135515,"end_time":"2023-03-22T12:58:31.459152","exception":false,"start_time":"2023-03-22T12:58:31.323637","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# MASK\nSDUC_mask=MDC_UC01_mask \nprint(DUC_mask.sum())","visibility":"show","key":"RiE58qh8PC"},{"type":"output","id":"xnJIF0SF026t3kFFX19Ji","data":[{"name":"stdout","output_type":"stream","text":"<xarray.DataArray ()>\narray(14494.)\nCoordinates:\n    spatial_ref  int64 0\n"}],"visibility":"show","key":"xII2aQYDTT"}],"visibility":"show","key":"LaQL6PchXB"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:31.662542Z","iopub.status.busy":"2023-03-22T12:58:31.661660Z","iopub.status.idle":"2023-03-22T12:58:31.685337Z","shell.execute_reply":"2023-03-22T12:58:31.683089Z"},"papermill":{"duration":0.128732,"end_time":"2023-03-22T12:58:31.691346","exception":false,"start_time":"2023-03-22T12:58:31.562614","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# CONNECTIVITY\nSDUC_8conn = measure.label(SDUC_mask, background=0, return_num=False, connectivity=MDC_Tcon) # 8-connectivity cluster\nprint('SDUC number of regions:', SDUC_8conn.max())","visibility":"show","key":"BTGXV8712N"},{"type":"output","id":"Aa8MyB5CT0bcc-rtoOr4K","data":[{"name":"stdout","output_type":"stream","text":"SDUC number of regions: 15569\n"}],"visibility":"show","key":"nOnPohAfBz"}],"visibility":"show","key":"GKR15sSnCy"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T12:58:31.900348Z","iopub.status.busy":"2023-03-22T12:58:31.899561Z","iopub.status.idle":"2023-03-22T13:00:13.105664Z","shell.execute_reply":"2023-03-22T13:00:13.104220Z"},"papermill":{"duration":101.317464,"end_time":"2023-03-22T13:00:13.108717","exception":false,"start_time":"2023-03-22T12:58:31.791253","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# TOTAL POPULATION IN CLUSTER\nSDUC_UC03=np.zeros_like(HDC_POP_mask).astype('int')\n\nPOPregionIDsum=[]\nPOPregionSUM=[]\nfor regionID in range(1, SDUC_8conn.max()):\n    POPregionID=((SDUC_8conn == regionID).astype('int')) * POP_da.data    \n    # threshold for population in cluster > 5000\n    if POPregionID.sum() > MDC_Pmin:\n        POPregionSUM.append(int(round(POPregionID.sum())))\n        POPregionIDsum.append(regionID)\n        SDUC_UC03=SDUC_UC03+np.where(SDUC_8conn == regionID, SDUC_8conn, 0)","visibility":"show","key":"HEnd324lzY"},{"type":"output","id":"XRXSTThOB-EMrI-Jnrfdw","data":[],"visibility":"show","key":"XsmKnbWIWS"}],"visibility":"show","key":"QKSI2qoqPX"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:00:13.331596Z","iopub.status.busy":"2023-03-22T13:00:13.330773Z","iopub.status.idle":"2023-03-22T13:00:13.362294Z","shell.execute_reply":"2023-03-22T13:00:13.357931Z"},"papermill":{"duration":0.150481,"end_time":"2023-03-22T13:00:13.369065","exception":false,"start_time":"2023-03-22T13:00:13.218584","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Minus HDC and DUC\nSDUC_UC03_BIN=np.where(SDUC_UC03 > 0, 1, 0)\nSDUC_UC03_BIN=SDUC_UC03_BIN - HDC_UC04_4conn_BIN - DUC_UC04_4conn_BIN\nSDUC_UC03_BIN=np.where(SDUC_UC03_BIN >0, 1, 0)\nprint(SDUC_UC03_BIN.sum())","visibility":"show","key":"WmlZxJ6aYU"},{"type":"output","id":"wl1GyYW8hObsELLqXFgtQ","data":[{"name":"stdout","output_type":"stream","text":"32703\n"}],"visibility":"show","key":"l8LVrlr6Mr"}],"visibility":"show","key":"Lg8RSbRCCf"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:00:13.799666Z","iopub.status.busy":"2023-03-22T13:00:13.799018Z","iopub.status.idle":"2023-03-22T13:00:13.836075Z","shell.execute_reply":"2023-03-22T13:00:13.831690Z"},"papermill":{"duration":0.209716,"end_time":"2023-03-22T13:00:13.838881","exception":false,"start_time":"2023-03-22T13:00:13.629165","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"SDUC_UC04_8conn = measure.label(SDUC_UC03_BIN, background=0, connectivity=MDC_Tcon)  # connectivity=HDC_Tcon\nprint(SDUC_UC04_8conn.min(),SDUC_UC04_8conn.max())","visibility":"show","key":"I2HNn83zr6"},{"type":"output","id":"9fZeRB-dg9g6vgztnW4qF","data":[{"name":"stdout","output_type":"stream","text":"0 2536\n"}],"visibility":"show","key":"YqyyLKcP1W"}],"visibility":"show","key":"fB4wS4vViG"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:00:14.079351Z","iopub.status.busy":"2023-03-22T13:00:14.078810Z","iopub.status.idle":"2023-03-22T13:00:14.113367Z","shell.execute_reply":"2023-03-22T13:00:14.109121Z"},"papermill":{"duration":0.173502,"end_time":"2023-03-22T13:00:14.117156","exception":false,"start_time":"2023-03-22T13:00:13.943654","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"SDUC_UC05 = xr.DataArray(\n    data=SDUC_UC04_8conn,\n    dims=BTU_da.dims,\n    coords=BTU_da.coords,\n    name='semidense_urban_cluster',\n    )\n\nSDUC_UC05=SDUC_UC05.astype(np.int16)\nSDUC_UC05","visibility":"show","key":"M6w3cFvONh"},{"type":"output","id":"pQD0qVm8FTdFyWP38Q11k","data":[{"output_type":"execute_result","execution_count":65,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=dark],\nbody[data-theme=dark],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1F1F1F;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 20px 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: none;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: '►';\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: '▼';\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: '(';\n}\n\n.xr-dim-list:after {\n  content: ')';\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: ',';\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;semidense_urban_cluster&#x27; (y: 831, x: 1266)&gt;\narray([[0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       ...,\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0]], dtype=int16)\nCoordinates:\n  * x            (x) float64 7.085e+05 7.095e+05 ... 1.972e+06 1.974e+06\n  * y            (y) float64 6.386e+06 6.386e+06 ... 5.558e+06 5.556e+06\n    spatial_ref  int64 0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'semidense_urban_cluster'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 831</li><li><span class='xr-has-index'>x</span>: 1266</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-481fa5c4-8e5c-4eb3-9b96-6bf6950ec66e' class='xr-array-in' type='checkbox' checked><label for='section-481fa5c4-8e5c-4eb3-9b96-6bf6950ec66e' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></div><div class='xr-array-data'><pre>array([[0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       ...,\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0]], dtype=int16)</pre></div></div></li><li class='xr-section-item'><input id='section-fae04f4f-c09f-4951-baca-262e42a4f0a0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fae04f4f-c09f-4951-baca-262e42a4f0a0' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>7.085e+05 7.095e+05 ... 1.974e+06</div><input id='attrs-0731a833-1e06-461e-836f-390155bfd5f6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0731a833-1e06-461e-836f-390155bfd5f6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cc330ce5-ac9a-4935-9527-1c388a38202e' class='xr-var-data-in' type='checkbox'><label for='data-cc330ce5-ac9a-4935-9527-1c388a38202e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>x coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd></dl></div><div class='xr-var-data'><pre>array([ 708500.,  709500.,  710500., ..., 1971500., 1972500., 1973500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>6.386e+06 6.386e+06 ... 5.556e+06</div><input id='attrs-cf97d94f-5808-49b2-9f84-6a48c0913504' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cf97d94f-5808-49b2-9f84-6a48c0913504' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2123c53d-43c8-4727-9f54-d2df3f0ed753' class='xr-var-data-in' type='checkbox'><label for='data-2123c53d-43c8-4727-9f54-d2df3f0ed753' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>y coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd><dt><span>units :</span></dt><dd>metre</dd></dl></div><div class='xr-var-data'><pre>array([6386500., 6385500., 6384500., ..., 5558500., 5557500., 5556500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-508c0e85-f5ff-43e4-8133-e102637a8130' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-508c0e85-f5ff-43e4-8133-e102637a8130' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7c8d3183-8aad-4227-88d0-2ca18868e8dd' class='xr-var-data-in' type='checkbox'><label for='data-7c8d3183-8aad-4227-88d0-2ca18868e8dd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>PROJCS[&quot;World_Mollweide&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;Degree&quot;,0.0174532925199433]],PROJECTION[&quot;Mollweide&quot;],PARAMETER[&quot;central_meridian&quot;,0],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH]]</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS[&quot;World_Mollweide&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;Degree&quot;,0.0174532925199433]],PROJECTION[&quot;Mollweide&quot;],PARAMETER[&quot;central_meridian&quot;,0],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH]]</dd><dt><span>GeoTransform :</span></dt><dd>708000.0 1000.0 0.0 6387000.0 0.0 -1000.0</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-44e36591-06f6-4682-8ea3-d29d4856ec36' class='xr-section-summary-in' type='checkbox'  ><label for='section-44e36591-06f6-4682-8ea3-d29d4856ec36' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1460d39e-8962-41e9-a059-36113aba29ae' class='xr-index-data-in' type='checkbox'/><label for='index-1460d39e-8962-41e9-a059-36113aba29ae' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([ 708500.0,  709500.0,  710500.0,  711500.0,  712500.0,  713500.0,\n               714500.0,  715500.0,  716500.0,  717500.0,\n              ...\n              1964500.0, 1965500.0, 1966500.0, 1967500.0, 1968500.0, 1969500.0,\n              1970500.0, 1971500.0, 1972500.0, 1973500.0],\n             dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=1266))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-8e6043b9-3b78-4a5f-b7fb-4592a4e6e5ca' class='xr-index-data-in' type='checkbox'/><label for='index-8e6043b9-3b78-4a5f-b7fb-4592a4e6e5ca' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([6386500.0, 6385500.0, 6384500.0, 6383500.0, 6382500.0, 6381500.0,\n              6380500.0, 6379500.0, 6378500.0, 6377500.0,\n              ...\n              5565500.0, 5564500.0, 5563500.0, 5562500.0, 5561500.0, 5560500.0,\n              5559500.0, 5558500.0, 5557500.0, 5556500.0],\n             dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=831))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1f3207a3-2118-4600-bfcd-d0cfa47ee712' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1f3207a3-2118-4600-bfcd-d0cfa47ee712' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray 'semidense_urban_cluster' (y: 831, x: 1266)>\narray([[0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       ...,\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0],\n       [0, 0, 0, ..., 0, 0, 0]], dtype=int16)\nCoordinates:\n  * x            (x) float64 7.085e+05 7.095e+05 ... 1.972e+06 1.974e+06\n  * y            (y) float64 6.386e+06 6.386e+06 ... 5.558e+06 5.556e+06\n    spatial_ref  int64 0","content_type":"text/plain"}}}],"visibility":"show","key":"AIogirUJGD"}],"visibility":"show","key":"WmGdumnkSf"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.099814,"end_time":"2023-03-22T13:00:14.333341","exception":false,"start_time":"2023-03-22T13:00:14.233527","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"SDUC: export to vector","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y2nkGjDyLs"}],"key":"rwKok80Jff"}],"visibility":"show","key":"ZLiIcTpbMn"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:00:14.526185Z","iopub.status.busy":"2023-03-22T13:00:14.525087Z","iopub.status.idle":"2023-03-22T13:00:14.664113Z","shell.execute_reply":"2023-03-22T13:00:14.662923Z"},"papermill":{"duration":0.242196,"end_time":"2023-03-22T13:00:14.668154","exception":false,"start_time":"2023-03-22T13:00:14.425958","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# mask=None\nmask=SDUC_UC05.data != 0\nwith SDUC_UC05 as src:\n    image = src.data # first band\n    results = (\n    {'properties': {'raster_val': v}, 'geometry': s}\n    for i, (s, v) \n    in enumerate(\n        shapes(image, mask=mask, connectivity=8, transform=SDUC_UC05.rio.transform())))\n\ngeoms = list(results)\n# first feature\n# print(geoms[0])","visibility":"show","key":"OOaK7R9dnB"},{"type":"output","id":"PTUhgdw_cq7PxF7Tw3TnL","data":[],"visibility":"show","key":"h1Wg3GvPLL"}],"visibility":"show","key":"ssRyOLEIAF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:00:14.926053Z","iopub.status.busy":"2023-03-22T13:00:14.924479Z","iopub.status.idle":"2023-03-22T13:00:15.279777Z","shell.execute_reply":"2023-03-22T13:00:15.277960Z"},"papermill":{"duration":0.483065,"end_time":"2023-03-22T13:00:15.283475","exception":false,"start_time":"2023-03-22T13:00:14.800410","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"SDUC_SemiDenseUrbanCluster_temp  = gpd.GeoDataFrame.from_features(geoms)\nSDUC_SemiDenseUrbanCluster_temp.crs=SDUC_UC05.rio.crs\nSDUC_SemiDenseUrbanCluster_temp.raster_val=SDUC_SemiDenseUrbanCluster_temp.raster_val.astype('int')\nSDUC_SemiDenseUrbanCluster_temp.rename(columns={'raster_val':'sducid'}, inplace=True)\nSDUC_SemiDenseUrbanCluster_temp['code']=22","visibility":"show","key":"wYKaLkRPCT"},{"type":"output","id":"qQ67MF7o7uuW0btXu5vHy","data":[],"visibility":"show","key":"wkx7JpN1pZ"}],"visibility":"show","key":"a8W1uQRBc7"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:00:15.484392Z","iopub.status.busy":"2023-03-22T13:00:15.483738Z","iopub.status.idle":"2023-03-22T13:00:16.494041Z","shell.execute_reply":"2023-03-22T13:00:16.492384Z"},"papermill":{"duration":1.114568,"end_time":"2023-03-22T13:00:16.503393","exception":false,"start_time":"2023-03-22T13:00:15.388825","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# HDC & DUC - BUFFER 3km \nres_union_buffer = gpd.overlay(HDC_UrbanCentre[['geometry']], DUC_DenseUrbanCluster[['geometry']], how='union',keep_geom_type=True).buffer(3000).unary_union\n\nres_union_buffer =gpd.GeoSeries(res_union_buffer)\nres_union_buffer = gpd.GeoDataFrame(geometry=gpd.GeoSeries(res_union_buffer))\nres_union_buffer.crs=HDC_UrbanCentre.crs\nres_union_buffer[['buff3']]=1","visibility":"show","key":"Qeez441Rgk"},{"type":"output","id":"-HS63xpHo8x9aFrM9hLYR","data":[],"visibility":"show","key":"UhAfU32gM1"}],"visibility":"show","key":"UMZJXrDGqf"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:00:16.711133Z","iopub.status.busy":"2023-03-22T13:00:16.710300Z","iopub.status.idle":"2023-03-22T13:00:20.421769Z","shell.execute_reply":"2023-03-22T13:00:20.419263Z"},"papermill":{"duration":3.823307,"end_time":"2023-03-22T13:00:20.427926","exception":false,"start_time":"2023-03-22T13:00:16.604619","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# sjoin with buffer\nSDUC_SemiDenseUrbanCluster_temp = gpd.sjoin(SDUC_SemiDenseUrbanCluster_temp, res_union_buffer[['buff3', 'geometry']], how='left',predicate='intersects')\nSDUC_SemiDenseUrbanCluster_temp.drop(columns =['index_right'],inplace=True)\nSDUC_SemiDenseUrbanCluster_temp['code'] = np.where(SDUC_SemiDenseUrbanCluster_temp['buff3'] == 1, 21, 22)\n# print(SDUC_SemiDenseUrbanCluster_temp.tail(2))","visibility":"show","key":"CdBESABD7w"},{"type":"output","id":"3fLREy3vyJ1SniAZKcdEy","data":[],"visibility":"show","key":"irpIcpdXJE"}],"visibility":"show","key":"F8yths3uxC"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:00:20.710165Z","iopub.status.busy":"2023-03-22T13:00:20.709613Z","iopub.status.idle":"2023-03-22T13:00:20.740567Z","shell.execute_reply":"2023-03-22T13:00:20.738776Z"},"papermill":{"duration":0.168632,"end_time":"2023-03-22T13:00:20.744101","exception":false,"start_time":"2023-03-22T13:00:20.575469","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# SDUC_SemiDenseUrbanCluster\nSDUC_SemiDenseUrbanCluster = SDUC_SemiDenseUrbanCluster_temp[SDUC_SemiDenseUrbanCluster_temp.code == 22].drop(columns=['buff3'])","visibility":"show","key":"AshZavcOtE"},{"type":"output","id":"iDTM7pqOOk2sykzVJn32l","data":[],"visibility":"show","key":"LufSLlLRzr"}],"visibility":"show","key":"SMHJkHuCue"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.129809,"end_time":"2023-03-22T13:00:21.037309","exception":false,"start_time":"2023-03-22T13:00:20.907500","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"step3: Peri-Urban Cluster (PUC)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EQhGGjSQV7"}],"identifier":"step3-peri-urban-cluster-puc","label":"step3: Peri-Urban Cluster (PUC)","html_id":"step3-peri-urban-cluster-puc","implicit":true,"key":"kFF3jag1hC"}],"visibility":"show","key":"IU0qPTuuUP"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:00:21.275326Z","iopub.status.busy":"2023-03-22T13:00:21.274867Z","iopub.status.idle":"2023-03-22T13:00:21.300853Z","shell.execute_reply":"2023-03-22T13:00:21.297330Z"},"papermill":{"duration":0.133349,"end_time":"2023-03-22T13:00:21.304346","exception":false,"start_time":"2023-03-22T13:00:21.170997","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# PUC_PeriUrbanCluster\nPUC_PeriUrbanCluster = SDUC_SemiDenseUrbanCluster_temp[SDUC_SemiDenseUrbanCluster_temp.code == 21].drop(columns=['buff3'])\nPUC_PeriUrbanCluster.rename(columns={'sducid':'pucid'},inplace=True)","visibility":"show","key":"Ye4A0sl4kh"},{"type":"output","id":"W-oFGUbA5rry_EzE68S1m","data":[],"visibility":"show","key":"cRJZoFD11m"}],"visibility":"show","key":"toRdQwv0Av"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.119409,"end_time":"2023-03-22T13:00:21.538637","exception":false,"start_time":"2023-03-22T13:00:21.419228","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"DUC, SDUC and PUC export to shapefile","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fm15eTiRUi"}],"identifier":"duc-sduc-and-puc-export-to-shapefile","label":"DUC, SDUC and PUC export to shapefile","html_id":"duc-sduc-and-puc-export-to-shapefile","implicit":true,"key":"rgJ3MxVknA"}],"visibility":"show","key":"bM7cSmiTBX"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.113461,"end_time":"2023-03-22T13:00:21.759059","exception":false,"start_time":"2023-03-22T13:00:21.645598","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"DUC: export to shapefile","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fQWoqnUhRd"}],"key":"KFHy9rr6rH"}],"visibility":"show","key":"MXCszf9mgY"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:00:21.996105Z","iopub.status.busy":"2023-03-22T13:00:21.995539Z","iopub.status.idle":"2023-03-22T13:00:22.264120Z","shell.execute_reply":"2023-03-22T13:00:22.261452Z"},"papermill":{"duration":0.394253,"end_time":"2023-03-22T13:00:22.268371","exception":false,"start_time":"2023-03-22T13:00:21.874118","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# EXPORT 2 shapefile World Mollweide (ESRI:54009)\nDUC_DenseUrbanCluster.to_file(os.path.join(os.path.realpath('GHSL_results'),'DUC_DenseUrbanCluster_'+str(REFyear)+'.shp'))\n\n# Export to shapefile WGS84 (EPSG:4326 )\n# DUC_DenseUrbanCluster.to_crs(epsg=4326).to_file(os.path.join(os.path.realpath('GHSL_results'),'DUC_DenseUrbanCluster_4326_'+str(REFyear)+'.shp'))","visibility":"show","key":"zgaHHHkUCI"},{"type":"output","id":"HMd4hdCLa0BjfJ7fzNAUO","data":[],"visibility":"show","key":"DbFCnBvAY1"}],"visibility":"show","key":"LB2xMkOzZO"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.109943,"end_time":"2023-03-22T13:00:22.484341","exception":false,"start_time":"2023-03-22T13:00:22.374398","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"SDUC: export to shapefile","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mavQj2k0A8"}],"key":"UuxzwIgetx"}],"visibility":"show","key":"qVqEDWc5vD"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:00:22.762773Z","iopub.status.busy":"2023-03-22T13:00:22.762200Z","iopub.status.idle":"2023-03-22T13:00:23.037896Z","shell.execute_reply":"2023-03-22T13:00:23.036593Z"},"papermill":{"duration":0.419933,"end_time":"2023-03-22T13:00:23.041029","exception":false,"start_time":"2023-03-22T13:00:22.621096","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# EXPORT 2 shapefile World Mollweide (ESRI:54009)\nSDUC_SemiDenseUrbanCluster.to_file(os.path.join(os.path.realpath('GHSL_results'),'SDUC_SemiDenseUrbanCluster_'+str(REFyear)+'.shp'))\n\n# Export to shapefile WGS84 (EPSG:4326 )\n# SDUC_SemiDenseUrbanCluster.to_crs(epsg=4326).to_file(os.path.join(os.path.realpath('GHSL_results'),'SDUC_SemiDenseUrbanCluster_4326_'+str(REFyear)+'.shp'))","visibility":"show","key":"zyWr0xkYEM"},{"type":"output","id":"HEtKXlZhjQit7Kp0idPx2","data":[],"visibility":"show","key":"Tm32WNXYxl"}],"visibility":"show","key":"FMP4HeyqnO"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.114041,"end_time":"2023-03-22T13:00:23.268820","exception":false,"start_time":"2023-03-22T13:00:23.154779","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"PUC: export to shapefile","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"im2RzORpzU"}],"key":"qiUifgtlmv"}],"visibility":"show","key":"axLSNpRicX"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:00:23.504356Z","iopub.status.busy":"2023-03-22T13:00:23.502233Z","iopub.status.idle":"2023-03-22T13:00:24.404234Z","shell.execute_reply":"2023-03-22T13:00:24.400472Z"},"papermill":{"duration":1.013696,"end_time":"2023-03-22T13:00:24.410151","exception":false,"start_time":"2023-03-22T13:00:23.396455","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# EXPORT 2 shapefile World Mollweide (ESRI:54009)\nPUC_PeriUrbanCluster.to_file(os.path.join(os.path.realpath('GHSL_results'),'PUC_PeriUrbanCluster_'+str(REFyear)+'.shp'))\n\n# Export to shapefile WGS84 (EPSG:4326 )\n# PUC_PeriUrbanCluster.to_crs(epsg=4326).to_file(os.path.join(os.path.realpath('GHSL_results'),'PUC_PeriUrbanCluster_4326'+str(REFyear)+'.shp'))","visibility":"show","key":"h3d5L0i7tk"},{"type":"output","id":"SZD6bZ5HEdUHqiTa6njW1","data":[],"visibility":"show","key":"NMO0Js0zEK"}],"visibility":"show","key":"fJZLHvikXv"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.210484,"end_time":"2023-03-22T13:00:24.814907","exception":false,"start_time":"2023-03-22T13:00:24.604423","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"L2: Visualization of results","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HgyyxVmkVs"}],"identifier":"l2-visualization-of-results","label":"L2: Visualization of results","html_id":"l2-visualization-of-results","implicit":true,"key":"E1NWHlucWs"}],"visibility":"show","key":"ddId2JTZRY"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:00:25.133011Z","iopub.status.busy":"2023-03-22T13:00:25.132230Z","iopub.status.idle":"2023-03-22T13:00:29.316712Z","shell.execute_reply":"2023-03-22T13:00:29.314145Z"},"papermill":{"duration":4.474481,"end_time":"2023-03-22T13:00:29.461149","exception":false,"start_time":"2023-03-22T13:00:24.986668","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = Figure(width=600, height=600)\n\nm = AOI54009.explore(style_kwds={'fillColor':'None','color':'blue','weight': 1}, name='aoi')\n\n# parallels:\nfor lat in range(-90, 91, lat_interval):\n     folium.PolyLine([[lat, -180],[lat, 180]], weight=0.5).add_to(m)\n# meridianss:\nfor lon in range(-180, 181, lon_interval):\n    folium.PolyLine([[-90, lon],[90, lon]], weight=0.5).add_to(m)\n\nPUC_PeriUrbanCluster.explore(m=m,style_kwds={'fillColor':'yellow','color':'yellow','weight': 1.5}, name='PUC_PeriUrbanCluster')\nSDUC_SemiDenseUrbanCluster.explore(m=m,style_kwds={'fillColor':'darkgoldenrod','color':'darkgoldenrod','weight': 1.5}, name='SDUC_SemiDenseUrbanCluster')\nDUC_DenseUrbanCluster.explore(m=m,style_kwds={'fillColor':'brown','color':'brown','weight': 1.5}, name='DUC_DenseUrbanCluster')\n\nMDC_UrbanCluster.explore(m=m,style_kwds={'fillColor':'orange','color':'orange','weight': 1}, name='MDC_UrbanCluster', show = False)\nHDC_UrbanCentre.explore(m=m,style_kwds={'fillColor':'red','color':'red','weight': 1.5}, name='HDC_UrbanCentre')\n\nfolium.LayerControl('topright',collapsed=True).add_to(m)\nminimap = plugins.MiniMap(height=90, width=90, zoom_level_offset=-7)\nm.add_child(minimap)\n\nfig.add_child(m)\nm","visibility":"show","key":"j23aQEf0wY"},{"type":"output","id":"F9eOnDGR_UlDTcnH2BbNq","data":[{"output_type":"execute_result","execution_count":75,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"eb88ed0d8a2c9e0eebb122c3a0ad56a1","path":"/notebooks_test/build/eb88ed0d8a2c9e0eebb122c3a0ad56a1.html"},"text/plain":{"content":"<folium.folium.Map at 0x7f7e2abaef70>","content_type":"text/plain"}}}],"visibility":"show","key":"rDkRo0VNqj"}],"visibility":"show","key":"zuB5BU7WUj"},{"type":"block","kind":"notebook-code","data":{"papermill":{"duration":0.250087,"end_time":"2023-03-22T13:00:29.966207","exception":false,"start_time":"2023-03-22T13:00:29.716120","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"","visibility":"show","key":"gtXvgAbyVu"},{"type":"output","id":"qFaeiTjdaPOCPCilXyDKm","data":[],"visibility":"show","key":"Va3AYgOGr0"}],"visibility":"show","key":"hW0pZEJsKR"},{"type":"block","kind":"notebook-code","data":{"papermill":{"duration":0.290576,"end_time":"2023-03-22T13:00:30.502573","exception":false,"start_time":"2023-03-22T13:00:30.211997","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"","visibility":"show","key":"fxB3OE1c5M"},{"type":"output","id":"UREC2j7Fbgp4vDuZZzd2G","data":[],"visibility":"show","key":"RiL4OsZlD1"}],"visibility":"show","key":"QZDBbHDWAp"}],"key":"kS0I7NfmE3"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Crop-classification using Sentinel-2 time-series","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/eurocrops-crop-classification-example","group":"Contributions"},"next":{"title":"Pre-requisites","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/globalearthmonitor-example","group":"Contributions"}}},"domain":"http://localhost:3000"}