{"version":1,"kind":"Notebook","sha256":"cd5dc62bb13c17b39b408da08c32ab61f408fa5a841806bd0b9f306dd9e6549e","slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-geodb-4-eurocrops-demo","location":"/external_notebooks/eurodatacube/notebooks/notebooks/contributions/EDC_GeoDB_4_eurocrops_demo.ipynb","dependencies":[],"frontmatter":{"title":"Demonstration of Eurocrops data use in geoDB","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"github":"https://github.com/eoxhub-workspaces/documentation/","numbering":{"title":{"offset":5}},"edit_url":"https://github.com/eoxhub-workspaces/documentation//blob/main/external_notebooks/eurodatacube/notebooks/notebooks/contributions/EDC_GeoDB_4_eurocrops_demo.ipynb","exports":[{"format":"ipynb","filename":"EDC_GeoDB_4_eurocrops_demo.ipynb","url":"/notebooks_test/build/EDC_GeoDB_4_eurocrop-ca9b6a683aa69adb6ffe58064c617abe.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"collapsed":true,"execution":{"iopub.execute_input":"2023-03-22T12:54:18.302023Z","iopub.status.busy":"2023-03-22T12:54:18.301421Z","iopub.status.idle":"2023-03-22T12:54:18.427486Z","shell.execute_reply":"2023-03-22T12:54:18.426200Z"},"papermill":{"duration":0.139611,"end_time":"2023-03-22T12:54:18.431875","exception":false,"start_time":"2023-03-22T12:54:18.292264","status":"completed"},"pycharm":{"name":"#%%\n"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from edc import check_compatibility\ncheck_compatibility(\"user-2023.03-02\", dependencies=[\"GEODB\"])","visibility":"show","key":"CgllGaf3cY"},{"type":"output","id":"EGCC9ksYdE9VwDeFdFwWh","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<script type=\"text/javascript\">\n        function toggle(id) {\n            el = document.getElementById(id);\n            el.style.display = el.style.display === \"none\" ? \"block\" : \"none\";\n        }\n    </script>","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"This notebook is compatible with this base image version (user-2023.03-02).","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/markdown":{"content":"\n\n---------\n\nThe following environment variables are available:\n\n* `GEODB_AUTH_AUD`, `GEODB_AUTH_CLIENT_ID`, `GEODB_AUTH_DOMAIN`, `GEODB_API_SERVER_URL`, `GEODB_AUTH_CLIENT_SECRET`, `GEODB_API_SERVER_PORT`\n","content_type":"text/markdown"},"text/plain":{"content":"<IPython.core.display.Markdown object>","content_type":"text/plain"}}}],"visibility":"show","key":"hot8ayxUQK"}],"visibility":"show","key":"Aa1BiS2mUD"},{"type":"block","kind":"notebook-content","data":{"collapsed":false,"papermill":{"duration":0.013719,"end_time":"2023-03-22T12:54:18.454781","exception":false,"start_time":"2023-03-22T12:54:18.441062","status":"completed"},"pycharm":{"name":"#%% md\n"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demonstration of Eurocrops data use in geoDB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pQiQUQN1qk"}],"identifier":"demonstration-of-eurocrops-data-use-in-geodb","label":"Demonstration of Eurocrops data use in geoDB","html_id":"demonstration-of-eurocrops-data-use-in-geodb","implicit":true,"key":"phMN0ZHowL"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This notebook demonstrates how the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hslGVhpZOr"},{"type":"link","url":"https://github.com/maja601/EuroCrops","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Eurocrops","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oj8xLShGHK"}],"urlSource":"https://github.com/maja601/EuroCrops","error":true,"key":"jIJa1laVtk"},{"type":"text","value":" data can be used for analysis, using the geoDB.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mGNOsGapr7"}],"key":"vnvmUo3wvg"}],"visibility":"show","key":"PlxRm4pxJC"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"execution":{"iopub.execute_input":"2023-03-22T12:54:18.469176Z","iopub.status.busy":"2023-03-22T12:54:18.467714Z","iopub.status.idle":"2023-03-22T12:54:19.351276Z","shell.execute_reply":"2023-03-22T12:54:19.348010Z"},"papermill":{"duration":0.895674,"end_time":"2023-03-22T12:54:19.356639","exception":false,"start_time":"2023-03-22T12:54:18.460965","status":"completed"},"pycharm":{"name":"#%%\n"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from xcube_geodb.core.geodb import GeoDBClient\nimport time\n\ngeodb = GeoDBClient()","visibility":"show","key":"bFufsLFpta"},{"type":"output","id":"v2Q7rsNNm9akdu7SEofHd","data":[],"visibility":"show","key":"kQxS4mx50d"}],"visibility":"show","key":"jaqgzRzpBk"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"execution":{"iopub.execute_input":"2023-03-22T12:54:19.374495Z","iopub.status.busy":"2023-03-22T12:54:19.373748Z","iopub.status.idle":"2023-03-22T12:54:19.382140Z","shell.execute_reply":"2023-03-22T12:54:19.379763Z"},"papermill":{"duration":0.02288,"end_time":"2023-03-22T12:54:19.387288","exception":false,"start_time":"2023-03-22T12:54:19.364408","status":"completed"},"pycharm":{"name":"#%%\n"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Setting the database name; this database contains the Eurocrops data collections\ndb = 'geodb_b34bfae7-9265-4a3e-b921-06549d3c6035'","visibility":"show","key":"St0af9i17u"},{"type":"output","id":"3SrystfBkGEoRVr6sGgSg","data":[],"visibility":"show","key":"VmdQlGehNC"}],"visibility":"show","key":"gxm8x86jE3"},{"type":"block","kind":"notebook-content","data":{"collapsed":false,"papermill":{"duration":0.004361,"end_time":"2023-03-22T12:54:19.396460","exception":false,"start_time":"2023-03-22T12:54:19.392099","status":"completed"},"pycharm":{"name":"#%% md\n"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo #1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ntZKGPiBs1"}],"identifier":"demo-1","label":"Demo #1","html_id":"demo-1","implicit":true,"key":"CLIbiUdKdt"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This step computes the area growing wheat in NRW (Germany), and measures the time needed to do that. Within the collection ‘DE_NRW_2021_EC21’, the crop types are identified by different codes stored in the column ‘code’; the values 112 and 115 identify wheat, therefore the respective query is ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ymaXabjgvz"},{"type":"inlineCode","value":"'or=(code.eq.112,code.eq.115)'","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"VTqLHkN485"},{"type":"text","value":". The sizes of the fields are stored in the column ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"CMJlnVmbLw"},{"type":"inlineCode","value":"'area_ha'","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"W3ISCjeH1T"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hvkoilwmKk"}],"key":"ARoS30TPnp"}],"visibility":"show","key":"eEAEmXbALm"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"execution":{"iopub.execute_input":"2023-03-22T12:54:19.415519Z","iopub.status.busy":"2023-03-22T12:54:19.414932Z","iopub.status.idle":"2023-03-22T12:54:38.324889Z","shell.execute_reply":"2023-03-22T12:54:38.323405Z"},"papermill":{"duration":18.926674,"end_time":"2023-03-22T12:54:38.328787","exception":false,"start_time":"2023-03-22T12:54:19.402113","status":"completed"},"pycharm":{"name":"#%%\n"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"tic = time.perf_counter()\ndf = geodb.get_collection('DE_NRW_2021_EC21', query='or=(code.eq.112,code.eq.115)', database=db)\narea_acc = df['area_ha'].sum()\ntoc = time.perf_counter()\nprint(f\"Computed the area growing wheat in NRW (Germany): {area_acc:0.0f} ha, within {toc - tic} seconds\")","visibility":"show","key":"foTJxXQjwc"},{"type":"output","id":"qdiUMTmPImDb7dQoCdInC","data":[{"name":"stdout","output_type":"stream","text":"Computed the area growing wheat in NRW (Germany): 226049 ha, within 18.902114251992316 seconds\n"}],"visibility":"show","key":"NVeIZ8PGnW"}],"visibility":"show","key":"G4CuN1053c"},{"type":"block","kind":"notebook-content","data":{"collapsed":false,"papermill":{"duration":0.008283,"end_time":"2023-03-22T12:54:38.344240","exception":false,"start_time":"2023-03-22T12:54:38.335957","status":"completed"},"pycharm":{"name":"#%% md\n"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo #2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"owNBnqSqOH"}],"identifier":"demo-2","label":"Demo #2","html_id":"demo-2","implicit":true,"key":"mMeufz2nM6"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This step computes the area growing wheat in Belgium, and measures the time needed to do that. Within the collection ‘BE_VLG_2021_EC21’, the crop types are identified by different codes stored in the column ‘gwscod_h’; the values 311 and 312 identify wheat, therefore the respective query is ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"UqC9GkD8zQ"},{"type":"inlineCode","value":"'or=(gwscod_h.eq.311,gwscod_h.eq.312)'","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"LC8U5dnhCP"},{"type":"text","value":". The sizes of the fields are stored in the column ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ELRXuaMUJX"},{"type":"inlineCode","value":"'graf_opp'","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"K7cKf9OoTo"}],"key":"VP6uKXWs66"}],"visibility":"show","key":"fSio09cV3D"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"execution":{"iopub.execute_input":"2023-03-22T12:54:38.361733Z","iopub.status.busy":"2023-03-22T12:54:38.361283Z","iopub.status.idle":"2023-03-22T12:54:45.204368Z","shell.execute_reply":"2023-03-22T12:54:45.202928Z"},"papermill":{"duration":6.856421,"end_time":"2023-03-22T12:54:45.208210","exception":false,"start_time":"2023-03-22T12:54:38.351789","status":"completed"},"pycharm":{"name":"#%%\n"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"tic = time.perf_counter()\ndf = geodb.get_collection('BE_VLG_2021_EC21', query='or=(gwscod_h.eq.311,gwscod_h.eq.312)', database=db)\narea_acc = df['graf_opp'].sum()\ntoc = time.perf_counter()\nprint(f\"Computed the area growing wheat in Belgium (VLG): {area_acc:0.0f} ha, within {toc - tic} seconds\")","visibility":"show","key":"P3Ajyzp8hI"},{"type":"output","id":"nRJGGdumi-BI_ZBKFLWSU","data":[{"name":"stdout","output_type":"stream","text":"Computed the area growing wheat in Belgium (VLG): 71014 ha, within 6.835164927993901 seconds\n"}],"visibility":"show","key":"R5r4njRl1f"}],"visibility":"show","key":"oalTZFLVDp"},{"type":"block","kind":"notebook-content","data":{"collapsed":false,"papermill":{"duration":0.004687,"end_time":"2023-03-22T12:54:45.217460","exception":false,"start_time":"2023-03-22T12:54:45.212773","status":"completed"},"pycharm":{"name":"#%% md\n"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo #3","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B1heNahfel"}],"identifier":"demo-3","label":"Demo #3","html_id":"demo-3","implicit":true,"key":"M2N6fvACTr"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This step extracts 1000 fields growing wheat in Austria. Within the collection ‘AT_2021_EC21’, the crop types are identified by different codes stored in the column ‘snar_code’; the values 140, 168 and 170 identify wheat, and the column ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"S7HZFHY6Mk"},{"type":"inlineCode","value":"'sl_flaeche'","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"D3VYFUhH5w"},{"type":"text","value":" stores the sizes of the fields.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"YEygv7yBXa"}],"key":"m3h9KsCCoL"}],"visibility":"show","key":"lwMWGW1Ugu"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"execution":{"iopub.execute_input":"2023-03-22T12:54:45.304077Z","iopub.status.busy":"2023-03-22T12:54:45.302974Z","iopub.status.idle":"2023-03-22T12:55:23.985919Z","shell.execute_reply":"2023-03-22T12:55:23.983823Z"},"papermill":{"duration":38.707864,"end_time":"2023-03-22T12:55:23.993605","exception":false,"start_time":"2023-03-22T12:54:45.285741","status":"completed"},"pycharm":{"name":"#%%\n"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"tic = time.perf_counter()\ndf = geodb.get_collection('AT_2021_EC21', query='and=(or(snar_code.eq.140,snar_code.eq.168,snar_code.eq.170),sl_flaeche.gt.1)', database=db, limit=1000)\ntoc = time.perf_counter()\nprint(f\"Extracted 1000 areas in Austria growing wheat, larger than 1 ha, within {toc - tic} seconds\")","visibility":"show","key":"AnNIFaO9kz"},{"type":"output","id":"P9Sq_uAr8TASpzW-KSdR5","data":[{"name":"stdout","output_type":"stream","text":"Extracted 1000 areas in Austria growing wheat, larger than 1 ha, within 38.67284113999631 seconds\n"}],"visibility":"show","key":"yWFUv90JmT"}],"visibility":"show","key":"Ws3bPhQeSf"}],"key":"VQxl7kYXyi"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"xcube-gen and xcube-geodb Hands-On Workshop Φ-Week 2020","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/edc-demo-phi-week-v2","group":"Contributions"},"next":{"title":"South Africa Crop Type Classification on Euro Data Cube (EDC)","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/edc-notebook-lstm","group":"Contributions"}}},"domain":"http://localhost:3000"}