{"version":1,"kind":"Notebook","sha256":"9a136c8bbe72206165f7a5fd824930dfb37ddba569a1f1bd39f1c7132abda0e3","slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-lockdown-in-venice","location":"/external_notebooks/eurodatacube/notebooks/notebooks/contributions/IGARSS2022/IGARSS-22_Lockdown_in_Venice.ipynb","dependencies":[],"frontmatter":{"title":"Environmental Impacts of Lockdown in Venice, Italy during 2020","content_includes_title":true,"kernelspec":{"name":"conda-env-edc-default-2022.07-00-py","display_name":"python3 (edc-default-2022.07-00)","language":"python"},"github":"https://github.com/eoxhub-workspaces/documentation/","numbering":{"title":{"offset":5}},"edit_url":"https://github.com/eoxhub-workspaces/documentation//blob/main/external_notebooks/eurodatacube/notebooks/notebooks/contributions/IGARSS2022/IGARSS-22_Lockdown_in_Venice.ipynb","exports":[{"format":"ipynb","filename":"IGARSS-22_Lockdown_in_Venice.ipynb","url":"/notebooks_test/build/IGARSS-22_Lockdown_i-7ab33da4ac998e35e2fc9cb0e1547b7f.ipynb"}]},"widgets":{"application/vnd.jupyter.widget-state+json":{"state":{"0fb8139e441c4c4492b5fe9ea450d5e9":{"model_module":"jupyter-leaflet","model_module_version":"^0.17","model_name":"LeafletSplitMapControlModel","state":{"_model_module":"jupyter-leaflet","_model_module_version":"^0.17","_model_name":"LeafletSplitMapControlModel","_view_count":null,"_view_module":"jupyter-leaflet","_view_module_version":"^0.17","_view_name":"LeafletSplitMapControlView","left_layer":"IPY_MODEL_53dbed71f0214728b307d21ac340e880","options":["position"],"position":"topleft","right_layer":"IPY_MODEL_b78b1d47a72343f8911f434a05817d35"}},"112b0453a73b4855948e3f1d8313c705":{"model_module":"jupyter-leaflet","model_module_version":"^0.17","model_name":"LeafletZoomControlModel","state":{"_model_module":"jupyter-leaflet","_model_module_version":"^0.17","_model_name":"LeafletZoomControlModel","_view_count":null,"_view_module":"jupyter-leaflet","_view_module_version":"^0.17","_view_name":"LeafletZoomControlView","options":["position","zoom_in_text","zoom_in_title","zoom_out_text","zoom_out_title"],"position":"topleft","zoom_in_text":"+","zoom_in_title":"Zoom in","zoom_out_text":"-","zoom_out_title":"Zoom out"}},"209e60efc97f4ba88d169598d130ae20":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"224339cdebbe417a88e9864419c2613d":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"27f10d097e864e3dab4fb7c59b8472b5":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"TextView","continuous_update":true,"description":"city","description_allow_html":false,"disabled":false,"layout":"IPY_MODEL_224339cdebbe417a88e9864419c2613d","placeholder":"​","style":"IPY_MODEL_8a2b4f4267d34539924d05f4b8417c46","tabbable":null,"tooltip":null,"value":"Venice Lagoon"}},"3d955379a017496d83a8a6aed5da93f7":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4b9b75ac4e6e413ea35c5cfa2e7977d3":{"model_module":"jupyter-leaflet","model_module_version":"^0.17","model_name":"LeafletMapStyleModel","state":{"_model_module":"jupyter-leaflet","_model_module_version":"^0.17","_model_name":"LeafletMapStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","cursor":"grab"}},"527f01baf3cc437fa5a2a34ad60b4192":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/output","_model_module_version":"1.0.0","_model_name":"OutputModel","_view_count":null,"_view_module":"@jupyter-widgets/output","_view_module_version":"1.0.0","_view_name":"OutputView","layout":"IPY_MODEL_f312c99cc9554adf8eabb6c8483d4e36","msg_id":"","outputs":[{"data":{"text/html":"\n  <div class=\"bk-root\" id=\"d0cb0322-1f4a-4bfb-8887-ef37528f87b8\" data-root-id=\"1004\"></div>\n"},"metadata":{},"output_type":"display_data"},{"data":{"application/javascript":"(function(root) {\n  function embed_document(root) {\n  const docs_json = {\"e1ff4190-4b76-4501-82f9-3e2784016e6d\":{\"defs\":[],\"roots\":{\"references\":[{\"attributes\":{\"below\":[{\"id\":\"1013\"}],\"center\":[{\"id\":\"1016\"},{\"id\":\"1020\"},{\"id\":\"1069\"}],\"left\":[{\"id\":\"1017\"}],\"renderers\":[{\"id\":\"1044\"}],\"title\":{\"id\":\"1035\"},\"toolbar\":{\"id\":\"1028\"},\"width\":800,\"x_range\":{\"id\":\"1005\"},\"x_scale\":{\"id\":\"1009\"},\"y_range\":{\"id\":\"1007\"},\"y_scale\":{\"id\":\"1011\"}},\"id\":\"1004\",\"subtype\":\"Figure\",\"type\":\"Plot\"},{\"attributes\":{\"bottom_units\":\"screen\",\"coordinates\":null,\"fill_alpha\":0.5,\"fill_color\":\"lightgrey\",\"group\":null,\"left_units\":\"screen\",\"level\":\"overlay\",\"line_alpha\":1.0,\"line_color\":\"black\",\"line_dash\":[4,4],\"line_width\":2,\"right_units\":\"screen\",\"syncable\":false,\"top_units\":\"screen\"},\"id\":\"1027\",\"type\":\"BoxAnnotation\"},{\"attributes\":{\"fill_color\":{\"field\":\"indicator_value\",\"transform\":{\"id\":\"1038\"}},\"line_color\":{\"field\":\"indicator_value\",\"transform\":{\"id\":\"1039\"}},\"line_width\":{\"value\":2},\"top\":{\"field\":\"measurement_value\"},\"x\":{\"field\":\"time\"}},\"id\":\"1041\",\"type\":\"VBar\"},{\"attributes\":{\"fill_alpha\":{\"value\":0.2},\"fill_color\":{\"field\":\"indicator_value\",\"transform\":{\"id\":\"1038\"}},\"hatch_alpha\":{\"value\":0.2},\"line_alpha\":{\"value\":0.2},\"line_color\":{\"field\":\"indicator_value\",\"transform\":{\"id\":\"1039\"}},\"line_width\":{\"value\":2},\"top\":{\"field\":\"measurement_value\"},\"x\":{\"field\":\"time\"}},\"id\":\"1043\",\"type\":\"VBar\"},{\"attributes\":{},\"id\":\"1009\",\"type\":\"LinearScale\"},{\"attributes\":{},\"id\":\"1025\",\"type\":\"ResetTool\"},{\"attributes\":{},\"id\":\"1018\",\"type\":\"BasicTicker\"},{\"attributes\":{},\"id\":\"1022\",\"type\":\"WheelZoomTool\"},{\"attributes\":{\"label\":{\"field\":\"indicator_value\"},\"renderers\":[{\"id\":\"1044\"}]},\"id\":\"1070\",\"type\":\"LegendItem\"},{\"attributes\":{\"coordinates\":null,\"data_source\":{\"id\":\"1003\"},\"glyph\":{\"id\":\"1041\"},\"group\":null,\"hover_glyph\":null,\"muted_glyph\":{\"id\":\"1043\"},\"nonselection_glyph\":{\"id\":\"1042\"},\"view\":{\"id\":\"1045\"}},\"id\":\"1044\",\"type\":\"GlyphRenderer\"},{\"attributes\":{\"base\":24,\"mantissas\":[1,2,4,6,8,12],\"max_interval\":43200000.0,\"min_interval\":3600000.0,\"num_minor_ticks\":0},\"id\":\"1059\",\"type\":\"AdaptiveTicker\"},{\"attributes\":{\"factors\":[\"NORMAL\",\"HIGH\",\"LOW\"],\"palette\":[\"#99d594\",\"#ffffbf\",\"#fc8d59\"]},\"id\":\"1038\",\"type\":\"CategoricalColorMapper\"},{\"attributes\":{\"source\":{\"id\":\"1003\"}},\"id\":\"1045\",\"type\":\"CDSView\"},{\"attributes\":{\"months\":[0,6]},\"id\":\"1067\",\"type\":\"MonthsTicker\"},{\"attributes\":{},\"id\":\"1050\",\"type\":\"AllLabels\"},{\"attributes\":{\"base\":60,\"mantissas\":[1,2,5,10,15,20,30],\"max_interval\":1800000.0,\"min_interval\":1000.0,\"num_minor_ticks\":0},\"id\":\"1058\",\"type\":\"AdaptiveTicker\"},{\"attributes\":{\"coordinates\":null,\"formatter\":{\"id\":\"1052\"},\"group\":null,\"major_label_policy\":{\"id\":\"1053\"},\"ticker\":{\"id\":\"1014\"}},\"id\":\"1013\",\"type\":\"DatetimeAxis\"},{\"attributes\":{},\"id\":\"1026\",\"type\":\"HelpTool\"},{\"attributes\":{},\"id\":\"1053\",\"type\":\"AllLabels\"},{\"attributes\":{\"days\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]},\"id\":\"1060\",\"type\":\"DaysTicker\"},{\"attributes\":{\"overlay\":{\"id\":\"1027\"}},\"id\":\"1023\",\"type\":\"BoxZoomTool\"},{\"attributes\":{\"days\":[1,8,15,22]},\"id\":\"1062\",\"type\":\"DaysTicker\"},{\"attributes\":{},\"id\":\"1054\",\"type\":\"UnionRenderers\"},{\"attributes\":{\"months\":[0,4,8]},\"id\":\"1066\",\"type\":\"MonthsTicker\"},{\"attributes\":{\"axis\":{\"id\":\"1017\"},\"coordinates\":null,\"dimension\":1,\"group\":null,\"ticker\":null},\"id\":\"1020\",\"type\":\"Grid\"},{\"attributes\":{},\"id\":\"1024\",\"type\":\"SaveTool\"},{\"attributes\":{\"num_minor_ticks\":5,\"tickers\":[{\"id\":\"1057\"},{\"id\":\"1058\"},{\"id\":\"1059\"},{\"id\":\"1060\"},{\"id\":\"1061\"},{\"id\":\"1062\"},{\"id\":\"1063\"},{\"id\":\"1064\"},{\"id\":\"1065\"},{\"id\":\"1066\"},{\"id\":\"1067\"},{\"id\":\"1068\"}]},\"id\":\"1014\",\"type\":\"DatetimeTicker\"},{\"attributes\":{},\"id\":\"1068\",\"type\":\"YearsTicker\"},{\"attributes\":{\"fill_alpha\":{\"value\":0.1},\"fill_color\":{\"field\":\"indicator_value\",\"transform\":{\"id\":\"1038\"}},\"hatch_alpha\":{\"value\":0.1},\"line_alpha\":{\"value\":0.1},\"line_color\":{\"field\":\"indicator_value\",\"transform\":{\"id\":\"1039\"}},\"line_width\":{\"value\":2},\"top\":{\"field\":\"measurement_value\"},\"x\":{\"field\":\"time\"}},\"id\":\"1042\",\"type\":\"VBar\"},{\"attributes\":{},\"id\":\"1005\",\"type\":\"DataRange1d\"},{\"attributes\":{\"mantissas\":[1,2,5],\"max_interval\":500.0,\"num_minor_ticks\":0},\"id\":\"1057\",\"type\":\"AdaptiveTicker\"},{\"attributes\":{},\"id\":\"1021\",\"type\":\"PanTool\"},{\"attributes\":{},\"id\":\"1052\",\"type\":\"DatetimeTickFormatter\"},{\"attributes\":{\"coordinates\":null,\"formatter\":{\"id\":\"1049\"},\"group\":null,\"major_label_policy\":{\"id\":\"1050\"},\"ticker\":{\"id\":\"1018\"}},\"id\":\"1017\",\"type\":\"LinearAxis\"},{\"attributes\":{\"days\":[1,4,7,10,13,16,19,22,25,28]},\"id\":\"1061\",\"type\":\"DaysTicker\"},{\"attributes\":{\"coordinates\":null,\"group\":null,\"items\":[{\"id\":\"1070\"}]},\"id\":\"1069\",\"type\":\"Legend\"},{\"attributes\":{\"axis\":{\"id\":\"1013\"},\"coordinates\":null,\"group\":null,\"ticker\":null},\"id\":\"1016\",\"type\":\"Grid\"},{\"attributes\":{\"days\":[1,15]},\"id\":\"1063\",\"type\":\"DaysTicker\"},{\"attributes\":{\"months\":[0,2,4,6,8,10]},\"id\":\"1065\",\"type\":\"MonthsTicker\"},{\"attributes\":{\"data\":{\"indicator_value\":[\"NORMAL\",\"LOW\",\"LOW\",\"NORMAL\",\"NORMAL\",\"LOW\",\"NORMAL\",\"NORMAL\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"NORMAL\",\"HIGH\",\"NORMAL\",\"NORMAL\",\"HIGH\",\"NORMAL\",\"HIGH\",\"NORMAL\",\"LOW\",\"LOW\",\"LOW\",\"NORMAL\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"NORMAL\",\"LOW\",\"LOW\",\"LOW\",\"NORMAL\",\"NORMAL\",\"HIGH\",\"LOW\",\"NORMAL\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"NORMAL\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"HIGH\",\"NORMAL\",\"LOW\",\"HIGH\",\"HIGH\",\"HIGH\",\"LOW\",\"NORMAL\",\"LOW\",\"HIGH\",\"HIGH\",\"NORMAL\",\"NORMAL\",\"NORMAL\",\"HIGH\",\"NORMAL\",\"LOW\",\"LOW\",\"NORMAL\",\"HIGH\",\"NORMAL\",\"HIGH\",\"NORMAL\",\"HIGH\",\"NORMAL\",\"NORMAL\",\"NORMAL\",\"LOW\",\"LOW\",\"HIGH\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"NORMAL\",\"HIGH\",\"HIGH\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"NORMAL\",\"NORMAL\",\"HIGH\",\"NORMAL\",\"HIGH\",\"HIGH\",\"LOW\",\"LOW\",\"NORMAL\",\"NORMAL\",\"NORMAL\",\"LOW\",\"LOW\",\"NORMAL\",\"LOW\",\"LOW\",\"LOW\",\"HIGH\",\"HIGH\",\"LOW\",\"NORMAL\",\"NORMAL\",\"LOW\",\"NORMAL\",\"LOW\",\"HIGH\",\"LOW\",\"HIGH\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"NORMAL\",\"LOW\",\"LOW\",\"NORMAL\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"NORMAL\",\"LOW\",\"NORMAL\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"LOW\",\"HIGH\",\"LOW\",\"NORMAL\",\"NORMAL\",\"LOW\",\"LOW\"],\"measurement_value\":{\"__ndarray__\":\"sp3vp8ZLt79SuB6F61HIv2MQWDm0yN6/u0kMAiuHlr8zMzMzMzPDv+xRuB6F68G/F9nO91PjxT8hsHJoke3MP/yp8dJNYrC/8tJNYhBYyb9xPQrXo3DNv1g5tMh2vp+/HFpkO99P3T8X2c73U+PVP+kmMQisHNo/IbByaJHt6D+WQ4ts5/vJPx+F61G4HuU/001iEFg54D/dJAaBlUPTPwMrhxbZztc/bef7qfHSzb8shxbZzvfbv5duEoPAyuW/xSCwcmiR1b8NAiuHFtnev6RwPQrXo+C/H4XrUbge5b/2KFyPwvXIvy/dJAaBldO/2s73U+Oly78hsHJoke3Mv3E9CtejcM2//Knx0k1icD/8qfHSTWKgPxFYObTIds6/PN9PjZdukr+mm8QgsHLQP1g5tMh2vs8/jGzn+6nxwj+7SQwCK4fev6rx0k1iELi/gZVDi2zn278pXI/C9SjMv+Olm8QgsMK/SgwCK4cW2b+4HoXrUbiev2Dl0CLb+b6/EoPAyqFFxr9Ei2zn+6mxPyuHFtnO96O/I9v5fmq8tL/8qfHSTWLAP/yp8dJNYmA/SOF6FK5H5T/TTWIQWDnUP3sUrkfhenS/lkOLbOf76T/P91PjpZvkPzEIrBxaZPE/UrgehetRyD/Xo3A9CtfTP5MYBFYOLdI/HFpkO99P1T/P91PjpZvEP3e+nxov3dy/PQrXo3A9yr+mm8QgsHLIv0oMAiuHFtk/KVyPwvUovD+BlUOLbOe7v1g5tMh2vr+/WmQ730+Nl78UrkfhehTOP9v5fmq8dKO/hetRuB6F0z+4HoXrUbi+PyUGgZVDi8w/+FPjpZvEwD/o+6nx0k3SP4/C9Shcj8K/Nl66SQwCy781XrpJDALTv99PjZduEsM/PN9PjZdu0r8j2/l+arzgvyuHFtnO9+O/MzMzMzMz77+TGARWDi3CvzvfT42Xbto/lkOLbOf72T/b+X5qvHTTv/yp8dJNYmA/pHA9CtejwD/RItv5fmq8P/p+arx0k5g/ObTIdr6fuj9t5/up8dLdP0SLbOf7qcE/K4cW2c732z/P91PjpZvUP5zEILByaNk/9ihcj8L15D+HFtnO91PvP0oMAiuHFsk/ukkMAiuHpr8/NV66SQzCvyPb+X5qvNS/7FG4HoXrob+yne+nxkvjvwrXo3A9Cse/eekmMQisfL+wcmiR7XzPv8/3U+Olm9y/WmQ730+Nx78CK4cW2c7HP4ts5/up8aK/sHJoke18v7+q8dJNYhCovx1aZDvfT80/uB6F61G4nr89CtejcD3KP5HtfD81Xrq/+n5qvHSTiL+R7Xw/NV7Sv90kBoGVQ9u/7FG4HoXr2b8Sg8DKoUXev8dLN4lBYNW/uB6F61G4vr9WDi2yne/Hv0SLbOf7qeG/sHJoke18778X2c73U+PtvzEIrBxaZMu/sHJoke18779SuB6F61G4v4GVQ4ts5+e/ZmZmZmZm6r+R7Xw/NV7mvxBYObTIdt6/c2iR7Xw/1T/4U+Olm8TAvzEIrBxaZMu/JzEIrBxaxL+q8dJNYhDIv6wcWmQ73+e/Rbbz/dR46b/AyqFFtvPtv/p+arx0k+i/yqFFtvP9xL8DK4cW2c7rvzq0yHa+n6q/PzVeukkM4r/6fmq8dJNov2Dl0CLb+ea/JQaBlUOL3L9vEoPAyqHhv/yp8dJNYtC/nMQgsHJo0b8YBFYOLbK9v8ZLN4lBYOm/ppvEILBy2L+oxks3iUHQP3e+nxov3dS/BoGVQ4tsxz+BlUOLbOe7P8uhRbbz/fC/SgwCK4cWqT8=\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[169]},\"time\":{\"__ndarray__\":\"AACAHeSFdkIAAMDlJIh2QgAAAK5linZCAABAdqaMdkIAAIA+5452QgAAwAYokXZCAAAAz2iTdkIAAECXqZV2QgAAgF/ql3ZCAADAJyuadkIAAADwa5x2QgAAwEguo3ZCAAAAEW+ldkIAAEDZr6d2QgAAwGkxrHZCAAAAMnKudkIAAED6srB2QgAAwIo0tXZCAAAAU3W3dkIAAEAbtrl2QgAAgOP2u3ZCAADAqze+dkIAAEA8ucJ2QgAAgAT6xHZCAADAzDrHdkIAAACVe8l2QgAAQF28y3ZCAADA7T3QdkIAAAC2ftJ2QgAAQH6/1HZCAACARgDXdkIAAMAOQdl2QgAAANeB23ZCAABAn8LddkIAAIBnA+B2QgAAwC9E4nZCAAAA+ITkdkIAAEDAxeZ2QgAAgIgG6XZCAABAMF/7dkIAAACJIQJ3QgAAQFFiBHdCAACAGaMGd0IAAMDh4wh3QgAAAKokC3dCAABAcmUNd0IAAIA6pg93QgAAwALnEXdCAAAAyycUd0IAAECTaBZ3QgAAgFupGHdCAADAI+oad0IAAADsKh13QgAAQLRrH3dCAACAfKwhd0IAAMBE7SN3QgAAQNVuKHdCAACAna8qd0IAAMBl8Cx3QgAAAC4xL3dCAABA9nExd0IAAIC+sjN3QgAAwIbzNXdCAAAATzQ4d0IAAEAXdTp3QgAAgN+1PHdCAADAp/Y+d0IAAABwN0F3QgAAQDh4Q3dCAACAALlFd0IAAMDI+Ud3QgAAAJE6SndCAABAWXtMd0IAAIAhvE53QgAAwOn8UHdCAAAAsj1Td0IAAEB6flV3QgAAwAoAWndCAAAA00Bcd0IAAECbgV53QgAAgGPCYHdCAABA3Ydwd0IAAIClyHJ3QgAAQP6KeXdCAACAxst7d0IAAMCODH53QgAAAFdNgHdCAABAH46Cd0IAAIDnzoR3QgAAwK8Ph3dCAAAAeFCJd0IAAEBAkYt3QgAAgAjSjXdCAADA0BKQd0IAAACZU5J3QgAAQGGUlHdCAACAKdWWd0IAAMDxFZl3QgAAALpWm3dCAABAgpedd0IAAIBK2J93QgAAwBIZondCAAAA21mkd0IAAECjmqZ3QgAAgGvbqHdCAAAA/Fytd0IAAEDEna93QgAAgIzesXdCAADAVB+0d0IAAAAdYLZ3QgAAQOWguHdCAACAreG6d0IAAMB1Ir13QgAAQAakwXdCAACAzuTDd0IAAMCWJcZ3QgAAAF9myHdCAABAJ6fKd0IAAIDv58x3QgAAwLcoz3dCAAAAgGnRd0IAAEBIqtN3QgAAgBDr1XdCAABAirDld0IAAIBS8ed3QgAAwBoy6ndCAAAA43Lsd0IAAECrs+53QgAAwDs183dCAAAABHb1d0IAAEDMtvd3QgAAgJT3+XdCAADAXDj8d0IAAAAlef53QgAAQO25AHhCAADAXDj8d0IAAIC1+gJ4QgAAwH07BXhCAAAARnwHeEIAAEAOvQl4QgAAgNb9C3hCAADAnj4OeEIAAABnfxB4QgAAQC/AEnhCAACA9wAVeEIAAMC/QRd4QgAAQFDDG3hCAAAAiIIZeEIAAIAYBB54QgAAwOBEIHhCAAAAqYUieEIAAEBxxiR4QgAAwAFIKXhCAACAOQcneEIAAADKiCt4QgAAgFoKMHhCAABAkskteEIAAMAiSzJ4QgAAAOuLNHhCAABAs8w2eEIAAIB7DTl4QgAAwENOO3hCAAAADI89eEIAAEDUzz94QgAAgJwQQnhCAADAZFFEeEIAAAAtkkZ4QgAAQPXSSHhCAACAvRNLeEI=\",\"dtype\":\"float64\",\"order\":\"little\",\"shape\":[169]}},\"selected\":{\"id\":\"1055\"},\"selection_policy\":{\"id\":\"1054\"}},\"id\":\"1003\",\"type\":\"ColumnDataSource\"},{\"attributes\":{\"months\":[0,1,2,3,4,5,6,7,8,9,10,11]},\"id\":\"1064\",\"type\":\"MonthsTicker\"},{\"attributes\":{},\"id\":\"1055\",\"type\":\"Selection\"},{\"attributes\":{\"align\":\"center\",\"coordinates\":null,\"group\":null,\"text\":\"N3 in Venice Lagoon\",\"text_font_size\":\"25px\"},\"id\":\"1035\",\"type\":\"Title\"},{\"attributes\":{},\"id\":\"1007\",\"type\":\"DataRange1d\"},{\"attributes\":{},\"id\":\"1011\",\"type\":\"LinearScale\"},{\"attributes\":{\"tools\":[{\"id\":\"1021\"},{\"id\":\"1022\"},{\"id\":\"1023\"},{\"id\":\"1024\"},{\"id\":\"1025\"},{\"id\":\"1026\"}]},\"id\":\"1028\",\"type\":\"Toolbar\"},{\"attributes\":{},\"id\":\"1049\",\"type\":\"BasicTickFormatter\"},{\"attributes\":{\"factors\":[\"NORMAL\",\"HIGH\",\"LOW\"],\"palette\":[\"#99d594\",\"#ffffbf\",\"#fc8d59\"]},\"id\":\"1039\",\"type\":\"CategoricalColorMapper\"}],\"root_ids\":[\"1004\"]},\"title\":\"Bokeh Application\",\"version\":\"2.4.3\"}};\n  const render_items = [{\"docid\":\"e1ff4190-4b76-4501-82f9-3e2784016e6d\",\"root_ids\":[\"1004\"],\"roots\":{\"1004\":\"d0cb0322-1f4a-4bfb-8887-ef37528f87b8\"}}];\n  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);\n  }\n  if (root.Bokeh !== undefined) {\n    embed_document(root);\n  } else {\n    let attempts = 0;\n    const timer = setInterval(function(root) {\n      if (root.Bokeh !== undefined) {\n        clearInterval(timer);\n        embed_document(root);\n      } else {\n        attempts++;\n        if (attempts > 100) {\n          clearInterval(timer);\n          console.log(\"Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing\");\n        }\n      }\n    }, 10, root)\n  }\n})(window);","application/vnd.bokehjs_exec.v0+json":""},"metadata":{"application/vnd.bokehjs_exec.v0+json":{"id":"1004"}},"output_type":"display_data"}],"tabbable":null,"tooltip":null}},"529b72484ef64258b0e600d79fd99a08":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"VBoxModel","state":{"_dom_classes":["widget-interact"],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"VBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"VBoxView","box_style":"","children":["IPY_MODEL_27f10d097e864e3dab4fb7c59b8472b5","IPY_MODEL_527f01baf3cc437fa5a2a34ad60b4192"],"layout":"IPY_MODEL_209e60efc97f4ba88d169598d130ae20","tabbable":null,"tooltip":null}},"53dbed71f0214728b307d21ac340e880":{"model_module":"jupyter-leaflet","model_module_version":"^0.17","model_name":"LeafletTileLayerModel","state":{"_model_module":"jupyter-leaflet","_model_module_version":"^0.17","_model_name":"LeafletTileLayerModel","_view_count":null,"_view_module":"jupyter-leaflet","_view_module_version":"^0.17","_view_name":"LeafletTileLayerView","attribution":null,"base":false,"bottom":true,"bounds":null,"detect_retina":false,"loading":false,"max_native_zoom":null,"max_zoom":18,"min_native_zoom":null,"min_zoom":0,"name":"","no_wrap":false,"opacity":1,"options":["attribution","bounds","detect_retina","max_native_zoom","max_zoom","min_native_zoom","min_zoom","no_wrap","tile_size","tms","zoom_offset"],"pane":"","popup":null,"popup_max_height":null,"popup_max_width":300,"popup_min_width":50,"show_loading":false,"subitems":[],"tile_size":256,"tms":false,"url":"https://staging-raster.delta-backend.com/stac/tiles/WebMercatorQuad/{z}/{x}/{y}@1x?collection=nightlights-hd-monthly&item=finalBMHD_ScaledVenice_201904&assets=cog_default&bidx=1&unscale=false&resampling=nearest&max_size=1024&rescale=0%2C255&colormap_name=plasma","visible":true,"zoom_offset":0}},"5ed1665e6fab40d4a1c1317d7b79ab87":{"model_module":"jupyter-leaflet","model_module_version":"^0.17","model_name":"LeafletTileLayerModel","state":{"_model_module":"jupyter-leaflet","_model_module_version":"^0.17","_model_name":"LeafletTileLayerModel","_view_count":null,"_view_module":"jupyter-leaflet","_view_module_version":"^0.17","_view_name":"LeafletTileLayerView","attribution":"&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors","base":true,"bottom":true,"bounds":null,"detect_retina":false,"loading":false,"max_native_zoom":null,"max_zoom":19,"min_native_zoom":null,"min_zoom":1,"name":"OpenStreetMap.Mapnik","no_wrap":false,"opacity":1,"options":["attribution","bounds","detect_retina","max_native_zoom","max_zoom","min_native_zoom","min_zoom","no_wrap","tile_size","tms","zoom_offset"],"pane":"","popup":null,"popup_max_height":null,"popup_max_width":300,"popup_min_width":50,"show_loading":false,"subitems":[],"tile_size":256,"tms":false,"url":"https://tile.openstreetmap.org/{z}/{x}/{y}.png","visible":true,"zoom_offset":0}},"8a2b4f4267d34539924d05f4b8417c46":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"TextStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"TextStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"b78b1d47a72343f8911f434a05817d35":{"model_module":"jupyter-leaflet","model_module_version":"^0.17","model_name":"LeafletTileLayerModel","state":{"_model_module":"jupyter-leaflet","_model_module_version":"^0.17","_model_name":"LeafletTileLayerModel","_view_count":null,"_view_module":"jupyter-leaflet","_view_module_version":"^0.17","_view_name":"LeafletTileLayerView","attribution":null,"base":false,"bottom":true,"bounds":null,"detect_retina":false,"loading":false,"max_native_zoom":null,"max_zoom":18,"min_native_zoom":null,"min_zoom":0,"name":"","no_wrap":false,"opacity":1,"options":["attribution","bounds","detect_retina","max_native_zoom","max_zoom","min_native_zoom","min_zoom","no_wrap","tile_size","tms","zoom_offset"],"pane":"","popup":null,"popup_max_height":null,"popup_max_width":300,"popup_min_width":50,"show_loading":false,"subitems":[],"tile_size":256,"tms":false,"url":"https://staging-raster.delta-backend.com/stac/tiles/WebMercatorQuad/{z}/{x}/{y}@1x?collection=nightlights-hd-monthly&item=finalBMHD_ScaledVenice_202004&assets=cog_default&bidx=1&unscale=false&resampling=nearest&max_size=1024&rescale=0%2C255&colormap_name=plasma","visible":true,"zoom_offset":0}},"c11b8f635e4c40119f4dab09d0db7136":{"model_module":"jupyter-leaflet","model_module_version":"^0.17","model_name":"LeafletMapStyleModel","state":{"_model_module":"jupyter-leaflet","_model_module_version":"^0.17","_model_name":"LeafletMapStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","cursor":"grab"}},"c2a0084602994b4a8be29df0baf75777":{"model_module":"jupyter-leaflet","model_module_version":"^0.17","model_name":"LeafletMapStyleModel","state":{"_model_module":"jupyter-leaflet","_model_module_version":"^0.17","_model_name":"LeafletMapStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","cursor":"move"}},"ee99958c097c4f359a5a351e09191633":{"model_module":"jupyter-leaflet","model_module_version":"^0.17","model_name":"LeafletAttributionControlModel","state":{"_model_module":"jupyter-leaflet","_model_module_version":"^0.17","_model_name":"LeafletAttributionControlModel","_view_count":null,"_view_module":"jupyter-leaflet","_view_module_version":"^0.17","_view_name":"LeafletAttributionControlView","options":["position","prefix"],"position":"bottomright","prefix":"ipyleaflet"}},"f312c99cc9554adf8eabb6c8483d4e36":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fd4635d27f5e4012a60cfc3f636cb9ab":{"model_module":"jupyter-leaflet","model_module_version":"^0.17","model_name":"LeafletMapModel","state":{"_dom_classes":[],"_model_module":"jupyter-leaflet","_model_module_version":"^0.17","_model_name":"LeafletMapModel","_view_count":null,"_view_module":"jupyter-leaflet","_view_module_version":"^0.17","_view_name":"LeafletMapView","bottom":0,"bounce_at_zoom_limits":true,"box_zoom":true,"center":[45.438558,12.333421],"close_popup_on_click":true,"controls":["IPY_MODEL_112b0453a73b4855948e3f1d8313c705","IPY_MODEL_ee99958c097c4f359a5a351e09191633","IPY_MODEL_0fb8139e441c4c4492b5fe9ea450d5e9"],"crs":{"custom":false,"name":"EPSG3857"},"default_style":"IPY_MODEL_c11b8f635e4c40119f4dab09d0db7136","double_click_zoom":true,"dragging":true,"dragging_style":"IPY_MODEL_c2a0084602994b4a8be29df0baf75777","east":0,"fullscreen":false,"inertia":true,"inertia_deceleration":3000,"inertia_max_speed":1500,"interpolation":"bilinear","keyboard":true,"keyboard_pan_offset":80,"keyboard_zoom_offset":1,"layers":["IPY_MODEL_5ed1665e6fab40d4a1c1317d7b79ab87"],"layout":"IPY_MODEL_3d955379a017496d83a8a6aed5da93f7","left":9007199254740991,"max_zoom":null,"min_zoom":null,"modisdate":"2023-03-21","north":0,"options":["bounce_at_zoom_limits","box_zoom","center","close_popup_on_click","double_click_zoom","dragging","fullscreen","inertia","inertia_deceleration","inertia_max_speed","interpolation","keyboard","keyboard_pan_offset","keyboard_zoom_offset","max_zoom","min_zoom","prefer_canvas","scroll_wheel_zoom","tap","tap_tolerance","touch_zoom","world_copy_jump","zoom","zoom_animation_threshold","zoom_delta","zoom_snap"],"panes":{},"prefer_canvas":false,"right":0,"scroll_wheel_zoom":false,"south":0,"style":"IPY_MODEL_4b9b75ac4e6e413ea35c5cfa2e7977d3","tabbable":null,"tap":true,"tap_tolerance":15,"tooltip":null,"top":9007199254740991,"touch_zoom":true,"west":0,"window_url":"","world_copy_jump":false,"zoom":13,"zoom_animation_threshold":4,"zoom_delta":1,"zoom_snap":1}}},"version_major":2,"version_minor":0}},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:09:11.385491Z","iopub.status.busy":"2023-03-22T13:09:11.385117Z","iopub.status.idle":"2023-03-22T13:09:11.513330Z","shell.execute_reply":"2023-03-22T13:09:11.507356Z"},"papermill":{"duration":0.18143,"end_time":"2023-03-22T13:09:11.517792","exception":false,"start_time":"2023-03-22T13:09:11.336362","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from eoxhub import check_compatibility\ncheck_compatibility(\"user-2023.03-02\", dependencies=[\"SH\", \"GEODB\"])","visibility":"show","key":"wv6vWL6HW3"},{"type":"output","id":"rRVp_OHHQRLl5LU30MCI3","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<script type=\"text/javascript\">\n        function toggle(id) {\n            el = document.getElementById(id);\n            el.style.display = el.style.display === \"none\" ? \"block\" : \"none\";\n        }\n    </script>","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"This notebook is compatible with this base image version (user-2023.03-02).","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/markdown":{"content":"\n\n---------\n\nThe following environment variables are available:\n\n* `SH_CLIENT_ID`, `SH_INSTANCE_ID`, `SH_CLIENT_NAME`, `SH_CLIENT_SECRET`\n* `GEODB_AUTH_AUD`, `GEODB_AUTH_CLIENT_ID`, `GEODB_AUTH_DOMAIN`, `GEODB_API_SERVER_URL`, `GEODB_AUTH_CLIENT_SECRET`, `GEODB_API_SERVER_PORT`\n","content_type":"text/markdown"},"text/plain":{"content":"<IPython.core.display.Markdown object>","content_type":"text/plain"}}}],"visibility":"show","key":"mDKEccB8JR"}],"visibility":"show","key":"T6K1B6wml4"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.030435,"end_time":"2023-03-22T13:09:11.579699","exception":false,"start_time":"2023-03-22T13:09:11.549264","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Environmental Impacts of Lockdown in Venice, Italy during 2020","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"weTgYdiHVM"}],"identifier":"environmental-impacts-of-lockdown-in-venice-italy-during-2020","label":"Environmental Impacts of Lockdown in Venice, Italy during 2020","html_id":"environmental-impacts-of-lockdown-in-venice-italy-during-2020","implicit":true,"key":"obpPqWiDws"},{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Geo-storytelling with EODASHBOARD and the Euro Data Cube - Notebook #2","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"N1kMbxU0m5"}],"identifier":"geo-storytelling-with-eodashboard-and-the-euro-data-cube-notebook-2","label":"Geo-storytelling with EODASHBOARD and the Euro Data Cube - Notebook #2","html_id":"geo-storytelling-with-eodashboard-and-the-euro-data-cube-notebook-2","implicit":true,"key":"dfowBrowc3"}],"visibility":"show","key":"upn3Z22hUc"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.02931,"end_time":"2023-03-22T13:09:11.663947","exception":false,"start_time":"2023-03-22T13:09:11.634637","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This notebook looks at the impact of the mobility restrictions imposed in the Italian region Veneto during the Covid-19 pandemic to restrict the spread of the virus.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H9kKpt4lGv"}],"key":"PWWiAUR6aP"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"It uses Earth Observation data from ESA, NASA and JAXA from the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hdMJaXYK0z"},{"type":"link","url":"https://eodashboard.org","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"EO Dashboard","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sgB46jtn3y"}],"urlSource":"https://eodashboard.org","key":"TOLXO4I5ak"},{"type":"text","value":", together with other geospatial data as well as non-EO information.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"j7mFq4WPJT"}],"key":"rl7DuXn5ok"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"To read more about the tri-agency collaboration visit ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pEP3QcIZUw"},{"type":"link","url":"https://eodashboard.org","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"https://​eodashboard​.org","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BpkRp4taZJ"}],"urlSource":"https://eodashboard.org","key":"SQTluqV3qq"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"X8BhwNVXdM"}],"key":"mmFgVojjh1"}],"visibility":"show","key":"ELTSfLyfpv"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.029492,"end_time":"2023-03-22T13:09:11.733026","exception":false,"start_time":"2023-03-22T13:09:11.703534","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this Notebook:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jj9JFbfG1X"}],"identifier":"in-this-notebook","label":"In this Notebook:","html_id":"in-this-notebook","implicit":true,"key":"hKxFPPiqa9"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We download and plot open data about mobility over the region of Veneto and determine extreme values associated with the lockdown","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AEXj8mpfSD"}],"identifier":"covid-mobility-data-from-google","label":"Covid-Mobility-Data-from-Google","kind":"heading","template":"{name}","resolved":true,"html_id":"covid-mobility-data-from-google","key":"NyhEeT5XSC"}],"key":"FYfljSGaVv"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We then access vessel density data in the venice Lagoon and evaluate the reduction in vessel traffic during the lockdown","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"XCFATkKopy"}],"identifier":"requesting-vessel-density-data","label":"Requesting-Vessel-Density-Data","kind":"heading","template":"{name}","resolved":true,"html_id":"requesting-vessel-density-data","key":"HtqKm737Bq"}],"key":"KbwqRZgfws"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"#Using-the-NASA-API-to-retreive-nightlights-data","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Using the extreme value’s date as a proxy for the period of reduced activity, we request NASA nightlight data and visually inspect if changes are visible","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HLdI6iRNo0"}],"urlSource":"#Using-the-NASA-API-to-retreive-nightlights-data","key":"z2L2WLbZ7C"}],"key":"vpPo4xk30t"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"#Retreiving-Sentinel-2-imagery-over-the-Island-of-Venice","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"We inspect whether an environmental impact of the activity reduciton is visible in the water quality in the lagoon by visually inspecting Copernicus Sentinel-2 imagery","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"qibLNrtZBa"}],"urlSource":"#Retreiving-Sentinel-2-imagery-over-the-Island-of-Venice","key":"vRTZjfI7Sd"}],"key":"mF4qK11qz6"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"We proceed to access and visualise Chlorophyll-a concentration maps in the Venice lagoon","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xExbpjW65S"}],"identifier":"requesting-water-quality-data-from-jaxa","label":"Requesting-Water-Quality-Data-from-JAXA","kind":"heading","template":"{name}","resolved":true,"html_id":"requesting-water-quality-data-from-jaxa","key":"XQp81elJJu"}],"key":"uI55OZMWr9"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"link","url":"#Retreiving-water-quality-time-series-from-GeoDB","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"We access water quality time series and inspect the Chlorophyll-a variation compared to the climatology","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"GIOMdePikq"}],"urlSource":"#Retreiving-water-quality-time-series-from-GeoDB","key":"M9xwz2p3P7"}],"key":"N31lhCIWmF"}],"key":"r5lwCLcSwQ"}],"visibility":"show","key":"kMj7KytArm"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.030403,"end_time":"2023-03-22T13:09:11.789128","exception":false,"start_time":"2023-03-22T13:09:11.758725","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Permissions and Package Download","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QWfietFq8a"}],"identifier":"permissions-and-package-download","label":"Permissions and Package Download","html_id":"permissions-and-package-download","implicit":true,"key":"ap97hd2Na7"}],"visibility":"show","key":"hlGzYbUBwr"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:09:11.842448Z","iopub.status.busy":"2023-03-22T13:09:11.842071Z","iopub.status.idle":"2023-03-22T13:09:14.117696Z","shell.execute_reply":"2023-03-22T13:09:14.114764Z"},"papermill":{"duration":2.306424,"end_time":"2023-03-22T13:09:14.121206","exception":false,"start_time":"2023-03-22T13:09:11.814782","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"#Import necessary packages\n\nimport concurrent.futures\nimport datetime as dt\nfrom ipyleaflet import basemaps, Map, GeoJSON\nimport json\nimport requests as re\nimport matplotlib.pyplot as plt\nimport pprint\nimport time\nimport datetime\nimport csv\nimport requests\nimport numpy as np\nimport sys\nimport pandas as pd\nimport geojson\nimport requests as re\nfrom ipyleaflet import Map, basemaps, basemap_to_tiles, TileLayer, SplitMapControl\nimport warnings\nwarnings.filterwarnings('ignore')\n\nfrom bokeh.plotting import figure, show, output_notebook\nfrom bokeh.models import ColumnDataSource\nfrom bokeh.palettes import Spectral3\nfrom bokeh.palettes import Spectral6\nfrom bokeh.transform import factor_cmap\nfrom __future__ import print_function\nfrom ipywidgets import interact, interactive, fixed, interact_manual\nimport ipywidgets as widgets\nimport matplotlib.patches as mpatches\n\n\n# Configure plots for inline use in Jupyter Notebook\n%matplotlib inline","visibility":"show","key":"bFLf8O0m3Q"},{"type":"output","id":"ALNIXfQ8LcqKhNJmSulPx","data":[],"visibility":"show","key":"BbX3jE43Mj"}],"visibility":"show","key":"CUzHlGhE3X"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:09:14.189556Z","iopub.status.busy":"2023-03-22T13:09:14.182324Z","iopub.status.idle":"2023-03-22T13:09:15.058141Z","shell.execute_reply":"2023-03-22T13:09:15.056656Z"},"papermill":{"duration":0.914365,"end_time":"2023-03-22T13:09:15.062300","exception":false,"start_time":"2023-03-22T13:09:14.147935","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Time Series data in Step 6. are store in the geodatabase, so we check if the xcube_geodb service is active\n\nfrom edc import check_compatibility\nfrom xcube_geodb.core.geodb import GeoDBClient\ngeodb = GeoDBClient()\ngeodb.whoami","visibility":"show","key":"K17vzyqFr6"},{"type":"output","id":"9-aICc88t2r7T16UkImy8","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"'geodb_418dfeac-15f0-4606-9edb-fd9eb722bf04'","content_type":"text/plain"}}}],"visibility":"show","key":"HoEyGGb8qC"}],"visibility":"show","key":"d45PZ5k1Oa"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:09:15.135667Z","iopub.status.busy":"2023-03-22T13:09:15.134099Z","iopub.status.idle":"2023-03-22T13:09:15.469560Z","shell.execute_reply":"2023-03-22T13:09:15.467975Z"},"papermill":{"duration":0.380166,"end_time":"2023-03-22T13:09:15.473492","exception":false,"start_time":"2023-03-22T13:09:15.093326","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Sentinel-2 imagery and the water quality maps that we use in Steps 4. and 5. will be accessed from the Sentinel Hub. \n# Here we make sure that the data needed for the authentication to use the Sentinel Hub services is available, and we establish a session \n\nimport os\nfrom oauthlib.oauth2 import BackendApplicationClient\nfrom requests_oauthlib import OAuth2Session\n# Your client credentials\nclient_id = os.environ['SH_CLIENT_ID']\nclient_secret = os.environ['SH_CLIENT_SECRET']\n# Create a session\nclient = BackendApplicationClient(client_id=client_id)\noauth = OAuth2Session(client=client)\n# Get token for the session\ntoken = oauth.fetch_token(token_url='https://services.sentinel-hub.com/oauth/token',\n                          client_id=client_id, client_secret=client_secret)\n# All requests using this session will have an access token automatically added\nresp = oauth.get(\"https://services.sentinel-hub.com/oauth/tokeninfo\")\n# Sentinel Hub\nfrom sentinelhub import (MimeType, CRS, BBox, SentinelHubRequest, SentinelHubDownloadClient, \n                         DataCollection, bbox_to_dimensions, DownloadRequest, SHConfig)","visibility":"show","key":"c9kMh7tN57"},{"type":"output","id":"tbkQbbNXZIdG7rB2RINBQ","data":[],"visibility":"show","key":"GvbY8OqkFK"}],"visibility":"show","key":"FBXU4vZQT4"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:09:15.545627Z","iopub.status.busy":"2023-03-22T13:09:15.545076Z","iopub.status.idle":"2023-03-22T13:09:15.557795Z","shell.execute_reply":"2023-03-22T13:09:15.555476Z"},"papermill":{"duration":0.052399,"end_time":"2023-03-22T13:09:15.562374","exception":false,"start_time":"2023-03-22T13:09:15.509975","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Pass Sentinel Hub credentials to SHConfig\nconfig = SHConfig()\nconfig.sh_client_id = os.environ[\"SH_CLIENT_ID\"]\nconfig.sh_client_secret = os.environ[\"SH_CLIENT_SECRET\"]","visibility":"show","key":"HStvHgnu4j"},{"type":"output","id":"WLlZc_pYMP6FDVNfD6T0T","data":[],"visibility":"show","key":"s7UlkRCJGX"}],"visibility":"show","key":"mModO4Dvzy"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.030949,"end_time":"2023-03-22T13:09:15.630002","exception":false,"start_time":"2023-03-22T13:09:15.599053","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Covid Mobility Data from Google","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NsBOlC0YI0"}],"identifier":"covid-mobility-data-from-google","label":"Covid Mobility Data from Google","html_id":"covid-mobility-data-from-google","implicit":true,"key":"GQ9MkTsQTk"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Google provides open data on mobility, called “Google COVID-19 Community Mobility Reports”. To access the original data source, visit: ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"we8i6f38xf"},{"type":"link","url":"https://www.google.com/covid19/mobility/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"https://​www​.google​.com​/covid19​/mobility/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wkL4RaNi1e"}],"urlSource":"https://www.google.com/covid19/mobility/","key":"NU86cZxRbf"}],"key":"lIHdK899hp"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In EO Dashboard this indicator is called “Mobility Data” and provides country-level aggregated charts. On EO Dashboard it can be accessed at: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"q3xm0Yj5je"},{"type":"link","url":"https://eodashboard.org/explore?indicator=GG","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"https://​eodashboard​.org​/explore​?indicator​=GG","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"vMWsibr1Sn"}],"urlSource":"https://eodashboard.org/explore?indicator=GG","key":"FeiTxHAaGk"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"r2uMgkniRx"}],"key":"rky3iSPxHJ"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"All charts and maps on EO Dashboard provide an “embed link” and we will use this together with the IFrame library to inspect the mobility trends at country level for Italy.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"sDe2Fk4a3f"}],"key":"cA3CfBiaNE"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Tip: try interacting with the chart, zoom in/out, activate/deactivate categories by clicking on the legend items, hover over the chart to get more details","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Qrdtb8YhCR"}],"key":"C7KGjqJ4ga"}],"key":"rFHq8cA2Uu"}],"visibility":"show","key":"Xz7ExQy2jE"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:09:15.711304Z","iopub.status.busy":"2023-03-22T13:09:15.703538Z","iopub.status.idle":"2023-03-22T13:09:15.734275Z","shell.execute_reply":"2023-03-22T13:09:15.732310Z"},"papermill":{"duration":0.075139,"end_time":"2023-03-22T13:09:15.737987","exception":false,"start_time":"2023-03-22T13:09:15.662848","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# How Mobility data is presented in EO Dashboard\n\nfrom IPython.display import IFrame\nIFrame('https://eodashboard.org/iframe?poi=IT-GG', width=800, height=500)","visibility":"show","key":"kW6zkT3dX3"},{"type":"output","id":"-CE5OBHCoTf2E8pH9BcvY","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content":"\n        <iframe\n            width=\"800\"\n            height=\"500\"\n            src=\"https://eodashboard.org/iframe?poi=IT-GG\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ","content_type":"text/html"},"text/plain":{"content":"<IPython.lib.display.IFrame at 0x7f98aba42310>","content_type":"text/plain"}}}],"visibility":"show","key":"A8V7jmTP7l"}],"visibility":"show","key":"r6DAuwTDzS"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.041392,"end_time":"2023-03-22T13:09:15.811537","exception":false,"start_time":"2023-03-22T13:09:15.770145","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Mobility in Veneto","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HXnJVmJImA"}],"identifier":"mobility-in-veneto","label":"Mobility in Veneto","html_id":"mobility-in-veneto","implicit":true,"key":"T8rATBi4Ak"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We want to focus only on the region of Veneto, not the entire country, as we will use the COVID Mobility data to relate lockdowns to changing behaviour in the region and especially in the Venice lagoon.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IBwoy0XLk4"}],"key":"nn8nKg2GKW"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We use this data to estimate the times where the lockdown restrictions were at their highest and inturn relate this to activity and finaly water quality.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zcj2qqZFta"}],"key":"PQ4YjdKHPr"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The Covid Mobility data covers the larger area of Veneto, which includes the region of Venice. Below we display the region using NUTS data:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"dFfa0GKEAL"}],"key":"lkv6diVrTu"}],"visibility":"show","key":"OQGslwPNt1"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:09:15.881499Z","iopub.status.busy":"2023-03-22T13:09:15.879593Z","iopub.status.idle":"2023-03-22T13:09:17.636289Z","shell.execute_reply":"2023-03-22T13:09:17.634807Z"},"papermill":{"duration":1.800796,"end_time":"2023-03-22T13:09:17.639227","exception":false,"start_time":"2023-03-22T13:09:15.838431","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import requests\n# First let us get the area information of the country from the administratives zones\n# You can find all the different NUTS levels, resolution here: https://gisco-services.ec.europa.eu/distribution/v2/nuts/nuts-2021-files.html\n\nresponse = requests.get(\n    \"https://gisco-services.ec.europa.eu/distribution/v2/nuts/geojson/NUTS_RG_10M_2021_4326_LEVL_2.geojson\"\n)\n\ndata = response.json()\n\n# Now lets find the geometry information for one country\nmatch = [x for x in data[\"features\"] if x[\"properties\"][\"NUTS_ID\"] == 'ITH3'][0]","visibility":"show","key":"RdNhrwC1Q4"},{"type":"output","id":"8vUN7ekl-ZQSEiHQZBJS8","data":[],"visibility":"show","key":"uQ4mwNDroR"}],"visibility":"show","key":"W91YG1KWYS"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:09:17.732948Z","iopub.status.busy":"2023-03-22T13:09:17.730584Z","iopub.status.idle":"2023-03-22T13:09:17.749443Z","shell.execute_reply":"2023-03-22T13:09:17.747162Z"},"papermill":{"duration":0.088122,"end_time":"2023-03-22T13:09:17.753602","exception":false,"start_time":"2023-03-22T13:09:17.665480","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import shapely.geometry\nimport IPython.display\nIPython.display.GeoJSON(match)","visibility":"show","key":"CpZML8LPv7"},{"type":"output","id":"LyONYfWzBsMzx1bV7MpKO","data":[{"output_type":"display_data","metadata":{"application/geo+json":{"expanded":false,"root":"root"}},"data":{"application/geo+json":{"content":"{\"geometry\":{\"coordinates\":[[[[12.73139,46.63429],[12.72414,46.54856],[12.64722,46.51645],[12.62565,46.47094],[12.52869,46.45272],[12.4987,46.41222],[12.33089,46.26894],[12.48638,46.14962],[12.47902,46.10931],[12.40053,46.042],[12.41494,46.0209],[12.43305,45.95719],[12.5074,45.91567],[12.55786,45.84055],[12.66167,45.79244],[12.77129,45.84411],[12.80836,45.82126],[12.85078,45.84367],[12.91619,45.82006],[12.97906,45.83405],[12.9859,45.78405],[13.09879,45.64453],[12.80836,45.56499],[12.59826,45.48619],[12.58138,45.4979],[12.62042,45.53272],[12.56752,45.56016],[12.40398,45.53394],[12.18244,45.40105],[12.13256,45.30037],[12.14003,45.26819],[12.20049,45.25734],[12.22575,45.20783],[12.29404,45.21694],[12.33057,45.16055],[12.28099,45.0928],[12.32172,45.00771],[12.42249,45.0097],[12.48248,44.95444],[12.45719,44.88353],[12.401,44.86772],[12.39906,44.79262],[12.29325,44.87514],[12.2736,44.93264],[12.13809,44.93853],[12.08229,44.96904],[11.79919,44.97254],[11.62695,44.89593],[11.42677,44.95008],[11.18972,45.05979],[11.2055,45.10949],[11.05514,45.10995],[10.92727,45.23218],[10.79289,45.30572],[10.73459,45.30228],[10.70496,45.33754],[10.70508,45.41191],[10.65466,45.41583],[10.6356,45.60806],[10.84018,45.83276],[10.88174,45.80072],[10.86348,45.71542],[10.94084,45.68377],[11.04216,45.713],[11.13834,45.69709],[11.26714,45.91276],[11.34536,45.92057],[11.3846,45.97827],[11.51451,46.00755],[11.61803,45.96438],[11.68432,45.98408],[11.67297,46.0209],[11.69941,46.09247],[11.87895,46.11919],[11.9521,46.18206],[11.91607,46.24865],[11.84232,46.28075],[11.78742,46.35592],[11.87833,46.44806],[11.82484,46.48301],[11.82834,46.50891],[12.00531,46.5448],[12.07797,46.6658],[12.21183,46.61369],[12.3815,46.62873],[12.47792,46.67984],[12.69064,46.65697],[12.73139,46.63429]]],[[[12.45435,45.4386],[12.43107,45.42394],[12.40993,45.45733],[12.46969,45.47724],[12.48769,45.50013],[12.5476,45.50853],[12.55421,45.46955],[12.45435,45.4386]]],[[[12.4006,45.44546],[12.37882,45.40627],[12.3226,45.43552],[12.34775,45.45403],[12.4006,45.44546]]]],\"type\":\"MultiPolygon\"},\"id\":\"ITH3\",\"properties\":{\"CNTR_CODE\":\"IT\",\"COAST_TYPE\":0,\"FID\":\"ITH3\",\"LEVL_CODE\":2,\"MOUNT_TYPE\":0,\"NAME_LATN\":\"Veneto\",\"NUTS_ID\":\"ITH3\",\"NUTS_NAME\":\"Veneto\",\"URBN_TYPE\":0},\"type\":\"Feature\"}","content_type":"application/geo+json"},"text/plain":{"content":"<IPython.display.GeoJSON object>","content_type":"text/plain"}}}],"visibility":"show","key":"Jn2KcAxiSy"}],"visibility":"show","key":"W6XQ0AsTYG"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:09:17.844617Z","iopub.status.busy":"2023-03-22T13:09:17.844079Z","iopub.status.idle":"2023-03-22T13:09:24.812706Z","shell.execute_reply":"2023-03-22T13:09:24.810829Z"},"papermill":{"duration":7.016905,"end_time":"2023-03-22T13:09:24.817066","exception":false,"start_time":"2023-03-22T13:09:17.800161","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Download google mobilty dataset\n\nurl = 'https://www.gstatic.com/covid19/mobility/Global_Mobility_Report.csv'\n\ngfile = requests.get(url, allow_redirects=True)\nopen('gmobility_data.csv', 'wb').write(gfile.content)","visibility":"show","key":"R1aetaYhyd"},{"type":"output","id":"asYRfiUBYQi9kj-rOJVKz","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"1144240623","content_type":"text/plain"}}}],"visibility":"show","key":"f5awkojmUQ"}],"visibility":"show","key":"dEdFG4rI72"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:09:24.881738Z","iopub.status.busy":"2023-03-22T13:09:24.881232Z","iopub.status.idle":"2023-03-22T13:10:35.352960Z","shell.execute_reply":"2023-03-22T13:10:35.351399Z"},"papermill":{"duration":70.509965,"end_time":"2023-03-22T13:10:35.357466","exception":false,"start_time":"2023-03-22T13:09:24.847501","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# open dataset and retrieve the data\nwith open('gmobility_data.csv') as csvfile:\n    reader = csv.DictReader(csvfile, delimiter=\",\", quotechar='\"')\n    country_data = {}\n    # Le us say we interested in retail_and_recreation_percent_change_from_baseline in 3 countries, France, Italy and Austria\n    countries = [\"IT\"]\n    for key in countries:\n        country_data[key] = []\n    # We iterate through the csv rows and extract the wanted data\n    for row in reader:\n        # For now we skip subregional data and only look at overall country data\n        # this is the case for countries that have no information on the following 3 parameters\n        if row[\"sub_region_1\"] == 'Veneto' and row[\"sub_region_2\"] == '' and row[\"metro_area\"] == '' :\n            location_key = row[\"country_region_code\"]\n\n            if location_key in countries:\n                country_data[location_key].append((\n                    datetime.datetime.strptime(row[\"date\"], \"%Y-%m-%d\"), # convert to date object\n                    float(row[\"retail_and_recreation_percent_change_from_baseline\"]) #convert to float\n                ))","visibility":"show","key":"um6Kt8GQvX"},{"type":"output","id":"K99KYQfZfQDQYz_H9YQSZ","data":[],"visibility":"show","key":"aH3K1jMVc9"}],"visibility":"show","key":"oo2tut7dU4"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:35.474244Z","iopub.status.busy":"2023-03-22T13:10:35.473753Z","iopub.status.idle":"2023-03-22T13:10:35.496767Z","shell.execute_reply":"2023-03-22T13:10:35.495608Z"},"papermill":{"duration":0.096244,"end_time":"2023-03-22T13:10:35.500925","exception":false,"start_time":"2023-03-22T13:10:35.404681","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# creating a pandas dataframe to store the data\nveneto = pd.DataFrame(country_data[key], columns=['date','retail_and_recreation_percent_change_from_baseline'])\nveneto['date'] =  pd.to_datetime(veneto['date'], infer_datetime_format=True)\nveneto_ts = veneto.set_index('date') ","visibility":"show","key":"KtCZf9tBEm"},{"type":"output","id":"r6_FagzSu8HLpqmtLCk_Q","data":[],"visibility":"show","key":"rY4BJEG096"}],"visibility":"show","key":"X1JvQexVwc"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:35.565747Z","iopub.status.busy":"2023-03-22T13:10:35.565168Z","iopub.status.idle":"2023-03-22T13:10:35.598042Z","shell.execute_reply":"2023-03-22T13:10:35.592699Z"},"papermill":{"duration":0.069842,"end_time":"2023-03-22T13:10:35.602440","exception":false,"start_time":"2023-03-22T13:10:35.532598","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# resampling the data\nweekly_veneto = veneto_ts.resample('W').mean()","visibility":"show","key":"KUDA7MXyMk"},{"type":"output","id":"SSeiSgw8sAWjtSUwizocS","data":[],"visibility":"show","key":"MlDHL106co"}],"visibility":"show","key":"ALvst6JjkZ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:35.668085Z","iopub.status.busy":"2023-03-22T13:10:35.667697Z","iopub.status.idle":"2023-03-22T13:10:36.442212Z","shell.execute_reply":"2023-03-22T13:10:36.439454Z"},"papermill":{"duration":0.810055,"end_time":"2023-03-22T13:10:36.447688","exception":false,"start_time":"2023-03-22T13:10:35.637633","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# plotting the data\nweekly_veneto.plot(y='retail_and_recreation_percent_change_from_baseline', figsize=(15,8))","visibility":"show","key":"YQmcctkiwk"},{"type":"output","id":"3pWORT86D805k2QMS6_TP","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"<Axes: xlabel='date'>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6812f43b037e7f4ba513bba01b1afef0","path":"/notebooks_test/build/6812f43b037e7f4ba513bba01b1afef0.png"},"text/plain":{"content":"<Figure size 1500x800 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"zAzB9X70Mz"}],"visibility":"show","key":"C8NBqjeKmt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:36.538124Z","iopub.status.busy":"2023-03-22T13:10:36.537561Z","iopub.status.idle":"2023-03-22T13:10:36.553925Z","shell.execute_reply":"2023-03-22T13:10:36.551470Z"},"papermill":{"duration":0.083158,"end_time":"2023-03-22T13:10:36.573024","exception":false,"start_time":"2023-03-22T13:10:36.489866","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# We output the date of the lowest value\nweekly_veneto.retail_and_recreation_percent_change_from_baseline.idxmin()","visibility":"show","key":"q0CStOhiu7"},{"type":"output","id":"qMDRKE4wGN6CM2AYS_7bq","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"Timestamp('2020-04-05 00:00:00', freq='W-SUN')","content_type":"text/plain"}}}],"visibility":"show","key":"yr4z1G5Irp"}],"visibility":"show","key":"dK7REsWQA1"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.035713,"end_time":"2023-03-22T13:10:36.650918","exception":false,"start_time":"2023-03-22T13:10:36.615205","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can see from the figure the drop in the activity from the baseline within the region and use this to help understand the impacts of this change.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uUrGokiFeZ"}],"key":"rNJlI1RIBz"}],"visibility":"show","key":"hxJMFbvl2J"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.041972,"end_time":"2023-03-22T13:10:36.728313","exception":false,"start_time":"2023-03-22T13:10:36.686341","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Requesting Vessel Density Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fkygHwy6mu"}],"identifier":"requesting-vessel-density-data","label":"Requesting Vessel Density Data","html_id":"requesting-vessel-density-data","implicit":true,"key":"OUojAxH8zx"}],"visibility":"show","key":"qPz6aweRdo"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.028509,"end_time":"2023-03-22T13:10:36.790312","exception":false,"start_time":"2023-03-22T13:10:36.761803","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We retrieve vessel data from the Euro Data Cube for Venice lagoon.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kREP1ZSv0N"}],"key":"meNPdVfkBB"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"This data layer is covering only the European region and can be visualised on the EO Dashboard instance focused only on Europe. This instance is branded “Rapid Action on Covid 19 and EO (RACE)” and includes some of the datasets from the ESA-NASA-JAXA instance as well as other Europe-centric datasets.\nThis dashboard instance is accessble at ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZFGnVvJmfj"},{"type":"link","url":"https://race.esa.int","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"https://​race​.esa​.int","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bI4h1b5458"}],"urlSource":"https://race.esa.int","key":"scfwPID16I"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JWHKEEypa9"}],"key":"nMZ73idVLV"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The vessel density data visualisation in the RACE Dashboard can be inspected here: ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"CaMe7EzCO3"},{"type":"link","url":"https://race.esa.int/?poi=World-E13o","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"https://​race​.esa​.int​/​?poi​=​World​-E13o","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"aPVqC2Zqlq"}],"urlSource":"https://race.esa.int/?poi=World-E13o","key":"qJKEpYGu3N"}],"key":"hTmO2IDJJG"}],"visibility":"show","key":"eXgnPSU9wt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:36.852095Z","iopub.status.busy":"2023-03-22T13:10:36.851558Z","iopub.status.idle":"2023-03-22T13:10:36.887918Z","shell.execute_reply":"2023-03-22T13:10:36.885764Z"},"papermill":{"duration":0.069497,"end_time":"2023-03-22T13:10:36.891206","exception":false,"start_time":"2023-03-22T13:10:36.821709","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# let's use the IFrame to embed the vesel density map\n# for a better experience, access this indicator direclty on the RACE Dashboard, at: https://race.esa.int/?poi=World-E13o \n# there you will be able to use the Draw AOI feature to generate times sereis of vessel density on your custom area.\n\n# the view below is offering limitted functionalities.\n# the 4 tabs: ALL, CARGO, TANKER, OTHERS\n\nIFrame('https://race.esa.int/iframe?poi=World-E13o', width=800, height=500)","visibility":"show","key":"T7yYcFGk2F"},{"type":"output","id":"csfjoRjQLzXQRT0Xp5nzR","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/html":{"content":"\n        <iframe\n            width=\"800\"\n            height=\"500\"\n            src=\"https://race.esa.int/iframe?poi=World-E13o\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ","content_type":"text/html"},"text/plain":{"content":"<IPython.lib.display.IFrame at 0x7f98aada8940>","content_type":"text/plain"}}}],"visibility":"show","key":"GYU3GiARq1"}],"visibility":"show","key":"S5c5dk5BST"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.029511,"end_time":"2023-03-22T13:10:36.954523","exception":false,"start_time":"2023-03-22T13:10:36.925012","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Getting the actual vessel density map data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"edMQ8ved6W"}],"identifier":"getting-the-actual-vessel-density-map-data","label":"Getting the actual vessel density map data","html_id":"getting-the-actual-vessel-density-map-data","implicit":true,"key":"uX3iFL1XPg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The vessel data is accessible using the Sentinel Hub service, and can be retrieve using the byoc (bring your own COG) code availble in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mEKXJVuBJ5"},{"type":"link","url":"https://collections.eurodatacube.com/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Eurodatacube Collections","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PxbwjbeAYb"}],"urlSource":"https://collections.eurodatacube.com/","key":"Vch8LUaq2r"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"E0eF4H3IT1"}],"key":"H7iJKAzzpG"}],"visibility":"show","key":"eOU4XuHlOT"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:37.024390Z","iopub.status.busy":"2023-03-22T13:10:37.023935Z","iopub.status.idle":"2023-03-22T13:10:37.050681Z","shell.execute_reply":"2023-03-22T13:10:37.049218Z"},"papermill":{"duration":0.071088,"end_time":"2023-03-22T13:10:37.054882","exception":false,"start_time":"2023-03-22T13:10:36.983794","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# define the area\n\ndef bbox(coord_list):\n     box = []\n     for i in (0,1):\n         res = sorted(coord_list, key=lambda x:x[i])\n         box.append((res[0][i],res[-1][i]))\n     ret = f\"({box[0][0]} {box[1][0]}, {box[0][1]} {box[1][1]})\"\n     return ret\n\n# Parse the json here\n\nimport geojson\nimport shapely.wkt\n\n# We have the POLYGON pre-defined for the Venice Lagoon. It is the same one that is used in EO Dashboard to display the Venice Water Quality Maps.\n\narea = shapely.wkt.loads('POLYGON((12.174395 44.778037,12.196361 44.816998,12.085149 45.405263,12.426024 45.583514,13.153667 45.779148,13.603981 45.811687,13.804426 45.675662,13.823647 45.596962,13.626039 45.443008,13.549156 45.433376,13.626039 45.323461,13.713905 45.095238,13.78383 44.980605,13.830519 44.892158,13.8 44.5,12.234821 44.481556,12.06659 44.581469,12.174395 44.778037))')\ngj_feat = geojson.Feature(geometry=area, properties={})\n\nIPython.display.GeoJSON(gj_feat)","visibility":"show","key":"bXN0PlE95i"},{"type":"output","id":"Dgj5R-08IKa6aiqT3322J","data":[{"output_type":"display_data","metadata":{"application/geo+json":{"expanded":false,"root":"root"}},"data":{"application/geo+json":{"content":"{\"geometry\":{\"coordinates\":[[[12.174395,44.778037],[12.196361,44.816998],[12.085149,45.405263],[12.426024,45.583514],[13.153667,45.779148],[13.603981,45.811687],[13.804426,45.675662],[13.823647,45.596962],[13.626039,45.443008],[13.549156,45.433376],[13.626039,45.323461],[13.713905,45.095238],[13.78383,44.980605],[13.830519,44.892158],[13.8,44.5],[12.234821,44.481556],[12.06659,44.581469],[12.174395,44.778037]]],\"type\":\"Polygon\"},\"properties\":{},\"type\":\"Feature\"}","content_type":"application/geo+json"},"text/plain":{"content":"<IPython.display.GeoJSON object>","content_type":"text/plain"}}}],"visibility":"show","key":"f2n0BL5SMl"}],"visibility":"show","key":"soeElxljUJ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:37.136572Z","iopub.status.busy":"2023-03-22T13:10:37.136041Z","iopub.status.idle":"2023-03-22T13:10:37.149842Z","shell.execute_reply":"2023-03-22T13:10:37.146426Z"},"papermill":{"duration":0.061088,"end_time":"2023-03-22T13:10:37.153314","exception":false,"start_time":"2023-03-22T13:10:37.092226","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# we create a bounding box for the geojson \n\nline = bbox(list(geojson.utils.coords(gj_feat)))\nprint(line)","visibility":"show","key":"akoCddibVT"},{"type":"output","id":"yS-ITaN85DT4Fp5bEzM-0","data":[{"name":"stdout","output_type":"stream","text":"(12.06659 44.481556, 13.830519 45.811687)\n"}],"visibility":"show","key":"mwBElKKDkI"}],"visibility":"show","key":"M8dgeBHu2k"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:37.237782Z","iopub.status.busy":"2023-03-22T13:10:37.237369Z","iopub.status.idle":"2023-03-22T13:10:37.249247Z","shell.execute_reply":"2023-03-22T13:10:37.246887Z"},"papermill":{"duration":0.055238,"end_time":"2023-03-22T13:10:37.253135","exception":false,"start_time":"2023-03-22T13:10:37.197897","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# use the coordinates to define the boundinbox for the Venice Laggon in the Adriatic \nadriatic = [\n  12.06659,\n  44.481556,\n  13.830519,\n  45.811687\n]","visibility":"show","key":"Wj407Efh5b"},{"type":"output","id":"EelivWJXsE22TVMj4iGbc","data":[],"visibility":"show","key":"HgqMv796aV"}],"visibility":"show","key":"EfzzR4061t"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:37.336403Z","iopub.status.busy":"2023-03-22T13:10:37.333745Z","iopub.status.idle":"2023-03-22T13:10:37.405762Z","shell.execute_reply":"2023-03-22T13:10:37.400979Z"},"papermill":{"duration":0.118312,"end_time":"2023-03-22T13:10:37.409319","exception":false,"start_time":"2023-03-22T13:10:37.291007","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# set the resolution and create a Sentinel Hub bbox and size object\n\nresolution = 100\nadriatic_bbox = BBox(bbox=adriatic, crs=CRS.WGS84)\nadriatic_size = bbox_to_dimensions(adriatic_bbox, resolution=resolution)\n\nprint(f'Image shape at {resolution} m resolution: {adriatic_bbox} pixels')","visibility":"show","key":"wl7UydW9LA"},{"type":"output","id":"mZ7fpMnyUVPlYRUWcwcFV","data":[{"name":"stdout","output_type":"stream","text":"Image shape at 100 m resolution: 12.06659,44.481556,13.830519,45.811687 pixels\n"},{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_2519/62629348.py:7: SHDeprecationWarning: The string representation of `BBox` will change to match its `repr` representation.\n  print(f'Image shape at {resolution} m resolution: {adriatic_bbox} pixels')\n"}],"visibility":"show","key":"N5b5932RZZ"}],"visibility":"show","key":"gILIflXxNO"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:37.491803Z","iopub.status.busy":"2023-03-22T13:10:37.490872Z","iopub.status.idle":"2023-03-22T13:10:37.504243Z","shell.execute_reply":"2023-03-22T13:10:37.501440Z"},"papermill":{"duration":0.068836,"end_time":"2023-03-22T13:10:37.520062","exception":false,"start_time":"2023-03-22T13:10:37.451226","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define the plot_image function\ndef plot_image(image, factor=1.0, clip_range = None, **kwargs):\n    \"\"\"\n    Utility function for plotting RGB images.\n    \"\"\"\n    fig, ax = plt.subplots(nrows=1, ncols=1, figsize=(15, 15))\n    if clip_range is not None:\n        ax.imshow(np.clip(image * factor, *clip_range), **kwargs)\n    else:\n        ax.imshow(image * factor, **kwargs)\n    \n    ax.set_xticks([])\n    ax.set_yticks([])","visibility":"show","key":"RKdGFRt6UB"},{"type":"output","id":"LbXyx5pe5wQY1uEX6UK5C","data":[],"visibility":"show","key":"RRlBIOjMgW"}],"visibility":"show","key":"Or9GbaoTQX"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.033278,"end_time":"2023-03-22T13:10:37.621167","exception":false,"start_time":"2023-03-22T13:10:37.587889","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Request vessel density data from the Sentinel Hub","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bnpj9x2jhX"}],"identifier":"request-vessel-density-data-from-the-sentinel-hub","label":"Request vessel density data from the Sentinel Hub","html_id":"request-vessel-density-data-from-the-sentinel-hub","implicit":true,"key":"iSsWrRBXi1"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"First we build the evalscript to request the data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bRtyEhDOnR"}],"key":"L9UTp9JSA5"}],"visibility":"show","key":"OiJoO8YlRH"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.036886,"end_time":"2023-03-22T13:10:37.698679","exception":false,"start_time":"2023-03-22T13:10:37.661793","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"variables to be inicted in the script for retrieving the SH images  and bands","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VEPKhXMEHb"}],"identifier":"variables-to-be-inicted-in-the-script-for-retrieving-the-sh-images-and-bands","label":"variables to be inicted in the script for retrieving the SH images  and bands","html_id":"variables-to-be-inicted-in-the-script-for-retrieving-the-sh-images-and-bands","implicit":true,"key":"ABzmFutRfy"}],"visibility":"show","key":"fLWjfQMaOq"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:37.786196Z","iopub.status.busy":"2023-03-22T13:10:37.783819Z","iopub.status.idle":"2023-03-22T13:10:37.794614Z","shell.execute_reply":"2023-03-22T13:10:37.792604Z"},"papermill":{"duration":0.059216,"end_time":"2023-03-22T13:10:37.801075","exception":false,"start_time":"2023-03-22T13:10:37.741859","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"### Parameters for the scripts for retrieving images from SH\nband = \"All\"\ncollectionID = \"beee9b47-b1ab-4044-baa5-0958d3465f12\"\nstart_date_cov = \"2020-03-15\"\nend_date_cov= \"2020-04-15\" \nstart_date_pre = \"2020-01-15\"\nend_date_pre= \"2020-02-15\" ","visibility":"show","key":"HMhzmamGnl"},{"type":"output","id":"2Be3yTju0uf5zXDreVQUS","data":[],"visibility":"show","key":"oXol9Ng2a5"}],"visibility":"show","key":"aVbnofbmj1"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:37.884559Z","iopub.status.busy":"2023-03-22T13:10:37.882113Z","iopub.status.idle":"2023-03-22T13:10:37.894107Z","shell.execute_reply":"2023-03-22T13:10:37.891853Z"},"papermill":{"duration":0.061901,"end_time":"2023-03-22T13:10:37.898754","exception":false,"start_time":"2023-03-22T13:10:37.836853","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_vessels = \"\"\"\n    //VERSION=3\n    function setup() {\n    return {\n        input: [{\n          bands: [\"%s\", \"dataMask\"], // this sets which bands to use\n        }],\n        output: { // this defines the output image type\n          bands: 4,\n          sampleType: \"UINT8\"\n        }\n    };\n}\n\nfunction evaluatePixel(sample) {\n\n  var arr = colorBlend(sample.%s,    [0.5, 2, 5 , 10, 20 , 100],    \n  [[0,155,143],[0,219,0],[255,252,0],[244,154,0],[208,19,0], [161,0,0] ]); \n  if (sample.dataMask==1)  arr.push(255);\n  else arr.push(0);\n  return arr;\n}\n\n    \"\"\"%(band,band)\nprint(evalscript_vessels)","visibility":"show","key":"j6imDcCsai"},{"type":"output","id":"so8WKhHlAU6SFREqcYrha","data":[{"name":"stdout","output_type":"stream","text":"\n    //VERSION=3\n    function setup() {\n    return {\n        input: [{\n          bands: [\"All\", \"dataMask\"], // this sets which bands to use\n        }],\n        output: { // this defines the output image type\n          bands: 4,\n          sampleType: \"UINT8\"\n        }\n    };\n}\n\nfunction evaluatePixel(sample) {\n\n  var arr = colorBlend(sample.All,    [0.5, 2, 5 , 10, 20 , 100],    \n  [[0,155,143],[0,219,0],[255,252,0],[244,154,0],[208,19,0], [161,0,0] ]); \n  if (sample.dataMask==1)  arr.push(255);\n  else arr.push(0);\n  return arr;\n}\n\n    \n"}],"visibility":"show","key":"zBwNLZ3eSk"}],"visibility":"show","key":"DkWZix7Ps5"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.084564,"end_time":"2023-03-22T13:10:38.036671","exception":false,"start_time":"2023-03-22T13:10:37.952107","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we request data over the lockdown period, remember we detected a low point in activity of 2020-04-05.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qj15WEm3S3"}],"key":"XgjXzMoZwL"}],"visibility":"show","key":"CAeM3hmA9b"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:38.152119Z","iopub.status.busy":"2023-03-22T13:10:38.150562Z","iopub.status.idle":"2023-03-22T13:10:38.166335Z","shell.execute_reply":"2023-03-22T13:10:38.164034Z"},"papermill":{"duration":0.066037,"end_time":"2023-03-22T13:10:38.169603","exception":false,"start_time":"2023-03-22T13:10:38.103566","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"request_vessels_covid = SentinelHubRequest(\n    evalscript=evalscript_vessels,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.define_byoc(collectionID),\n            time_interval=(start_date_cov, end_date_cov),\n        )\n    ],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.PNG)\n    ],\n    bbox=adriatic_bbox,\n    size=adriatic_size,\n    config=config\n)","visibility":"show","key":"leuXIL1VUJ"},{"type":"output","id":"S_XzeikYQLVQCaheCFEpp","data":[],"visibility":"show","key":"gC08BSCdvL"}],"visibility":"show","key":"BGQXdr0dSS"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.027802,"end_time":"2023-03-22T13:10:38.226562","exception":false,"start_time":"2023-03-22T13:10:38.198760","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We set the pre-covid period one month before.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Lq86VfSe3u"}],"key":"FKr142PZXM"}],"visibility":"show","key":"KkcFJut4Hv"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:38.285603Z","iopub.status.busy":"2023-03-22T13:10:38.285011Z","iopub.status.idle":"2023-03-22T13:10:38.297452Z","shell.execute_reply":"2023-03-22T13:10:38.295638Z"},"papermill":{"duration":0.045781,"end_time":"2023-03-22T13:10:38.300928","exception":false,"start_time":"2023-03-22T13:10:38.255147","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"request_vessels_pre = SentinelHubRequest(\n    evalscript=evalscript_vessels,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.define_byoc('beee9b47-b1ab-4044-baa5-0958d3465f12'),\n            time_interval=(start_date_pre, end_date_pre),\n        )\n    ],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.PNG)\n    ],\n    bbox=adriatic_bbox,\n    size=adriatic_size,\n    config=config\n)","visibility":"show","key":"ULagkiwvMd"},{"type":"output","id":"aqSlaRnImHaR_tcZVN_qY","data":[],"visibility":"show","key":"ixdNla3vvn"}],"visibility":"show","key":"NLnl5bZ4dL"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.028386,"end_time":"2023-03-22T13:10:38.358516","exception":false,"start_time":"2023-03-22T13:10:38.330130","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Request vessel density map data during lockdown","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YU6aTYlktd"}],"identifier":"request-vessel-density-map-data-during-lockdown","label":"Request vessel density map data during lockdown","html_id":"request-vessel-density-map-data-during-lockdown","implicit":true,"key":"CU1eRId6t7"}],"visibility":"show","key":"FX9djvDnvR"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:38.419867Z","iopub.status.busy":"2023-03-22T13:10:38.419358Z","iopub.status.idle":"2023-03-22T13:10:41.689481Z","shell.execute_reply":"2023-03-22T13:10:41.686378Z"},"papermill":{"duration":3.30916,"end_time":"2023-03-22T13:10:41.696869","exception":false,"start_time":"2023-03-22T13:10:38.387709","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"vessel_covid = request_vessels_covid.get_data()","visibility":"show","key":"pU50r9eFts"},{"type":"output","id":"16HgGkndj4NqEOML12Hmt","data":[],"visibility":"show","key":"x4tfhJr7Fj"}],"visibility":"show","key":"jBbmfK0fm5"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:41.779903Z","iopub.status.busy":"2023-03-22T13:10:41.779023Z","iopub.status.idle":"2023-03-22T13:10:45.895051Z","shell.execute_reply":"2023-03-22T13:10:45.893513Z"},"papermill":{"duration":4.160676,"end_time":"2023-03-22T13:10:45.905021","exception":false,"start_time":"2023-03-22T13:10:41.744345","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"image = vessel_covid[0]\nprint(f'Image type: {image.dtype}')\n\n# plot function\ncovid_data = request_vessels_covid.get_data()\nplot_image(covid_data[0], factor=1 / 255)","visibility":"show","key":"FiZFqwF8Z3"},{"type":"output","id":"GJsdsoTX9osyGNy_ipksg","data":[{"name":"stdout","output_type":"stream","text":"Image type: uint8\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"da5642acb1a717a8bf53da7172fd9203","path":"/notebooks_test/build/da5642acb1a717a8bf53da7172fd9203.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"Dfu2TURSQh"}],"visibility":"show","key":"yHfpdDf5u2"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.042281,"end_time":"2023-03-22T13:10:46.004876","exception":false,"start_time":"2023-03-22T13:10:45.962595","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Request vessel density map data before lockdown","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vDAsfmkyR1"}],"identifier":"request-vessel-density-map-data-before-lockdown","label":"Request vessel density map data before lockdown","html_id":"request-vessel-density-map-data-before-lockdown","implicit":true,"key":"p6hZsSOZwg"}],"visibility":"show","key":"rzgoahYzAN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:46.093409Z","iopub.status.busy":"2023-03-22T13:10:46.092394Z","iopub.status.idle":"2023-03-22T13:10:48.544786Z","shell.execute_reply":"2023-03-22T13:10:48.543328Z"},"papermill":{"duration":2.504895,"end_time":"2023-03-22T13:10:48.553152","exception":false,"start_time":"2023-03-22T13:10:46.048257","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"vessel_pre = request_vessels_pre.get_data()","visibility":"show","key":"tc0RMcJeQ9"},{"type":"output","id":"B_RcwDpXghoNS47Rr12rR","data":[],"visibility":"show","key":"P2LbovEmZA"}],"visibility":"show","key":"UF0BzRZFyK"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:48.729789Z","iopub.status.busy":"2023-03-22T13:10:48.728222Z","iopub.status.idle":"2023-03-22T13:10:53.155357Z","shell.execute_reply":"2023-03-22T13:10:53.151706Z"},"papermill":{"duration":4.552227,"end_time":"2023-03-22T13:10:53.165971","exception":false,"start_time":"2023-03-22T13:10:48.613744","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"image = vessel_pre[0]\nprint(f'Image type: {image.dtype}')\n\n# plot function\npre_data = request_vessels_pre.get_data()\nplot_image(pre_data[0], factor=1 / 255)","visibility":"show","key":"nOy0NpccS5"},{"type":"output","id":"ZpaSWvjQpyu_dmne8sHwt","data":[{"name":"stdout","output_type":"stream","text":"Image type: uint8\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4d5a9431641fb52295b731a3e3270a13","path":"/notebooks_test/build/4d5a9431641fb52295b731a3e3270a13.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"YwI4pAWYIu"}],"visibility":"show","key":"kofTAZmLAT"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:53.283229Z","iopub.status.busy":"2023-03-22T13:10:53.282020Z","iopub.status.idle":"2023-03-22T13:10:53.310774Z","shell.execute_reply":"2023-03-22T13:10:53.308117Z"},"papermill":{"duration":0.08967,"end_time":"2023-03-22T13:10:53.316103","exception":false,"start_time":"2023-03-22T13:10:53.226433","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# get the range of values for the vessel density maps\n\nimport numpy as np\nmin_pre = np.amin(pre_data[0])\nmax_pre = np.amax(pre_data[0])\n\nmin_post = np.amin(covid_data[0])\nmax_post = np.amax(covid_data[0])\n\nprint (\"min value pre-lockdown:\", min_pre, \"max value pre-lockdown:\", max_pre)\nprint (\"min value lockdown:\", min_post, \"max value lockdown:\", max_post)","visibility":"show","key":"pLLgpfRFUo"},{"type":"output","id":"frADE5YvJFw0-L4AWACX3","data":[{"name":"stdout","output_type":"stream","text":"min value pre-lockdown: 0 max value pre-lockdown: 255\nmin value lockdown: 0 max value lockdown: 255\n"}],"visibility":"show","key":"L5LbxhC0dI"}],"visibility":"show","key":"NucPVJvCC2"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.054777,"end_time":"2023-03-22T13:10:53.427634","exception":false,"start_time":"2023-03-22T13:10:53.372857","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The red areas indicate areas with high vessel density and the dark green areas with low density.\nFrom the two images we can see a clear reduction in vessel density with the data corresponding to reduced acrivity in the Veneto region.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MIVPhiAZ2h"}],"key":"rSHA2Z04ys"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"From the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ykM9W9IkcE"},{"type":"link","url":"https://www.emodnet-humanactivities.eu/documents/Vessel%20density%20maps_method_v1.5.pdfhttps://www.emodnet-humanactivities.eu/documents/Vessel%20density%20maps_method_v1.5.pdf","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"dataset documentation","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"NvklcPkfAJ"}],"urlSource":"https://www.emodnet-humanactivities.eu/documents/Vessel%20density%20maps_method_v1.5.pdfhttps://www.emodnet-humanactivities.eu/documents/Vessel%20density%20maps_method_v1.5.pdf","key":"hr6lhQoLPz"},{"type":"text","value":" we know that the units of density in the published maps are ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"iKzCB6LBfd"},{"type":"inlineCode","value":"total ship time in hours spent in a cell over the whole month","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"LLNcDNP2Dq"},{"type":"text","value":". As the cells are 1 km , this is immediately per square km.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"jddVf06Sha"}],"key":"p4NgNGrZ00"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"So every pixel in the original data has a value of ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"tvyW59UfWF"},{"type":"inlineCode","value":"N = nr_hours x nr_ships x nr_days_in_month","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"UICu0VD6qN"}],"key":"Gu0bV5qx3Y"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"In order to obtain the density as the average number of instantaneous ships per square km, the values of the published monthly maps must be divided by the total number of hours in the month, which is 28, 30 or 31 times 24 hours depending on the month. For the published yearly average maps, the values must be multiplied by 12 and divided by 365 times 24 hours (for 2017).","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"eSTaUdiBuf"}],"key":"zedDD1nqIr"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"To convert to ship density per square degree instead of per square km, the published numbers can be multiplied by the factor ( 60 * 1.852 )2 cos( latitude ).","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"xCDkxIAVH3"}],"key":"uWrmDwaQ2S"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Note that in the plotted images above, the pixel values range between [0, 255]. This is due to the fact that all values above 100 hours have been capped at 255","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"K9UDfG5thQ"}],"key":"s7DjUuovnP"},{"type":"text","value":".","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"sBQNmFxi7Y"}],"key":"v1RZZAMscK"}],"visibility":"show","key":"m4rzIjF6Ol"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.070213,"end_time":"2023-03-22T13:10:53.561137","exception":false,"start_time":"2023-03-22T13:10:53.490924","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercise 1: Use EO Dashboard/ RACE Dashboard to extract vessel density time series","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WgT1xBktKz"}],"identifier":"exercise-1-use-eo-dashboard-race-dashboard-to-extract-vessel-density-time-series","label":"Exercise 1: Use EO Dashboard/ RACE Dashboard to extract vessel density time series","html_id":"exercise-1-use-eo-dashboard-race-dashboard-to-extract-vessel-density-time-series","implicit":true,"key":"pXO295C8WU"}],"visibility":"show","key":"tULujqg7jT"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.065175,"end_time":"2023-03-22T13:10:53.688568","exception":false,"start_time":"2023-03-22T13:10:53.623393","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Vessel data can be accessed on the RACE Dashboard at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tkblK2VRPC"},{"type":"link","url":"https://race.esa.int/?poi=World-E13o","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​race​.esa​.int​/​?poi​=​World​-E13o","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wUQwGJFEJq"}],"urlSource":"https://race.esa.int/?poi=World-E13o","key":"tYLUet7QhT"}],"key":"MzO65MYSf2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Using the Draw AOI feature, generate a time series chart. Note that the polygon information is included in the URL.\nUse the information from the previously defined bounding box to customise the AOI, then regenerate the graph.\nDownload the CSV and import it into your workspace.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"h4ytjpWOfx"}],"key":"aomgxrTKqk"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Read the CSV and plot the graph.\nCan you determine significant changes in the vessel traffic from the plot?","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"YXIO4sLALt"}],"key":"e19LKiJ0gY"}],"visibility":"show","key":"B5kymMcqom"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.056787,"end_time":"2023-03-22T13:10:53.798563","exception":false,"start_time":"2023-03-22T13:10:53.741776","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Using the NASA API to retrieve nightlights data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kFEKuKLYkX"}],"identifier":"using-the-nasa-api-to-retrieve-nightlights-data","label":"Using the NASA API to retrieve nightlights data","html_id":"using-the-nasa-api-to-retrieve-nightlights-data","implicit":true,"key":"IdXm8WX0rt"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s inspect the Nightlights data over Venice. To inspect other locations and learn more about these datasets access this ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"f83wQxSJap"},{"type":"link","url":"https://eodashboard.org/story?id=nightlights","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Nightlights Story on EO Dashboard","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vC7C9LheaG"}],"urlSource":"https://eodashboard.org/story?id=nightlights","key":"KLHTrHUtou"}],"key":"Dezyq0kPwW"}],"visibility":"show","key":"sDWjJwvZdY"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:53.918013Z","iopub.status.busy":"2023-03-22T13:10:53.917543Z","iopub.status.idle":"2023-03-22T13:10:53.935722Z","shell.execute_reply":"2023-03-22T13:10:53.933580Z"},"papermill":{"duration":0.084543,"end_time":"2023-03-22T13:10:53.940880","exception":false,"start_time":"2023-03-22T13:10:53.856337","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"IFrame('https://eodashboard.org/explore?indicator=N5&poi=IT01-N5', width=800, height=500)","visibility":"show","key":"rbdN90TTWk"},{"type":"output","id":"W_UDM4hZXzPGEGJgRxzMZ","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/html":{"content":"\n        <iframe\n            width=\"800\"\n            height=\"500\"\n            src=\"https://eodashboard.org/explore?indicator=N5&poi=IT01-N5\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ","content_type":"text/html"},"text/plain":{"content":"<IPython.lib.display.IFrame at 0x7f98aada8b20>","content_type":"text/plain"}}}],"visibility":"show","key":"ZWWrPjklPN"}],"visibility":"show","key":"pWfNuHhEJC"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.057422,"end_time":"2023-03-22T13:10:54.057237","exception":false,"start_time":"2023-03-22T13:10:53.999815","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we retrieve nightlights data from the NASA API to check if there is a reduction in activity in the island of Venice over the covid period. The High Definition Nightlights dataset is processed to eliminate light sources like moonlight reflectance and other interferences. The darker shades are places with less light while the lighter shades of yellow are areas with more light.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"THk2u5ehda"}],"key":"YiOy6CiI9R"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The endpoints include a STAC API, which is a catalog endpoint to retrieve metadata on available datasets: ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WtlvjNcJrr"},{"type":"link","url":"https://staging-stac.delta-backend.com/docs/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"https://​staging​-stac​.delta​-backend​.com​/docs/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gk2Eo8yUdn"}],"urlSource":"https://staging-stac.delta-backend.com/docs/","key":"gMml93I56G"}],"key":"RYdOXP3hFB"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The other is to render the data for which we find information in the STAC API: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VDUGyMjZrM"},{"type":"link","url":"https://staging-raster.delta-backend.com/docs/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"https://​staging​-raster​.delta​-backend​.com​/docs/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"U9zC7E3qRy"}],"urlSource":"https://staging-raster.delta-backend.com/docs/","key":"uJQGPfKfp4"}],"key":"tgKDG5NuuL"}],"visibility":"show","key":"BbDrEZzH9Y"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:54.175126Z","iopub.status.busy":"2023-03-22T13:10:54.174654Z","iopub.status.idle":"2023-03-22T13:10:54.186307Z","shell.execute_reply":"2023-03-22T13:10:54.184125Z"},"papermill":{"duration":0.077878,"end_time":"2023-03-22T13:10:54.189859","exception":false,"start_time":"2023-03-22T13:10:54.111981","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# endpoints for nasa api\nSTAC_ENDPOINT_URL = \"https://staging-stac.delta-backend.com\"\nRASTER_ENDPOINT_URL = \"https://staging-raster.delta-backend.com\"","visibility":"show","key":"RiNW4MmPAs"},{"type":"output","id":"LPUurybmIy6aNI-6oEWHF","data":[],"visibility":"show","key":"hrOGnKfF7C"}],"visibility":"show","key":"qJ3z4qMQwG"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.056446,"end_time":"2023-03-22T13:10:54.309634","exception":false,"start_time":"2023-03-22T13:10:54.253188","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Request metadata for the nightlights data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a5UuEqyAjj"}],"identifier":"request-metadata-for-the-nightlights-data","label":"Request metadata for the nightlights data","html_id":"request-metadata-for-the-nightlights-data","implicit":true,"key":"v9Ay0o2e6Q"}],"visibility":"show","key":"KAaW2Xf3VW"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:54.438982Z","iopub.status.busy":"2023-03-22T13:10:54.437260Z","iopub.status.idle":"2023-03-22T13:10:55.393931Z","shell.execute_reply":"2023-03-22T13:10:55.388132Z"},"papermill":{"duration":1.022943,"end_time":"2023-03-22T13:10:55.397569","exception":false,"start_time":"2023-03-22T13:10:54.374626","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# summary of the metadata for the indicator of interest\nnightlights_collection_summary = re.get(f\"{STAC_ENDPOINT_URL}/collections/nightlights-hd-monthly\").json()\nnightlights_collection_summary","visibility":"show","key":"QpU307o6vt"},{"type":"output","id":"yHkdDINwOblR6-Gkducnc","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/plain":{"content":"{'id': 'nightlights-hd-monthly',\n 'type': 'Collection',\n 'links': [{'rel': 'items',\n   'type': 'application/geo+json',\n   'href': 'https://staging-stac.delta-backend.com/collections/nightlights-hd-monthly/items'},\n  {'rel': 'parent',\n   'type': 'application/json',\n   'href': 'https://staging-stac.delta-backend.com/'},\n  {'rel': 'root',\n   'type': 'application/json',\n   'href': 'https://staging-stac.delta-backend.com/'},\n  {'rel': 'self',\n   'type': 'application/json',\n   'href': 'https://staging-stac.delta-backend.com/collections/nightlights-hd-monthly'}],\n 'title': 'Black Marble High Definition Nightlights Monthly Dataset',\n 'extent': {'spatial': {'bbox': [[-180, -90, 180, 90]]},\n  'temporal': {'interval': [['2017-07-21T00:00:00Z',\n     '2021-09-30T23:59:59Z']]}},\n 'license': 'MIT',\n 'summaries': {'datetime': ['2019-01-01T00:00:00Z', '2022-03-01T00:00:00Z'],\n  'cog_default': {'max': 255, 'min': 0}},\n 'description': 'The High Definition Nightlights dataset is processed to eliminate light sources, including moonlight reflectance and other interferences. Darker colors indicate fewer night lights and less activity. Lighter colors indicate more night lights and more activity.',\n 'item_assets': {'cog_default': {'type': 'image/tiff; application=geotiff; profile=cloud-optimized',\n   'roles': ['data', 'layer'],\n   'title': 'Default COG Layer',\n   'description': 'Cloud optimized default layer to display on map'}},\n 'stac_version': '1.0.0',\n 'stac_extensions': [],\n 'dashboard:is_periodic': True,\n 'dashboard:time_density': 'month'}","content_type":"text/plain"}}}],"visibility":"show","key":"y7jU9uKfYw"}],"visibility":"show","key":"yS5Jefj36k"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.055087,"end_time":"2023-03-22T13:10:55.506750","exception":false,"start_time":"2023-03-22T13:10:55.451663","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Request nightlights data before lockdown","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nhm9bU38FX"}],"identifier":"request-nightlights-data-before-lockdown","label":"Request nightlights data before lockdown","html_id":"request-nightlights-data-before-lockdown","implicit":true,"key":"sSNLdlAXDX"}],"visibility":"show","key":"seBpa5shx7"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:55.620348Z","iopub.status.busy":"2023-03-22T13:10:55.618559Z","iopub.status.idle":"2023-03-22T13:10:56.495888Z","shell.execute_reply":"2023-03-22T13:10:56.494246Z"},"papermill":{"duration":0.935542,"end_time":"2023-03-22T13:10:56.498666","exception":false,"start_time":"2023-03-22T13:10:55.563124","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# retrieving a pre-covid image from the STAC API\n\nresponse_pre = re.post(\n    f\"{STAC_ENDPOINT_URL}/search\", \n    json={\n        \"collections\": [\"nightlights-hd-monthly\"],\n        \"query\": {\"datetime\": {\"eq\":\"2019-04-01T00:00:00\"}},\n        \"limit\": 100\n    }\n).json()\nitem_pre = response_pre[\"features\"][0]","visibility":"show","key":"rsaIW3GQmf"},{"type":"output","id":"zr4E8gIS1W4HsCxGPt4nc","data":[],"visibility":"show","key":"YBA0Gj51eg"}],"visibility":"show","key":"qvm7PeeHwl"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.059026,"end_time":"2023-03-22T13:10:56.623746","exception":false,"start_time":"2023-03-22T13:10:56.564720","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In order to render the image correctly you must define the visualisation parameters, which will differ between datasets. Here in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CGEt8emjZW"},{"type":"link","url":"https://staging-raster.delta-backend.com/docs#/Cloud%20Optimized%20GeoTIFF/preview_cog_preview__format__get","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"documentation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hguZd4MJoX"}],"urlSource":"https://staging-raster.delta-backend.com/docs#/Cloud%20Optimized%20GeoTIFF/preview_cog_preview__format__get","key":"e0PV7i5nI0"},{"type":"text","value":" you can input the correct visualisation parameters and generate an output, this will help you to form the request within the notebook.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gNGa5v5VFF"}],"key":"lhbbiFZDia"}],"visibility":"show","key":"KI2k4oYuEt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:56.748891Z","iopub.status.busy":"2023-03-22T13:10:56.748222Z","iopub.status.idle":"2023-03-22T13:10:57.489562Z","shell.execute_reply":"2023-03-22T13:10:57.481422Z"},"papermill":{"duration":0.81192,"end_time":"2023-03-22T13:10:57.492771","exception":false,"start_time":"2023-03-22T13:10:56.680851","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# rendering the image with the RASTER API\ntiles_pre_covid = re.get(\n    f\"{RASTER_ENDPOINT_URL}/stac/tilejson.json?collection={item_pre['collection']}&item={item_pre['id']}&assets=cog_default&bidx=1&unscale=false&resampling=nearest&max_size=1024&rescale=0%2C255&colormap_name=plasma\", \n).json()\ntiles_pre_covid","visibility":"show","key":"xVs4MgKM2A"},{"type":"output","id":"EsoBEQSkFz0WcYN_YCH6r","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/plain":{"content":"{'tilejson': '2.2.0',\n 'version': '1.0.0',\n 'scheme': 'xyz',\n 'tiles': ['https://staging-raster.delta-backend.com/stac/tiles/WebMercatorQuad/{z}/{x}/{y}@1x?collection=nightlights-hd-monthly&item=finalBMHD_ScaledVenice_201904&assets=cog_default&bidx=1&unscale=false&resampling=nearest&max_size=1024&rescale=0%2C255&colormap_name=plasma'],\n 'minzoom': 0,\n 'maxzoom': 24,\n 'bounds': [11.7631744, 45.06062636, 12.79039608, 45.79310055],\n 'center': [12.27678524, 45.426863455, 0]}","content_type":"text/plain"}}}],"visibility":"show","key":"jaOpVgilCO"}],"visibility":"show","key":"msN2glundR"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.05824,"end_time":"2023-03-22T13:10:57.618903","exception":false,"start_time":"2023-03-22T13:10:57.560663","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Request nightlights data during lockdown","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FEo34ilL2R"}],"identifier":"request-nightlights-data-during-lockdown","label":"Request nightlights data during lockdown","html_id":"request-nightlights-data-during-lockdown","implicit":true,"key":"Dge1TCie4e"}],"visibility":"show","key":"rqxDEXCIhc"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:57.765003Z","iopub.status.busy":"2023-03-22T13:10:57.764595Z","iopub.status.idle":"2023-03-22T13:10:58.664407Z","shell.execute_reply":"2023-03-22T13:10:58.662742Z"},"papermill":{"duration":0.994943,"end_time":"2023-03-22T13:10:58.667535","exception":false,"start_time":"2023-03-22T13:10:57.672592","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# retrieving a covid image from the STAC API\n\nresponse_nasa_covid = re.post(\n    f\"{STAC_ENDPOINT_URL}/search\", \n    json={\n        \"collections\": [\"nightlights-hd-monthly\"],\n        \"query\": {\"datetime\": {\"eq\":\"2020-04-01T00:00:00\"}},\n        \"limit\": 100\n    }\n).json()\nitem_covid = response_nasa_covid[\"features\"][0]","visibility":"show","key":"llxZdmz36V"},{"type":"output","id":"0pL331cU00B2BST3-ngz-","data":[],"visibility":"show","key":"t1e8zg9MFe"}],"visibility":"show","key":"fRBFGk3Rei"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:58.799439Z","iopub.status.busy":"2023-03-22T13:10:58.798614Z","iopub.status.idle":"2023-03-22T13:10:59.511053Z","shell.execute_reply":"2023-03-22T13:10:59.507898Z"},"papermill":{"duration":0.794229,"end_time":"2023-03-22T13:10:59.518142","exception":false,"start_time":"2023-03-22T13:10:58.723913","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"tiles_covid = re.get(\n    f\"{RASTER_ENDPOINT_URL}/stac/tilejson.json?collection={item_covid['collection']}&item={item_covid['id']}&assets=cog_default&bidx=1&unscale=false&resampling=nearest&max_size=1024&rescale=0%2C255&colormap_name=plasma\", \n).json()\ntiles_covid","visibility":"show","key":"kKoShJj13i"},{"type":"output","id":"1BiNlAgncmgHWU9qXu8gu","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/plain":{"content":"{'tilejson': '2.2.0',\n 'version': '1.0.0',\n 'scheme': 'xyz',\n 'tiles': ['https://staging-raster.delta-backend.com/stac/tiles/WebMercatorQuad/{z}/{x}/{y}@1x?collection=nightlights-hd-monthly&item=finalBMHD_ScaledVenice_202004&assets=cog_default&bidx=1&unscale=false&resampling=nearest&max_size=1024&rescale=0%2C255&colormap_name=plasma'],\n 'minzoom': 0,\n 'maxzoom': 24,\n 'bounds': [11.7631744, 45.06062636, 12.79039608, 45.79310055],\n 'center': [12.27678524, 45.426863455, 0]}","content_type":"text/plain"}}}],"visibility":"show","key":"nUXGoilgo2"}],"visibility":"show","key":"Uxy9WtS0CQ"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.054734,"end_time":"2023-03-22T13:10:59.623705","exception":false,"start_time":"2023-03-22T13:10:59.568971","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Directly compare the two images","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XsQRgkh52E"}],"identifier":"directly-compare-the-two-images","label":"Directly compare the two images","html_id":"directly-compare-the-two-images","implicit":true,"key":"RRZeOmzZq9"}],"visibility":"show","key":"FgAkMYiNsp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:59.786564Z","iopub.status.busy":"2023-03-22T13:10:59.785953Z","iopub.status.idle":"2023-03-22T13:10:59.796086Z","shell.execute_reply":"2023-03-22T13:10:59.794488Z"},"papermill":{"duration":0.134523,"end_time":"2023-03-22T13:10:59.808611","exception":false,"start_time":"2023-03-22T13:10:59.674088","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# set map parameters\ncenter = [45.438558, 12.333421]\nzoom = 13","visibility":"show","key":"jZj20pZWaN"},{"type":"output","id":"VJzzKEl1lg3wPGKXIdj7I","data":[],"visibility":"show","key":"PlBXMhAZqN"}],"visibility":"show","key":"k1u6K6TLic"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:10:59.936843Z","iopub.status.busy":"2023-03-22T13:10:59.935963Z","iopub.status.idle":"2023-03-22T13:10:59.959539Z","shell.execute_reply":"2023-03-22T13:10:59.957632Z"},"papermill":{"duration":0.097299,"end_time":"2023-03-22T13:10:59.973752","exception":false,"start_time":"2023-03-22T13:10:59.876453","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# display interactive map\nm = Map(center=center, zoom=zoom)\nm","visibility":"show","key":"bFcMOS02LI"},{"type":"output","id":"ZkDowdsLz6pKj3NpkD5Lh","data":[{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"fd4635d27f5e4012a60cfc3f636cb9ab\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"text/plain":{"content":"Map(center=[45.438558, 12.333421], controls=(ZoomControl(options=['position', 'zoom_in_text', 'zoom_in_title',…","content_type":"text/plain"}}}],"visibility":"show","key":"kenGkHtphB"}],"visibility":"show","key":"lllYExYg1n"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:11:00.101701Z","iopub.status.busy":"2023-03-22T13:11:00.100117Z","iopub.status.idle":"2023-03-22T13:11:00.124854Z","shell.execute_reply":"2023-03-22T13:11:00.120271Z"},"papermill":{"duration":0.090283,"end_time":"2023-03-22T13:11:00.128713","exception":false,"start_time":"2023-03-22T13:11:00.038430","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"left = TileLayer(url=tiles_pre_covid[\"tiles\"][0])\nright = TileLayer(url=tiles_covid[\"tiles\"][0])\n\ncontrol = SplitMapControl(left_layer=left, right_layer=right)\nm.add_control(control)","visibility":"show","key":"f3Y0nVh84T"},{"type":"output","id":"fOuiOEcG2z3Uc-QSc2OJh","data":[],"visibility":"show","key":"cuvI6CjelA"}],"visibility":"show","key":"N8j3NoUcQK"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.082145,"end_time":"2023-03-22T13:11:00.276656","exception":false,"start_time":"2023-03-22T13:11:00.194511","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The darker areas indicate a reduction in luminosity and the yellow areas higher luminosity, when comparing the two images we can see a reduction in activity over the covid period.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xy2o9roqIC"}],"key":"Qxhs7wqgJa"}],"visibility":"show","key":"QPZ46kxBUx"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.062505,"end_time":"2023-03-22T13:11:00.447510","exception":false,"start_time":"2023-03-22T13:11:00.385005","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Retrieving Sentinel 2 imagery over the Island of Venice","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t3CbIKp4iI"}],"identifier":"retrieving-sentinel-2-imagery-over-the-island-of-venice","label":"Retrieving Sentinel 2 imagery over the Island of Venice","html_id":"retrieving-sentinel-2-imagery-over-the-island-of-venice","implicit":true,"key":"yw9IJ4A8im"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Now we have identified the drop in activity due to the lockdown conditions we can retrieve the satellite images to see if there is a corresponding impact visable.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"TGPZ6X8tLc"}],"key":"hVx7VT4Egj"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"link","url":"https://sentinel.esa.int/web/sentinel/missions/sentinel-2","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Sentinel-2","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Nsw7YPuXts"}],"urlSource":"https://sentinel.esa.int/web/sentinel/missions/sentinel-2","key":"F3mMGcIMOT"},{"type":"text","value":" is a multispectral satellite with 13 spectral bands, launched in 2016. We use the Red, Green and Blue bands to contruct a true colour image over the island of Vencie from August 2019 to August 2020.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"QsJgsyc9V0"}],"key":"hNyWh7eSfq"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This data is stored in the Sentinel Hub, for more infomation on the dataset and parameters visit the ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"taBycs3yY9"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/data/sentinel-2-l1c/","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"documentation.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"fQGWyw0KtH"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/data/sentinel-2-l1c/","key":"JbKXI3Mylb"}],"key":"Edu6FEBSwu"}],"visibility":"show","key":"lvDIIsyDYr"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.071688,"end_time":"2023-03-22T13:11:00.622214","exception":false,"start_time":"2023-03-22T13:11:00.550526","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"First we define a bounding box for our area of intrest. An easy way to do this is using the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P4H3q21rw9"},{"type":"link","url":"https://apps.sentinel-hub.com/requests-builder/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"SH Request Builder.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ibJctb6U8s"}],"urlSource":"https://apps.sentinel-hub.com/requests-builder/","key":"P82mbrFWIU"}],"key":"d3ro6JKiZd"}],"visibility":"show","key":"vJGQFGVEBj"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:11:00.767431Z","iopub.status.busy":"2023-03-22T13:11:00.766727Z","iopub.status.idle":"2023-03-22T13:11:00.775192Z","shell.execute_reply":"2023-03-22T13:11:00.773541Z"},"papermill":{"duration":0.084081,"end_time":"2023-03-22T13:11:00.780455","exception":false,"start_time":"2023-03-22T13:11:00.696374","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# defining our bbox over the island of Venice\n\nvenice = [\n  12.296613,\n  45.411707,\n  12.393469,\n  45.469281\n]","visibility":"show","key":"JWdEeGAtjD"},{"type":"output","id":"8pCL17HZb6dJl3LZ9waLH","data":[],"visibility":"show","key":"zGAZT7g1iU"}],"visibility":"show","key":"wkIuQpo0Nh"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:11:00.946701Z","iopub.status.busy":"2023-03-22T13:11:00.946163Z","iopub.status.idle":"2023-03-22T13:11:00.963744Z","shell.execute_reply":"2023-03-22T13:11:00.960370Z"},"papermill":{"duration":0.105476,"end_time":"2023-03-22T13:11:00.969952","exception":false,"start_time":"2023-03-22T13:11:00.864476","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"#Set the resolution and create a sentinel hub bbox and size object\n\nresolution = 10\nvenice_bbox = BBox(bbox=venice, crs=CRS.WGS84)\nvenice_size = bbox_to_dimensions(venice_bbox, resolution=resolution)\n\nprint(f'Image shape at {resolution} m resolution: {venice_bbox} pixels')","visibility":"show","key":"dJHxIKcjhv"},{"type":"output","id":"H0faVcMFaD1cLM93f6vHx","data":[{"name":"stdout","output_type":"stream","text":"Image shape at 10 m resolution: 12.296613,45.411707,12.393469,45.469281 pixels\n"},{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_2519/289685052.py:7: SHDeprecationWarning: The string representation of `BBox` will change to match its `repr` representation.\n  print(f'Image shape at {resolution} m resolution: {venice_bbox} pixels')\n"}],"visibility":"show","key":"ZL5fHHIRyf"}],"visibility":"show","key":"kzh2JZGEKy"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.062215,"end_time":"2023-03-22T13:11:01.115439","exception":false,"start_time":"2023-03-22T13:11:01.053224","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Below we use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u7HF3Z66vF"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/evalscript/v3/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Evalscript","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uDnchQxy8g"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/evalscript/v3/","key":"RWj4Cgc63u"},{"type":"text","value":" to define the metadata and preprocessing for RGB Sentinel-2 imagery from the Sentinelhub.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DUjHy3QJgE"}],"key":"O2I5ynho3b"}],"visibility":"show","key":"wbJM8o4aGH"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:11:01.217987Z","iopub.status.busy":"2023-03-22T13:11:01.217524Z","iopub.status.idle":"2023-03-22T13:11:01.231054Z","shell.execute_reply":"2023-03-22T13:11:01.228324Z"},"papermill":{"duration":0.076954,"end_time":"2023-03-22T13:11:01.242458","exception":false,"start_time":"2023-03-22T13:11:01.165504","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_true_color = \"\"\"\n    //VERSION=3\n\n    function setup() {\n        return {\n            input: [{\n                bands: [\"B02\", \"B03\", \"B04\"]\n            }],\n            output: {\n                bands: 3\n            }\n        };\n    }\n\n    function evaluatePixel(sample) {\n        return [2.5 * sample.B04, 2.5 * sample.B03, 2.5 * sample.B02];\n    }\n\"\"\"","visibility":"show","key":"HVPOds6pni"},{"type":"output","id":"-vwhHO7HXs__-6xORStWr","data":[],"visibility":"show","key":"ROZBVF9OaO"}],"visibility":"show","key":"Ep8aUJn2ZN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:11:01.350772Z","iopub.status.busy":"2023-03-22T13:11:01.350355Z","iopub.status.idle":"2023-03-22T13:11:01.366308Z","shell.execute_reply":"2023-03-22T13:11:01.363703Z"},"papermill":{"duration":0.082008,"end_time":"2023-03-22T13:11:01.372796","exception":false,"start_time":"2023-03-22T13:11:01.290788","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# We create a list of dates for retreiving multiple images\n\nstart = datetime.datetime(2019,8,1)\nend = datetime.datetime(2020,8,1)\nn_chunks =13\ntdelta = (end - start) / n_chunks\nedges = [(start + i*tdelta).date().isoformat() for i in range(n_chunks)]\nslots = [(edges[i], edges[i+1]) for i in range(len(edges)-1)]\n\nprint('Monthly time windows:\\n')\nfor slot in slots:\n    print(slot)","visibility":"show","key":"d5kWaJJVMn"},{"type":"output","id":"EIQHsyyEUTmVNpPZgFMHm","data":[{"name":"stdout","output_type":"stream","text":"Monthly time windows:\n\n('2019-08-01', '2019-08-29')\n('2019-08-29', '2019-09-26')\n('2019-09-26', '2019-10-24')\n('2019-10-24', '2019-11-21')\n('2019-11-21', '2019-12-19')\n('2019-12-19', '2020-01-16')\n('2020-01-16', '2020-02-14')\n('2020-02-14', '2020-03-13')\n('2020-03-13', '2020-04-10')\n('2020-04-10', '2020-05-08')\n('2020-05-08', '2020-06-05')\n('2020-06-05', '2020-07-03')\n"}],"visibility":"show","key":"jyvfvleSMt"}],"visibility":"show","key":"IcQPzm3Cyp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:11:01.497680Z","iopub.status.busy":"2023-03-22T13:11:01.497109Z","iopub.status.idle":"2023-03-22T13:11:01.522120Z","shell.execute_reply":"2023-03-22T13:11:01.518269Z"},"papermill":{"duration":0.086026,"end_time":"2023-03-22T13:11:01.526708","exception":false,"start_time":"2023-03-22T13:11:01.440682","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# define the function to retreive the image\ndef get_true_color_request(time_interval):\n    return SentinelHubRequest(\n        evalscript=evalscript_true_color,\n        input_data=[\n            SentinelHubRequest.input_data(\n                data_collection=DataCollection.SENTINEL2_L1C,\n                time_interval=time_interval,\n                mosaicking_order='leastCC'\n            )\n        ],\n        responses=[\n            SentinelHubRequest.output_response('default', MimeType.PNG)\n        ],\n        bbox=venice_bbox,\n        size=venice_size,\n        config=config\n    )","visibility":"show","key":"DKtdLLwIha"},{"type":"output","id":"gxM44DJvbKzN__vq9kLpO","data":[],"visibility":"show","key":"f1kaxqVcsO"}],"visibility":"show","key":"A5aqQPbT7t"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:11:01.632880Z","iopub.status.busy":"2023-03-22T13:11:01.632233Z","iopub.status.idle":"2023-03-22T13:11:11.368812Z","shell.execute_reply":"2023-03-22T13:11:11.366846Z"},"papermill":{"duration":9.915768,"end_time":"2023-03-22T13:11:11.489513","exception":false,"start_time":"2023-03-22T13:11:01.573745","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# create a list of requests\nlist_of_requests = [get_true_color_request(slot) for slot in slots]\nlist_of_requests = [request.download_list[0] for request in list_of_requests]\n\n# download data with multiple threads\ndata = SentinelHubDownloadClient(config=config).download(list_of_requests, max_threads=5)\n# some stuff for pretty plots\nncols = 3\nnrows = 4\naspect_ratio = venice_size[0] / venice_size[1]\nsubplot_kw = {'xticks': [], 'yticks': [], 'frame_on': False}\n\nfig, axs = plt.subplots(ncols=ncols, nrows=nrows, figsize=(5 * ncols * aspect_ratio, 5 * nrows),\n                        subplot_kw=subplot_kw)\n\nfor idx, image in enumerate(data):\n    ax = axs[idx // ncols][idx % ncols]\n    ax.imshow(np.clip(image * 2.5/255, 0, 1))\n    ax.set_title(f'{slots[idx][0]}  -  {slots[idx][1]}', fontsize=10)\n\nplt.tight_layout()","visibility":"show","key":"lMw9fStiUh"},{"type":"output","id":"CWqxATVXBn6BDkH6jS7ws","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ae4eeb7ff2c8fafc87df150f1fe9681d","path":"/notebooks_test/build/ae4eeb7ff2c8fafc87df150f1fe9681d.png"},"text/plain":{"content":"<Figure size 1900x2000 with 12 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"ALYvGJhMRj"}],"visibility":"show","key":"qBrVkWHf4i"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.154262,"end_time":"2023-03-22T13:11:11.808028","exception":false,"start_time":"2023-03-22T13:11:11.653766","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"EXERCISE","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AHGdnsxHXP"}],"identifier":"exercise","label":"EXERCISE","html_id":"exercise","implicit":true,"key":"qoa1i7dQRz"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Are you aware of the atmospheric correction effect on the image? To understand the impact on the true color images use SENTINEL2_L2A instead of SENTINEL2_L1C in the get true color request function","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"vT8H8ic4AN"}],"key":"BkZudrvflI"}],"visibility":"show","key":"pJ3MqRBqm3"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.151453,"end_time":"2023-03-22T13:11:12.112670","exception":false,"start_time":"2023-03-22T13:11:11.961217","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From the images we can see a sharp reduction in the amount of boats which are travelling around the Island of Venice, and a corresponding impovement in the water quality.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DYo4ilYlsy"}],"key":"kZYfYiQ7DX"}],"visibility":"show","key":"SpxmzdtKfU"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.165361,"end_time":"2023-03-22T13:11:12.438238","exception":false,"start_time":"2023-03-22T13:11:12.272877","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Requesting Water Quality Data from JAXA","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vEhOOEUhoC"}],"identifier":"requesting-water-quality-data-from-jaxa","label":"Requesting Water Quality Data from JAXA","html_id":"requesting-water-quality-data-from-jaxa","implicit":true,"key":"LHtaEUmZAz"}],"visibility":"show","key":"nH61vMXtin"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.15621,"end_time":"2023-03-22T13:11:12.839962","exception":false,"start_time":"2023-03-22T13:11:12.683752","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In order to test our theory about the improved water quality we use JAXA water quality data, specifically ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZdQ2vD04qM"},{"type":"link","url":"https://collections.eurodatacube.com/jaxa_wq_chla/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"water quality Chlorophyll-a weekly anomaly","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V0hpk3NDsg"}],"urlSource":"https://collections.eurodatacube.com/jaxa_wq_chla/","key":"oWFflbULbm"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EPZNvgw66w"}],"key":"AQBQQiMWTo"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"As data is stored in the Sentinel Hub we use a similar syntax as above to retrieve the data but instead define the byoc code, stated in the documentation.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SfmTREmeyC"}],"key":"Ff58n1hhpi"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We will request this data using the Adriatic boundinbox.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gcNehL9Vxy"}],"key":"wCx0vFsrps"}],"visibility":"show","key":"WiCBEiNpFj"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.15968,"end_time":"2023-03-22T13:11:13.165926","exception":false,"start_time":"2023-03-22T13:11:13.006246","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The following cell is reccomended to set the reference collection and the band to be used.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zFylDTXLez"}],"key":"NAGhYbuqQf"}],"visibility":"show","key":"O5aLmx2MTh"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:11:13.485655Z","iopub.status.busy":"2023-03-22T13:11:13.485219Z","iopub.status.idle":"2023-03-22T13:11:13.506483Z","shell.execute_reply":"2023-03-22T13:11:13.498629Z"},"papermill":{"duration":0.193905,"end_time":"2023-03-22T13:11:13.516035","exception":false,"start_time":"2023-03-22T13:11:13.322130","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"### Parameters for the scripts for retrieving images from SH\nband = \"chla\"\ncollectionID = \"198aa13a-b0c0-4b78-8f69-e08fc58551a7\"\nstart_date = \"2020-03-15\"\nend_date= \"2020-04-15\" ","visibility":"show","key":"KhC8myieDQ"},{"type":"output","id":"1qs76XMzIS0xE_Nd8ijI3","data":[],"visibility":"show","key":"LOelxA1day"}],"visibility":"show","key":"Pjeq6VnKtv"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:11:13.961070Z","iopub.status.busy":"2023-03-22T13:11:13.959732Z","iopub.status.idle":"2023-03-22T13:11:13.982083Z","shell.execute_reply":"2023-03-22T13:11:13.980269Z"},"papermill":{"duration":0.226419,"end_time":"2023-03-22T13:11:13.984992","exception":false,"start_time":"2023-03-22T13:11:13.758573","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_jaxa = \"\"\"\n    //VERSION=3\n    function setup() {\n      return {\n        input: [\"%s\"],\n        output: { bands: 1,\n          sampleType: \"UINT8\" }\n      };\n    }\n    function evaluatePixel(sample) {\n        return [sample.%s];\n    }\n    \"\"\"%(band,band)\nprint(evalscript_jaxa)","visibility":"show","key":"Luz8RZe7W8"},{"type":"output","id":"yLpBLfanPBbOt0EUTlkEz","data":[{"name":"stdout","output_type":"stream","text":"\n    //VERSION=3\n    function setup() {\n      return {\n        input: [\"chla\"],\n        output: { bands: 1,\n          sampleType: \"UINT8\" }\n      };\n    }\n    function evaluatePixel(sample) {\n        return [sample.chla];\n    }\n    \n"}],"visibility":"show","key":"nSfRfHrbUJ"}],"visibility":"show","key":"caDYBL5xJ0"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:11:14.310278Z","iopub.status.busy":"2023-03-22T13:11:14.309482Z","iopub.status.idle":"2023-03-22T13:11:15.307146Z","shell.execute_reply":"2023-03-22T13:11:15.298650Z"},"papermill":{"duration":1.168613,"end_time":"2023-03-22T13:11:15.315467","exception":false,"start_time":"2023-03-22T13:11:14.146854","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"#defining the request\nrequest_jaxa = SentinelHubRequest(\n    evalscript=evalscript_jaxa,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.define_byoc(collectionID),  #('4f5f67f1-5715-4f2b-8c98-ae57948ee2f5'),\n            time_interval=(start_date, end_date),\n        )\n    ],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.PNG)\n    ],\n    bbox=adriatic_bbox,\n    size=adriatic_size,\n    config=config\n)\n\njaxa = request_jaxa.get_data()","visibility":"show","key":"xoVx74lw2u"},{"type":"output","id":"M0DBpQgDj05gpemwvlYkY","data":[],"visibility":"show","key":"G5gBiR68G4"}],"visibility":"show","key":"UAvNSqDRlh"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:11:15.804068Z","iopub.status.busy":"2023-03-22T13:11:15.803700Z","iopub.status.idle":"2023-03-22T13:11:17.207575Z","shell.execute_reply":"2023-03-22T13:11:17.205420Z"},"papermill":{"duration":1.639944,"end_time":"2023-03-22T13:11:17.213401","exception":false,"start_time":"2023-03-22T13:11:15.573457","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# retreiving a single image\nimage = jaxa[0]\nprint(f'Image type: {image.dtype}')\n\n# plot function\nplot_image(jaxa[0], factor=1 / 255)","visibility":"show","key":"W0RVIKMQqU"},{"type":"output","id":"MF6qxs7jrVLV3NbQB-ipu","data":[{"name":"stdout","output_type":"stream","text":"Image type: uint8\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"63c670974fe2537f3c1b21454ac48706","path":"/notebooks_test/build/63c670974fe2537f3c1b21454ac48706.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"iF1PwBm1OE"}],"visibility":"show","key":"soFwoP38GO"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:11:17.570371Z","iopub.status.busy":"2023-03-22T13:11:17.569826Z","iopub.status.idle":"2023-03-22T13:11:17.587832Z","shell.execute_reply":"2023-03-22T13:11:17.582924Z"},"papermill":{"duration":0.1985,"end_time":"2023-03-22T13:11:17.592116","exception":false,"start_time":"2023-03-22T13:11:17.393616","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def get_water_quality_request(time_interval):\n    return SentinelHubRequest(\n        evalscript=evalscript_jaxa,\n        input_data=[\n            SentinelHubRequest.input_data(\n                data_collection=DataCollection.define_byoc(collectionID),\n                time_interval=time_interval\n            )\n        ],\n        responses=[\n            SentinelHubRequest.output_response('default', MimeType.PNG)\n        ],\n        bbox=adriatic_bbox,\n        size=adriatic_size,\n        config=config\n    )","visibility":"show","key":"GukfvYUDkn"},{"type":"output","id":"uOdw7I8C5Es9AhPLP7vAA","data":[],"visibility":"show","key":"oYd4sQdRYa"}],"visibility":"show","key":"iHpBWCbKDO"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:11:18.110148Z","iopub.status.busy":"2023-03-22T13:11:18.109488Z","iopub.status.idle":"2023-03-22T13:11:27.462233Z","shell.execute_reply":"2023-03-22T13:11:27.459140Z"},"papermill":{"duration":9.673862,"end_time":"2023-03-22T13:11:27.513509","exception":false,"start_time":"2023-03-22T13:11:17.839647","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# create a list of requests\n\nimport matplotlib\nimport matplotlib.pyplot as plt\nfrom matplotlib.cm import coolwarm \n\nlist_of_requests = [get_water_quality_request(slot) for slot in slots]\nlist_of_requests = [request.download_list[0] for request in list_of_requests]\n\n# download data with multiple threads\ndata = SentinelHubDownloadClient(config=config).download(list_of_requests, max_threads=5)\n# some stuff for pretty plots\nncols = 3\nnrows = 4\naspect_ratio = venice_size[0] / venice_size[1]\nsubplot_kw = {'xticks': [], 'yticks': [], 'frame_on': False}\n\nfig, axs = plt.subplots(ncols=ncols, nrows=nrows, figsize=(5 * ncols * aspect_ratio, 5 * nrows),\n                        subplot_kw=subplot_kw)\n\nfor idx, image in enumerate(data):\n    ax = axs[idx // ncols][idx % ncols]\n    ax.imshow(np.clip(image * 1/255, 0, 1))\n    ax.set_title(f'{slots[idx][0]}  -  {slots[idx][1]}', fontsize=10)\nplt.tight_layout()","visibility":"show","key":"NpqhlaYcCi"},{"type":"output","id":"lmsSBIS6wzBKH3sJcG_XU","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b0d2fb50aa0bbf3746738f18bf6188b4","path":"/notebooks_test/build/b0d2fb50aa0bbf3746738f18bf6188b4.png"},"text/plain":{"content":"<Figure size 1900x2000 with 12 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"N2wDNaUdl6"}],"visibility":"show","key":"hDCs22MpZE"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.265205,"end_time":"2023-03-22T13:11:28.055737","exception":false,"start_time":"2023-03-22T13:11:27.790532","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The range lies from 0-1 (blue to yellow), 0 being no anomaly in chlorophyll-a and the 1 being high anomaly. From a first look at the images it is hard to make robust conclusions on the water quality. However the image retrieved over the period of the first lockdown does seem to have the lowest anomalies.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x4Yl7y1J8i"}],"key":"g2Phy5DkIg"}],"visibility":"show","key":"SZLliH1XU8"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.367627,"end_time":"2023-03-22T13:11:28.760059","exception":false,"start_time":"2023-03-22T13:11:28.392432","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercise 2: Retrieving Water Quality Datasets from the SentinelHub","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zDvvlgfYTr"}],"identifier":"exercise-2-retrieving-water-quality-datasets-from-the-sentinelhub","label":"Exercise 2: Retrieving Water Quality Datasets from the SentinelHub","html_id":"exercise-2-retrieving-water-quality-datasets-from-the-sentinelhub","implicit":true,"key":"o5XTKpkH8k"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Search the edc collections and retrieve a different ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aifDnN5pdm"},{"type":"link","url":"https://collections.eurodatacube.com/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"water quality product.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CIseTqdm0Q"}],"urlSource":"https://collections.eurodatacube.com/","key":"PhY5CzG0TF"}],"key":"Bv5zpvxRxa"}],"visibility":"show","key":"NZ8MXl2YEE"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.275552,"end_time":"2023-03-22T13:11:29.384645","exception":false,"start_time":"2023-03-22T13:11:29.109093","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Copy the above structure to access another water quality dataset, you will need to change some parameters.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ve8zJZ4gBv"}],"key":"NVnc3s7fgE"}],"visibility":"show","key":"T7L5yk3e4z"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.294446,"end_time":"2023-03-22T13:11:29.945392","exception":false,"start_time":"2023-03-22T13:11:29.650946","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Retrieving water quality time series from GeoDB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LnsoI0ru39"}],"identifier":"retrieving-water-quality-time-series-from-geodb","label":"Retrieving water quality time series from GeoDB","html_id":"retrieving-water-quality-time-series-from-geodb","implicit":true,"key":"h2W6CQzuMF"}],"visibility":"show","key":"aHT8ArBk2M"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.271922,"end_time":"2023-03-22T13:11:30.520780","exception":false,"start_time":"2023-03-22T13:11:30.248858","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"On EO Dahboard we also have access to Chlorophyll a and Total Suspended Sediments time sereis data on a number of locations, including Venice.\nYou can inspect these time series on the dashboard at: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JGibDLmQk2"},{"type":"link","url":"https://eodashboard.org/explore?indicator=N3b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​eodashboard​.org​/explore​?indicator​=​N3b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dZ23Zwo5Am"}],"urlSource":"https://eodashboard.org/explore?indicator=N3b","key":"rqsVkxG6pS"}],"key":"QjxLIsDTvw"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"For Venice, the time series is available here: ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"wtOq07lfUh"},{"type":"link","url":"https://eodashboard.org/explore?indicator=N3b&poi=IT6-N3b","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"https://​eodashboard​.org​/explore​?indicator​=​N3b​&​poi​=​IT6​-N3b","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"lW4u7d87cF"}],"urlSource":"https://eodashboard.org/explore?indicator=N3b&poi=IT6-N3b","key":"yuyHb6HD18"}],"key":"YoaAXwjpTe"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The displayed time series show weekly Chl concentration anomalies (%) as calculated from Sentinel-3 (purple), MODIS (blue) and GCOM-C(light blue) around the Alta Aqua Oceanographic Tower (AAOT at 45.30 N, 12.50 E) in the North Adriatic Sea, the Mediterranean sub-basin most influenced by river runoff, in particular by the Po River, which is the largest river in Italy and which runs along many different industrialized areas.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"EF4TGlDDIf"}],"key":"sDUhmlcm0w"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"On EO Dashboard we can see that the measurements from the three sensors on Sentinel3, MODIS and GCOM-C are in agreement.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"VM6WVpeVbg"}],"key":"ZYBbHOawVZ"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"We could go a bit deeper in the analysis if we only focus on the Sentinel3 data, where we have access to the same time series but compared to the climatology. This graph is not available on EO Dashboard, but we can visualise it on The RACE platform.\nThis data is stored in the EuroDataCube GeoDB.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"DFrn3J6PB8"}],"key":"UqQD7eGrji"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"(For a complete overview of where the data is available please use the DataAccess.jpynb).","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"txr69hq3C6"}],"key":"sznYegvwHs"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"link","url":"https://race.esa.int/?indicator=N3&poi=IT6-N3","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"https://​race​.esa​.int​/​?indicator​=​N3​&​poi​=​IT6​-N3","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"BIz4iRP1R4"}],"urlSource":"https://race.esa.int/?indicator=N3&poi=IT6-N3","key":"PTj3HN5oRR"}],"key":"hfif7paLr1"}],"visibility":"show","key":"Uc68sUeXwI"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:11:31.125648Z","iopub.status.busy":"2023-03-22T13:11:31.124078Z","iopub.status.idle":"2023-03-22T13:11:31.132452Z","shell.execute_reply":"2023-03-22T13:11:31.130623Z"},"papermill":{"duration":0.315447,"end_time":"2023-03-22T13:11:31.143168","exception":false,"start_time":"2023-03-22T13:11:30.827721","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"geodb_database = \"eodash\"\ngeodb_collection = \"N3\"","visibility":"show","key":"Er6Ag8KDp0"},{"type":"output","id":"sTbeGUkhK5bELK5TW72T1","data":[],"visibility":"show","key":"haHFEZ0fwg"}],"visibility":"show","key":"eZ41qj0aCL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:11:31.674500Z","iopub.status.busy":"2023-03-22T13:11:31.673676Z","iopub.status.idle":"2023-03-22T13:11:31.978107Z","shell.execute_reply":"2023-03-22T13:11:31.976569Z"},"papermill":{"duration":0.550768,"end_time":"2023-03-22T13:11:31.984878","exception":false,"start_time":"2023-03-22T13:11:31.434110","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"data = geodb.get_collection(collection=geodb_collection, database=geodb_database)\ndata.head()","visibility":"show","key":"lo02CEhcd9"},{"type":"output","id":"vDxZRvbMmLc3QpqyudfJZ","data":[{"output_type":"execute_result","execution_count":53,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>id</th>\n      <th>created_at</th>\n      <th>modified_at</th>\n      <th>geometry</th>\n      <th>aoi</th>\n      <th>country</th>\n      <th>region</th>\n      <th>city</th>\n      <th>site_name</th>\n      <th>description</th>\n      <th>...</th>\n      <th>reference_value</th>\n      <th>rule</th>\n      <th>indicator_value</th>\n      <th>sub_aoi</th>\n      <th>y_axis</th>\n      <th>indicator_name</th>\n      <th>color_code</th>\n      <th>data_provider</th>\n      <th>aoi_id</th>\n      <th>update_frequency</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>2021-01-21T16:51:28.038108+00:00</td>\n      <td>None</td>\n      <td>POINT (12.50806 45.31425)</td>\n      <td>45.314247,12.508055</td>\n      <td>IT</td>\n      <td>North Adriatic Sea</td>\n      <td>Venice Lagoon</td>\n      <td>AAOT fixed station Venezia</td>\n      <td>Water Quality Time Series</td>\n      <td>...</td>\n      <td>[-999 -999]</td>\n      <td>Measurement &lt; Reference [0] outputs LOW; Refer...</td>\n      <td>/</td>\n      <td>/</td>\n      <td>Chlorophyll-a concentration [mg m-3]</td>\n      <td>Chlorophyll-a concentration at AAOT fixed stat...</td>\n      <td>/</td>\n      <td>CNR-ISMAR</td>\n      <td>IT6</td>\n      <td>Weekly</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>2021-01-21T16:51:28.038108+00:00</td>\n      <td>None</td>\n      <td>POINT (12.50806 45.31425)</td>\n      <td>45.314247,12.508055</td>\n      <td>IT</td>\n      <td>North Adriatic Sea</td>\n      <td>Venice Lagoon</td>\n      <td>AAOT fixed station Venezia</td>\n      <td>Water Quality Time Series</td>\n      <td>...</td>\n      <td>[-0.139 0.044]</td>\n      <td>Measurement &lt; Reference [0] outputs LOW; Refer...</td>\n      <td>/</td>\n      <td>/</td>\n      <td>Chlorophyll-a concentration [mg m-3]</td>\n      <td>Chlorophyll-a concentration at AAOT fixed stat...</td>\n      <td>/</td>\n      <td>CNR-ISMAR</td>\n      <td>IT6</td>\n      <td>Weekly</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n      <td>2021-01-21T16:51:28.038108+00:00</td>\n      <td>None</td>\n      <td>POINT (12.50806 45.31425)</td>\n      <td>45.314247,12.508055</td>\n      <td>IT</td>\n      <td>North Adriatic Sea</td>\n      <td>Venice Lagoon</td>\n      <td>AAOT fixed station Venezia</td>\n      <td>Water Quality Time Series</td>\n      <td>...</td>\n      <td>[-0.158 0.083]</td>\n      <td>Measurement &lt; Reference [0] outputs LOW; Refer...</td>\n      <td>NORMAL</td>\n      <td>/</td>\n      <td>Chlorophyll-a concentration [mg m-3]</td>\n      <td>Chlorophyll-a concentration at AAOT fixed stat...</td>\n      <td>BLUE</td>\n      <td>CNR-ISMAR</td>\n      <td>IT6</td>\n      <td>Weekly</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4</td>\n      <td>2021-01-21T16:51:28.038108+00:00</td>\n      <td>None</td>\n      <td>POINT (12.50806 45.31425)</td>\n      <td>45.314247,12.508055</td>\n      <td>IT</td>\n      <td>North Adriatic Sea</td>\n      <td>Venice Lagoon</td>\n      <td>AAOT fixed station Venezia</td>\n      <td>Water Quality Time Series</td>\n      <td>...</td>\n      <td>[-0.138 0.099]</td>\n      <td>Measurement &lt; Reference [0] outputs LOW; Refer...</td>\n      <td>LOW</td>\n      <td>/</td>\n      <td>Chlorophyll-a concentration [mg m-3]</td>\n      <td>Chlorophyll-a concentration at AAOT fixed stat...</td>\n      <td>GREEN</td>\n      <td>CNR-ISMAR</td>\n      <td>IT6</td>\n      <td>Weekly</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5</td>\n      <td>2021-01-21T16:51:28.038108+00:00</td>\n      <td>None</td>\n      <td>POINT (12.50806 45.31425)</td>\n      <td>45.314247,12.508055</td>\n      <td>IT</td>\n      <td>North Adriatic Sea</td>\n      <td>Venice Lagoon</td>\n      <td>AAOT fixed station Venezia</td>\n      <td>Water Quality Time Series</td>\n      <td>...</td>\n      <td>[-0.455 0.335]</td>\n      <td>Measurement &lt; Reference [0] outputs LOW; Refer...</td>\n      <td>LOW</td>\n      <td>/</td>\n      <td>Chlorophyll-a concentration [mg m-3]</td>\n      <td>Chlorophyll-a concentration at AAOT fixed stat...</td>\n      <td>GREEN</td>\n      <td>CNR-ISMAR</td>\n      <td>IT6</td>\n      <td>Weekly</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 28 columns</p>\n</div>","content_type":"text/html"},"text/plain":{"content":"   id                        created_at modified_at  \\\n0   1  2021-01-21T16:51:28.038108+00:00        None   \n1   2  2021-01-21T16:51:28.038108+00:00        None   \n2   3  2021-01-21T16:51:28.038108+00:00        None   \n3   4  2021-01-21T16:51:28.038108+00:00        None   \n4   5  2021-01-21T16:51:28.038108+00:00        None   \n\n                    geometry                  aoi country              region  \\\n0  POINT (12.50806 45.31425)  45.314247,12.508055      IT  North Adriatic Sea   \n1  POINT (12.50806 45.31425)  45.314247,12.508055      IT  North Adriatic Sea   \n2  POINT (12.50806 45.31425)  45.314247,12.508055      IT  North Adriatic Sea   \n3  POINT (12.50806 45.31425)  45.314247,12.508055      IT  North Adriatic Sea   \n4  POINT (12.50806 45.31425)  45.314247,12.508055      IT  North Adriatic Sea   \n\n            city                   site_name                description  ...  \\\n0  Venice Lagoon  AAOT fixed station Venezia  Water Quality Time Series  ...   \n1  Venice Lagoon  AAOT fixed station Venezia  Water Quality Time Series  ...   \n2  Venice Lagoon  AAOT fixed station Venezia  Water Quality Time Series  ...   \n3  Venice Lagoon  AAOT fixed station Venezia  Water Quality Time Series  ...   \n4  Venice Lagoon  AAOT fixed station Venezia  Water Quality Time Series  ...   \n\n  reference_value                                               rule  \\\n0     [-999 -999]  Measurement < Reference [0] outputs LOW; Refer...   \n1  [-0.139 0.044]  Measurement < Reference [0] outputs LOW; Refer...   \n2  [-0.158 0.083]  Measurement < Reference [0] outputs LOW; Refer...   \n3  [-0.138 0.099]  Measurement < Reference [0] outputs LOW; Refer...   \n4  [-0.455 0.335]  Measurement < Reference [0] outputs LOW; Refer...   \n\n  indicator_value sub_aoi                                y_axis  \\\n0               /       /  Chlorophyll-a concentration [mg m-3]   \n1               /       /  Chlorophyll-a concentration [mg m-3]   \n2          NORMAL       /  Chlorophyll-a concentration [mg m-3]   \n3             LOW       /  Chlorophyll-a concentration [mg m-3]   \n4             LOW       /  Chlorophyll-a concentration [mg m-3]   \n\n                                      indicator_name color_code data_provider  \\\n0  Chlorophyll-a concentration at AAOT fixed stat...          /     CNR-ISMAR   \n1  Chlorophyll-a concentration at AAOT fixed stat...          /     CNR-ISMAR   \n2  Chlorophyll-a concentration at AAOT fixed stat...       BLUE     CNR-ISMAR   \n3  Chlorophyll-a concentration at AAOT fixed stat...      GREEN     CNR-ISMAR   \n4  Chlorophyll-a concentration at AAOT fixed stat...      GREEN     CNR-ISMAR   \n\n  aoi_id update_frequency  \n0    IT6           Weekly  \n1    IT6           Weekly  \n2    IT6           Weekly  \n3    IT6           Weekly  \n4    IT6           Weekly  \n\n[5 rows x 28 columns]","content_type":"text/plain"}}}],"visibility":"show","key":"p1SBg7aD0G"}],"visibility":"show","key":"XJUEjXrZhk"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:11:32.555538Z","iopub.status.busy":"2023-03-22T13:11:32.553505Z","iopub.status.idle":"2023-03-22T13:11:36.603512Z","shell.execute_reply":"2023-03-22T13:11:36.600351Z"},"papermill":{"duration":4.346563,"end_time":"2023-03-22T13:11:36.609620","exception":false,"start_time":"2023-03-22T13:11:32.263057","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# display the locations of the data\ncities = geodb.get_collection_pg(geodb_collection, database=geodb_database, group='city, geometry', select='city, geometry')\n\nfeatures = json.loads(cities.to_json())\n\nIPython.display.GeoJSON(features)\n    ","visibility":"show","key":"iYhVTzx75Q"},{"type":"output","id":"3bN0NSvyZD2YMGy7zgT_r","data":[{"output_type":"display_data","metadata":{"application/geo+json":{"expanded":false,"root":"root"}},"data":{"application/geo+json":{"content":"{\"features\":[{\"geometry\":{\"coordinates\":[1.358,40.717],\"type\":\"Point\"},\"id\":\"0\",\"properties\":{\"city\":\"Barcelona\"},\"type\":\"Feature\"},{\"geometry\":{\"coordinates\":[4.94,43.4],\"type\":\"Point\"},\"id\":\"1\",\"properties\":{\"city\":\"Marseilles\"},\"type\":\"Feature\"},{\"geometry\":{\"coordinates\":[12.508055,45.314247],\"type\":\"Point\"},\"id\":\"2\",\"properties\":{\"city\":\"Venice Lagoon\"},\"type\":\"Feature\"}],\"type\":\"FeatureCollection\"}","content_type":"application/geo+json"},"text/plain":{"content":"<IPython.display.GeoJSON object>","content_type":"text/plain"}}}],"visibility":"show","key":"X5gUXLcgvD"}],"visibility":"show","key":"H5kvD7pTBo"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:11:37.257741Z","iopub.status.busy":"2023-03-22T13:11:37.257281Z","iopub.status.idle":"2023-03-22T13:11:37.272031Z","shell.execute_reply":"2023-03-22T13:11:37.270317Z"},"papermill":{"duration":0.36375,"end_time":"2023-03-22T13:11:37.274386","exception":false,"start_time":"2023-03-22T13:11:36.910636","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def plot_city(city=cities.city[0]):\n    #A bit hidden in this function lies the query against the RACE collection of interest.\n    gdf = geodb.get_collection(geodb_collection, database=geodb_database, query=f\"city=eq.{city}\")\n    \n    # A bit if data cleaning to get this working as None values are given as '/'\n    gdf = gdf.drop(gdf[gdf.indicator_value == \"/\"].index)\n    \n    indicator_values = geodb.get_collection_pg(geodb_collection, database=geodb_database, group='indicator_value', select='indicator_value')\n    \n    # A bit if data cleaning to get this working as None values are given as '/'\n    indicator_values = indicator_values.drop(indicator_values[indicator_values.indicator_value == \"/\"].index)\n    \n    gdf['time'] = pd.to_datetime(gdf.time)\n    gdf['measurement_value']  = gdf.measurement_value.astype(float)\n    source = ColumnDataSource(data=dict(time=gdf.time, measurement_value=gdf.measurement_value, indicator_value=gdf.indicator_value))\n    \n    p = figure(x_axis_type='datetime', width=800)\n    p.title.text = geodb_collection + \" in \" +  city\n    p.title.align = \"center\"\n    p.title.text_font_size = \"25px\"\n\n    p.vbar(x='time', top='measurement_value', legend_field=\"indicator_value\", line_width=2, fill_color=factor_cmap('indicator_value', palette=Spectral3, factors=indicator_values.indicator_value), line_color=factor_cmap('indicator_value', palette=Spectral3, factors=indicator_values.indicator_value), source=source)\n\n    show(p)","visibility":"show","key":"O9LJMPI5r0"},{"type":"output","id":"2ObwjvHYJm45Nk_Xjom5h","data":[],"visibility":"show","key":"kpJvApx2ih"}],"visibility":"show","key":"eH4NMGGWPO"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.289666,"end_time":"2023-03-22T13:11:37.794419","exception":false,"start_time":"2023-03-22T13:11:37.504753","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we plot the cities with insitu water quality timeseries for the Venice lagoon.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PGVJmDxaOs"}],"key":"JmVyRi90xZ"}],"visibility":"show","key":"Hm0XiKB2V4"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-03-22T13:11:38.272218Z","iopub.status.busy":"2023-03-22T13:11:38.271761Z","iopub.status.idle":"2023-03-22T13:11:47.967775Z","shell.execute_reply":"2023-03-22T13:11:47.961867Z"},"papermill":{"duration":9.939558,"end_time":"2023-03-22T13:11:47.975334","exception":false,"start_time":"2023-03-22T13:11:38.035776","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Generate a unique list of cities\noutput_notebook()\ncities = geodb.get_collection_pg(geodb_collection, database=geodb_database, group='city', select='city')\n\ninteract(plot_city, city=cities.city[0]);","visibility":"show","key":"yD6LuDZ4OT"},{"type":"output","id":"DUoOGFPxDQpZupombWrWV","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<div class=\"bk-root\">\n        <a href=\"https://bokeh.org\" target=\"_blank\" class=\"bk-logo bk-logo-small bk-logo-notebook\"></a>\n        <span id=\"1002\">Loading BokehJS ...</span>\n    </div>\n","content_type":"text/html"}}},{"output_type":"display_data","metadata":{},"data":{"application/javascript":{"content":"(function(root) {\n  function now() {\n    return new Date();\n  }\n\n  const force = true;\n\n  if (typeof root._bokeh_onload_callbacks === \"undefined\" || force === true) {\n    root._bokeh_onload_callbacks = [];\n    root._bokeh_is_loading = undefined;\n  }\n\nconst JS_MIME_TYPE = 'application/javascript';\n  const HTML_MIME_TYPE = 'text/html';\n  const EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';\n  const CLASS_NAME = 'output_bokeh rendered_html';\n\n  /**\n   * Render data to the DOM node\n   */\n  function render(props, node) {\n    const script = document.createElement(\"script\");\n    node.appendChild(script);\n  }\n\n  /**\n   * Handle when an output is cleared or removed\n   */\n  function handleClearOutput(event, handle) {\n    const cell = handle.cell;\n\n    const id = cell.output_area._bokeh_element_id;\n    const server_id = cell.output_area._bokeh_server_id;\n    // Clean up Bokeh references\n    if (id != null && id in Bokeh.index) {\n      Bokeh.index[id].model.document.clear();\n      delete Bokeh.index[id];\n    }\n\n    if (server_id !== undefined) {\n      // Clean up Bokeh references\n      const cmd_clean = \"from bokeh.io.state import curstate; print(curstate().uuid_to_server['\" + server_id + \"'].get_sessions()[0].document.roots[0]._id)\";\n      cell.notebook.kernel.execute(cmd_clean, {\n        iopub: {\n          output: function(msg) {\n            const id = msg.content.text.trim();\n            if (id in Bokeh.index) {\n              Bokeh.index[id].model.document.clear();\n              delete Bokeh.index[id];\n            }\n          }\n        }\n      });\n      // Destroy server and session\n      const cmd_destroy = \"import bokeh.io.notebook as ion; ion.destroy_server('\" + server_id + \"')\";\n      cell.notebook.kernel.execute(cmd_destroy);\n    }\n  }\n\n  /**\n   * Handle when a new output is added\n   */\n  function handleAddOutput(event, handle) {\n    const output_area = handle.output_area;\n    const output = handle.output;\n\n    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only\n    if ((output.output_type != \"display_data\") || (!Object.prototype.hasOwnProperty.call(output.data, EXEC_MIME_TYPE))) {\n      return\n    }\n\n    const toinsert = output_area.element.find(\".\" + CLASS_NAME.split(' ')[0]);\n\n    if (output.metadata[EXEC_MIME_TYPE][\"id\"] !== undefined) {\n      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];\n      // store reference to embed id on output_area\n      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE][\"id\"];\n    }\n    if (output.metadata[EXEC_MIME_TYPE][\"server_id\"] !== undefined) {\n      const bk_div = document.createElement(\"div\");\n      bk_div.innerHTML = output.data[HTML_MIME_TYPE];\n      const script_attrs = bk_div.children[0].attributes;\n      for (let i = 0; i < script_attrs.length; i++) {\n        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);\n        toinsert[toinsert.length - 1].firstChild.textContent = bk_div.children[0].textContent\n      }\n      // store reference to server id on output_area\n      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE][\"server_id\"];\n    }\n  }\n\n  function register_renderer(events, OutputArea) {\n\n    function append_mime(data, metadata, element) {\n      // create a DOM node to render to\n      const toinsert = this.create_output_subarea(\n        metadata,\n        CLASS_NAME,\n        EXEC_MIME_TYPE\n      );\n      this.keyboard_manager.register_events(toinsert);\n      // Render to node\n      const props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};\n      render(props, toinsert[toinsert.length - 1]);\n      element.append(toinsert);\n      return toinsert\n    }\n\n    /* Handle when an output is cleared or removed */\n    events.on('clear_output.CodeCell', handleClearOutput);\n    events.on('delete.Cell', handleClearOutput);\n\n    /* Handle when a new output is added */\n    events.on('output_added.OutputArea', handleAddOutput);\n\n    /**\n     * Register the mime type and append_mime function with output_area\n     */\n    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {\n      /* Is output safe? */\n      safe: true,\n      /* Index of renderer in `output_area.display_order` */\n      index: 0\n    });\n  }\n\n  // register the mime type if in Jupyter Notebook environment and previously unregistered\n  if (root.Jupyter !== undefined) {\n    const events = require('base/js/events');\n    const OutputArea = require('notebook/js/outputarea').OutputArea;\n\n    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {\n      register_renderer(events, OutputArea);\n    }\n  }\n  if (typeof (root._bokeh_timeout) === \"undefined\" || force === true) {\n    root._bokeh_timeout = Date.now() + 5000;\n    root._bokeh_failed_load = false;\n  }\n\n  const NB_LOAD_WARNING = {'data': {'text/html':\n     \"<div style='background-color: #fdd'>\\n\"+\n     \"<p>\\n\"+\n     \"BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \\n\"+\n     \"may be due to a slow or bad network connection. Possible fixes:\\n\"+\n     \"</p>\\n\"+\n     \"<ul>\\n\"+\n     \"<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\\n\"+\n     \"<li>use INLINE resources instead, as so:</li>\\n\"+\n     \"</ul>\\n\"+\n     \"<code>\\n\"+\n     \"from bokeh.resources import INLINE\\n\"+\n     \"output_notebook(resources=INLINE)\\n\"+\n     \"</code>\\n\"+\n     \"</div>\"}};\n\n  function display_loaded() {\n    const el = document.getElementById(\"1002\");\n    if (el != null) {\n      el.textContent = \"BokehJS is loading...\";\n    }\n    if (root.Bokeh !== undefined) {\n      if (el != null) {\n        el.textContent = \"BokehJS \" + root.Bokeh.version + \" successfully loaded.\";\n      }\n    } else if (Date.now() < root._bokeh_timeout) {\n      setTimeout(display_loaded, 100)\n    }\n  }\n\n  function run_callbacks() {\n    try {\n      root._bokeh_onload_callbacks.forEach(function(callback) {\n        if (callback != null)\n          callback();\n      });\n    } finally {\n      delete root._bokeh_onload_callbacks\n    }\n    console.debug(\"Bokeh: all callbacks have finished\");\n  }\n\n  function load_libs(css_urls, js_urls, callback) {\n    if (css_urls == null) css_urls = [];\n    if (js_urls == null) js_urls = [];\n\n    root._bokeh_onload_callbacks.push(callback);\n    if (root._bokeh_is_loading > 0) {\n      console.debug(\"Bokeh: BokehJS is being loaded, scheduling callback at\", now());\n      return null;\n    }\n    if (js_urls == null || js_urls.length === 0) {\n      run_callbacks();\n      return null;\n    }\n    console.debug(\"Bokeh: BokehJS not loaded, scheduling load and callback at\", now());\n    root._bokeh_is_loading = css_urls.length + js_urls.length;\n\n    function on_load() {\n      root._bokeh_is_loading--;\n      if (root._bokeh_is_loading === 0) {\n        console.debug(\"Bokeh: all BokehJS libraries/stylesheets loaded\");\n        run_callbacks()\n      }\n    }\n\n    function on_error(url) {\n      console.error(\"failed to load \" + url);\n    }\n\n    for (let i = 0; i < css_urls.length; i++) {\n      const url = css_urls[i];\n      const element = document.createElement(\"link\");\n      element.onload = on_load;\n      element.onerror = on_error.bind(null, url);\n      element.rel = \"stylesheet\";\n      element.type = \"text/css\";\n      element.href = url;\n      console.debug(\"Bokeh: injecting link tag for BokehJS stylesheet: \", url);\n      document.body.appendChild(element);\n    }\n\n    for (let i = 0; i < js_urls.length; i++) {\n      const url = js_urls[i];\n      const element = document.createElement('script');\n      element.onload = on_load;\n      element.onerror = on_error.bind(null, url);\n      element.async = false;\n      element.src = url;\n      console.debug(\"Bokeh: injecting script tag for BokehJS library: \", url);\n      document.head.appendChild(element);\n    }\n  };\n\n  function inject_raw_css(css) {\n    const element = document.createElement(\"style\");\n    element.appendChild(document.createTextNode(css));\n    document.body.appendChild(element);\n  }\n\n  const js_urls = [\"https://cdn.bokeh.org/bokeh/release/bokeh-2.4.3.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-gl-2.4.3.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.4.3.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.4.3.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-2.4.3.min.js\"];\n  const css_urls = [];\n\n  const inline_js = [    function(Bokeh) {\n      Bokeh.set_log_level(\"info\");\n    },\nfunction(Bokeh) {\n    }\n  ];\n\n  function run_inline_js() {\n    if (root.Bokeh !== undefined || force === true) {\n          for (let i = 0; i < inline_js.length; i++) {\n      inline_js[i].call(root, root.Bokeh);\n    }\nif (force === true) {\n        display_loaded();\n      }} else if (Date.now() < root._bokeh_timeout) {\n      setTimeout(run_inline_js, 100);\n    } else if (!root._bokeh_failed_load) {\n      console.log(\"Bokeh: BokehJS failed to load within specified timeout.\");\n      root._bokeh_failed_load = true;\n    } else if (force !== true) {\n      const cell = $(document.getElementById(\"1002\")).parents('.cell').data().cell;\n      cell.output_area.append_execute_result(NB_LOAD_WARNING)\n    }\n  }\n\n  if (root._bokeh_is_loading === 0) {\n    console.debug(\"Bokeh: BokehJS loaded, going straight to plotting\");\n    run_inline_js();\n  } else {\n    load_libs(css_urls, js_urls, function() {\n      console.debug(\"Bokeh: BokehJS plotting callback run at\", now());\n      run_inline_js();\n    });\n  }\n}(window));","content_type":"application/javascript"},"application/vnd.bokehjs_load.v0+json":{"content":"(function(root) {\n  function now() {\n    return new Date();\n  }\n\n  const force = true;\n\n  if (typeof root._bokeh_onload_callbacks === \"undefined\" || force === true) {\n    root._bokeh_onload_callbacks = [];\n    root._bokeh_is_loading = undefined;\n  }\n\n\n  if (typeof (root._bokeh_timeout) === \"undefined\" || force === true) {\n    root._bokeh_timeout = Date.now() + 5000;\n    root._bokeh_failed_load = false;\n  }\n\n  const NB_LOAD_WARNING = {'data': {'text/html':\n     \"<div style='background-color: #fdd'>\\n\"+\n     \"<p>\\n\"+\n     \"BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \\n\"+\n     \"may be due to a slow or bad network connection. Possible fixes:\\n\"+\n     \"</p>\\n\"+\n     \"<ul>\\n\"+\n     \"<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\\n\"+\n     \"<li>use INLINE resources instead, as so:</li>\\n\"+\n     \"</ul>\\n\"+\n     \"<code>\\n\"+\n     \"from bokeh.resources import INLINE\\n\"+\n     \"output_notebook(resources=INLINE)\\n\"+\n     \"</code>\\n\"+\n     \"</div>\"}};\n\n  function display_loaded() {\n    const el = document.getElementById(\"1002\");\n    if (el != null) {\n      el.textContent = \"BokehJS is loading...\";\n    }\n    if (root.Bokeh !== undefined) {\n      if (el != null) {\n        el.textContent = \"BokehJS \" + root.Bokeh.version + \" successfully loaded.\";\n      }\n    } else if (Date.now() < root._bokeh_timeout) {\n      setTimeout(display_loaded, 100)\n    }\n  }\n\n  function run_callbacks() {\n    try {\n      root._bokeh_onload_callbacks.forEach(function(callback) {\n        if (callback != null)\n          callback();\n      });\n    } finally {\n      delete root._bokeh_onload_callbacks\n    }\n    console.debug(\"Bokeh: all callbacks have finished\");\n  }\n\n  function load_libs(css_urls, js_urls, callback) {\n    if (css_urls == null) css_urls = [];\n    if (js_urls == null) js_urls = [];\n\n    root._bokeh_onload_callbacks.push(callback);\n    if (root._bokeh_is_loading > 0) {\n      console.debug(\"Bokeh: BokehJS is being loaded, scheduling callback at\", now());\n      return null;\n    }\n    if (js_urls == null || js_urls.length === 0) {\n      run_callbacks();\n      return null;\n    }\n    console.debug(\"Bokeh: BokehJS not loaded, scheduling load and callback at\", now());\n    root._bokeh_is_loading = css_urls.length + js_urls.length;\n\n    function on_load() {\n      root._bokeh_is_loading--;\n      if (root._bokeh_is_loading === 0) {\n        console.debug(\"Bokeh: all BokehJS libraries/stylesheets loaded\");\n        run_callbacks()\n      }\n    }\n\n    function on_error(url) {\n      console.error(\"failed to load \" + url);\n    }\n\n    for (let i = 0; i < css_urls.length; i++) {\n      const url = css_urls[i];\n      const element = document.createElement(\"link\");\n      element.onload = on_load;\n      element.onerror = on_error.bind(null, url);\n      element.rel = \"stylesheet\";\n      element.type = \"text/css\";\n      element.href = url;\n      console.debug(\"Bokeh: injecting link tag for BokehJS stylesheet: \", url);\n      document.body.appendChild(element);\n    }\n\n    for (let i = 0; i < js_urls.length; i++) {\n      const url = js_urls[i];\n      const element = document.createElement('script');\n      element.onload = on_load;\n      element.onerror = on_error.bind(null, url);\n      element.async = false;\n      element.src = url;\n      console.debug(\"Bokeh: injecting script tag for BokehJS library: \", url);\n      document.head.appendChild(element);\n    }\n  };\n\n  function inject_raw_css(css) {\n    const element = document.createElement(\"style\");\n    element.appendChild(document.createTextNode(css));\n    document.body.appendChild(element);\n  }\n\n  const js_urls = [\"https://cdn.bokeh.org/bokeh/release/bokeh-2.4.3.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-gl-2.4.3.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.4.3.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.4.3.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-2.4.3.min.js\"];\n  const css_urls = [];\n\n  const inline_js = [    function(Bokeh) {\n      Bokeh.set_log_level(\"info\");\n    },\nfunction(Bokeh) {\n    }\n  ];\n\n  function run_inline_js() {\n    if (root.Bokeh !== undefined || force === true) {\n          for (let i = 0; i < inline_js.length; i++) {\n      inline_js[i].call(root, root.Bokeh);\n    }\nif (force === true) {\n        display_loaded();\n      }} else if (Date.now() < root._bokeh_timeout) {\n      setTimeout(run_inline_js, 100);\n    } else if (!root._bokeh_failed_load) {\n      console.log(\"Bokeh: BokehJS failed to load within specified timeout.\");\n      root._bokeh_failed_load = true;\n    } else if (force !== true) {\n      const cell = $(document.getElementById(\"1002\")).parents('.cell').data().cell;\n      cell.output_area.append_execute_result(NB_LOAD_WARNING)\n    }\n  }\n\n  if (root._bokeh_is_loading === 0) {\n    console.debug(\"Bokeh: BokehJS loaded, going straight to plotting\");\n    run_inline_js();\n  } else {\n    load_libs(css_urls, js_urls, function() {\n      console.debug(\"Bokeh: BokehJS plotting callback run at\", now());\n      run_inline_js();\n    });\n  }\n}(window));","content_type":"application/vnd.bokehjs_load.v0+json"}}},{"output_type":"display_data","metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"529b72484ef64258b0e600d79fd99a08\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"text/plain":{"content":"interactive(children=(Text(value='Venice Lagoon', description='city'), Output()), _dom_classes=('widget-intera…","content_type":"text/plain"}}}],"visibility":"show","key":"omYPItNWKt"}],"visibility":"show","key":"fjdhpVe8JT"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.289523,"end_time":"2023-03-22T13:11:48.605198","exception":false,"start_time":"2023-03-22T13:11:48.315675","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercise 3","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V4MK0YNOQk"}],"identifier":"exercise-3","label":"Exercise 3","html_id":"exercise-3","implicit":true,"key":"YETVsHpPeg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Can you make some conclusions from the time series? This event has been studied at length in the literature, this ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"F4qcYmOHeH"},{"type":"link","url":"https://www.sciencedirect.com/science/article/pii/S0048969722000912","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"paper","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"X3xD275RU0"}],"urlSource":"https://www.sciencedirect.com/science/article/pii/S0048969722000912","key":"dC3Omw9iPX"},{"type":"text","value":" can be a starting point for some ideas on how to improve the method.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Xj888V9mS3"}],"key":"qK7HJqBWeR"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"There could be another reason for the change in water quality in the region, the largest river in Italy is located just below Venice. Can you preform some anaylsis to investigate this further?","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"k0ler1SNAH"}],"key":"ZACpGUDNgg"}],"visibility":"show","key":"npPJ127ASa"}],"key":"oLhlhAGHlF"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Truck Detection Exercise","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/igarss2022/igarss-22-detect-trucks-sentinel2","group":"Contributions"},"next":{"title":"Lockdown in Venice","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/igarss2022/igarss-22-nasa-api-lockdown-in-venice","group":"Contributions"}}},"domain":"http://localhost:3000"}