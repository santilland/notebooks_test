{"version":1,"kind":"Notebook","sha256":"eb9fff9204f9df4db6ad9ee170d59d0ae388a217354e36cddea9cef50158069d","slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.sentinelhub-py","location":"/external_notebooks/eurodatacube/notebooks/notebooks/curated/sentinelhub-py.ipynb","dependencies":[],"frontmatter":{"title":"Using Sentinel Hub Process API in EDC: a starter’s guide.","content_includes_title":true,"kernelspec":{"name":"conda-env-users-edc-2023.10-01-py","display_name":"EDC 0.24.5 (Python3)","language":"python"},"github":"https://github.com/eoxhub-workspaces/documentation/","numbering":{"title":{"offset":5}},"edit_url":"https://github.com/eoxhub-workspaces/documentation//blob/main/external_notebooks/eurodatacube/notebooks/notebooks/curated/sentinelhub-py.ipynb","thumbnail":"/notebooks_test/build/01e22903839391bc356ac886ec2b2fa7.png","exports":[{"format":"ipynb","filename":"sentinelhub-py.ipynb","url":"/notebooks_test/build/sentinelhub-py-c237ccbd5b57879f4b50887ce3f02cd6.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:15.182649Z","iopub.status.busy":"2023-10-24T07:58:15.182255Z","iopub.status.idle":"2023-10-24T07:58:15.238796Z","shell.execute_reply":"2023-10-24T07:58:15.238388Z"},"papermill":{"duration":0.089734,"end_time":"2023-10-24T07:58:15.239791","exception":false,"start_time":"2023-10-24T07:58:15.150057","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from edc import check_compatibility\ncheck_compatibility(\"user-2023.10-01\", dependencies=[\"SH\"])","visibility":"show","key":"bRuFw4ODRu"},{"type":"output","id":"aVizmrJLCW4bUMmBEIggG","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<script type=\"text/javascript\">\n        function toggle(id) {\n            el = document.getElementById(id);\n            el.style.display = el.style.display === \"none\" ? \"block\" : \"none\";\n        }\n    </script>","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"This notebook is compatible with this base image version (user-2023.10-01).","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/markdown":{"content":"\n\n---------\n\nThe following environment variables are available:\n\n* `SH_CLIENT_ID`, `SH_INSTANCE_ID`, `SH_CLIENT_NAME`, `SH_CLIENT_SECRET`\n","content_type":"text/markdown"},"text/plain":{"content":"<IPython.core.display.Markdown object>","content_type":"text/plain"}}}],"visibility":"show","key":"VdV0lX4Do2"}],"visibility":"show","key":"xxzvv9fMvB"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.027883,"end_time":"2023-10-24T07:58:15.317124","exception":false,"start_time":"2023-10-24T07:58:15.289241","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Using Sentinel Hub Process API in EDC: a starter’s guide.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QAKnSBMqcO"}],"identifier":"using-sentinel-hub-process-api-in-edc-a-starters-guide","label":"Using Sentinel Hub Process API in EDC: a starter’s guide.","html_id":"using-sentinel-hub-process-api-in-edc-a-starters-guide","implicit":true,"key":"L6t0S25Y6O"},{"type":"thematicBreak","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"cwTmh85k1L"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Source: ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CDHLu3m76X"},{"type":"link","url":"https://sentinelhub-py.readthedocs.io/en/latest/index.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Sentinel Hub Python package documentation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xcm9hBAAYu"}],"urlSource":"https://sentinelhub-py.readthedocs.io/en/latest/index.html","key":"JH6Vo3n2Jj"}],"key":"Xsbt7tJJxI"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Getting started with ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IHTTEWsvk7"},{"type":"inlineCode","value":"sentinelhub-py","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DPjb4uWZsr"}],"identifier":"getting-started-with-sentinelhub-py","label":"Getting started with sentinelhub-py","html_id":"getting-started-with-sentinelhub-py","implicit":true,"key":"Re467Hl4pC"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"In this demonstration Jupyter Notebook, we will be requesting and exporting analysis-ready Earth Observation data with the Sentinel Hub ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"cfPQVc53s2"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/api/process/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Process API","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xWjnD007PK"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/api/process/","key":"WXErDbomBr"},{"type":"text","value":" using the dedicated ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vVVrvUMhdY"},{"type":"link","url":"https://sentinelhub-py.readthedocs.io/en/latest/index.html","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"sentinelhub-py package","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"EK4X1g1CLg"}],"urlSource":"https://sentinelhub-py.readthedocs.io/en/latest/index.html","key":"lLlQwGAn5Z"},{"type":"text","value":" in the EDC EOxHub Workplace. In this notebook we will learn how to:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"BJeNPIx5AG"}],"key":"VWiPF9JBYX"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"link","url":"#Example-1:-Request-a-true-color-(PNG)-image-on-a-specific-date","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Request a true color (PNG) image on a specific date","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"yCgOATZbiz"}],"urlSource":"#Example-1:-Request-a-true-color-(PNG)-image-on-a-specific-date","key":"SgVgxmdqol"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"link","url":"#Example-1.1-Adding-cloud-mask-data","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Add cloud mask data to the request","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"cK5pWTjkct"}],"urlSource":"#Example-1.1-Adding-cloud-mask-data","key":"SiyO0mizhj"}],"key":"KWiOy6afRv"}],"key":"L9bA8NR4pZ"}],"key":"o5OncZR5cQ"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"link","url":"#Example-2:-Request-a-true-color-mosaic-of-least-cloudy-acquisitions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Request a true color mosaic of least cloudy acquisitions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"FkpFmSB5dl"}],"urlSource":"#Example-2:-Request-a-true-color-mosaic-of-least-cloudy-acquisitions","key":"p3JqyB8tQg"}],"key":"KJHxPwqVdU"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"link","url":"#Example-3:-Request-all-Sentinel-2's-raw-band-values","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Request all Sentinel-2’s raw band values","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"sTDaXaQZC2"}],"urlSource":"#Example-3:-Request-all-Sentinel-2's-raw-band-values","key":"Y7rv3VEp3o"}],"key":"DhJEmeJK1K"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"link","url":"#Example-4:-Save-downloaded-data-to-disk-and-read-it-from-disk","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Save downloaded data to disk and read it from disk","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"tfKjXxQ24e"}],"urlSource":"#Example-4:-Save-downloaded-data-to-disk-and-read-it-from-disk","key":"FOo4gQVi7h"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"link","url":"#Example-4.1:-Save-downloaded-data-directly-to-disk","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Save downloaded data directly to disk","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"iuwMdeu623"}],"urlSource":"#Example-4.1:-Save-downloaded-data-directly-to-disk","key":"yvV5NDMEVD"}],"key":"zvCeaz8jEK"}],"key":"n6KPjhVcPc"}],"key":"TboOZmlKTO"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"link","url":"#Example-5:-Request-other-data-collections-supported-by-sh-py","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Request other data collections supported by sentinelhub-py","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"JXAf7VSc4C"}],"urlSource":"#Example-5:-Request-other-data-collections-supported-by-sh-py","key":"E2jiQgBXsm"}],"key":"AV7JfiPOT2"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"link","url":"#Example-6:-Multi-response-request","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Perform a multi-response request","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"g0uYW5vJTv"}],"urlSource":"#Example-6:-Multi-response-request","key":"FpH0ME6Ene"}],"key":"SZDJS8Esqb"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"link","url":"#Example-7:-Request-with-a-raw-dictionary","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Request with a raw dictionary","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"k4W1vSsUl8"}],"urlSource":"#Example-7:-Request-with-a-raw-dictionary","key":"iLutgcZXti"}],"key":"PU04i3Xew4"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"link","url":"#Example-8:-Request-multiple-timestamps-data","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Request multiple timestamps data","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"mx5FslZrAM"}],"urlSource":"#Example-8:-Request-multiple-timestamps-data","key":"BISwlK08Mp"}],"key":"AK8LkM7tjG"}],"key":"d9jkjvZjie"}],"visibility":"show","key":"TmXvLnN38J"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.030899,"end_time":"2023-10-24T07:58:15.401641","exception":false,"start_time":"2023-10-24T07:58:15.370742","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zl7X5N7XLd"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"AFXZWT4jhA"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Before acccessing the data, we will start by importing the necessary Python libraries (already configured in your EDC workspace), generate credentials automatically to access the services and define the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MidiEyKITG"},{"type":"inlineCode","value":"plot_image","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DAFZHXtH8G"},{"type":"text","value":" function that can be found in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"M15UuRRxix"},{"type":"inlineCode","value":"utils.py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jNDS9yp06U"},{"type":"text","value":" ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mmo0I3FVDO"},{"type":"link","url":"https://github.com/sentinel-hub/sentinelhub-py/blob/master/examples/utils.py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"file","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pMCh6g9kVC"}],"urlSource":"https://github.com/sentinel-hub/sentinelhub-py/blob/master/examples/utils.py","data":{"kind":"file","org":"sentinel-hub","repo":"sentinelhub-py","reference":"master","file":"examples/utils.py","raw":"https://raw.githubusercontent.com/sentinel-hub/sentinelhub-py/master/examples/utils.py"},"internal":false,"protocol":"github","key":"qIJLbb2Y6m"},{"type":"text","value":" located in Sentinel Hub’s ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CcYlFFX7Dr"},{"type":"link","url":"https://github.com/sentinel-hub/sentinelhub-py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"GitHub repository","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wsGpjF6qpK"}],"urlSource":"https://github.com/sentinel-hub/sentinelhub-py","error":true,"key":"UkWv7eA6vv"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ew5PdXb4ao"}],"key":"oARlgwIpXK"}],"visibility":"show","key":"xf0zTiWl8j"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.027386,"end_time":"2023-10-24T07:58:15.469611","exception":false,"start_time":"2023-10-24T07:58:15.442225","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pCjgRz16pi"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"bvJEsL3jAd"}],"visibility":"show","key":"MJCxELkQEH"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:15.542283Z","iopub.status.busy":"2023-10-24T07:58:15.541994Z","iopub.status.idle":"2023-10-24T07:58:16.275602Z","shell.execute_reply":"2023-10-24T07:58:16.275129Z"},"papermill":{"duration":0.763462,"end_time":"2023-10-24T07:58:16.277010","exception":false,"start_time":"2023-10-24T07:58:15.513548","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# EDC libraries\nfrom edc import setup_environment_variables\n\n# Utilities\nimport os\nimport datetime\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom IPython.display import display, Image\n\n# Sentinel Hub\nfrom sentinelhub import (MimeType, CRS, BBox, SentinelHubRequest, SentinelHubDownloadClient, \n                         DataCollection, bbox_to_dimensions, DownloadRequest, SHConfig)","visibility":"show","key":"kTW1TxzbC4"},{"type":"output","id":"wFYv4vPDjKUTuKy3k46NJ","data":[],"visibility":"show","key":"VZ6eCFrHGr"}],"visibility":"show","key":"Hu5JYVdfiZ"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.025247,"end_time":"2023-10-24T07:58:16.346012","exception":false,"start_time":"2023-10-24T07:58:16.320765","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Credentials","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GBbEBRqtrn"}],"identifier":"credentials","label":"Credentials","html_id":"credentials","implicit":true,"key":"TxHgjv5v9k"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Credentials for Sentinel Hub services are automatically injected as environement variables. It is therefore easy to populate Sentinel Hub’s credential manager with the values.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DqrhBaX6tB"}],"key":"WzvGqxOUcu"}],"visibility":"show","key":"wpCkhaL1wB"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:16.421849Z","iopub.status.busy":"2023-10-24T07:58:16.421356Z","iopub.status.idle":"2023-10-24T07:58:16.424783Z","shell.execute_reply":"2023-10-24T07:58:16.424346Z"},"papermill":{"duration":0.039716,"end_time":"2023-10-24T07:58:16.425680","exception":false,"start_time":"2023-10-24T07:58:16.385964","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Pass Sentinel Hub credentials to SHConfig\nconfig = SHConfig()\nconfig.sh_client_id = os.environ[\"SH_CLIENT_ID\"]\nconfig.sh_client_secret = os.environ[\"SH_CLIENT_SECRET\"]","visibility":"show","key":"u8hKZCGD5f"},{"type":"output","id":"JBL1NkiLJ43wcSU8nsPsD","data":[],"visibility":"show","key":"paQSQ8B3f1"}],"visibility":"show","key":"cfxhCfdUAp"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.029287,"end_time":"2023-10-24T07:58:16.496363","exception":false,"start_time":"2023-10-24T07:58:16.467076","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Utility function for plotting images","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zuH1vrFq58"}],"identifier":"utility-function-for-plotting-images","label":"Utility function for plotting images","html_id":"utility-function-for-plotting-images","implicit":true,"key":"TNtaH5yerw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In the following cell, we define the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uTyVc2UX5G"},{"type":"inlineCode","value":"plot_image","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Pfr8nu0Pvf"},{"type":"text","value":" function which will be used to display the requested images for all examples demonstrated in this notebook.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kSRnewcxEQ"}],"key":"fPq2NhxP1P"}],"visibility":"show","key":"pjd5FwlMtv"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:16.571117Z","iopub.status.busy":"2023-10-24T07:58:16.570757Z","iopub.status.idle":"2023-10-24T07:58:16.574542Z","shell.execute_reply":"2023-10-24T07:58:16.574116Z"},"papermill":{"duration":0.034914,"end_time":"2023-10-24T07:58:16.575435","exception":false,"start_time":"2023-10-24T07:58:16.540521","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define the plot_image function\ndef plot_image(image, factor=1.0, clip_range = None, **kwargs):\n    \"\"\"\n    Utility function for plotting RGB images.\n    \"\"\"\n    fig, ax = plt.subplots(nrows=1, ncols=1, figsize=(15, 15))\n    if clip_range is not None:\n        ax.imshow(np.clip(image * factor, *clip_range), **kwargs)\n    else:\n        ax.imshow(image * factor, **kwargs)\n    ax.set_xticks([])\n    ax.set_yticks([])","visibility":"show","key":"MIs55yQFsa"},{"type":"output","id":"FUkg-IJP2xl0LVoKzFvL2","data":[],"visibility":"show","key":"mLn8iGs3sd"}],"visibility":"show","key":"noV7FqUZZz"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:16.643794Z","iopub.status.busy":"2023-10-24T07:58:16.643496Z","iopub.status.idle":"2023-10-24T07:58:16.649760Z","shell.execute_reply":"2023-10-24T07:58:16.649377Z"},"papermill":{"duration":0.037264,"end_time":"2023-10-24T07:58:16.650832","exception":false,"start_time":"2023-10-24T07:58:16.613568","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Configure plots for inline use in Jupyter Notebook\n%matplotlib inline","visibility":"show","key":"VdzmAMXEOZ"},{"type":"output","id":"nwQzBSLxOA9FFco2IwngV","data":[],"visibility":"show","key":"J7DssZP0vh"}],"visibility":"show","key":"xgh1KP9nkP"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.028023,"end_time":"2023-10-24T07:58:16.724769","exception":false,"start_time":"2023-10-24T07:58:16.696746","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Setting area of interest (AOI)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BlU2cMRd43"}],"identifier":"setting-area-of-interest-aoi","label":"Setting area of interest (AOI)","html_id":"setting-area-of-interest-aoi","implicit":true,"key":"GPwv8BYU55"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We will download Sentinel-2 imagery of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mgXBRWg6UL"},{"type":"link","url":"https://en.wikipedia.org/wiki/Betsiboka_River","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Betsiboka Estuary","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GRq7E66OVV"}],"urlSource":"https://en.wikipedia.org/wiki/Betsiboka_River","data":{"page":"Betsiboka_River","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"Ut1wTRywkW"},{"type":"text","value":" such as the one shown below (taken by Sentinel-2 on 2017-12-15):","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dpudS9yxlN"}],"key":"qPhPswpYmq"}],"visibility":"show","key":"AoOk0acZXn"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.025774,"end_time":"2023-10-24T07:58:16.790076","exception":false,"start_time":"2023-10-24T07:58:16.764302","status":"completed"},"tags":[]},"children":[{"type":"image","url":"/notebooks_test/build/01e22903839391bc356ac886ec2b2fa7.png","alt":"Betsiboka Estuary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MmCzZst0bI","urlSource":"https://sentinelhub-py.readthedocs.io/en/latest/_images/wms_TRUE_COLOR_EPSG4326_-16.15_46.16_-15.58_46.51_2017-12-15T07-12-03_512X856.png"}],"visibility":"show","key":"MGaleIMhJm"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.026899,"end_time":"2023-10-24T07:58:16.855920","exception":false,"start_time":"2023-10-24T07:58:16.829021","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The bounding box in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wQuR1JFsFT"},{"type":"inlineCode","value":"WGS84","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OJGXj31SMN"},{"type":"text","value":" coordinate system is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dAiBYOca9g"},{"type":"inlineCode","value":"[46.16, -16.15, 46.51, -15.58]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V8t67N7kOP"},{"type":"text","value":" (longitude and latitude coordinates of lower left and upper right corners). You can get the bbox for a different area at the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yHc6s4lxrt"},{"type":"link","url":"http://bboxfinder.com/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"bboxfinder","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K6n5eIa1z3"}],"urlSource":"http://bboxfinder.com/","key":"bmyK45CFvK"},{"type":"text","value":" website.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dAQhIdkSzN"}],"key":"oo8z1kSUaQ"}],"visibility":"show","key":"H4oOZ13zc4"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.028415,"end_time":"2023-10-24T07:58:16.924242","exception":false,"start_time":"2023-10-24T07:58:16.895827","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"All requests require bounding box to be given as an instance of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"w4tZT333IM"},{"type":"inlineCode","value":"sentinelhub.geometry.BBox","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"imyNwKtSiJ"},{"type":"text","value":" with corresponding Coordinate Reference System (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gXZUIojlPX"},{"type":"inlineCode","value":"sentinelhub.constants.CRS","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XPrrmxXbeM"},{"type":"text","value":"). In our case it is in WGS84 and we can use the predefined WGS84 coordinate reference system from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cCfwCqlV2E"},{"type":"inlineCode","value":"sentinelhub.constants.CRS","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X6fBXBy5O5"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qWOh0S9gnc"}],"key":"QJN80feBej"}],"visibility":"show","key":"IHROX2Er6N"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:16.989795Z","iopub.status.busy":"2023-10-24T07:58:16.989578Z","iopub.status.idle":"2023-10-24T07:58:16.992778Z","shell.execute_reply":"2023-10-24T07:58:16.992260Z"},"papermill":{"duration":0.031069,"end_time":"2023-10-24T07:58:16.993795","exception":false,"start_time":"2023-10-24T07:58:16.962726","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"betsiboka_coords_wgs84 = [46.16, -16.15, 46.51, -15.58]","visibility":"show","key":"NVFsClhqnb"},{"type":"output","id":"hgJ9h_h7Gor7a70KPgPS4","data":[],"visibility":"show","key":"DSFQmG8AdC"}],"visibility":"show","key":"sOTQLLLVMf"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.026196,"end_time":"2023-10-24T07:58:17.060663","exception":false,"start_time":"2023-10-24T07:58:17.034467","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"When the bounding box bounds have been defined, you can initialize the BBox of the area of interest. Using the bbox_to_dimensions utility function, you can provide the desired resolution parameter of the image in meters and obtain the output image shape.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JrNscPyUcO"}],"key":"dkMOJQiW4C"}],"visibility":"show","key":"t3sAI4fDgG"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:17.129544Z","iopub.status.busy":"2023-10-24T07:58:17.129203Z","iopub.status.idle":"2023-10-24T07:58:17.146453Z","shell.execute_reply":"2023-10-24T07:58:17.145979Z"},"papermill":{"duration":0.04571,"end_time":"2023-10-24T07:58:17.147527","exception":false,"start_time":"2023-10-24T07:58:17.101817","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"resolution = 60\nbetsiboka_bbox = BBox(bbox=betsiboka_coords_wgs84, crs=CRS.WGS84)\nbetsiboka_size = bbox_to_dimensions(betsiboka_bbox, resolution=resolution)\n\nprint(f'Image shape at {resolution} m resolution: {betsiboka_size} pixels')","visibility":"show","key":"kLCLd8BrNt"},{"type":"output","id":"c4WqQde71xuk7OAq9oAoR","data":[{"name":"stdout","output_type":"stream","text":"Image shape at 60 m resolution: (631, 1047) pixels\n"}],"visibility":"show","key":"hzFeCDhCmd"}],"visibility":"show","key":"xBryod1z9P"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.026438,"end_time":"2023-10-24T07:58:17.212596","exception":false,"start_time":"2023-10-24T07:58:17.186158","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 1: Request a true color (PNG) image on a specific date","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nBxeNRUSgB"}],"identifier":"example-1-request-a-true-color-png-image-on-a-specific-date","label":"Example 1: Request a true color (PNG) image on a specific date","html_id":"example-1-request-a-true-color-png-image-on-a-specific-date","implicit":true,"key":"gHHYm1cXav"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We build the request according to the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"r93mDNZU0Y"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/reference/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"API Reference","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LCSiPZdBgi"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/reference/","key":"XYFEIBgnZE"},{"type":"text","value":", using the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"V2NzduOQFo"},{"type":"inlineCode","value":"SentinelHubRequest","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZRwxyao8mD"},{"type":"text","value":" class. Each Process API request also needs an ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FeEwPGWRQL"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/Evalscript/V3/README","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"evalscript","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZwUoQoVlLH"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/Evalscript/V3/README","key":"HrYZzFsG7w"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RgA2EugNiT"}],"key":"yYCMqz8Goh"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The information that we specify in the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GsysPDu6yZ"},{"type":"inlineCode","value":"SentinelHubRequest","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cpnnMNuPag"},{"type":"text","value":" object is:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xj2eXPDWpA"}],"key":"qbfcZn4nEh"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"an evalscript,","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"YqwcG1W92P"}],"key":"tjqyQPOCL5"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"a list of input data collections with time interval,","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ML5lkuo8h0"}],"key":"JjoxCCSDwD"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"a format of the response,","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"BKYZPAv1l8"}],"key":"Q6kk64Nt4d"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"a bounding box and it’s size (size or resolution).","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"M65GrjPbV1"}],"key":"hYM6KyZnvc"}],"key":"IdIQSY5XAn"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The evalscript in the example is used to select the appropriate bands. We return the RGB (B04, B03, B02) Sentinel-2 L1C bands.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"IVcKiI3iTC"}],"key":"llbOsKnjwV"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"The image from Jun 12th 2020 is downloaded. Without any additional parameters in the evalscript, the downloaded data will correspond to reflectance values in ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"fWkpNNkP6D"},{"type":"inlineCode","value":"UINT8","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"uQTMnn62FR"},{"type":"text","value":" format (values in 0-255 range).","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"U5HMB7XRzM"}],"key":"TQTNH4L2PT"}],"visibility":"show","key":"mBllzcFFid"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:17.281579Z","iopub.status.busy":"2023-10-24T07:58:17.281352Z","iopub.status.idle":"2023-10-24T07:58:17.286230Z","shell.execute_reply":"2023-10-24T07:58:17.285747Z"},"papermill":{"duration":0.035807,"end_time":"2023-10-24T07:58:17.287179","exception":false,"start_time":"2023-10-24T07:58:17.251372","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_true_color = \"\"\"\n    //VERSION=3\n\n    function setup() {\n        return {\n            input: [{\n                bands: [\"B02\", \"B03\", \"B04\"]\n            }],\n            output: {\n                bands: 3\n            }\n        };\n    }\n\n    function evaluatePixel(sample) {\n        return [sample.B04, sample.B03, sample.B02];\n    }\n\"\"\"\n\nrequest_true_color = SentinelHubRequest(\n    evalscript=evalscript_true_color,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L1C,\n            time_interval=('2020-06-12', '2020-06-13'),\n        )\n    ],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.PNG)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"QHyAZoo8kN"},{"type":"output","id":"j_x1LANDIDdCfi_mERogz","data":[],"visibility":"show","key":"iSePECrXci"}],"visibility":"show","key":"YHBBobwZu3"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:17.353393Z","iopub.status.busy":"2023-10-24T07:58:17.353043Z","iopub.status.idle":"2023-10-24T07:58:18.418103Z","shell.execute_reply":"2023-10-24T07:58:18.417366Z"},"papermill":{"duration":1.095641,"end_time":"2023-10-24T07:58:18.421078","exception":false,"start_time":"2023-10-24T07:58:17.325437","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"true_color_imgs = request_true_color.get_data()","visibility":"show","key":"XTrcR93abl"},{"type":"output","id":"jBsfXRCTpUWhL3pcTtHQU","data":[],"visibility":"show","key":"VjTOvNtDZR"}],"visibility":"show","key":"zoiEZcXzAL"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.044092,"end_time":"2023-10-24T07:58:18.521263","exception":false,"start_time":"2023-10-24T07:58:18.477171","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The method ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yr7FaIXf3y"},{"type":"inlineCode","value":"get_data()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Qr4A4glQBz"},{"type":"text","value":" will always return a list of length 1 with the available image from the requested time interval in the form of numpy arrays.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uSpsMAOeh5"}],"key":"KDUdSSAXsx"}],"visibility":"show","key":"R2eChWO0wd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:18.592589Z","iopub.status.busy":"2023-10-24T07:58:18.592107Z","iopub.status.idle":"2023-10-24T07:58:18.595889Z","shell.execute_reply":"2023-10-24T07:58:18.595326Z"},"papermill":{"duration":0.032682,"end_time":"2023-10-24T07:58:18.597447","exception":false,"start_time":"2023-10-24T07:58:18.564765","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f'Returned data is of type = {type(true_color_imgs)} and length {len(true_color_imgs)}.')\nprint(f'Single element in the list is of type {type(true_color_imgs[-1])} and has shape {true_color_imgs[-1].shape}')","visibility":"show","key":"eFLoHhXBix"},{"type":"output","id":"CVW1XXAbiC2tJ05NVHADS","data":[{"name":"stdout","output_type":"stream","text":"Returned data is of type = <class 'list'> and length 1.\nSingle element in the list is of type <class 'numpy.ndarray'> and has shape (1047, 631, 3)\n"}],"visibility":"show","key":"sTgPsObWuh"}],"visibility":"show","key":"zBHdNFqMrA"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:18.667461Z","iopub.status.busy":"2023-10-24T07:58:18.666882Z","iopub.status.idle":"2023-10-24T07:58:19.387747Z","shell.execute_reply":"2023-10-24T07:58:19.387197Z"},"papermill":{"duration":0.758762,"end_time":"2023-10-24T07:58:19.397971","exception":false,"start_time":"2023-10-24T07:58:18.639209","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"image = true_color_imgs[0]\nprint(f'Image type: {image.dtype}')\n\n# plot function\n# factor 1/255 to scale between 0-1\n# factor 3.5 to increase brightness\nplot_image(image, factor=3.5/255, clip_range=(0,1))","visibility":"show","key":"nPDiJ8Cy4L"},{"type":"output","id":"6MPpAFUOR_m2LTNDNXe7J","data":[{"name":"stdout","output_type":"stream","text":"Image type: uint8\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a6ee3c4a1a25ec6db2dc04a521204869","path":"/notebooks_test/build/a6ee3c4a1a25ec6db2dc04a521204869.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"DqxiuO8VYc"}],"visibility":"show","key":"SLwTL9DhTQ"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.08628,"end_time":"2023-10-24T07:58:19.584640","exception":false,"start_time":"2023-10-24T07:58:19.498360","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 1.1 Adding cloud mask data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qrgPUYG3yN"}],"identifier":"example-1-1-adding-cloud-mask-data","label":"Example 1.1 Adding cloud mask data","html_id":"example-1-1-adding-cloud-mask-data","implicit":true,"key":"oUzgWeHyRC"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"It is also possible to obtain cloud masks when requesting Sentinel-2 data by using the cloud mask band (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"be63IEYDYf"},{"type":"inlineCode","value":"CLM","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PhR85KBNF0"},{"type":"text","value":") or the cloud probabilities band (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uWILgQeyZp"},{"type":"inlineCode","value":"CLP","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ehe9ofeVol"},{"type":"text","value":"). More info ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tFYkMsVa8z"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/API/data_access?id=cloud-masks-and-cloud-probabilities","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nHPCnHKQ5X"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/API/data_access?id=cloud-masks-and-cloud-probabilities","key":"aYxA8wzCES"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SHE2s6pe60"}],"key":"Ot0zRCWbjP"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The factor for increasing the image brightness can already be provided in the evalscript.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xSKSc0yYEW"}],"key":"TdpaMmH0Vn"}],"visibility":"show","key":"hqW4ZPdjeI"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:19.768890Z","iopub.status.busy":"2023-10-24T07:58:19.768613Z","iopub.status.idle":"2023-10-24T07:58:19.772589Z","shell.execute_reply":"2023-10-24T07:58:19.772092Z"},"papermill":{"duration":0.092391,"end_time":"2023-10-24T07:58:19.773751","exception":false,"start_time":"2023-10-24T07:58:19.681360","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_clm = \"\"\"\n//VERSION=3\nfunction setup() {\n  return {\n    input: [\"B02\", \"B03\", \"B04\", \"CLM\"],\n    output: { bands: 3 }\n  }\n}\n\nfunction evaluatePixel(sample) {\n  if (sample.CLM == 1) {\n    return [0.75 + sample.B04, sample.B03, sample.B02]\n  }\n  return [3.5*sample.B04, 3.5*sample.B03, 3.5*sample.B02];\n}\n\"\"\"\n\nrequest_true_color = SentinelHubRequest(\n    evalscript=evalscript_clm,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L1C,\n            time_interval=('2020-06-12', '2020-06-13'),\n        )\n    ],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.PNG)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"biyRQ3sn04"},{"type":"output","id":"eyRAnshRQpmn6tDtR2xlD","data":[],"visibility":"show","key":"uJOziYqB7e"}],"visibility":"show","key":"KWFfdE147E"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:19.960475Z","iopub.status.busy":"2023-10-24T07:58:19.960133Z","iopub.status.idle":"2023-10-24T07:58:21.035944Z","shell.execute_reply":"2023-10-24T07:58:21.035485Z"},"papermill":{"duration":1.168935,"end_time":"2023-10-24T07:58:21.037249","exception":false,"start_time":"2023-10-24T07:58:19.868314","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"data_with_cloud_mask = request_true_color.get_data()","visibility":"show","key":"yn2ecy0tt9"},{"type":"output","id":"IY8mYOcxMrkBLfTZYOQ5w","data":[],"visibility":"show","key":"nrMCZwV9nI"}],"visibility":"show","key":"pn5aTQeKaT"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:21.221532Z","iopub.status.busy":"2023-10-24T07:58:21.221293Z","iopub.status.idle":"2023-10-24T07:58:21.948919Z","shell.execute_reply":"2023-10-24T07:58:21.948437Z"},"papermill":{"duration":0.822987,"end_time":"2023-10-24T07:58:21.956107","exception":false,"start_time":"2023-10-24T07:58:21.133120","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_image(data_with_cloud_mask[0], factor=1/255)","visibility":"show","key":"sGsVI3TWPF"},{"type":"output","id":"0lcKm_JPVzzWSMlgHhX55","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7cc2c750d55706b6c8b6428bb3b47567","path":"/notebooks_test/build/7cc2c750d55706b6c8b6428bb3b47567.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"vCZIHvVTmg"}],"visibility":"show","key":"rNVUve0eLe"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.112788,"end_time":"2023-10-24T07:58:22.189616","exception":false,"start_time":"2023-10-24T07:58:22.076828","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 2: Request a true color mosaic of least cloudy acquisitions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rF958BlVgj"}],"identifier":"example-2-request-a-true-color-mosaic-of-least-cloudy-acquisitions","label":"Example 2: Request a true color mosaic of least cloudy acquisitions","html_id":"example-2-request-a-true-color-mosaic-of-least-cloudy-acquisitions","implicit":true,"key":"FVRvasGBaP"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FF7ODF0gge"},{"type":"inlineCode","value":"SentinelHubRequest","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"J2g8FUaSSp"},{"type":"text","value":" automatically creates a mosaic from all available images in the given time interval. By default, the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"p3dCJlUD2t"},{"type":"inlineCode","value":"mostRecent","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jiVVVVcPli"},{"type":"text","value":" mosaicking order is used. More information available ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"g1VjRiktmA"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/data/Sentinel-2-L2A?id=mosaickingorder","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"B7w9Aab8SY"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/data/Sentinel-2-L2A?id=mosaickingorder","key":"joynhefu4x"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Rokf55cysO"}],"key":"GRApk2IXgY"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In this example we will provide a month long interval, order the images w.r.t. the cloud coverage on the tile level (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PFrZbFyfll"},{"type":"inlineCode","value":"leastCC","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HT21zYZl6p"},{"type":"text","value":" parameter), and mosaic them in the specified order.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tFTPp1VC8W"}],"key":"FmSCHz7TX1"}],"visibility":"show","key":"A61qJFoxAZ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:22.432871Z","iopub.status.busy":"2023-10-24T07:58:22.432433Z","iopub.status.idle":"2023-10-24T07:58:22.436060Z","shell.execute_reply":"2023-10-24T07:58:22.435588Z"},"papermill":{"duration":0.120449,"end_time":"2023-10-24T07:58:22.437037","exception":false,"start_time":"2023-10-24T07:58:22.316588","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"request_true_color = SentinelHubRequest(\n    evalscript=evalscript_true_color,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L1C,\n            time_interval=('2020-06-01', '2020-06-30'),\n            mosaicking_order='leastCC'\n        )\n    ],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.PNG)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"SGAh3IpICq"},{"type":"output","id":"jmuOBM7E07VvLOhJzKEGD","data":[],"visibility":"show","key":"dkPhIHFR3H"}],"visibility":"show","key":"MgyNvQEHDe"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:22.699732Z","iopub.status.busy":"2023-10-24T07:58:22.699318Z","iopub.status.idle":"2023-10-24T07:58:24.250156Z","shell.execute_reply":"2023-10-24T07:58:24.249669Z"},"papermill":{"duration":1.691195,"end_time":"2023-10-24T07:58:24.257346","exception":false,"start_time":"2023-10-24T07:58:22.566151","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_image(request_true_color.get_data()[0], factor=3.5/255, clip_range=(0,1))","visibility":"show","key":"C0a4CnH2UO"},{"type":"output","id":"pROSbqCUIRLtRXaRliIYT","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9c3a0f7e7f03b678f292f3d756e7ebf4","path":"/notebooks_test/build/9c3a0f7e7f03b678f292f3d756e7ebf4.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"Hb4bdMGzqQ"}],"visibility":"show","key":"ZRgjjxDGnx"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.158495,"end_time":"2023-10-24T07:58:24.592486","exception":false,"start_time":"2023-10-24T07:58:24.433991","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 3: Request all Sentinel-2’s raw band values","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Dov1EywcaE"}],"identifier":"example-3-request-all-sentinel-2s-raw-band-values","label":"Example 3: Request all Sentinel-2’s raw band values","html_id":"example-3-request-all-sentinel-2s-raw-band-values","implicit":true,"key":"a0Alzd2XWe"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now let’s define an evalscript which will return all Sentinel-2 spectral bands with raw values.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FwaWmCJvIU"}],"key":"S2vUysdYQf"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In this example we are downloading already quite a big chunk of data, so optimization of the request is not out of the question. Downloading raw digital numbers in the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pS8OO5AwCw"},{"type":"inlineCode","value":"INT16","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"O4mYBHnsJJ"},{"type":"text","value":" format instead of reflectances in the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bj2l56IkWW"},{"type":"inlineCode","value":"FLOAT32","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"M1y2p38HD8"},{"type":"text","value":" format means that much less data is downloaded, which results in a faster download and a smaller usage of SH processing units.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"smuL6U2guv"}],"key":"WTUYmqOqbF"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"In order to achieve this, we have to set the input units in the evalscript to ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ECazBn3HSa"},{"type":"inlineCode","value":"DN","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"s24N8Hy3CH"},{"type":"text","value":" (digital numbers) and the output ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"fw8RzlTnSQ"},{"type":"inlineCode","value":"sampleType","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"PeTzNvkCXE"},{"type":"text","value":" argument to ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"N4IUfRIFKq"},{"type":"inlineCode","value":"INT16","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"bD6DyQUaVu"},{"type":"text","value":". Additionally, we can’t pack all Sentinel-2’s 13 bands into a ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"KD7dZKOtra"},{"type":"inlineCode","value":"PNG","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"K9cAjzM2Wo"},{"type":"text","value":" image, so we have to set the output image type to the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"a2xPB8deAn"},{"type":"inlineCode","value":"TIFF","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"bJ1hakCQ8h"},{"type":"text","value":" format via ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VuhrtTs6rt"},{"type":"inlineCode","value":"MimeType.TIFF","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"YYKT2QKpVT"},{"type":"text","value":" in the request.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ThwT2JZoJr"}],"key":"hYbXIrGUcp"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The digital numbers are in the range from 0-10000, so we have to scale the downloaded data appropriately.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"t8N47gfKdz"}],"key":"oKOu91funt"}],"visibility":"show","key":"J7RnqeD04v"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:24.930585Z","iopub.status.busy":"2023-10-24T07:58:24.930109Z","iopub.status.idle":"2023-10-24T07:58:24.934135Z","shell.execute_reply":"2023-10-24T07:58:24.933703Z"},"papermill":{"duration":0.177238,"end_time":"2023-10-24T07:58:24.935088","exception":false,"start_time":"2023-10-24T07:58:24.757850","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_all_bands = \"\"\"\n    //VERSION=3\n    function setup() {\n        return {\n            input: [{\n                bands: [\"B01\",\"B02\",\"B03\",\"B04\",\"B05\",\"B06\",\"B07\",\"B08\",\"B8A\",\"B09\",\"B10\",\"B11\",\"B12\"],\n                units: \"DN\"\n            }],\n            output: {\n                bands: 13,\n                sampleType: \"INT16\"\n            }\n        };\n    }\n\n    function evaluatePixel(sample) {\n        return [sample.B01,\n                sample.B02,\n                sample.B03,\n                sample.B04,\n                sample.B05,\n                sample.B06,\n                sample.B07,\n                sample.B08,\n                sample.B8A,\n                sample.B09,\n                sample.B10,\n                sample.B11,\n                sample.B12];\n    }\n\"\"\"\n\nrequest_all_bands = SentinelHubRequest(\n    evalscript=evalscript_all_bands,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L1C,\n            time_interval=('2020-06-01', '2020-06-30'),\n            mosaicking_order='leastCC'\n    )],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.TIFF)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"DIlfREtFIm"},{"type":"output","id":"8K5R7SqGCmRYqBWAjsV70","data":[],"visibility":"show","key":"kDrDF7nWM2"}],"visibility":"show","key":"mKsqSmFwXf"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:25.246449Z","iopub.status.busy":"2023-10-24T07:58:25.246139Z","iopub.status.idle":"2023-10-24T07:58:29.591562Z","shell.execute_reply":"2023-10-24T07:58:29.591058Z"},"papermill":{"duration":4.501737,"end_time":"2023-10-24T07:58:29.593006","exception":false,"start_time":"2023-10-24T07:58:25.091269","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"all_bands_response = request_all_bands.get_data()","visibility":"show","key":"lB1uSB7jr1"},{"type":"output","id":"BIkpzcsS40FjnXRXDb2-4","data":[],"visibility":"show","key":"qLVaCUxz9O"}],"visibility":"show","key":"H6Fe7om9v1"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:29.963501Z","iopub.status.busy":"2023-10-24T07:58:29.963043Z","iopub.status.idle":"2023-10-24T07:58:30.427331Z","shell.execute_reply":"2023-10-24T07:58:30.426858Z"},"papermill":{"duration":0.630095,"end_time":"2023-10-24T07:58:30.434315","exception":false,"start_time":"2023-10-24T07:58:29.804220","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Image showing the SWIR band B12\n# Factor 1/1e4 due to the DN band values in the range 0-10000\n# Factor 3.5 to increase the brightness\nplot_image(all_bands_response[0][:, :, 12], factor=3.5/1e4, vmax=1)","visibility":"show","key":"VAhflLO7ms"},{"type":"output","id":"GtfkAPgN7DJx2A4DgEUFW","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"69b20c649f17fdf2cf95a7dc0fccbce8","path":"/notebooks_test/build/69b20c649f17fdf2cf95a7dc0fccbce8.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"p8HYFpwUJO"}],"visibility":"show","key":"Kjarwon9uU"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:30.862665Z","iopub.status.busy":"2023-10-24T07:58:30.862154Z","iopub.status.idle":"2023-10-24T07:58:31.482062Z","shell.execute_reply":"2023-10-24T07:58:31.481547Z"},"papermill":{"duration":0.839145,"end_time":"2023-10-24T07:58:31.491142","exception":false,"start_time":"2023-10-24T07:58:30.651997","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# From raw bands we can also construct a False-Color image\n# False color image is (B03, B04, B08)\nplot_image(all_bands_response[0][:, :, [2,3,7]], factor=3.5/1e4, clip_range=(0,1))","visibility":"show","key":"Dq9lg3WsW2"},{"type":"output","id":"x0_hT9cWT0wG475b0mEO0","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"331dd2d9e3f90301403aa18125282a6d","path":"/notebooks_test/build/331dd2d9e3f90301403aa18125282a6d.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"Cu50OIsEau"}],"visibility":"show","key":"T0W8Um3JrZ"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.20739,"end_time":"2023-10-24T07:58:31.947717","exception":false,"start_time":"2023-10-24T07:58:31.740327","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 4: Save downloaded data to disk and read it from disk","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VaAuP6U7ET"}],"identifier":"example-4-save-downloaded-data-to-disk-and-read-it-from-disk","label":"Example 4: Save downloaded data to disk and read it from disk","html_id":"example-4-save-downloaded-data-to-disk-and-read-it-from-disk","implicit":true,"key":"pHvlkcWYt5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"All downloaded data can be saved to disk and later read from it. Simply specify the location on disk where data should be saved (or loaded from) via the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bT3lLDXnD9"},{"type":"inlineCode","value":"data_folder","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"J2MvVVYY1r"},{"type":"text","value":" argument of the request’s constructor. When executing the request’s ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"k9SKihzcnM"},{"type":"inlineCode","value":"get_data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"I0POsTmVVb"},{"type":"text","value":" method, set the argument ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IVXoHRaeRT"},{"type":"inlineCode","value":"save_data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mijqpKN4Vi"},{"type":"text","value":" to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uMLRX4QjcW"},{"type":"inlineCode","value":"True","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PEMRXYUCuc"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zQp9iqe7ur"}],"key":"LK88fP5NkV"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This also means that in all the future requests for data, the request will first check the provided location if the data is already there, unless you explicitly demand to redownload the data.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JMqucs8v3l"}],"key":"jUIoaMeB9L"}],"visibility":"show","key":"UCkxZXHqVX"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:32.386579Z","iopub.status.busy":"2023-10-24T07:58:32.386242Z","iopub.status.idle":"2023-10-24T07:58:32.389771Z","shell.execute_reply":"2023-10-24T07:58:32.389307Z"},"papermill":{"duration":0.211012,"end_time":"2023-10-24T07:58:32.390802","exception":false,"start_time":"2023-10-24T07:58:32.179790","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"request_all_bands = SentinelHubRequest(\n    data_folder='test_dir',\n    evalscript=evalscript_all_bands,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L1C,\n            time_interval=('2020-06-01', '2020-06-30'),\n            mosaicking_order='leastCC'\n    )],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.TIFF)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"ZkSLS3k6Gp"},{"type":"output","id":"vQrSBcG0zH3jrgTAtUdKR","data":[],"visibility":"show","key":"aWZkayLVgi"}],"visibility":"show","key":"KkeO4MqzSk"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:32.881602Z","iopub.status.busy":"2023-10-24T07:58:32.881346Z","iopub.status.idle":"2023-10-24T07:58:36.883113Z","shell.execute_reply":"2023-10-24T07:58:36.882692Z"},"papermill":{"duration":4.26001,"end_time":"2023-10-24T07:58:36.884678","exception":false,"start_time":"2023-10-24T07:58:32.624668","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nall_bands_img = request_all_bands.get_data(save_data=True)","visibility":"show","key":"xSoMYDeB2N"},{"type":"output","id":"V6_31jEVqJcJJcOKp17Mz","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 141 ms, sys: 26 ms, total: 167 ms\nWall time: 4 s\n"}],"visibility":"show","key":"RjB3LlgiVI"}],"visibility":"show","key":"gDYIOFpXxS"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:37.363448Z","iopub.status.busy":"2023-10-24T07:58:37.363170Z","iopub.status.idle":"2023-10-24T07:58:37.372692Z","shell.execute_reply":"2023-10-24T07:58:37.372183Z"},"papermill":{"duration":0.226648,"end_time":"2023-10-24T07:58:37.373812","exception":false,"start_time":"2023-10-24T07:58:37.147164","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f'The output directory has been created and a tiff file with all 13 bands was saved into ' \\\n      'the following structure:\\n')\n\nfor folder, _, filenames in os.walk(request_all_bands.data_folder):\n    for filename in filenames:\n        print(os.path.join(folder, filename))","visibility":"show","key":"qK0JjZfjTN"},{"type":"output","id":"rttokI6zT3TYbQnNW6yfq","data":[{"name":"stdout","output_type":"stream","text":"The output directory has been created and a tiff file with all 13 bands was saved into the following structure:\n\ntest_dir/4d34ca44cf5505abbf2690c928df83fe/response.tiff\ntest_dir/4d34ca44cf5505abbf2690c928df83fe/request.json\n"}],"visibility":"show","key":"e9hmF95rqM"}],"visibility":"show","key":"zjfLkuMCcg"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:37.828388Z","iopub.status.busy":"2023-10-24T07:58:37.828122Z","iopub.status.idle":"2023-10-24T07:58:37.986498Z","shell.execute_reply":"2023-10-24T07:58:37.985920Z"},"papermill":{"duration":0.38535,"end_time":"2023-10-24T07:58:37.987513","exception":false,"start_time":"2023-10-24T07:58:37.602163","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# try to re-download the data\nall_bands_img_from_disk = request_all_bands.get_data()","visibility":"show","key":"oGsacDjqph"},{"type":"output","id":"UCbyAWnGapvF5Zp_f2l5D","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 110 ms, sys: 15.3 ms, total: 125 ms\nWall time: 155 ms\n"}],"visibility":"show","key":"S1yAz2nDPz"}],"visibility":"show","key":"QYJHmyPKsS"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:38.456540Z","iopub.status.busy":"2023-10-24T07:58:38.456117Z","iopub.status.idle":"2023-10-24T07:58:43.895246Z","shell.execute_reply":"2023-10-24T07:58:43.894700Z"},"papermill":{"duration":5.672089,"end_time":"2023-10-24T07:58:43.896353","exception":false,"start_time":"2023-10-24T07:58:38.224264","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# force the redownload\nall_bands_img_redownload = request_all_bands.get_data(redownload=True)","visibility":"show","key":"lkXkltOnU9"},{"type":"output","id":"gx7bwGpMKSceLCTndUjEO","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 153 ms, sys: 11.1 ms, total: 164 ms\nWall time: 5.44 s\n"}],"visibility":"show","key":"eIIEXmj6Qf"}],"visibility":"show","key":"PSHrBCd9rM"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.241312,"end_time":"2023-10-24T07:58:44.417988","exception":false,"start_time":"2023-10-24T07:58:44.176676","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 4.1: Save downloaded data directly to disk","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VK19p0t1Ra"}],"identifier":"example-4-1-save-downloaded-data-directly-to-disk","label":"Example 4.1: Save downloaded data directly to disk","html_id":"example-4-1-save-downloaded-data-directly-to-disk","implicit":true,"key":"D4rZsfMnqp"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"laUcinNVGL"},{"type":"inlineCode","value":"get_data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jMTHjtIuoE"},{"type":"text","value":" method returns a list of numpy arrays and can save the downloaded data to disk, as we have seen in the previous example. Sometimes it is convenient to just save the data directly to disk. You can do that by using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fX9NiK89FZ"},{"type":"inlineCode","value":"save_data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BoNob4hHsK"},{"type":"text","value":" method instead.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"E5rTbWGoGv"}],"key":"scT1wgyvsV"}],"visibility":"show","key":"czDytlhtfG"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:44.890483Z","iopub.status.busy":"2023-10-24T07:58:44.890067Z","iopub.status.idle":"2023-10-24T07:58:44.894451Z","shell.execute_reply":"2023-10-24T07:58:44.893926Z"},"papermill":{"duration":0.216491,"end_time":"2023-10-24T07:58:44.895703","exception":false,"start_time":"2023-10-24T07:58:44.679212","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nrequest_all_bands.save_data()","visibility":"show","key":"nYwTda7iqB"},{"type":"output","id":"o1dhnAqpJ-YPftK9YUANH","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 1.39 ms, sys: 0 ns, total: 1.39 ms\nWall time: 1.35 ms\n"}],"visibility":"show","key":"ZuMYiMcWl0"}],"visibility":"show","key":"h2RGVrUzKz"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:45.386767Z","iopub.status.busy":"2023-10-24T07:58:45.386500Z","iopub.status.idle":"2023-10-24T07:58:45.400043Z","shell.execute_reply":"2023-10-24T07:58:45.399372Z"},"papermill":{"duration":0.251393,"end_time":"2023-10-24T07:58:45.401218","exception":false,"start_time":"2023-10-24T07:58:45.149825","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f'The output directory has been created and a tiff file with all 13 bands was saved into ' \\\n      'the following structure:\\n')\n\nfor folder, _, filenames in os.walk(request_all_bands.data_folder):\n    for filename in filenames:\n        print(os.path.join(folder, filename))","visibility":"show","key":"dP38HeDDnM"},{"type":"output","id":"S7k7Rc_eV_femwcDb0gml","data":[{"name":"stdout","output_type":"stream","text":"The output directory has been created and a tiff file with all 13 bands was saved into the following structure:\n\ntest_dir/4d34ca44cf5505abbf2690c928df83fe/response.tiff\ntest_dir/4d34ca44cf5505abbf2690c928df83fe/request.json\n"}],"visibility":"show","key":"LGVhRazLGN"}],"visibility":"show","key":"GY7eOox02B"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.234628,"end_time":"2023-10-24T07:58:45.871433","exception":false,"start_time":"2023-10-24T07:58:45.636805","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 5: Request other data collections supported by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BBgtdhCI44"},{"type":"inlineCode","value":"sh-py","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K6y6azl97c"}],"identifier":"example-5-request-other-data-collections-supported-by-sh-py","label":"Example 5: Request other data collections supported by sh-py","html_id":"example-5-request-other-data-collections-supported-by-sh-py","implicit":true,"key":"PZYZH4Knu7"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qp6pIap9AR"},{"type":"inlineCode","value":"sentinelhub-py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sSH6zWcvNq"},{"type":"text","value":" package supports various data collections. The example below is shown for one of them, but the process is the same for all of them.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HKKGSUWS6P"}],"key":"sysr5TSSQN"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Note: For more examples and information check the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dfKkwlVWXC"},{"type":"link","url":"https://sentinelhub-py.readthedocs.io/en/latest/examples/data_collections.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"tutorial about data collections","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IARWdXgIr2"}],"urlSource":"https://sentinelhub-py.readthedocs.io/en/latest/examples/data_collections.html","key":"qWG0xc6LIB"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IElnm1kjAp"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/data/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Sentinel Hub documentation about data collections","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"a9Iyz6gZE9"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/data/","key":"WAhjHxiEVm"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BQmVeKWBxa"}],"key":"xc2YJJjYTn"}],"key":"hFEyFaB7yj"}],"visibility":"show","key":"rS1DrtveRd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:46.356779Z","iopub.status.busy":"2023-10-24T07:58:46.356191Z","iopub.status.idle":"2023-10-24T07:58:46.360157Z","shell.execute_reply":"2023-10-24T07:58:46.359619Z"},"papermill":{"duration":0.235303,"end_time":"2023-10-24T07:58:46.361427","exception":false,"start_time":"2023-10-24T07:58:46.126124","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"print('Supported DataCollections:\\n')\nfor collection in DataCollection.get_available_collections():\n    print(collection)","visibility":"show","key":"kYwfBlx6Iy"},{"type":"output","id":"Nlly8HjKyC5uzYNj9K8p-","data":[{"name":"stdout","output_type":"stream","text":"Supported DataCollections:\n\nDataCollection.SENTINEL2_L1C\nDataCollection.SENTINEL2_L2A\nDataCollection.SENTINEL1\nDataCollection.SENTINEL1_IW\nDataCollection.SENTINEL1_IW_ASC\nDataCollection.SENTINEL1_IW_DES\nDataCollection.SENTINEL1_EW\nDataCollection.SENTINEL1_EW_ASC\nDataCollection.SENTINEL1_EW_DES\nDataCollection.SENTINEL1_EW_SH\nDataCollection.SENTINEL1_EW_SH_ASC\nDataCollection.SENTINEL1_EW_SH_DES\nDataCollection.DEM\nDataCollection.DEM_MAPZEN\nDataCollection.DEM_COPERNICUS_30\nDataCollection.DEM_COPERNICUS_90\nDataCollection.MODIS\nDataCollection.LANDSAT_MSS_L1\nDataCollection.LANDSAT_TM_L1\nDataCollection.LANDSAT_TM_L2\nDataCollection.LANDSAT_ETM_L1\nDataCollection.LANDSAT_ETM_L2\nDataCollection.LANDSAT_OT_L1\nDataCollection.LANDSAT_OT_L2\nDataCollection.SENTINEL5P\nDataCollection.SENTINEL3_OLCI\nDataCollection.SENTINEL3_SLSTR\nDataCollection.HARMONIZED_LANDSAT_SENTINEL\n"}],"visibility":"show","key":"AkbmgQ1mUz"}],"visibility":"show","key":"KodR5hSOK8"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.240947,"end_time":"2023-10-24T07:58:46.861365","exception":false,"start_time":"2023-10-24T07:58:46.620418","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For this example let’s download the digital elevation model data (DEM). The process is similar as before, we just provide the evalscript and create the request. More data on the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BIexVOhlmt"},{"type":"inlineCode","value":"DEM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pe9kmDZCEy"},{"type":"text","value":" data collection is available ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gn5haSPUtw"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/data/DEM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k1HAHWJSAp"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/data/DEM","key":"YUPop7drXP"},{"type":"text","value":". ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aHVXbGZipT"},{"type":"inlineCode","value":"DEM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xgRtANQzJI"},{"type":"text","value":" values are in meters and can be negative for areas which lie below sea level, so it is recommended to set the output format in your evalscript to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nmwHoLZdjQ"},{"type":"inlineCode","value":"FLOAT32","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jPis5oA6Dz"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c6fxj72zvx"}],"key":"iih3odL53H"}],"visibility":"show","key":"OFP3WipM2Y"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:47.339683Z","iopub.status.busy":"2023-10-24T07:58:47.339183Z","iopub.status.idle":"2023-10-24T07:58:47.342272Z","shell.execute_reply":"2023-10-24T07:58:47.341758Z"},"papermill":{"duration":0.236946,"end_time":"2023-10-24T07:58:47.343339","exception":false,"start_time":"2023-10-24T07:58:47.106393","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_dem = '''\n//VERSION=3\nfunction setup() {\n  return {\n    input: [\"DEM\"],\n    output:{\n      id: \"default\",\n      bands: 1,\n      sampleType: SampleType.FLOAT32\n    }\n  }\n}\n\nfunction evaluatePixel(sample) {\n  return [sample.DEM]\n}\n'''","visibility":"show","key":"Hv81766bkv"},{"type":"output","id":"kmuFGQHw1LTJO5b91f-mp","data":[],"visibility":"show","key":"LM1sFpvxHi"}],"visibility":"show","key":"AdWj8a1KBa"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:47.827899Z","iopub.status.busy":"2023-10-24T07:58:47.827316Z","iopub.status.idle":"2023-10-24T07:58:47.831465Z","shell.execute_reply":"2023-10-24T07:58:47.831005Z"},"papermill":{"duration":0.240012,"end_time":"2023-10-24T07:58:47.832621","exception":false,"start_time":"2023-10-24T07:58:47.592609","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"dem_request = SentinelHubRequest(\n    evalscript=evalscript_dem,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.DEM,\n            time_interval=('2020-06-12', '2020-06-13'),\n    )\n    ],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.TIFF)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"Gc70GDWMsl"},{"type":"output","id":"xU7rW-PsHEe4E_WqIS_Pr","data":[],"visibility":"show","key":"PyTx9MeZjp"}],"visibility":"show","key":"c7VQ9Yx86l"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:48.301435Z","iopub.status.busy":"2023-10-24T07:58:48.300968Z","iopub.status.idle":"2023-10-24T07:58:49.524209Z","shell.execute_reply":"2023-10-24T07:58:49.523751Z"},"papermill":{"duration":1.451687,"end_time":"2023-10-24T07:58:49.526186","exception":false,"start_time":"2023-10-24T07:58:48.074499","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"dem_data = dem_request.get_data()","visibility":"show","key":"YigoIyTSOw"},{"type":"output","id":"5QZEYhaWA7cqWbCLI24Ow","data":[],"visibility":"show","key":"bnVExjl5Ux"}],"visibility":"show","key":"OgJhpY2KhJ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:49.991133Z","iopub.status.busy":"2023-10-24T07:58:49.990720Z","iopub.status.idle":"2023-10-24T07:58:50.317452Z","shell.execute_reply":"2023-10-24T07:58:50.317037Z"},"papermill":{"duration":0.548964,"end_time":"2023-10-24T07:58:50.320298","exception":false,"start_time":"2023-10-24T07:58:49.771334","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Plot DEM map\n# vmin = 0; cutoff at sea level (0 m)\n# vmax = 120; cutoff at high values (120 m)\nplot_image(dem_data[0], factor=1.0, cmap=plt.cm.Greys_r, vmin=0, vmax=120)","visibility":"show","key":"yobmSyHq3b"},{"type":"output","id":"3CksAqNxAWWgo7vulOjbr","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2a682b1635f3c4a62e35abf11409f279","path":"/notebooks_test/build/2a682b1635f3c4a62e35abf11409f279.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"gXE640Acv8"}],"visibility":"show","key":"kQB3AAdJ6s"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.238989,"end_time":"2023-10-24T07:58:50.817639","exception":false,"start_time":"2023-10-24T07:58:50.578650","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 6: Multi-response request","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Pt3HElqdtj"}],"identifier":"example-6-multi-response-request","label":"Example 6: Multi-response request","html_id":"example-6-multi-response-request","implicit":true,"key":"cMhnQ8u30p"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Process API enables downloading multiple files in one response, packed together in a TAR archive.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yYcgaR7Xrn"}],"key":"Ci7VR32A6T"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We will get the same image as before, download in the form of digital numbers (DN) as a UINT16 TIFF file. Along with the image we will download the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MR2qrINljS"},{"type":"inlineCode","value":"inputMetadata","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BA6gyVxFyG"},{"type":"text","value":" which contains the normalization factor value in a JSON format.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PZJrcU4cxz"}],"key":"fQAZiBkMVs"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"After the download we will be able to convert the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"PHjGCzLcG7"},{"type":"inlineCode","value":"INT16","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"atyBKDXret"},{"type":"text","value":" digital numbers to get the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"TncHfjsPoT"},{"type":"inlineCode","value":"FLOAT32","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"fxzqXZHCum"},{"type":"text","value":" reflectances.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"r2QxQ9Fhff"}],"key":"XcJBebf1s2"}],"visibility":"show","key":"dNymu3mg2i"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:51.307893Z","iopub.status.busy":"2023-10-24T07:58:51.307468Z","iopub.status.idle":"2023-10-24T07:58:51.311224Z","shell.execute_reply":"2023-10-24T07:58:51.310809Z"},"papermill":{"duration":0.243238,"end_time":"2023-10-24T07:58:51.312640","exception":false,"start_time":"2023-10-24T07:58:51.069402","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript = \"\"\"\n    //VERSION=3\n\n    function setup() {\n        return {\n            input: [{\n                bands: [\"B02\", \"B03\", \"B04\"],\n                units: \"DN\"\n            }],\n            output: {\n                bands: 3,\n                sampleType: \"INT16\"\n            }\n        };\n    }\n\n    function updateOutputMetadata(scenes, inputMetadata, outputMetadata) {\n        outputMetadata.userData = { \"norm_factor\":  inputMetadata.normalizationFactor }\n    }\n\n    function evaluatePixel(sample) {\n        return [sample.B04, sample.B03, sample.B02];\n    }\n\"\"\"\n\nrequest_multitype = SentinelHubRequest(\n    evalscript=evalscript,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L1C,\n            time_interval=('2020-06-01', '2020-06-30'),\n            mosaicking_order='leastCC'\n        )\n    ],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.TIFF),\n        SentinelHubRequest.output_response('userdata', MimeType.JSON)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"iYsVfjbzDd"},{"type":"output","id":"A4yWMFB5L4tNo48-smo4_","data":[],"visibility":"show","key":"DNhE0PnQOH"}],"visibility":"show","key":"TE8Di6eqyZ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:51.811918Z","iopub.status.busy":"2023-10-24T07:58:51.811393Z","iopub.status.idle":"2023-10-24T07:58:53.044049Z","shell.execute_reply":"2023-10-24T07:58:53.043553Z"},"papermill":{"duration":1.47041,"end_time":"2023-10-24T07:58:53.045218","exception":false,"start_time":"2023-10-24T07:58:51.574808","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# print out information\nmulti_data = request_multitype.get_data()[0]\nmulti_data.keys()","visibility":"show","key":"t9IK32dOm0"},{"type":"output","id":"Ax6CG7qYyCxheAUnjekMw","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/plain":{"content":"dict_keys(['default.tif', 'userdata.json'])","content_type":"text/plain"}}}],"visibility":"show","key":"SnPWUbHKNS"}],"visibility":"show","key":"gMAHuW5Lg5"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:53.571721Z","iopub.status.busy":"2023-10-24T07:58:53.571270Z","iopub.status.idle":"2023-10-24T07:58:53.575388Z","shell.execute_reply":"2023-10-24T07:58:53.574964Z"},"papermill":{"duration":0.28882,"end_time":"2023-10-24T07:58:53.576868","exception":false,"start_time":"2023-10-24T07:58:53.288048","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# normalize image\nimg = multi_data['default.tif']\nnorm_factor = multi_data['userdata.json']['norm_factor']\n\nimg_float32 = img * norm_factor","visibility":"show","key":"c7CT7aEETb"},{"type":"output","id":"y-IHPdPZe1ZfeXdVgOEjS","data":[],"visibility":"show","key":"q9jwphEsFB"}],"visibility":"show","key":"vLKiyUCOen"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:54.066725Z","iopub.status.busy":"2023-10-24T07:58:54.066112Z","iopub.status.idle":"2023-10-24T07:58:54.746026Z","shell.execute_reply":"2023-10-24T07:58:54.745572Z"},"papermill":{"duration":0.919051,"end_time":"2023-10-24T07:58:54.755429","exception":false,"start_time":"2023-10-24T07:58:53.836378","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_image(img_float32, factor=3.5, clip_range=(0, 1))","visibility":"show","key":"U2Fmlmrfeb"},{"type":"output","id":"4-rLYciN2lQr1EWDwqLM1","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3507c6173d8238b3fd0018b749a79dd9","path":"/notebooks_test/build/3507c6173d8238b3fd0018b749a79dd9.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"rjtSH8jwcg"}],"visibility":"show","key":"uXsWafAgmN"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.26274,"end_time":"2023-10-24T07:58:55.310679","exception":false,"start_time":"2023-10-24T07:58:55.047939","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 7: Request with a raw dictionary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CwBeohM43L"}],"identifier":"example-7-request-with-a-raw-dictionary","label":"Example 7: Request with a raw dictionary","html_id":"example-7-request-with-a-raw-dictionary","implicit":true,"key":"Ogv5bNOHzy"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"All requests so far were built with some helper functions. We can also construct a raw dictionary as defined in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MSeVAyeQvE"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/reference/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"API Reference","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BIT1kMr94l"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/reference/","key":"MPsQgihxAg"},{"type":"text","value":", without these helper functions, so we have full control over building the request body.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"clp8jKA3pu"}],"key":"DbUvzphVi6"}],"visibility":"show","key":"A4gxv1crpi"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:55.895161Z","iopub.status.busy":"2023-10-24T07:58:55.894814Z","iopub.status.idle":"2023-10-24T07:58:55.898654Z","shell.execute_reply":"2023-10-24T07:58:55.898230Z"},"papermill":{"duration":0.28599,"end_time":"2023-10-24T07:58:55.899609","exception":false,"start_time":"2023-10-24T07:58:55.613619","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"request_raw_dict = {\n    \"input\": {\n        \"bounds\": {\n            \"properties\": {\n                \"crs\": betsiboka_bbox.crs.opengis_string\n            },\n            \"bbox\": list(betsiboka_bbox)\n        },\n        \"data\": [\n            {\n                \"type\": \"S2L1C\",\n                \"dataFilter\": {\n                    \"timeRange\": {\"from\": '2020-06-01T00:00:00Z', \"to\": '2020-06-30T00:00:00Z'},\n                    \"mosaickingOrder\": \"leastCC\",\n                }\n            }\n        ]\n    },\n    \"output\": {\n        \"width\": betsiboka_size[0],\n        \"height\": betsiboka_size[1],\n        \"responses\": [\n            {\n                \"identifier\": \"default\",\n                \"format\": {\n                    'type': MimeType.TIFF.get_string()\n                }\n            }\n        ]\n    },\n    \"evalscript\": evalscript_true_color\n}","visibility":"show","key":"WVUgiss16I"},{"type":"output","id":"3SXCjpgaxEjY8Rzbjakq4","data":[],"visibility":"show","key":"XQbb6a9d8B"}],"visibility":"show","key":"YfSdUYVF2c"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:56.424445Z","iopub.status.busy":"2023-10-24T07:58:56.423884Z","iopub.status.idle":"2023-10-24T07:58:57.276025Z","shell.execute_reply":"2023-10-24T07:58:57.275591Z"},"papermill":{"duration":1.104523,"end_time":"2023-10-24T07:58:57.277474","exception":false,"start_time":"2023-10-24T07:58:56.172951","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# create request\ndownload_request = DownloadRequest(\n    request_type='POST',\n    url=\"https://services.sentinel-hub.com/api/v1/process\",\n    post_values=request_raw_dict,\n    data_type=MimeType.TIFF,\n    headers={'content-type': 'application/json'},\n    use_session=True\n)\n\n# execute request\nclient = SentinelHubDownloadClient(config=config)\nimg = client.download(download_request)","visibility":"show","key":"Ac0XsQplWA"},{"type":"output","id":"GGemJg2gjM03LFxGGXJ7t","data":[{"name":"stderr","output_type":"stream","text":"/home/conda/20a41cef-8d63-4030-9e37-aa3412866cee/60a7fe77bf15cdba38ca795208c44847e274649eaaa525aeefa5bf7a3f7692e0-20231023-081922-894744-312-bm-test-edc-2023.10-01/lib/python3.11/site-packages/sentinelhub/download/client.py:78: SHDeprecationWarning: The parameter `download_requests` should be a sequence of requests. In future versions download of single requests will only be supported if provided as a singelton tuple or list.\n  warnings.warn(\n"}],"visibility":"show","key":"RyYDpY8vvw"}],"visibility":"show","key":"higkmkRYuh"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:57.810223Z","iopub.status.busy":"2023-10-24T07:58:57.809843Z","iopub.status.idle":"2023-10-24T07:58:58.466505Z","shell.execute_reply":"2023-10-24T07:58:58.466084Z"},"papermill":{"duration":0.912216,"end_time":"2023-10-24T07:58:58.473503","exception":false,"start_time":"2023-10-24T07:58:57.561287","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_image(img, factor=3.5/255, clip_range=(0,1))","visibility":"show","key":"hZ2bPgk4PR"},{"type":"output","id":"HUAwXBhbwKe0unpS-Yesj","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9c3a0f7e7f03b678f292f3d756e7ebf4","path":"/notebooks_test/build/9c3a0f7e7f03b678f292f3d756e7ebf4.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"HDX5NdALCL"}],"visibility":"show","key":"XMKLeVfBzB"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.281786,"end_time":"2023-10-24T07:58:59.064993","exception":false,"start_time":"2023-10-24T07:58:58.783207","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 8: Request multiple timestamps data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lhmpqerBXK"}],"identifier":"example-8-request-multiple-timestamps-data","label":"Example 8: Request multiple timestamps data","html_id":"example-8-request-multiple-timestamps-data","implicit":true,"key":"OviHmCfSRy"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"It is possible to construct some logic in order to return data for multiple timestamps. By defining the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lmjAWwjwLM"},{"type":"inlineCode","value":"time_interval","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vkGbo2hIxE"},{"type":"text","value":" parameter and some logic of splitting it, it is possible to create an SH reques per each “time slot” and then download the data from all the requests with the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PGIrOQq3eB"},{"type":"inlineCode","value":"SentinelHubDownloadClient","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Q5t5n6TGwI"},{"type":"text","value":" in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Qq4VyORlPK"},{"type":"inlineCode","value":"sentinelhub-py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QeAkkb5FXp"},{"type":"text","value":". In this example we will create least cloudy monthly images for the year 2019.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lEw7UzCwhc"}],"key":"eJvmWoTr2e"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"However, this is already a functionality built on top of this SH API package. We have extended the support for such usage in our package ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kErSAcVKA6"},{"type":"link","url":"https://github.com/sentinel-hub/eo-learn","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"eo-learn","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LakkPCsz3D"}],"urlSource":"https://github.com/sentinel-hub/eo-learn","error":true,"key":"U0EiPfMuTY"},{"type":"text","value":". We recommend to use ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YtxvFA7Fku"},{"type":"inlineCode","value":"eo-learn","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QUuoa28LPU"},{"type":"text","value":" for more complex cases where you need multiple timestamps or high-resolution data for larger areas.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ot3BXTAaoe"}],"key":"VaYGFroDBP"}],"visibility":"show","key":"IgwH3fE6Mp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:59.708856Z","iopub.status.busy":"2023-10-24T07:58:59.708397Z","iopub.status.idle":"2023-10-24T07:58:59.715809Z","shell.execute_reply":"2023-10-24T07:58:59.715341Z"},"papermill":{"duration":0.287743,"end_time":"2023-10-24T07:58:59.717033","exception":false,"start_time":"2023-10-24T07:58:59.429290","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"start = datetime.datetime(2019,1,1)\nend = datetime.datetime(2019,12,31)\nn_chunks = 13\ntdelta = (end - start) / n_chunks\nedges = [(start + i*tdelta).date().isoformat() for i in range(n_chunks)]\nslots = [(edges[i], edges[i+1]) for i in range(len(edges)-1)]\n\nprint('Monthly time windows:\\n')\nfor slot in slots:\n    print(slot)","visibility":"show","key":"obSlMMfCty"},{"type":"output","id":"F-mcP3SymIPKxgoNNFGVm","data":[{"name":"stdout","output_type":"stream","text":"Monthly time windows:\n\n('2019-01-01', '2019-01-29')\n('2019-01-29', '2019-02-26')\n('2019-02-26', '2019-03-26')\n('2019-03-26', '2019-04-23')\n('2019-04-23', '2019-05-21')\n('2019-05-21', '2019-06-18')\n('2019-06-18', '2019-07-16')\n('2019-07-16', '2019-08-13')\n('2019-08-13', '2019-09-10')\n('2019-09-10', '2019-10-08')\n('2019-10-08', '2019-11-05')\n('2019-11-05', '2019-12-03')\n"}],"visibility":"show","key":"rfidYp3jXO"}],"visibility":"show","key":"ZWqkyzMClE"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:59:00.342060Z","iopub.status.busy":"2023-10-24T07:59:00.341644Z","iopub.status.idle":"2023-10-24T07:59:00.344948Z","shell.execute_reply":"2023-10-24T07:59:00.344528Z"},"papermill":{"duration":0.285921,"end_time":"2023-10-24T07:59:00.345880","exception":false,"start_time":"2023-10-24T07:59:00.059959","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def get_true_color_request(time_interval):\n    return SentinelHubRequest(\n        evalscript=evalscript_true_color,\n        input_data=[\n            SentinelHubRequest.input_data(\n                data_collection=DataCollection.SENTINEL2_L1C,\n                time_interval=time_interval,\n                mosaicking_order='leastCC'\n            )\n        ],\n        responses=[\n            SentinelHubRequest.output_response('default', MimeType.PNG)\n        ],\n        bbox=betsiboka_bbox,\n        size=betsiboka_size,\n        config=config\n    )","visibility":"show","key":"mjI0CcxZLg"},{"type":"output","id":"niy0-fDrAZ6KbDs7zkT4b","data":[],"visibility":"show","key":"YNb7anZvEY"}],"visibility":"show","key":"E6mNJD9l2g"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:59:00.987296Z","iopub.status.busy":"2023-10-24T07:59:00.986928Z","iopub.status.idle":"2023-10-24T07:59:06.109827Z","shell.execute_reply":"2023-10-24T07:59:06.109199Z"},"papermill":{"duration":5.406415,"end_time":"2023-10-24T07:59:06.111345","exception":false,"start_time":"2023-10-24T07:59:00.704930","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# create a list of requests\nlist_of_requests = [get_true_color_request(slot) for slot in slots]\nlist_of_requests = [request.download_list[0] for request in list_of_requests]\n\n# download data with multiple threads\ndata = SentinelHubDownloadClient(config=config).download(list_of_requests, max_threads=5)","visibility":"show","key":"zaIPzt6WA5"},{"type":"output","id":"pS-g4RxRAEkc3mnwEg9a8","data":[],"visibility":"show","key":"qoNZtATXjG"}],"visibility":"show","key":"K6CTKNlI6H"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:59:06.699774Z","iopub.status.busy":"2023-10-24T07:59:06.699285Z","iopub.status.idle":"2023-10-24T07:59:08.942736Z","shell.execute_reply":"2023-10-24T07:59:08.942242Z"},"papermill":{"duration":2.546323,"end_time":"2023-10-24T07:59:08.955558","exception":false,"start_time":"2023-10-24T07:59:06.409235","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# some stuff for pretty plots\nncols = 4\nnrows = 3\naspect_ratio = betsiboka_size[0] / betsiboka_size[1]\nsubplot_kw = {'xticks': [], 'yticks': [], 'frame_on': False}\n\nfig, axs = plt.subplots(ncols=ncols, nrows=nrows, figsize=(5 * ncols * aspect_ratio, 5 * nrows),\n                        subplot_kw=subplot_kw)\n\nfor idx, image in enumerate(data):\n    ax = axs[idx // ncols][idx % ncols]\n    ax.imshow(np.clip(image * 2.5/255, 0, 1))\n    ax.set_title(f'{slots[idx][0]}  -  {slots[idx][1]}', fontsize=10)\n\nplt.tight_layout()","visibility":"show","key":"Zcz10K9TJz"},{"type":"output","id":"4pniSafkk-dFmi3YDVEbN","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b10c454ccb423435bdc768f4b5d29050","path":"/notebooks_test/build/b10c454ccb423435bdc768f4b5d29050.png"},"text/plain":{"content":"<Figure size 1205.35x1500 with 12 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"sEI8zXb8eg"}],"visibility":"show","key":"TD25d8u1qY"}],"key":"QUb2HrCk1B"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"How to access DEM data through Sentinel Hub API","url":"/external-notebooks/eurodatacube/notebooks/notebooks/curated/how-to-access-dem-data-through-sentinel-hub-api","group":"Curated"},"next":{"title":"📘 Example Notebook 1","url":"/notebooks/example1","group":"Notebooks"}}},"domain":"http://localhost:3000"}