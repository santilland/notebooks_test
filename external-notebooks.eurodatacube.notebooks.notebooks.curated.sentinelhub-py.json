{"version":1,"kind":"Notebook","sha256":"eb9fff9204f9df4db6ad9ee170d59d0ae388a217354e36cddea9cef50158069d","slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.sentinelhub-py","location":"/external_notebooks/eurodatacube/notebooks/notebooks/curated/sentinelhub-py.ipynb","dependencies":[],"frontmatter":{"title":"Using Sentinel Hub Process API in EDC: a starter’s guide.","content_includes_title":true,"kernelspec":{"name":"conda-env-users-edc-2023.10-01-py","display_name":"EDC 0.24.5 (Python3)","language":"python"},"github":"https://github.com/eoxhub-workspaces/documentation/","numbering":{"title":{"offset":5}},"edit_url":"https://github.com/eoxhub-workspaces/documentation//blob/main/external_notebooks/eurodatacube/notebooks/notebooks/curated/sentinelhub-py.ipynb","thumbnail":"/notebooks_test/build/01e22903839391bc356ac886ec2b2fa7.png","exports":[{"format":"ipynb","filename":"sentinelhub-py.ipynb","url":"/notebooks_test/build/sentinelhub-py-bd416fb93d1033d25dc131443f96539f.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:15.182649Z","iopub.status.busy":"2023-10-24T07:58:15.182255Z","iopub.status.idle":"2023-10-24T07:58:15.238796Z","shell.execute_reply":"2023-10-24T07:58:15.238388Z"},"papermill":{"duration":0.089734,"end_time":"2023-10-24T07:58:15.239791","exception":false,"start_time":"2023-10-24T07:58:15.150057","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from edc import check_compatibility\ncheck_compatibility(\"user-2023.10-01\", dependencies=[\"SH\"])","visibility":"show","key":"bKCbviqzEC"},{"type":"output","id":"lCdPYf1rRk8P60CguyIU4","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<script type=\"text/javascript\">\n        function toggle(id) {\n            el = document.getElementById(id);\n            el.style.display = el.style.display === \"none\" ? \"block\" : \"none\";\n        }\n    </script>","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"This notebook is compatible with this base image version (user-2023.10-01).","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/markdown":{"content":"\n\n---------\n\nThe following environment variables are available:\n\n* `SH_CLIENT_ID`, `SH_INSTANCE_ID`, `SH_CLIENT_NAME`, `SH_CLIENT_SECRET`\n","content_type":"text/markdown"},"text/plain":{"content":"<IPython.core.display.Markdown object>","content_type":"text/plain"}}}],"visibility":"show","key":"ct4hA2Lw7Z"}],"visibility":"show","key":"eCMXxOhmwf"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.027883,"end_time":"2023-10-24T07:58:15.317124","exception":false,"start_time":"2023-10-24T07:58:15.289241","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Using Sentinel Hub Process API in EDC: a starter’s guide.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fcLzLWDadt"}],"identifier":"using-sentinel-hub-process-api-in-edc-a-starters-guide","label":"Using Sentinel Hub Process API in EDC: a starter’s guide.","html_id":"using-sentinel-hub-process-api-in-edc-a-starters-guide","implicit":true,"key":"dYdUkLZFWA"},{"type":"thematicBreak","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"yK9RDvvmmC"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Source: ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"v5n1PMYa3I"},{"type":"link","url":"https://sentinelhub-py.readthedocs.io/en/latest/index.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Sentinel Hub Python package documentation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nplcPwIngM"}],"urlSource":"https://sentinelhub-py.readthedocs.io/en/latest/index.html","key":"vUU7fKkwKi"}],"key":"fQoAEJ5IMt"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Getting started with ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XeLgH7tLt0"},{"type":"inlineCode","value":"sentinelhub-py","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MBNUg864tq"}],"identifier":"getting-started-with-sentinelhub-py","label":"Getting started with sentinelhub-py","html_id":"getting-started-with-sentinelhub-py","implicit":true,"key":"OrbsVlPbU8"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"In this demonstration Jupyter Notebook, we will be requesting and exporting analysis-ready Earth Observation data with the Sentinel Hub ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"qH1lwj3u85"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/api/process/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Process API","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"TLHtIOWnW9"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/api/process/","key":"sKOvORECvG"},{"type":"text","value":" using the dedicated ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Jy5spSjwF6"},{"type":"link","url":"https://sentinelhub-py.readthedocs.io/en/latest/index.html","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"sentinelhub-py package","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"DPxAFyn0jq"}],"urlSource":"https://sentinelhub-py.readthedocs.io/en/latest/index.html","key":"gPOk4n4VQf"},{"type":"text","value":" in the EDC EOxHub Workplace. In this notebook we will learn how to:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"hcH1ADvt8N"}],"key":"wDahMbSYbp"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"link","url":"#Example-1:-Request-a-true-color-(PNG)-image-on-a-specific-date","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Request a true color (PNG) image on a specific date","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"JwCvcJSlPM"}],"urlSource":"#Example-1:-Request-a-true-color-(PNG)-image-on-a-specific-date","key":"ll8yuivzOF"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"link","url":"#Example-1.1-Adding-cloud-mask-data","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Add cloud mask data to the request","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"LYNoaceNsB"}],"urlSource":"#Example-1.1-Adding-cloud-mask-data","key":"rAd9Qxmig9"}],"key":"pnmkTf94bm"}],"key":"jPOKA1ZsPV"}],"key":"bCIPJfSzb5"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"link","url":"#Example-2:-Request-a-true-color-mosaic-of-least-cloudy-acquisitions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Request a true color mosaic of least cloudy acquisitions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"tIkMxwu6hr"}],"urlSource":"#Example-2:-Request-a-true-color-mosaic-of-least-cloudy-acquisitions","key":"xNBfagcWvl"}],"key":"WlMrpRMf1U"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"link","url":"#Example-3:-Request-all-Sentinel-2's-raw-band-values","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Request all Sentinel-2’s raw band values","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"bF3x1hp4sO"}],"urlSource":"#Example-3:-Request-all-Sentinel-2's-raw-band-values","key":"e3sSIfTgBO"}],"key":"AmOGcnUJUj"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"link","url":"#Example-4:-Save-downloaded-data-to-disk-and-read-it-from-disk","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Save downloaded data to disk and read it from disk","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"YQZwmUF2lx"}],"urlSource":"#Example-4:-Save-downloaded-data-to-disk-and-read-it-from-disk","key":"Yisu7VWiRu"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"link","url":"#Example-4.1:-Save-downloaded-data-directly-to-disk","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Save downloaded data directly to disk","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"RhHtUsXEFV"}],"urlSource":"#Example-4.1:-Save-downloaded-data-directly-to-disk","key":"kB0ofYoqbj"}],"key":"BRTBpi0Jo2"}],"key":"aAErN1Sgpr"}],"key":"TjTAMOaM5F"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"link","url":"#Example-5:-Request-other-data-collections-supported-by-sh-py","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Request other data collections supported by sentinelhub-py","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"fptdtOHdqG"}],"urlSource":"#Example-5:-Request-other-data-collections-supported-by-sh-py","key":"AKyNQcRFfk"}],"key":"PQSEVr08gx"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"link","url":"#Example-6:-Multi-response-request","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Perform a multi-response request","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"GwpbloHTe8"}],"urlSource":"#Example-6:-Multi-response-request","key":"ql8WgXtLOy"}],"key":"qwA91zMJte"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"link","url":"#Example-7:-Request-with-a-raw-dictionary","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Request with a raw dictionary","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"MHtxFbxhQD"}],"urlSource":"#Example-7:-Request-with-a-raw-dictionary","key":"sZfnFDLj5r"}],"key":"fqWyOdLI9I"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"link","url":"#Example-8:-Request-multiple-timestamps-data","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Request multiple timestamps data","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"a1AyrCGUlL"}],"urlSource":"#Example-8:-Request-multiple-timestamps-data","key":"hvDgOHLSRd"}],"key":"oQQooxpkph"}],"key":"U1sDh6fW2T"}],"visibility":"show","key":"xb73cc8bPs"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.030899,"end_time":"2023-10-24T07:58:15.401641","exception":false,"start_time":"2023-10-24T07:58:15.370742","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zPDnoRdqk3"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"uyFhS8Z9NL"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Before acccessing the data, we will start by importing the necessary Python libraries (already configured in your EDC workspace), generate credentials automatically to access the services and define the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"F2nFkNVMaE"},{"type":"inlineCode","value":"plot_image","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YgZZXYgESk"},{"type":"text","value":" function that can be found in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vKS7eiVogz"},{"type":"inlineCode","value":"utils.py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BSa1oyLMa7"},{"type":"text","value":" ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZjEVcD4twu"},{"type":"link","url":"https://github.com/sentinel-hub/sentinelhub-py/blob/master/examples/utils.py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"file","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"amVP53vqZP"}],"urlSource":"https://github.com/sentinel-hub/sentinelhub-py/blob/master/examples/utils.py","data":{"kind":"file","org":"sentinel-hub","repo":"sentinelhub-py","reference":"master","file":"examples/utils.py","raw":"https://raw.githubusercontent.com/sentinel-hub/sentinelhub-py/master/examples/utils.py"},"internal":false,"protocol":"github","key":"MQyc3iJrmT"},{"type":"text","value":" located in Sentinel Hub’s ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bZsY72YmEA"},{"type":"link","url":"https://github.com/sentinel-hub/sentinelhub-py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"GitHub repository","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nhC0sgRRJi"}],"urlSource":"https://github.com/sentinel-hub/sentinelhub-py","error":true,"key":"JV7ZPwel3r"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aC2pOdSWsm"}],"key":"JcjbihHMcA"}],"visibility":"show","key":"ZDvbOuKoK2"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.027386,"end_time":"2023-10-24T07:58:15.469611","exception":false,"start_time":"2023-10-24T07:58:15.442225","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RE7TQPfbO2"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"FndZDFnUhq"}],"visibility":"show","key":"qJABRZa96n"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:15.542283Z","iopub.status.busy":"2023-10-24T07:58:15.541994Z","iopub.status.idle":"2023-10-24T07:58:16.275602Z","shell.execute_reply":"2023-10-24T07:58:16.275129Z"},"papermill":{"duration":0.763462,"end_time":"2023-10-24T07:58:16.277010","exception":false,"start_time":"2023-10-24T07:58:15.513548","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# EDC libraries\nfrom edc import setup_environment_variables\n\n# Utilities\nimport os\nimport datetime\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom IPython.display import display, Image\n\n# Sentinel Hub\nfrom sentinelhub import (MimeType, CRS, BBox, SentinelHubRequest, SentinelHubDownloadClient, \n                         DataCollection, bbox_to_dimensions, DownloadRequest, SHConfig)","visibility":"show","key":"kgEfeFNvrO"},{"type":"output","id":"bfVAajTqTLJN03F9sTJ-l","data":[],"visibility":"show","key":"CHK2Yc0mBN"}],"visibility":"show","key":"oLHsbl0tzU"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.025247,"end_time":"2023-10-24T07:58:16.346012","exception":false,"start_time":"2023-10-24T07:58:16.320765","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Credentials","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xT7St3P1kp"}],"identifier":"credentials","label":"Credentials","html_id":"credentials","implicit":true,"key":"iPB2MjcH3a"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Credentials for Sentinel Hub services are automatically injected as environement variables. It is therefore easy to populate Sentinel Hub’s credential manager with the values.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QmY0Ux23sH"}],"key":"kqD8z8WLsj"}],"visibility":"show","key":"ayiQk6APe5"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:16.421849Z","iopub.status.busy":"2023-10-24T07:58:16.421356Z","iopub.status.idle":"2023-10-24T07:58:16.424783Z","shell.execute_reply":"2023-10-24T07:58:16.424346Z"},"papermill":{"duration":0.039716,"end_time":"2023-10-24T07:58:16.425680","exception":false,"start_time":"2023-10-24T07:58:16.385964","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Pass Sentinel Hub credentials to SHConfig\nconfig = SHConfig()\nconfig.sh_client_id = os.environ[\"SH_CLIENT_ID\"]\nconfig.sh_client_secret = os.environ[\"SH_CLIENT_SECRET\"]","visibility":"show","key":"s9p2WxPdcR"},{"type":"output","id":"S6Kivc72QRlGjmBNRoMV4","data":[],"visibility":"show","key":"HTWBqnOuDA"}],"visibility":"show","key":"dIzwJFyjnY"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.029287,"end_time":"2023-10-24T07:58:16.496363","exception":false,"start_time":"2023-10-24T07:58:16.467076","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Utility function for plotting images","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KuMdcgiDDv"}],"identifier":"utility-function-for-plotting-images","label":"Utility function for plotting images","html_id":"utility-function-for-plotting-images","implicit":true,"key":"OSEip01ERy"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In the following cell, we define the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HEXXLXikQ2"},{"type":"inlineCode","value":"plot_image","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bMJRcTpNTM"},{"type":"text","value":" function which will be used to display the requested images for all examples demonstrated in this notebook.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vC6wsg4URH"}],"key":"xFcSXDKYnS"}],"visibility":"show","key":"xkdJFurtdH"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:16.571117Z","iopub.status.busy":"2023-10-24T07:58:16.570757Z","iopub.status.idle":"2023-10-24T07:58:16.574542Z","shell.execute_reply":"2023-10-24T07:58:16.574116Z"},"papermill":{"duration":0.034914,"end_time":"2023-10-24T07:58:16.575435","exception":false,"start_time":"2023-10-24T07:58:16.540521","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define the plot_image function\ndef plot_image(image, factor=1.0, clip_range = None, **kwargs):\n    \"\"\"\n    Utility function for plotting RGB images.\n    \"\"\"\n    fig, ax = plt.subplots(nrows=1, ncols=1, figsize=(15, 15))\n    if clip_range is not None:\n        ax.imshow(np.clip(image * factor, *clip_range), **kwargs)\n    else:\n        ax.imshow(image * factor, **kwargs)\n    ax.set_xticks([])\n    ax.set_yticks([])","visibility":"show","key":"PR2W62okt4"},{"type":"output","id":"2SgIlTfLE3dRVHvD-u29x","data":[],"visibility":"show","key":"T5I5tff4kN"}],"visibility":"show","key":"KhyCJadpGI"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:16.643794Z","iopub.status.busy":"2023-10-24T07:58:16.643496Z","iopub.status.idle":"2023-10-24T07:58:16.649760Z","shell.execute_reply":"2023-10-24T07:58:16.649377Z"},"papermill":{"duration":0.037264,"end_time":"2023-10-24T07:58:16.650832","exception":false,"start_time":"2023-10-24T07:58:16.613568","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Configure plots for inline use in Jupyter Notebook\n%matplotlib inline","visibility":"show","key":"A0g2UHYvKx"},{"type":"output","id":"kwQ5QpPiorByHBPJW9GwL","data":[],"visibility":"show","key":"Aur1TeYcec"}],"visibility":"show","key":"ENG0l4t081"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.028023,"end_time":"2023-10-24T07:58:16.724769","exception":false,"start_time":"2023-10-24T07:58:16.696746","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Setting area of interest (AOI)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z2TWZjagRE"}],"identifier":"setting-area-of-interest-aoi","label":"Setting area of interest (AOI)","html_id":"setting-area-of-interest-aoi","implicit":true,"key":"DQPg5xPn9p"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We will download Sentinel-2 imagery of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BeSP9it345"},{"type":"link","url":"https://en.wikipedia.org/wiki/Betsiboka_River","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Betsiboka Estuary","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gK9TJ11qpX"}],"urlSource":"https://en.wikipedia.org/wiki/Betsiboka_River","data":{"page":"Betsiboka_River","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"Bw5RNT6iSb"},{"type":"text","value":" such as the one shown below (taken by Sentinel-2 on 2017-12-15):","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Iw5zzu1qNF"}],"key":"Vd0YpcFHb9"}],"visibility":"show","key":"XxyvLZTqzb"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.025774,"end_time":"2023-10-24T07:58:16.790076","exception":false,"start_time":"2023-10-24T07:58:16.764302","status":"completed"},"tags":[]},"children":[{"type":"image","url":"/notebooks_test/build/01e22903839391bc356ac886ec2b2fa7.png","alt":"Betsiboka Estuary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eeKpojk2qa","urlSource":"https://sentinelhub-py.readthedocs.io/en/latest/_images/wms_TRUE_COLOR_EPSG4326_-16.15_46.16_-15.58_46.51_2017-12-15T07-12-03_512X856.png"}],"visibility":"show","key":"u0zW0BQB64"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.026899,"end_time":"2023-10-24T07:58:16.855920","exception":false,"start_time":"2023-10-24T07:58:16.829021","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The bounding box in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HIIbB7AsxR"},{"type":"inlineCode","value":"WGS84","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UHQ4Uiw5jN"},{"type":"text","value":" coordinate system is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VZiynnwdCh"},{"type":"inlineCode","value":"[46.16, -16.15, 46.51, -15.58]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wo5oKweHy1"},{"type":"text","value":" (longitude and latitude coordinates of lower left and upper right corners). You can get the bbox for a different area at the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pebDfLomrI"},{"type":"link","url":"http://bboxfinder.com/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"bboxfinder","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZdElBRXlXX"}],"urlSource":"http://bboxfinder.com/","key":"CpU16fTED6"},{"type":"text","value":" website.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IW4AdKV3zx"}],"key":"yzuqIcG2D8"}],"visibility":"show","key":"uzwWrmUUu0"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.028415,"end_time":"2023-10-24T07:58:16.924242","exception":false,"start_time":"2023-10-24T07:58:16.895827","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"All requests require bounding box to be given as an instance of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aS8RpAE6OI"},{"type":"inlineCode","value":"sentinelhub.geometry.BBox","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RuEvwjuN3x"},{"type":"text","value":" with corresponding Coordinate Reference System (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NYOKw45O2W"},{"type":"inlineCode","value":"sentinelhub.constants.CRS","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ICJlqF7oyY"},{"type":"text","value":"). In our case it is in WGS84 and we can use the predefined WGS84 coordinate reference system from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UnW2cySjSI"},{"type":"inlineCode","value":"sentinelhub.constants.CRS","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PejdHIKpMM"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XrqTwMkmx1"}],"key":"bbunMp5glN"}],"visibility":"show","key":"rtFWqsnbdL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:16.989795Z","iopub.status.busy":"2023-10-24T07:58:16.989578Z","iopub.status.idle":"2023-10-24T07:58:16.992778Z","shell.execute_reply":"2023-10-24T07:58:16.992260Z"},"papermill":{"duration":0.031069,"end_time":"2023-10-24T07:58:16.993795","exception":false,"start_time":"2023-10-24T07:58:16.962726","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"betsiboka_coords_wgs84 = [46.16, -16.15, 46.51, -15.58]","visibility":"show","key":"VwXx8PprwE"},{"type":"output","id":"CRzjLpcSK8ZBZhnMoX6xQ","data":[],"visibility":"show","key":"yg2OGkAwBz"}],"visibility":"show","key":"pvO5xXJDZM"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.026196,"end_time":"2023-10-24T07:58:17.060663","exception":false,"start_time":"2023-10-24T07:58:17.034467","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"When the bounding box bounds have been defined, you can initialize the BBox of the area of interest. Using the bbox_to_dimensions utility function, you can provide the desired resolution parameter of the image in meters and obtain the output image shape.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cmVCLKpnM7"}],"key":"SB1m6JBGLI"}],"visibility":"show","key":"cRFtV6sszU"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:17.129544Z","iopub.status.busy":"2023-10-24T07:58:17.129203Z","iopub.status.idle":"2023-10-24T07:58:17.146453Z","shell.execute_reply":"2023-10-24T07:58:17.145979Z"},"papermill":{"duration":0.04571,"end_time":"2023-10-24T07:58:17.147527","exception":false,"start_time":"2023-10-24T07:58:17.101817","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"resolution = 60\nbetsiboka_bbox = BBox(bbox=betsiboka_coords_wgs84, crs=CRS.WGS84)\nbetsiboka_size = bbox_to_dimensions(betsiboka_bbox, resolution=resolution)\n\nprint(f'Image shape at {resolution} m resolution: {betsiboka_size} pixels')","visibility":"show","key":"xWuuQayvqd"},{"type":"output","id":"EWU6axRCUnl6p_WUaWL0_","data":[{"name":"stdout","output_type":"stream","text":"Image shape at 60 m resolution: (631, 1047) pixels\n"}],"visibility":"show","key":"hU5rqh1izG"}],"visibility":"show","key":"P8UFblxaGw"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.026438,"end_time":"2023-10-24T07:58:17.212596","exception":false,"start_time":"2023-10-24T07:58:17.186158","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 1: Request a true color (PNG) image on a specific date","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G6DvN3IXr5"}],"identifier":"example-1-request-a-true-color-png-image-on-a-specific-date","label":"Example 1: Request a true color (PNG) image on a specific date","html_id":"example-1-request-a-true-color-png-image-on-a-specific-date","implicit":true,"key":"YA9lkXXGKa"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We build the request according to the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Q0bOPe0DwV"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/reference/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"API Reference","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sDWV22DoFc"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/reference/","key":"Swr8tgiHgr"},{"type":"text","value":", using the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NLi8XHymEG"},{"type":"inlineCode","value":"SentinelHubRequest","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Zp0YKqBPzd"},{"type":"text","value":" class. Each Process API request also needs an ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Nka9nY8CmV"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/Evalscript/V3/README","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"evalscript","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LNdibA5BiV"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/Evalscript/V3/README","key":"VURDHsVUCj"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"y5SXk2emco"}],"key":"dKtPtBsFOV"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The information that we specify in the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dxPykvqgRH"},{"type":"inlineCode","value":"SentinelHubRequest","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XjKKKVrdge"},{"type":"text","value":" object is:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"f0KUsVk7kk"}],"key":"nHeIrWIL7L"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"an evalscript,","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"eMZtzpVV7Y"}],"key":"XLXDiayk1R"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"a list of input data collections with time interval,","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"yQyLkIJXiG"}],"key":"xUWuJ3aFOq"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"a format of the response,","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"jFC6Px5Bqk"}],"key":"RRm4taojaG"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"a bounding box and it’s size (size or resolution).","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"xUE5kjolK0"}],"key":"lFEx7f8bQv"}],"key":"T4oZObt6SN"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The evalscript in the example is used to select the appropriate bands. We return the RGB (B04, B03, B02) Sentinel-2 L1C bands.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"MZrVw2Jaxm"}],"key":"QnJUxwDqlx"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"The image from Jun 12th 2020 is downloaded. Without any additional parameters in the evalscript, the downloaded data will correspond to reflectance values in ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"hzMTO2HlQ0"},{"type":"inlineCode","value":"UINT8","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"SzwWvTZ0Pb"},{"type":"text","value":" format (values in 0-255 range).","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"z5HR2MBuGU"}],"key":"zPidYaJmes"}],"visibility":"show","key":"LFGreWfrch"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:17.281579Z","iopub.status.busy":"2023-10-24T07:58:17.281352Z","iopub.status.idle":"2023-10-24T07:58:17.286230Z","shell.execute_reply":"2023-10-24T07:58:17.285747Z"},"papermill":{"duration":0.035807,"end_time":"2023-10-24T07:58:17.287179","exception":false,"start_time":"2023-10-24T07:58:17.251372","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_true_color = \"\"\"\n    //VERSION=3\n\n    function setup() {\n        return {\n            input: [{\n                bands: [\"B02\", \"B03\", \"B04\"]\n            }],\n            output: {\n                bands: 3\n            }\n        };\n    }\n\n    function evaluatePixel(sample) {\n        return [sample.B04, sample.B03, sample.B02];\n    }\n\"\"\"\n\nrequest_true_color = SentinelHubRequest(\n    evalscript=evalscript_true_color,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L1C,\n            time_interval=('2020-06-12', '2020-06-13'),\n        )\n    ],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.PNG)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"ErZ9LYVZ7N"},{"type":"output","id":"0BSnPYClFqyRaROOEx3Q0","data":[],"visibility":"show","key":"GnzJcdoaQj"}],"visibility":"show","key":"R0CeL1cfDg"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:17.353393Z","iopub.status.busy":"2023-10-24T07:58:17.353043Z","iopub.status.idle":"2023-10-24T07:58:18.418103Z","shell.execute_reply":"2023-10-24T07:58:18.417366Z"},"papermill":{"duration":1.095641,"end_time":"2023-10-24T07:58:18.421078","exception":false,"start_time":"2023-10-24T07:58:17.325437","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"true_color_imgs = request_true_color.get_data()","visibility":"show","key":"i85AZOk3Q9"},{"type":"output","id":"Dt1l443JuXrOaC98zNUJH","data":[],"visibility":"show","key":"uOLsLPw2IJ"}],"visibility":"show","key":"PjGM25mNht"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.044092,"end_time":"2023-10-24T07:58:18.521263","exception":false,"start_time":"2023-10-24T07:58:18.477171","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The method ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PNJtdPciN4"},{"type":"inlineCode","value":"get_data()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OZGkpguA8u"},{"type":"text","value":" will always return a list of length 1 with the available image from the requested time interval in the form of numpy arrays.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NTvv5bvSfO"}],"key":"KON3MkQuHn"}],"visibility":"show","key":"zskM8tOYNc"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:18.592589Z","iopub.status.busy":"2023-10-24T07:58:18.592107Z","iopub.status.idle":"2023-10-24T07:58:18.595889Z","shell.execute_reply":"2023-10-24T07:58:18.595326Z"},"papermill":{"duration":0.032682,"end_time":"2023-10-24T07:58:18.597447","exception":false,"start_time":"2023-10-24T07:58:18.564765","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f'Returned data is of type = {type(true_color_imgs)} and length {len(true_color_imgs)}.')\nprint(f'Single element in the list is of type {type(true_color_imgs[-1])} and has shape {true_color_imgs[-1].shape}')","visibility":"show","key":"ZKuSdSxFiB"},{"type":"output","id":"11nY1yGy--FHGqfYukCPC","data":[{"name":"stdout","output_type":"stream","text":"Returned data is of type = <class 'list'> and length 1.\nSingle element in the list is of type <class 'numpy.ndarray'> and has shape (1047, 631, 3)\n"}],"visibility":"show","key":"u6sYbKfqdJ"}],"visibility":"show","key":"Bi2ji7AlBd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:18.667461Z","iopub.status.busy":"2023-10-24T07:58:18.666882Z","iopub.status.idle":"2023-10-24T07:58:19.387747Z","shell.execute_reply":"2023-10-24T07:58:19.387197Z"},"papermill":{"duration":0.758762,"end_time":"2023-10-24T07:58:19.397971","exception":false,"start_time":"2023-10-24T07:58:18.639209","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"image = true_color_imgs[0]\nprint(f'Image type: {image.dtype}')\n\n# plot function\n# factor 1/255 to scale between 0-1\n# factor 3.5 to increase brightness\nplot_image(image, factor=3.5/255, clip_range=(0,1))","visibility":"show","key":"UZs6RiylkI"},{"type":"output","id":"fVZR6yarHzeHXZZqEmOjA","data":[{"name":"stdout","output_type":"stream","text":"Image type: uint8\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a6ee3c4a1a25ec6db2dc04a521204869","path":"/notebooks_test/build/a6ee3c4a1a25ec6db2dc04a521204869.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"lrHi1Tncoj"}],"visibility":"show","key":"rXgLOO5pNy"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.08628,"end_time":"2023-10-24T07:58:19.584640","exception":false,"start_time":"2023-10-24T07:58:19.498360","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 1.1 Adding cloud mask data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BQEi4cP2Wz"}],"identifier":"example-1-1-adding-cloud-mask-data","label":"Example 1.1 Adding cloud mask data","html_id":"example-1-1-adding-cloud-mask-data","implicit":true,"key":"ku7V66rhWw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"It is also possible to obtain cloud masks when requesting Sentinel-2 data by using the cloud mask band (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xQG4rVqV7G"},{"type":"inlineCode","value":"CLM","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DicvYIAcNK"},{"type":"text","value":") or the cloud probabilities band (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WaOlDuChVM"},{"type":"inlineCode","value":"CLP","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fHjPlvkHZA"},{"type":"text","value":"). More info ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aDINYBOSPB"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/API/data_access?id=cloud-masks-and-cloud-probabilities","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YSMRG3FNSL"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/API/data_access?id=cloud-masks-and-cloud-probabilities","key":"XnwJqH3FCC"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"To4coICGcl"}],"key":"RlYxaszBL2"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The factor for increasing the image brightness can already be provided in the evalscript.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Im2g8wegCX"}],"key":"GgTPuIel1K"}],"visibility":"show","key":"d1oHqnovdD"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:19.768890Z","iopub.status.busy":"2023-10-24T07:58:19.768613Z","iopub.status.idle":"2023-10-24T07:58:19.772589Z","shell.execute_reply":"2023-10-24T07:58:19.772092Z"},"papermill":{"duration":0.092391,"end_time":"2023-10-24T07:58:19.773751","exception":false,"start_time":"2023-10-24T07:58:19.681360","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_clm = \"\"\"\n//VERSION=3\nfunction setup() {\n  return {\n    input: [\"B02\", \"B03\", \"B04\", \"CLM\"],\n    output: { bands: 3 }\n  }\n}\n\nfunction evaluatePixel(sample) {\n  if (sample.CLM == 1) {\n    return [0.75 + sample.B04, sample.B03, sample.B02]\n  }\n  return [3.5*sample.B04, 3.5*sample.B03, 3.5*sample.B02];\n}\n\"\"\"\n\nrequest_true_color = SentinelHubRequest(\n    evalscript=evalscript_clm,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L1C,\n            time_interval=('2020-06-12', '2020-06-13'),\n        )\n    ],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.PNG)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"yEoQgrPyX8"},{"type":"output","id":"w4q4QkT6wB2_ThVKprQhs","data":[],"visibility":"show","key":"D6WWbMEcxT"}],"visibility":"show","key":"F6Vp7UdEr7"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:19.960475Z","iopub.status.busy":"2023-10-24T07:58:19.960133Z","iopub.status.idle":"2023-10-24T07:58:21.035944Z","shell.execute_reply":"2023-10-24T07:58:21.035485Z"},"papermill":{"duration":1.168935,"end_time":"2023-10-24T07:58:21.037249","exception":false,"start_time":"2023-10-24T07:58:19.868314","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"data_with_cloud_mask = request_true_color.get_data()","visibility":"show","key":"kz6C5Iybhm"},{"type":"output","id":"-HjTaZBLqXT61PizNoZNw","data":[],"visibility":"show","key":"gAMbvmwobw"}],"visibility":"show","key":"lHgVL68RXg"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:21.221532Z","iopub.status.busy":"2023-10-24T07:58:21.221293Z","iopub.status.idle":"2023-10-24T07:58:21.948919Z","shell.execute_reply":"2023-10-24T07:58:21.948437Z"},"papermill":{"duration":0.822987,"end_time":"2023-10-24T07:58:21.956107","exception":false,"start_time":"2023-10-24T07:58:21.133120","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_image(data_with_cloud_mask[0], factor=1/255)","visibility":"show","key":"DuSnOSaRE1"},{"type":"output","id":"mjy8BjwnBTpNifOTmiSxC","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7cc2c750d55706b6c8b6428bb3b47567","path":"/notebooks_test/build/7cc2c750d55706b6c8b6428bb3b47567.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"Vs56kDahNv"}],"visibility":"show","key":"ccVCIVFhTL"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.112788,"end_time":"2023-10-24T07:58:22.189616","exception":false,"start_time":"2023-10-24T07:58:22.076828","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 2: Request a true color mosaic of least cloudy acquisitions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z842cZR6fl"}],"identifier":"example-2-request-a-true-color-mosaic-of-least-cloudy-acquisitions","label":"Example 2: Request a true color mosaic of least cloudy acquisitions","html_id":"example-2-request-a-true-color-mosaic-of-least-cloudy-acquisitions","implicit":true,"key":"ueGjop4ra6"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"s5Kmu8Aa9h"},{"type":"inlineCode","value":"SentinelHubRequest","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fhvYKD6t8N"},{"type":"text","value":" automatically creates a mosaic from all available images in the given time interval. By default, the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HTwSvZz4Gl"},{"type":"inlineCode","value":"mostRecent","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VqUsMpxVkx"},{"type":"text","value":" mosaicking order is used. More information available ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Nu3qlk7047"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/data/Sentinel-2-L2A?id=mosaickingorder","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ufodQynBZO"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/data/Sentinel-2-L2A?id=mosaickingorder","key":"btlPLpPcom"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GGyDIsalXW"}],"key":"g5rVWL54Xz"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In this example we will provide a month long interval, order the images w.r.t. the cloud coverage on the tile level (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YVWfum4I02"},{"type":"inlineCode","value":"leastCC","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yRZHfAxUSv"},{"type":"text","value":" parameter), and mosaic them in the specified order.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uqNCAYbN1T"}],"key":"CKfMW0IO9b"}],"visibility":"show","key":"xyVTLfZpPZ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:22.432871Z","iopub.status.busy":"2023-10-24T07:58:22.432433Z","iopub.status.idle":"2023-10-24T07:58:22.436060Z","shell.execute_reply":"2023-10-24T07:58:22.435588Z"},"papermill":{"duration":0.120449,"end_time":"2023-10-24T07:58:22.437037","exception":false,"start_time":"2023-10-24T07:58:22.316588","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"request_true_color = SentinelHubRequest(\n    evalscript=evalscript_true_color,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L1C,\n            time_interval=('2020-06-01', '2020-06-30'),\n            mosaicking_order='leastCC'\n        )\n    ],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.PNG)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"eXlROI27fI"},{"type":"output","id":"qaMiIAnfdqHTr--DfHb0q","data":[],"visibility":"show","key":"ZeFAk7127k"}],"visibility":"show","key":"M2qRw4dwUE"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:22.699732Z","iopub.status.busy":"2023-10-24T07:58:22.699318Z","iopub.status.idle":"2023-10-24T07:58:24.250156Z","shell.execute_reply":"2023-10-24T07:58:24.249669Z"},"papermill":{"duration":1.691195,"end_time":"2023-10-24T07:58:24.257346","exception":false,"start_time":"2023-10-24T07:58:22.566151","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_image(request_true_color.get_data()[0], factor=3.5/255, clip_range=(0,1))","visibility":"show","key":"uDvvSmkzRG"},{"type":"output","id":"d_gUKL-R0eRCQJYcifdab","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9c3a0f7e7f03b678f292f3d756e7ebf4","path":"/notebooks_test/build/9c3a0f7e7f03b678f292f3d756e7ebf4.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"JZVGKI5dYt"}],"visibility":"show","key":"C2BEgWZJ7O"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.158495,"end_time":"2023-10-24T07:58:24.592486","exception":false,"start_time":"2023-10-24T07:58:24.433991","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 3: Request all Sentinel-2’s raw band values","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UGKSXgGrN0"}],"identifier":"example-3-request-all-sentinel-2s-raw-band-values","label":"Example 3: Request all Sentinel-2’s raw band values","html_id":"example-3-request-all-sentinel-2s-raw-band-values","implicit":true,"key":"aNpJ89jvr6"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now let’s define an evalscript which will return all Sentinel-2 spectral bands with raw values.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rsWEkuji6k"}],"key":"MSuRe5MAOg"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In this example we are downloading already quite a big chunk of data, so optimization of the request is not out of the question. Downloading raw digital numbers in the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"e0vMW2Hkfb"},{"type":"inlineCode","value":"INT16","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"shij4wtirp"},{"type":"text","value":" format instead of reflectances in the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MS0cVQ8JOt"},{"type":"inlineCode","value":"FLOAT32","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RmoD8oPTHU"},{"type":"text","value":" format means that much less data is downloaded, which results in a faster download and a smaller usage of SH processing units.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kdT6L4mSvc"}],"key":"FDRxsi7brk"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"In order to achieve this, we have to set the input units in the evalscript to ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"C9yeGj0zEh"},{"type":"inlineCode","value":"DN","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vzMz9rs9Z0"},{"type":"text","value":" (digital numbers) and the output ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jExnupZaHG"},{"type":"inlineCode","value":"sampleType","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jh57GefmLK"},{"type":"text","value":" argument to ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"g3MFpdrtJS"},{"type":"inlineCode","value":"INT16","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IpxBxO93BF"},{"type":"text","value":". Additionally, we can’t pack all Sentinel-2’s 13 bands into a ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"gAFoRjft4V"},{"type":"inlineCode","value":"PNG","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"T47l7JHTTH"},{"type":"text","value":" image, so we have to set the output image type to the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"O0kfRmUVRm"},{"type":"inlineCode","value":"TIFF","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"qBfUZUBV7n"},{"type":"text","value":" format via ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Vg0SBLwC7S"},{"type":"inlineCode","value":"MimeType.TIFF","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"MyLh6IBImn"},{"type":"text","value":" in the request.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ig1d15ZlVq"}],"key":"BfzmOgAhFk"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The digital numbers are in the range from 0-10000, so we have to scale the downloaded data appropriately.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"RsvAGdj9SZ"}],"key":"zqLq1gGARS"}],"visibility":"show","key":"GhkNw3p21u"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:24.930585Z","iopub.status.busy":"2023-10-24T07:58:24.930109Z","iopub.status.idle":"2023-10-24T07:58:24.934135Z","shell.execute_reply":"2023-10-24T07:58:24.933703Z"},"papermill":{"duration":0.177238,"end_time":"2023-10-24T07:58:24.935088","exception":false,"start_time":"2023-10-24T07:58:24.757850","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_all_bands = \"\"\"\n    //VERSION=3\n    function setup() {\n        return {\n            input: [{\n                bands: [\"B01\",\"B02\",\"B03\",\"B04\",\"B05\",\"B06\",\"B07\",\"B08\",\"B8A\",\"B09\",\"B10\",\"B11\",\"B12\"],\n                units: \"DN\"\n            }],\n            output: {\n                bands: 13,\n                sampleType: \"INT16\"\n            }\n        };\n    }\n\n    function evaluatePixel(sample) {\n        return [sample.B01,\n                sample.B02,\n                sample.B03,\n                sample.B04,\n                sample.B05,\n                sample.B06,\n                sample.B07,\n                sample.B08,\n                sample.B8A,\n                sample.B09,\n                sample.B10,\n                sample.B11,\n                sample.B12];\n    }\n\"\"\"\n\nrequest_all_bands = SentinelHubRequest(\n    evalscript=evalscript_all_bands,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L1C,\n            time_interval=('2020-06-01', '2020-06-30'),\n            mosaicking_order='leastCC'\n    )],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.TIFF)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"hpz2TH8ZY9"},{"type":"output","id":"25IErBb_TK-wINr1HQL1i","data":[],"visibility":"show","key":"rWvxq69qo0"}],"visibility":"show","key":"aqeeENgjCM"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:25.246449Z","iopub.status.busy":"2023-10-24T07:58:25.246139Z","iopub.status.idle":"2023-10-24T07:58:29.591562Z","shell.execute_reply":"2023-10-24T07:58:29.591058Z"},"papermill":{"duration":4.501737,"end_time":"2023-10-24T07:58:29.593006","exception":false,"start_time":"2023-10-24T07:58:25.091269","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"all_bands_response = request_all_bands.get_data()","visibility":"show","key":"LaD8PslwMp"},{"type":"output","id":"J6h8s64BrS5_Vw1YDMPpY","data":[],"visibility":"show","key":"dit8w9qR0y"}],"visibility":"show","key":"zRNGxGs1iU"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:29.963501Z","iopub.status.busy":"2023-10-24T07:58:29.963043Z","iopub.status.idle":"2023-10-24T07:58:30.427331Z","shell.execute_reply":"2023-10-24T07:58:30.426858Z"},"papermill":{"duration":0.630095,"end_time":"2023-10-24T07:58:30.434315","exception":false,"start_time":"2023-10-24T07:58:29.804220","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Image showing the SWIR band B12\n# Factor 1/1e4 due to the DN band values in the range 0-10000\n# Factor 3.5 to increase the brightness\nplot_image(all_bands_response[0][:, :, 12], factor=3.5/1e4, vmax=1)","visibility":"show","key":"XTcgXD1jyY"},{"type":"output","id":"WQIMRPvj9-C4RjryXddOc","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"69b20c649f17fdf2cf95a7dc0fccbce8","path":"/notebooks_test/build/69b20c649f17fdf2cf95a7dc0fccbce8.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"F3fzfHYHEu"}],"visibility":"show","key":"uNxipXMCi2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:30.862665Z","iopub.status.busy":"2023-10-24T07:58:30.862154Z","iopub.status.idle":"2023-10-24T07:58:31.482062Z","shell.execute_reply":"2023-10-24T07:58:31.481547Z"},"papermill":{"duration":0.839145,"end_time":"2023-10-24T07:58:31.491142","exception":false,"start_time":"2023-10-24T07:58:30.651997","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# From raw bands we can also construct a False-Color image\n# False color image is (B03, B04, B08)\nplot_image(all_bands_response[0][:, :, [2,3,7]], factor=3.5/1e4, clip_range=(0,1))","visibility":"show","key":"yMXTtpfUPX"},{"type":"output","id":"hsbHx-n9JDKwleHXvmmQp","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"331dd2d9e3f90301403aa18125282a6d","path":"/notebooks_test/build/331dd2d9e3f90301403aa18125282a6d.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"AJ8O1OqVei"}],"visibility":"show","key":"QCdgpQ0SsV"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.20739,"end_time":"2023-10-24T07:58:31.947717","exception":false,"start_time":"2023-10-24T07:58:31.740327","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 4: Save downloaded data to disk and read it from disk","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Sqb83nCIWj"}],"identifier":"example-4-save-downloaded-data-to-disk-and-read-it-from-disk","label":"Example 4: Save downloaded data to disk and read it from disk","html_id":"example-4-save-downloaded-data-to-disk-and-read-it-from-disk","implicit":true,"key":"BdwgsZRyY5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"All downloaded data can be saved to disk and later read from it. Simply specify the location on disk where data should be saved (or loaded from) via the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LI5Or7COte"},{"type":"inlineCode","value":"data_folder","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VSdhwqd5cQ"},{"type":"text","value":" argument of the request’s constructor. When executing the request’s ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BQLsYc2DOL"},{"type":"inlineCode","value":"get_data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IAmNpVH1X1"},{"type":"text","value":" method, set the argument ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NqiXE6pKdf"},{"type":"inlineCode","value":"save_data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gLINsLEeSr"},{"type":"text","value":" to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zOiDbCrdi6"},{"type":"inlineCode","value":"True","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WQcGdSJ95Q"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tJcFJhpOPx"}],"key":"DApOPfmpEj"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This also means that in all the future requests for data, the request will first check the provided location if the data is already there, unless you explicitly demand to redownload the data.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"AOTBJt3e6C"}],"key":"M7w8yzI5Pf"}],"visibility":"show","key":"qARpLdRKEl"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:32.386579Z","iopub.status.busy":"2023-10-24T07:58:32.386242Z","iopub.status.idle":"2023-10-24T07:58:32.389771Z","shell.execute_reply":"2023-10-24T07:58:32.389307Z"},"papermill":{"duration":0.211012,"end_time":"2023-10-24T07:58:32.390802","exception":false,"start_time":"2023-10-24T07:58:32.179790","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"request_all_bands = SentinelHubRequest(\n    data_folder='test_dir',\n    evalscript=evalscript_all_bands,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L1C,\n            time_interval=('2020-06-01', '2020-06-30'),\n            mosaicking_order='leastCC'\n    )],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.TIFF)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"ruzvuLiLNi"},{"type":"output","id":"jAMSNl33OYt3_G4gcUN2z","data":[],"visibility":"show","key":"gNOPgtpTxZ"}],"visibility":"show","key":"udXutRyOdb"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:32.881602Z","iopub.status.busy":"2023-10-24T07:58:32.881346Z","iopub.status.idle":"2023-10-24T07:58:36.883113Z","shell.execute_reply":"2023-10-24T07:58:36.882692Z"},"papermill":{"duration":4.26001,"end_time":"2023-10-24T07:58:36.884678","exception":false,"start_time":"2023-10-24T07:58:32.624668","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nall_bands_img = request_all_bands.get_data(save_data=True)","visibility":"show","key":"bUspg8m0BV"},{"type":"output","id":"A0PNSXZq17nUY3yhy4cL7","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 141 ms, sys: 26 ms, total: 167 ms\nWall time: 4 s\n"}],"visibility":"show","key":"XZKNe6caTQ"}],"visibility":"show","key":"HRqCEXI9kX"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:37.363448Z","iopub.status.busy":"2023-10-24T07:58:37.363170Z","iopub.status.idle":"2023-10-24T07:58:37.372692Z","shell.execute_reply":"2023-10-24T07:58:37.372183Z"},"papermill":{"duration":0.226648,"end_time":"2023-10-24T07:58:37.373812","exception":false,"start_time":"2023-10-24T07:58:37.147164","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f'The output directory has been created and a tiff file with all 13 bands was saved into ' \\\n      'the following structure:\\n')\n\nfor folder, _, filenames in os.walk(request_all_bands.data_folder):\n    for filename in filenames:\n        print(os.path.join(folder, filename))","visibility":"show","key":"qHtZ2s7CV3"},{"type":"output","id":"CJq_Bs1HrKFglAuCelR_E","data":[{"name":"stdout","output_type":"stream","text":"The output directory has been created and a tiff file with all 13 bands was saved into the following structure:\n\ntest_dir/4d34ca44cf5505abbf2690c928df83fe/response.tiff\ntest_dir/4d34ca44cf5505abbf2690c928df83fe/request.json\n"}],"visibility":"show","key":"qeqCjk4YDJ"}],"visibility":"show","key":"W28pYUx0A6"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:37.828388Z","iopub.status.busy":"2023-10-24T07:58:37.828122Z","iopub.status.idle":"2023-10-24T07:58:37.986498Z","shell.execute_reply":"2023-10-24T07:58:37.985920Z"},"papermill":{"duration":0.38535,"end_time":"2023-10-24T07:58:37.987513","exception":false,"start_time":"2023-10-24T07:58:37.602163","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# try to re-download the data\nall_bands_img_from_disk = request_all_bands.get_data()","visibility":"show","key":"UsknffX6fF"},{"type":"output","id":"pzy90MLyMPrlQxRpa6c2d","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 110 ms, sys: 15.3 ms, total: 125 ms\nWall time: 155 ms\n"}],"visibility":"show","key":"tsZ6TVX2d3"}],"visibility":"show","key":"syupoCQOIO"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:38.456540Z","iopub.status.busy":"2023-10-24T07:58:38.456117Z","iopub.status.idle":"2023-10-24T07:58:43.895246Z","shell.execute_reply":"2023-10-24T07:58:43.894700Z"},"papermill":{"duration":5.672089,"end_time":"2023-10-24T07:58:43.896353","exception":false,"start_time":"2023-10-24T07:58:38.224264","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# force the redownload\nall_bands_img_redownload = request_all_bands.get_data(redownload=True)","visibility":"show","key":"dX84yyURin"},{"type":"output","id":"giN1ij3J_Df2qPhlS2UKF","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 153 ms, sys: 11.1 ms, total: 164 ms\nWall time: 5.44 s\n"}],"visibility":"show","key":"VatkVXIcDs"}],"visibility":"show","key":"liF5WeSpkM"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.241312,"end_time":"2023-10-24T07:58:44.417988","exception":false,"start_time":"2023-10-24T07:58:44.176676","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 4.1: Save downloaded data directly to disk","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RjBH5huuhk"}],"identifier":"example-4-1-save-downloaded-data-directly-to-disk","label":"Example 4.1: Save downloaded data directly to disk","html_id":"example-4-1-save-downloaded-data-directly-to-disk","implicit":true,"key":"rvWUesgI24"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tCGgAk857q"},{"type":"inlineCode","value":"get_data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kohYBIpOD0"},{"type":"text","value":" method returns a list of numpy arrays and can save the downloaded data to disk, as we have seen in the previous example. Sometimes it is convenient to just save the data directly to disk. You can do that by using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dBmd2fv4P5"},{"type":"inlineCode","value":"save_data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"K4s5jSRwGJ"},{"type":"text","value":" method instead.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vH21nEqYVh"}],"key":"PEeg4qeMDV"}],"visibility":"show","key":"IWaxofD62p"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:44.890483Z","iopub.status.busy":"2023-10-24T07:58:44.890067Z","iopub.status.idle":"2023-10-24T07:58:44.894451Z","shell.execute_reply":"2023-10-24T07:58:44.893926Z"},"papermill":{"duration":0.216491,"end_time":"2023-10-24T07:58:44.895703","exception":false,"start_time":"2023-10-24T07:58:44.679212","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nrequest_all_bands.save_data()","visibility":"show","key":"B33GqaGZ6M"},{"type":"output","id":"_kRB5abwcBYbTtkTe22SE","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 1.39 ms, sys: 0 ns, total: 1.39 ms\nWall time: 1.35 ms\n"}],"visibility":"show","key":"vl3JZjLAcs"}],"visibility":"show","key":"cT2HqeCReC"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:45.386767Z","iopub.status.busy":"2023-10-24T07:58:45.386500Z","iopub.status.idle":"2023-10-24T07:58:45.400043Z","shell.execute_reply":"2023-10-24T07:58:45.399372Z"},"papermill":{"duration":0.251393,"end_time":"2023-10-24T07:58:45.401218","exception":false,"start_time":"2023-10-24T07:58:45.149825","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f'The output directory has been created and a tiff file with all 13 bands was saved into ' \\\n      'the following structure:\\n')\n\nfor folder, _, filenames in os.walk(request_all_bands.data_folder):\n    for filename in filenames:\n        print(os.path.join(folder, filename))","visibility":"show","key":"S7Q3w4LMzO"},{"type":"output","id":"KSXMCu35O__SLQrJtpDz2","data":[{"name":"stdout","output_type":"stream","text":"The output directory has been created and a tiff file with all 13 bands was saved into the following structure:\n\ntest_dir/4d34ca44cf5505abbf2690c928df83fe/response.tiff\ntest_dir/4d34ca44cf5505abbf2690c928df83fe/request.json\n"}],"visibility":"show","key":"tNkaDPzkQj"}],"visibility":"show","key":"wxXoqpUUu1"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.234628,"end_time":"2023-10-24T07:58:45.871433","exception":false,"start_time":"2023-10-24T07:58:45.636805","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 5: Request other data collections supported by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xXdDmCBwCb"},{"type":"inlineCode","value":"sh-py","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"he7a7mLO9N"}],"identifier":"example-5-request-other-data-collections-supported-by-sh-py","label":"Example 5: Request other data collections supported by sh-py","html_id":"example-5-request-other-data-collections-supported-by-sh-py","implicit":true,"key":"bKWKXAJSbg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mp1FqPNDo3"},{"type":"inlineCode","value":"sentinelhub-py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lm3BBoXcP8"},{"type":"text","value":" package supports various data collections. The example below is shown for one of them, but the process is the same for all of them.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"g6eyFcekaN"}],"key":"o3cbWdXN3Q"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Note: For more examples and information check the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LjXr1aoIjY"},{"type":"link","url":"https://sentinelhub-py.readthedocs.io/en/latest/examples/data_collections.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"tutorial about data collections","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VyWiYmBaoM"}],"urlSource":"https://sentinelhub-py.readthedocs.io/en/latest/examples/data_collections.html","key":"SbDtjzP6rx"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gcBrkXVPYZ"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/data/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Sentinel Hub documentation about data collections","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"a2Pq313odV"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/data/","key":"hMfHyGmuoq"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TuZWwSCLjF"}],"key":"fvfOwXPoZt"}],"key":"Y8451FcEkx"}],"visibility":"show","key":"YZWD8JRyDI"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:46.356779Z","iopub.status.busy":"2023-10-24T07:58:46.356191Z","iopub.status.idle":"2023-10-24T07:58:46.360157Z","shell.execute_reply":"2023-10-24T07:58:46.359619Z"},"papermill":{"duration":0.235303,"end_time":"2023-10-24T07:58:46.361427","exception":false,"start_time":"2023-10-24T07:58:46.126124","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"print('Supported DataCollections:\\n')\nfor collection in DataCollection.get_available_collections():\n    print(collection)","visibility":"show","key":"AzV3rquMYN"},{"type":"output","id":"oivUpuTU-q7_mxjYjknL9","data":[{"name":"stdout","output_type":"stream","text":"Supported DataCollections:\n\nDataCollection.SENTINEL2_L1C\nDataCollection.SENTINEL2_L2A\nDataCollection.SENTINEL1\nDataCollection.SENTINEL1_IW\nDataCollection.SENTINEL1_IW_ASC\nDataCollection.SENTINEL1_IW_DES\nDataCollection.SENTINEL1_EW\nDataCollection.SENTINEL1_EW_ASC\nDataCollection.SENTINEL1_EW_DES\nDataCollection.SENTINEL1_EW_SH\nDataCollection.SENTINEL1_EW_SH_ASC\nDataCollection.SENTINEL1_EW_SH_DES\nDataCollection.DEM\nDataCollection.DEM_MAPZEN\nDataCollection.DEM_COPERNICUS_30\nDataCollection.DEM_COPERNICUS_90\nDataCollection.MODIS\nDataCollection.LANDSAT_MSS_L1\nDataCollection.LANDSAT_TM_L1\nDataCollection.LANDSAT_TM_L2\nDataCollection.LANDSAT_ETM_L1\nDataCollection.LANDSAT_ETM_L2\nDataCollection.LANDSAT_OT_L1\nDataCollection.LANDSAT_OT_L2\nDataCollection.SENTINEL5P\nDataCollection.SENTINEL3_OLCI\nDataCollection.SENTINEL3_SLSTR\nDataCollection.HARMONIZED_LANDSAT_SENTINEL\n"}],"visibility":"show","key":"aXJlTivD4s"}],"visibility":"show","key":"YeLQOOR758"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.240947,"end_time":"2023-10-24T07:58:46.861365","exception":false,"start_time":"2023-10-24T07:58:46.620418","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For this example let’s download the digital elevation model data (DEM). The process is similar as before, we just provide the evalscript and create the request. More data on the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v3HyjATPgS"},{"type":"inlineCode","value":"DEM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wE66FxWvwB"},{"type":"text","value":" data collection is available ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AuvjME1n30"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/data/DEM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aCavvsJa2K"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/data/DEM","key":"CpnDoBPgLp"},{"type":"text","value":". ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yZoYg9JYUJ"},{"type":"inlineCode","value":"DEM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NFPpOt6r3n"},{"type":"text","value":" values are in meters and can be negative for areas which lie below sea level, so it is recommended to set the output format in your evalscript to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zmBWAHlpdU"},{"type":"inlineCode","value":"FLOAT32","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M2YBBLOIu3"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Aet29UlFJK"}],"key":"fC12z69jKF"}],"visibility":"show","key":"zoVphQ1zd9"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:47.339683Z","iopub.status.busy":"2023-10-24T07:58:47.339183Z","iopub.status.idle":"2023-10-24T07:58:47.342272Z","shell.execute_reply":"2023-10-24T07:58:47.341758Z"},"papermill":{"duration":0.236946,"end_time":"2023-10-24T07:58:47.343339","exception":false,"start_time":"2023-10-24T07:58:47.106393","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_dem = '''\n//VERSION=3\nfunction setup() {\n  return {\n    input: [\"DEM\"],\n    output:{\n      id: \"default\",\n      bands: 1,\n      sampleType: SampleType.FLOAT32\n    }\n  }\n}\n\nfunction evaluatePixel(sample) {\n  return [sample.DEM]\n}\n'''","visibility":"show","key":"bB87keeTB8"},{"type":"output","id":"Sx8zZdn3SUH6nG5yqpCW5","data":[],"visibility":"show","key":"ibQHqjWOqw"}],"visibility":"show","key":"pEA1v5prv4"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:47.827899Z","iopub.status.busy":"2023-10-24T07:58:47.827316Z","iopub.status.idle":"2023-10-24T07:58:47.831465Z","shell.execute_reply":"2023-10-24T07:58:47.831005Z"},"papermill":{"duration":0.240012,"end_time":"2023-10-24T07:58:47.832621","exception":false,"start_time":"2023-10-24T07:58:47.592609","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"dem_request = SentinelHubRequest(\n    evalscript=evalscript_dem,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.DEM,\n            time_interval=('2020-06-12', '2020-06-13'),\n    )\n    ],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.TIFF)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"lV6wCSRA37"},{"type":"output","id":"1rDJW2UOJ-UMaAnKpveSs","data":[],"visibility":"show","key":"YWB4FbgV01"}],"visibility":"show","key":"mr1fYqjLR8"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:48.301435Z","iopub.status.busy":"2023-10-24T07:58:48.300968Z","iopub.status.idle":"2023-10-24T07:58:49.524209Z","shell.execute_reply":"2023-10-24T07:58:49.523751Z"},"papermill":{"duration":1.451687,"end_time":"2023-10-24T07:58:49.526186","exception":false,"start_time":"2023-10-24T07:58:48.074499","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"dem_data = dem_request.get_data()","visibility":"show","key":"M17CakUgD5"},{"type":"output","id":"9jmv-C1CCJtdKmSLAx-k8","data":[],"visibility":"show","key":"PqVCrySn9H"}],"visibility":"show","key":"nZjogVAzKL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:49.991133Z","iopub.status.busy":"2023-10-24T07:58:49.990720Z","iopub.status.idle":"2023-10-24T07:58:50.317452Z","shell.execute_reply":"2023-10-24T07:58:50.317037Z"},"papermill":{"duration":0.548964,"end_time":"2023-10-24T07:58:50.320298","exception":false,"start_time":"2023-10-24T07:58:49.771334","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Plot DEM map\n# vmin = 0; cutoff at sea level (0 m)\n# vmax = 120; cutoff at high values (120 m)\nplot_image(dem_data[0], factor=1.0, cmap=plt.cm.Greys_r, vmin=0, vmax=120)","visibility":"show","key":"YNPQlknmkJ"},{"type":"output","id":"IIVMDEO4gfJAq23Thvjtv","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2a682b1635f3c4a62e35abf11409f279","path":"/notebooks_test/build/2a682b1635f3c4a62e35abf11409f279.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"O0YMDRLmBb"}],"visibility":"show","key":"Y9S3atQjI9"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.238989,"end_time":"2023-10-24T07:58:50.817639","exception":false,"start_time":"2023-10-24T07:58:50.578650","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 6: Multi-response request","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l9PPODdbba"}],"identifier":"example-6-multi-response-request","label":"Example 6: Multi-response request","html_id":"example-6-multi-response-request","implicit":true,"key":"suXzSa1AHa"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Process API enables downloading multiple files in one response, packed together in a TAR archive.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AmR0FOiJX5"}],"key":"WPGnlA0rsH"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We will get the same image as before, download in the form of digital numbers (DN) as a UINT16 TIFF file. Along with the image we will download the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mve8XzPhG5"},{"type":"inlineCode","value":"inputMetadata","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ODaShkMSpq"},{"type":"text","value":" which contains the normalization factor value in a JSON format.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"c7S8Mz6AxE"}],"key":"sogxQzkIB7"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"After the download we will be able to convert the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Hoifpdvrlm"},{"type":"inlineCode","value":"INT16","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"EaPlPe6O0l"},{"type":"text","value":" digital numbers to get the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"KRmk8wejrb"},{"type":"inlineCode","value":"FLOAT32","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"GSLEMHlEEI"},{"type":"text","value":" reflectances.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FeGd1YVk58"}],"key":"jTGsTeSkca"}],"visibility":"show","key":"PQ9BYRikuN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:51.307893Z","iopub.status.busy":"2023-10-24T07:58:51.307468Z","iopub.status.idle":"2023-10-24T07:58:51.311224Z","shell.execute_reply":"2023-10-24T07:58:51.310809Z"},"papermill":{"duration":0.243238,"end_time":"2023-10-24T07:58:51.312640","exception":false,"start_time":"2023-10-24T07:58:51.069402","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript = \"\"\"\n    //VERSION=3\n\n    function setup() {\n        return {\n            input: [{\n                bands: [\"B02\", \"B03\", \"B04\"],\n                units: \"DN\"\n            }],\n            output: {\n                bands: 3,\n                sampleType: \"INT16\"\n            }\n        };\n    }\n\n    function updateOutputMetadata(scenes, inputMetadata, outputMetadata) {\n        outputMetadata.userData = { \"norm_factor\":  inputMetadata.normalizationFactor }\n    }\n\n    function evaluatePixel(sample) {\n        return [sample.B04, sample.B03, sample.B02];\n    }\n\"\"\"\n\nrequest_multitype = SentinelHubRequest(\n    evalscript=evalscript,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L1C,\n            time_interval=('2020-06-01', '2020-06-30'),\n            mosaicking_order='leastCC'\n        )\n    ],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.TIFF),\n        SentinelHubRequest.output_response('userdata', MimeType.JSON)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"dTD9VaonUO"},{"type":"output","id":"gP-mEXkLkuZF57Bp032Iu","data":[],"visibility":"show","key":"xTzCfpvt3s"}],"visibility":"show","key":"MZ55M6kV8p"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:51.811918Z","iopub.status.busy":"2023-10-24T07:58:51.811393Z","iopub.status.idle":"2023-10-24T07:58:53.044049Z","shell.execute_reply":"2023-10-24T07:58:53.043553Z"},"papermill":{"duration":1.47041,"end_time":"2023-10-24T07:58:53.045218","exception":false,"start_time":"2023-10-24T07:58:51.574808","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# print out information\nmulti_data = request_multitype.get_data()[0]\nmulti_data.keys()","visibility":"show","key":"bxuDkW3mo4"},{"type":"output","id":"qFapTKSMz6EHzNVqcB10q","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/plain":{"content":"dict_keys(['default.tif', 'userdata.json'])","content_type":"text/plain"}}}],"visibility":"show","key":"agFk3MHXsY"}],"visibility":"show","key":"YhjsnxxbEm"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:53.571721Z","iopub.status.busy":"2023-10-24T07:58:53.571270Z","iopub.status.idle":"2023-10-24T07:58:53.575388Z","shell.execute_reply":"2023-10-24T07:58:53.574964Z"},"papermill":{"duration":0.28882,"end_time":"2023-10-24T07:58:53.576868","exception":false,"start_time":"2023-10-24T07:58:53.288048","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# normalize image\nimg = multi_data['default.tif']\nnorm_factor = multi_data['userdata.json']['norm_factor']\n\nimg_float32 = img * norm_factor","visibility":"show","key":"Q3Q3re6j3v"},{"type":"output","id":"Z5HidhtdQsC3DmzQaCQ9H","data":[],"visibility":"show","key":"UPrcIpcsEg"}],"visibility":"show","key":"WuQN4vFB1v"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:54.066725Z","iopub.status.busy":"2023-10-24T07:58:54.066112Z","iopub.status.idle":"2023-10-24T07:58:54.746026Z","shell.execute_reply":"2023-10-24T07:58:54.745572Z"},"papermill":{"duration":0.919051,"end_time":"2023-10-24T07:58:54.755429","exception":false,"start_time":"2023-10-24T07:58:53.836378","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_image(img_float32, factor=3.5, clip_range=(0, 1))","visibility":"show","key":"leqfTkvF0G"},{"type":"output","id":"D8mD34TZLgsbFMAr_VpYF","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3507c6173d8238b3fd0018b749a79dd9","path":"/notebooks_test/build/3507c6173d8238b3fd0018b749a79dd9.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"uHHiBOHIVk"}],"visibility":"show","key":"lEhecwJTWE"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.26274,"end_time":"2023-10-24T07:58:55.310679","exception":false,"start_time":"2023-10-24T07:58:55.047939","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 7: Request with a raw dictionary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qeUBljNbIZ"}],"identifier":"example-7-request-with-a-raw-dictionary","label":"Example 7: Request with a raw dictionary","html_id":"example-7-request-with-a-raw-dictionary","implicit":true,"key":"M8MGPrRQA6"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"All requests so far were built with some helper functions. We can also construct a raw dictionary as defined in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"voWcU4VHio"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/reference/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"API Reference","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WupUp8oZiL"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/reference/","key":"DwfChr6Zv0"},{"type":"text","value":", without these helper functions, so we have full control over building the request body.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gjYtiXOruZ"}],"key":"A6aRXUUE1P"}],"visibility":"show","key":"rDTmUnOjfT"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:55.895161Z","iopub.status.busy":"2023-10-24T07:58:55.894814Z","iopub.status.idle":"2023-10-24T07:58:55.898654Z","shell.execute_reply":"2023-10-24T07:58:55.898230Z"},"papermill":{"duration":0.28599,"end_time":"2023-10-24T07:58:55.899609","exception":false,"start_time":"2023-10-24T07:58:55.613619","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"request_raw_dict = {\n    \"input\": {\n        \"bounds\": {\n            \"properties\": {\n                \"crs\": betsiboka_bbox.crs.opengis_string\n            },\n            \"bbox\": list(betsiboka_bbox)\n        },\n        \"data\": [\n            {\n                \"type\": \"S2L1C\",\n                \"dataFilter\": {\n                    \"timeRange\": {\"from\": '2020-06-01T00:00:00Z', \"to\": '2020-06-30T00:00:00Z'},\n                    \"mosaickingOrder\": \"leastCC\",\n                }\n            }\n        ]\n    },\n    \"output\": {\n        \"width\": betsiboka_size[0],\n        \"height\": betsiboka_size[1],\n        \"responses\": [\n            {\n                \"identifier\": \"default\",\n                \"format\": {\n                    'type': MimeType.TIFF.get_string()\n                }\n            }\n        ]\n    },\n    \"evalscript\": evalscript_true_color\n}","visibility":"show","key":"V1sjQ1ZV2i"},{"type":"output","id":"y0NTAySDkz_F7ICZvanL-","data":[],"visibility":"show","key":"hHJ2emJq6j"}],"visibility":"show","key":"LNDLIjatWp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:56.424445Z","iopub.status.busy":"2023-10-24T07:58:56.423884Z","iopub.status.idle":"2023-10-24T07:58:57.276025Z","shell.execute_reply":"2023-10-24T07:58:57.275591Z"},"papermill":{"duration":1.104523,"end_time":"2023-10-24T07:58:57.277474","exception":false,"start_time":"2023-10-24T07:58:56.172951","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# create request\ndownload_request = DownloadRequest(\n    request_type='POST',\n    url=\"https://services.sentinel-hub.com/api/v1/process\",\n    post_values=request_raw_dict,\n    data_type=MimeType.TIFF,\n    headers={'content-type': 'application/json'},\n    use_session=True\n)\n\n# execute request\nclient = SentinelHubDownloadClient(config=config)\nimg = client.download(download_request)","visibility":"show","key":"hIhAZJTDD8"},{"type":"output","id":"I5tC6FVpB6AFABq1JARYn","data":[{"name":"stderr","output_type":"stream","text":"/home/conda/20a41cef-8d63-4030-9e37-aa3412866cee/60a7fe77bf15cdba38ca795208c44847e274649eaaa525aeefa5bf7a3f7692e0-20231023-081922-894744-312-bm-test-edc-2023.10-01/lib/python3.11/site-packages/sentinelhub/download/client.py:78: SHDeprecationWarning: The parameter `download_requests` should be a sequence of requests. In future versions download of single requests will only be supported if provided as a singelton tuple or list.\n  warnings.warn(\n"}],"visibility":"show","key":"tfxaxxXdWy"}],"visibility":"show","key":"EBhh9RIiDt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:57.810223Z","iopub.status.busy":"2023-10-24T07:58:57.809843Z","iopub.status.idle":"2023-10-24T07:58:58.466505Z","shell.execute_reply":"2023-10-24T07:58:58.466084Z"},"papermill":{"duration":0.912216,"end_time":"2023-10-24T07:58:58.473503","exception":false,"start_time":"2023-10-24T07:58:57.561287","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_image(img, factor=3.5/255, clip_range=(0,1))","visibility":"show","key":"qJhIqCOilN"},{"type":"output","id":"1nkGtndPOiUnVVS0ZkK9b","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9c3a0f7e7f03b678f292f3d756e7ebf4","path":"/notebooks_test/build/9c3a0f7e7f03b678f292f3d756e7ebf4.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"Rwyb0inpzX"}],"visibility":"show","key":"T7QBT8If8r"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.281786,"end_time":"2023-10-24T07:58:59.064993","exception":false,"start_time":"2023-10-24T07:58:58.783207","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 8: Request multiple timestamps data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oyxZoWGUjN"}],"identifier":"example-8-request-multiple-timestamps-data","label":"Example 8: Request multiple timestamps data","html_id":"example-8-request-multiple-timestamps-data","implicit":true,"key":"UKhAO7a0iO"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"It is possible to construct some logic in order to return data for multiple timestamps. By defining the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Dk7sWkPOjw"},{"type":"inlineCode","value":"time_interval","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VdizCO3lEj"},{"type":"text","value":" parameter and some logic of splitting it, it is possible to create an SH reques per each “time slot” and then download the data from all the requests with the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"poWuaygLDD"},{"type":"inlineCode","value":"SentinelHubDownloadClient","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jTcf2Hrdkv"},{"type":"text","value":" in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Y6yonrKkQ7"},{"type":"inlineCode","value":"sentinelhub-py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jgZrnBAXWB"},{"type":"text","value":". In this example we will create least cloudy monthly images for the year 2019.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"o3HeGA3zf2"}],"key":"iO8mdJ4U7T"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"However, this is already a functionality built on top of this SH API package. We have extended the support for such usage in our package ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dEhCA5FtMN"},{"type":"link","url":"https://github.com/sentinel-hub/eo-learn","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"eo-learn","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wsnfAtPMc7"}],"urlSource":"https://github.com/sentinel-hub/eo-learn","error":true,"key":"thuOlHE3PI"},{"type":"text","value":". We recommend to use ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CcvPOkU0sM"},{"type":"inlineCode","value":"eo-learn","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Py1x56qHKq"},{"type":"text","value":" for more complex cases where you need multiple timestamps or high-resolution data for larger areas.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xFNx505Td8"}],"key":"jgl3C3aUt6"}],"visibility":"show","key":"cMSrTq8g6P"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:59.708856Z","iopub.status.busy":"2023-10-24T07:58:59.708397Z","iopub.status.idle":"2023-10-24T07:58:59.715809Z","shell.execute_reply":"2023-10-24T07:58:59.715341Z"},"papermill":{"duration":0.287743,"end_time":"2023-10-24T07:58:59.717033","exception":false,"start_time":"2023-10-24T07:58:59.429290","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"start = datetime.datetime(2019,1,1)\nend = datetime.datetime(2019,12,31)\nn_chunks = 13\ntdelta = (end - start) / n_chunks\nedges = [(start + i*tdelta).date().isoformat() for i in range(n_chunks)]\nslots = [(edges[i], edges[i+1]) for i in range(len(edges)-1)]\n\nprint('Monthly time windows:\\n')\nfor slot in slots:\n    print(slot)","visibility":"show","key":"bHes14BVU7"},{"type":"output","id":"TtXWcClIohTrEsfIvMYqs","data":[{"name":"stdout","output_type":"stream","text":"Monthly time windows:\n\n('2019-01-01', '2019-01-29')\n('2019-01-29', '2019-02-26')\n('2019-02-26', '2019-03-26')\n('2019-03-26', '2019-04-23')\n('2019-04-23', '2019-05-21')\n('2019-05-21', '2019-06-18')\n('2019-06-18', '2019-07-16')\n('2019-07-16', '2019-08-13')\n('2019-08-13', '2019-09-10')\n('2019-09-10', '2019-10-08')\n('2019-10-08', '2019-11-05')\n('2019-11-05', '2019-12-03')\n"}],"visibility":"show","key":"j4fSfc9Ugv"}],"visibility":"show","key":"Qy6p9LrDma"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:59:00.342060Z","iopub.status.busy":"2023-10-24T07:59:00.341644Z","iopub.status.idle":"2023-10-24T07:59:00.344948Z","shell.execute_reply":"2023-10-24T07:59:00.344528Z"},"papermill":{"duration":0.285921,"end_time":"2023-10-24T07:59:00.345880","exception":false,"start_time":"2023-10-24T07:59:00.059959","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def get_true_color_request(time_interval):\n    return SentinelHubRequest(\n        evalscript=evalscript_true_color,\n        input_data=[\n            SentinelHubRequest.input_data(\n                data_collection=DataCollection.SENTINEL2_L1C,\n                time_interval=time_interval,\n                mosaicking_order='leastCC'\n            )\n        ],\n        responses=[\n            SentinelHubRequest.output_response('default', MimeType.PNG)\n        ],\n        bbox=betsiboka_bbox,\n        size=betsiboka_size,\n        config=config\n    )","visibility":"show","key":"wZYlWeqWtN"},{"type":"output","id":"V3Pv7x8W3OD0J_7FWQ1AS","data":[],"visibility":"show","key":"YQK39IDwUb"}],"visibility":"show","key":"zQsZdjyThs"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:59:00.987296Z","iopub.status.busy":"2023-10-24T07:59:00.986928Z","iopub.status.idle":"2023-10-24T07:59:06.109827Z","shell.execute_reply":"2023-10-24T07:59:06.109199Z"},"papermill":{"duration":5.406415,"end_time":"2023-10-24T07:59:06.111345","exception":false,"start_time":"2023-10-24T07:59:00.704930","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# create a list of requests\nlist_of_requests = [get_true_color_request(slot) for slot in slots]\nlist_of_requests = [request.download_list[0] for request in list_of_requests]\n\n# download data with multiple threads\ndata = SentinelHubDownloadClient(config=config).download(list_of_requests, max_threads=5)","visibility":"show","key":"YiltkG3EB5"},{"type":"output","id":"EX8MwIGwBfIGNX0PiaRZF","data":[],"visibility":"show","key":"YpDhjxkm6r"}],"visibility":"show","key":"tpySX4mFBg"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:59:06.699774Z","iopub.status.busy":"2023-10-24T07:59:06.699285Z","iopub.status.idle":"2023-10-24T07:59:08.942736Z","shell.execute_reply":"2023-10-24T07:59:08.942242Z"},"papermill":{"duration":2.546323,"end_time":"2023-10-24T07:59:08.955558","exception":false,"start_time":"2023-10-24T07:59:06.409235","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# some stuff for pretty plots\nncols = 4\nnrows = 3\naspect_ratio = betsiboka_size[0] / betsiboka_size[1]\nsubplot_kw = {'xticks': [], 'yticks': [], 'frame_on': False}\n\nfig, axs = plt.subplots(ncols=ncols, nrows=nrows, figsize=(5 * ncols * aspect_ratio, 5 * nrows),\n                        subplot_kw=subplot_kw)\n\nfor idx, image in enumerate(data):\n    ax = axs[idx // ncols][idx % ncols]\n    ax.imshow(np.clip(image * 2.5/255, 0, 1))\n    ax.set_title(f'{slots[idx][0]}  -  {slots[idx][1]}', fontsize=10)\n\nplt.tight_layout()","visibility":"show","key":"smrnmwfNTb"},{"type":"output","id":"2kRF80W6BmBQ9Dit68FtO","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b10c454ccb423435bdc768f4b5d29050","path":"/notebooks_test/build/b10c454ccb423435bdc768f4b5d29050.png"},"text/plain":{"content":"<Figure size 1205.35x1500 with 12 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"kPGkaq9Q6S"}],"visibility":"show","key":"iHmq9bON77"}],"key":"KtMJYA4CJb"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"How to access DEM data through Sentinel Hub API","url":"/external-notebooks/eurodatacube/notebooks/notebooks/curated/how-to-access-dem-data-through-sentinel-hub-api","group":"Curated"},"next":{"title":"📘 Example Notebook 1","url":"/notebooks/example1","group":"Notebooks"}}},"domain":"http://localhost:3000"}