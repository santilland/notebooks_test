{"version":1,"kind":"Notebook","sha256":"eb9fff9204f9df4db6ad9ee170d59d0ae388a217354e36cddea9cef50158069d","slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.sentinelhub-py","location":"/external_notebooks/eurodatacube/notebooks/notebooks/curated/sentinelhub-py.ipynb","dependencies":[],"frontmatter":{"title":"Using Sentinel Hub Process API in EDC: a starter’s guide.","content_includes_title":true,"kernelspec":{"name":"conda-env-users-edc-2023.10-01-py","display_name":"EDC 0.24.5 (Python3)","language":"python"},"github":"https://github.com/eoxhub-workspaces/documentation/","numbering":{"title":{"offset":5}},"edit_url":"https://github.com/eoxhub-workspaces/documentation//blob/main/external_notebooks/eurodatacube/notebooks/notebooks/curated/sentinelhub-py.ipynb","thumbnail":"/notebooks_test/build/01e22903839391bc356ac886ec2b2fa7.png","exports":[{"format":"ipynb","filename":"sentinelhub-py.ipynb","url":"/notebooks_test/build/sentinelhub-py-3275d217eb8daf862446db84986d33bf.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:15.182649Z","iopub.status.busy":"2023-10-24T07:58:15.182255Z","iopub.status.idle":"2023-10-24T07:58:15.238796Z","shell.execute_reply":"2023-10-24T07:58:15.238388Z"},"papermill":{"duration":0.089734,"end_time":"2023-10-24T07:58:15.239791","exception":false,"start_time":"2023-10-24T07:58:15.150057","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from edc import check_compatibility\ncheck_compatibility(\"user-2023.10-01\", dependencies=[\"SH\"])","visibility":"show","key":"dsu4d3inl7"},{"type":"output","id":"uR5zQ5B6KOjladE-4sipP","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<script type=\"text/javascript\">\n        function toggle(id) {\n            el = document.getElementById(id);\n            el.style.display = el.style.display === \"none\" ? \"block\" : \"none\";\n        }\n    </script>","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"This notebook is compatible with this base image version (user-2023.10-01).","content_type":"text/html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/markdown":{"content":"\n\n---------\n\nThe following environment variables are available:\n\n* `SH_CLIENT_ID`, `SH_INSTANCE_ID`, `SH_CLIENT_NAME`, `SH_CLIENT_SECRET`\n","content_type":"text/markdown"},"text/plain":{"content":"<IPython.core.display.Markdown object>","content_type":"text/plain"}}}],"visibility":"show","key":"TUz5sMXSgq"}],"visibility":"show","key":"YLAVCmSdCc"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.027883,"end_time":"2023-10-24T07:58:15.317124","exception":false,"start_time":"2023-10-24T07:58:15.289241","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Using Sentinel Hub Process API in EDC: a starter’s guide.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KesWKkHKAr"}],"identifier":"using-sentinel-hub-process-api-in-edc-a-starters-guide","label":"Using Sentinel Hub Process API in EDC: a starter’s guide.","html_id":"using-sentinel-hub-process-api-in-edc-a-starters-guide","implicit":true,"key":"dmzenBiGvk"},{"type":"thematicBreak","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"olOElKu87j"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Source: ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HEhCbX3C0E"},{"type":"link","url":"https://sentinelhub-py.readthedocs.io/en/latest/index.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Sentinel Hub Python package documentation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xe0SR4BsmC"}],"urlSource":"https://sentinelhub-py.readthedocs.io/en/latest/index.html","key":"pKJlA2P9IX"}],"key":"nyI37YvS5a"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Getting started with ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VWjdK8AmLc"},{"type":"inlineCode","value":"sentinelhub-py","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"sBkan6uUh4"}],"identifier":"getting-started-with-sentinelhub-py","label":"Getting started with sentinelhub-py","html_id":"getting-started-with-sentinelhub-py","implicit":true,"key":"jwkn8k3Npg"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"In this demonstration Jupyter Notebook, we will be requesting and exporting analysis-ready Earth Observation data with the Sentinel Hub ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Jqi1FAfBqM"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/api/process/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Process API","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"M267FJUciG"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/api/process/","key":"J0yJJtUn9P"},{"type":"text","value":" using the dedicated ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jNp9jSDNAK"},{"type":"link","url":"https://sentinelhub-py.readthedocs.io/en/latest/index.html","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"sentinelhub-py package","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"BqWiqk6cCa"}],"urlSource":"https://sentinelhub-py.readthedocs.io/en/latest/index.html","key":"FWMXkjcUs5"},{"type":"text","value":" in the EDC EOxHub Workplace. In this notebook we will learn how to:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"NWyK5GeYbA"}],"key":"RyNTjuXDN8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"link","url":"#Example-1:-Request-a-true-color-(PNG)-image-on-a-specific-date","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Request a true color (PNG) image on a specific date","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ygBgpemGJV"}],"urlSource":"#Example-1:-Request-a-true-color-(PNG)-image-on-a-specific-date","key":"cWszYhtm8P"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"link","url":"#Example-1.1-Adding-cloud-mask-data","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Add cloud mask data to the request","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"yd9zgaOi4d"}],"urlSource":"#Example-1.1-Adding-cloud-mask-data","key":"TGsvsqUlGE"}],"key":"hlizbSB9mF"}],"key":"QVd5MFUtHA"}],"key":"UUT3qatHIV"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"link","url":"#Example-2:-Request-a-true-color-mosaic-of-least-cloudy-acquisitions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Request a true color mosaic of least cloudy acquisitions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"bx0sM2AVby"}],"urlSource":"#Example-2:-Request-a-true-color-mosaic-of-least-cloudy-acquisitions","key":"GAzuouXCQn"}],"key":"L3tFC0jfSd"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"link","url":"#Example-3:-Request-all-Sentinel-2's-raw-band-values","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Request all Sentinel-2’s raw band values","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"BZRmGlKkoc"}],"urlSource":"#Example-3:-Request-all-Sentinel-2's-raw-band-values","key":"mM6yp3QMqm"}],"key":"Uk4J8eOmu9"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"link","url":"#Example-4:-Save-downloaded-data-to-disk-and-read-it-from-disk","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Save downloaded data to disk and read it from disk","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"UewrFMY1Dw"}],"urlSource":"#Example-4:-Save-downloaded-data-to-disk-and-read-it-from-disk","key":"cgbNyANQzG"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"link","url":"#Example-4.1:-Save-downloaded-data-directly-to-disk","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Save downloaded data directly to disk","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"jsfSg1aPjC"}],"urlSource":"#Example-4.1:-Save-downloaded-data-directly-to-disk","key":"lXEMkhodlO"}],"key":"qgjpQ252do"}],"key":"RLf6eKWkXs"}],"key":"Le4kfzSYAn"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"link","url":"#Example-5:-Request-other-data-collections-supported-by-sh-py","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Request other data collections supported by sentinelhub-py","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"vsVm4KUbHR"}],"urlSource":"#Example-5:-Request-other-data-collections-supported-by-sh-py","key":"zN6lcINOK4"}],"key":"vWxN5Gje9H"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"link","url":"#Example-6:-Multi-response-request","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Perform a multi-response request","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"VoRohkzb9M"}],"urlSource":"#Example-6:-Multi-response-request","key":"EW60rcInoC"}],"key":"HGPb1ZfSuN"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"link","url":"#Example-7:-Request-with-a-raw-dictionary","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Request with a raw dictionary","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"bIjRrGywma"}],"urlSource":"#Example-7:-Request-with-a-raw-dictionary","key":"eLQkeAfSDd"}],"key":"C7l77urpIN"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"link","url":"#Example-8:-Request-multiple-timestamps-data","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Request multiple timestamps data","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"so5tNcFly7"}],"urlSource":"#Example-8:-Request-multiple-timestamps-data","key":"uNqUOzhObH"}],"key":"oCaAgXXcCo"}],"key":"WEwynDsq7B"}],"visibility":"show","key":"fRLVXlRf5V"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.030899,"end_time":"2023-10-24T07:58:15.401641","exception":false,"start_time":"2023-10-24T07:58:15.370742","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kAeHoqLYXJ"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"bMNMood0Yn"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Before acccessing the data, we will start by importing the necessary Python libraries (already configured in your EDC workspace), generate credentials automatically to access the services and define the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FSOMoQgn9C"},{"type":"inlineCode","value":"plot_image","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Z6WRmZJeAi"},{"type":"text","value":" function that can be found in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Y5e90mi7ZI"},{"type":"inlineCode","value":"utils.py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GqFktA5bnm"},{"type":"text","value":" ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SsdGMci41y"},{"type":"link","url":"https://github.com/sentinel-hub/sentinelhub-py/blob/master/examples/utils.py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"file","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ShFIYgXG1L"}],"urlSource":"https://github.com/sentinel-hub/sentinelhub-py/blob/master/examples/utils.py","data":{"kind":"file","org":"sentinel-hub","repo":"sentinelhub-py","reference":"master","file":"examples/utils.py","raw":"https://raw.githubusercontent.com/sentinel-hub/sentinelhub-py/master/examples/utils.py"},"internal":false,"protocol":"github","key":"I5ct5H6fbD"},{"type":"text","value":" located in Sentinel Hub’s ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AFxsJEBCwm"},{"type":"link","url":"https://github.com/sentinel-hub/sentinelhub-py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"GitHub repository","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xzPV1wM3Nt"}],"urlSource":"https://github.com/sentinel-hub/sentinelhub-py","error":true,"key":"eGYo8NIpdr"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"elpdcdVVXr"}],"key":"MESkQF9WNY"}],"visibility":"show","key":"dlhEvTKIXh"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.027386,"end_time":"2023-10-24T07:58:15.469611","exception":false,"start_time":"2023-10-24T07:58:15.442225","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NA2cYx1dpe"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"GInyL5sX9b"}],"visibility":"show","key":"xxJKNnqEC2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:15.542283Z","iopub.status.busy":"2023-10-24T07:58:15.541994Z","iopub.status.idle":"2023-10-24T07:58:16.275602Z","shell.execute_reply":"2023-10-24T07:58:16.275129Z"},"papermill":{"duration":0.763462,"end_time":"2023-10-24T07:58:16.277010","exception":false,"start_time":"2023-10-24T07:58:15.513548","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# EDC libraries\nfrom edc import setup_environment_variables\n\n# Utilities\nimport os\nimport datetime\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom IPython.display import display, Image\n\n# Sentinel Hub\nfrom sentinelhub import (MimeType, CRS, BBox, SentinelHubRequest, SentinelHubDownloadClient, \n                         DataCollection, bbox_to_dimensions, DownloadRequest, SHConfig)","visibility":"show","key":"TQeh4Jw22g"},{"type":"output","id":"1ox1lWU1zSnGTb0Oz1Tnb","data":[],"visibility":"show","key":"SMx25VaUSK"}],"visibility":"show","key":"RkH2n2EVDI"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.025247,"end_time":"2023-10-24T07:58:16.346012","exception":false,"start_time":"2023-10-24T07:58:16.320765","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Credentials","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EdtKhTcS6m"}],"identifier":"credentials","label":"Credentials","html_id":"credentials","implicit":true,"key":"ywcXV0C2qr"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Credentials for Sentinel Hub services are automatically injected as environement variables. It is therefore easy to populate Sentinel Hub’s credential manager with the values.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MSV6RW3zYd"}],"key":"NOb7ezw4bj"}],"visibility":"show","key":"BUh0EVtNPk"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:16.421849Z","iopub.status.busy":"2023-10-24T07:58:16.421356Z","iopub.status.idle":"2023-10-24T07:58:16.424783Z","shell.execute_reply":"2023-10-24T07:58:16.424346Z"},"papermill":{"duration":0.039716,"end_time":"2023-10-24T07:58:16.425680","exception":false,"start_time":"2023-10-24T07:58:16.385964","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Pass Sentinel Hub credentials to SHConfig\nconfig = SHConfig()\nconfig.sh_client_id = os.environ[\"SH_CLIENT_ID\"]\nconfig.sh_client_secret = os.environ[\"SH_CLIENT_SECRET\"]","visibility":"show","key":"B0zD5JeAR9"},{"type":"output","id":"LRnCTvb6xEQU-KDSY4JlO","data":[],"visibility":"show","key":"DjucVK9dTR"}],"visibility":"show","key":"agyoRosbUM"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.029287,"end_time":"2023-10-24T07:58:16.496363","exception":false,"start_time":"2023-10-24T07:58:16.467076","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Utility function for plotting images","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aYktIZtdaa"}],"identifier":"utility-function-for-plotting-images","label":"Utility function for plotting images","html_id":"utility-function-for-plotting-images","implicit":true,"key":"J723yWR5hI"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In the following cell, we define the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KKAxO1DqkK"},{"type":"inlineCode","value":"plot_image","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BDhsFTMaF0"},{"type":"text","value":" function which will be used to display the requested images for all examples demonstrated in this notebook.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kI6b9uuiNX"}],"key":"Q6u1X8utsP"}],"visibility":"show","key":"CEuwYuz0wG"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:16.571117Z","iopub.status.busy":"2023-10-24T07:58:16.570757Z","iopub.status.idle":"2023-10-24T07:58:16.574542Z","shell.execute_reply":"2023-10-24T07:58:16.574116Z"},"papermill":{"duration":0.034914,"end_time":"2023-10-24T07:58:16.575435","exception":false,"start_time":"2023-10-24T07:58:16.540521","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define the plot_image function\ndef plot_image(image, factor=1.0, clip_range = None, **kwargs):\n    \"\"\"\n    Utility function for plotting RGB images.\n    \"\"\"\n    fig, ax = plt.subplots(nrows=1, ncols=1, figsize=(15, 15))\n    if clip_range is not None:\n        ax.imshow(np.clip(image * factor, *clip_range), **kwargs)\n    else:\n        ax.imshow(image * factor, **kwargs)\n    ax.set_xticks([])\n    ax.set_yticks([])","visibility":"show","key":"bK5NVCL5wJ"},{"type":"output","id":"GWnycmzwqjmcmfwLKH3cP","data":[],"visibility":"show","key":"qSJXO0nqoq"}],"visibility":"show","key":"B9V7s5A6iL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:16.643794Z","iopub.status.busy":"2023-10-24T07:58:16.643496Z","iopub.status.idle":"2023-10-24T07:58:16.649760Z","shell.execute_reply":"2023-10-24T07:58:16.649377Z"},"papermill":{"duration":0.037264,"end_time":"2023-10-24T07:58:16.650832","exception":false,"start_time":"2023-10-24T07:58:16.613568","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Configure plots for inline use in Jupyter Notebook\n%matplotlib inline","visibility":"show","key":"Bfb9fK5HKr"},{"type":"output","id":"HXQLdECQ8onG1CWxeRTBK","data":[],"visibility":"show","key":"OgGiNYbRaI"}],"visibility":"show","key":"crIVlGNGU8"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.028023,"end_time":"2023-10-24T07:58:16.724769","exception":false,"start_time":"2023-10-24T07:58:16.696746","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Setting area of interest (AOI)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RVY4QzgvO9"}],"identifier":"setting-area-of-interest-aoi","label":"Setting area of interest (AOI)","html_id":"setting-area-of-interest-aoi","implicit":true,"key":"DiVsTHkwDt"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We will download Sentinel-2 imagery of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qMswYGToch"},{"type":"link","url":"https://en.wikipedia.org/wiki/Betsiboka_River","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Betsiboka Estuary","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"p5kSINDbhd"}],"urlSource":"https://en.wikipedia.org/wiki/Betsiboka_River","data":{"page":"Betsiboka_River","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"Sz33fL3dxJ"},{"type":"text","value":" such as the one shown below (taken by Sentinel-2 on 2017-12-15):","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ld8YcugTQX"}],"key":"nL9hXyigks"}],"visibility":"show","key":"LSIbhwWKHp"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.025774,"end_time":"2023-10-24T07:58:16.790076","exception":false,"start_time":"2023-10-24T07:58:16.764302","status":"completed"},"tags":[]},"children":[{"type":"image","url":"/notebooks_test/build/01e22903839391bc356ac886ec2b2fa7.png","alt":"Betsiboka Estuary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zOG9SIrAm3","urlSource":"https://sentinelhub-py.readthedocs.io/en/latest/_images/wms_TRUE_COLOR_EPSG4326_-16.15_46.16_-15.58_46.51_2017-12-15T07-12-03_512X856.png"}],"visibility":"show","key":"U5Wko3nO3N"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.026899,"end_time":"2023-10-24T07:58:16.855920","exception":false,"start_time":"2023-10-24T07:58:16.829021","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The bounding box in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xNeKwLUQjD"},{"type":"inlineCode","value":"WGS84","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mclFsXpO62"},{"type":"text","value":" coordinate system is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XN0n6DFMyB"},{"type":"inlineCode","value":"[46.16, -16.15, 46.51, -15.58]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JRA72v8DkV"},{"type":"text","value":" (longitude and latitude coordinates of lower left and upper right corners). You can get the bbox for a different area at the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QhgguWB2sx"},{"type":"link","url":"http://bboxfinder.com/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"bboxfinder","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WJZNwfCU45"}],"urlSource":"http://bboxfinder.com/","key":"qvR37Z54rT"},{"type":"text","value":" website.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a6TNonnR31"}],"key":"udjKWtcEar"}],"visibility":"show","key":"GOimMA6bUt"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.028415,"end_time":"2023-10-24T07:58:16.924242","exception":false,"start_time":"2023-10-24T07:58:16.895827","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"All requests require bounding box to be given as an instance of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cjtScnxqCR"},{"type":"inlineCode","value":"sentinelhub.geometry.BBox","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oi2JjheoqG"},{"type":"text","value":" with corresponding Coordinate Reference System (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K1ZPRAKyHH"},{"type":"inlineCode","value":"sentinelhub.constants.CRS","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zgsx4G4TJI"},{"type":"text","value":"). In our case it is in WGS84 and we can use the predefined WGS84 coordinate reference system from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SpWT1PKCkC"},{"type":"inlineCode","value":"sentinelhub.constants.CRS","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"izj2SkCIQ6"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VOx1sQ4jnD"}],"key":"zSQGFr38B7"}],"visibility":"show","key":"IVRBvvx30x"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:16.989795Z","iopub.status.busy":"2023-10-24T07:58:16.989578Z","iopub.status.idle":"2023-10-24T07:58:16.992778Z","shell.execute_reply":"2023-10-24T07:58:16.992260Z"},"papermill":{"duration":0.031069,"end_time":"2023-10-24T07:58:16.993795","exception":false,"start_time":"2023-10-24T07:58:16.962726","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"betsiboka_coords_wgs84 = [46.16, -16.15, 46.51, -15.58]","visibility":"show","key":"xWZ0VbvSKi"},{"type":"output","id":"Wk8VNoredSRhnZJOZCKTW","data":[],"visibility":"show","key":"OAj8EvuN0X"}],"visibility":"show","key":"Io6zgZUN4V"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.026196,"end_time":"2023-10-24T07:58:17.060663","exception":false,"start_time":"2023-10-24T07:58:17.034467","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"When the bounding box bounds have been defined, you can initialize the BBox of the area of interest. Using the bbox_to_dimensions utility function, you can provide the desired resolution parameter of the image in meters and obtain the output image shape.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fS8pGWnCVQ"}],"key":"YIHOCbSm4W"}],"visibility":"show","key":"Sx4pGH6yoK"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:17.129544Z","iopub.status.busy":"2023-10-24T07:58:17.129203Z","iopub.status.idle":"2023-10-24T07:58:17.146453Z","shell.execute_reply":"2023-10-24T07:58:17.145979Z"},"papermill":{"duration":0.04571,"end_time":"2023-10-24T07:58:17.147527","exception":false,"start_time":"2023-10-24T07:58:17.101817","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"resolution = 60\nbetsiboka_bbox = BBox(bbox=betsiboka_coords_wgs84, crs=CRS.WGS84)\nbetsiboka_size = bbox_to_dimensions(betsiboka_bbox, resolution=resolution)\n\nprint(f'Image shape at {resolution} m resolution: {betsiboka_size} pixels')","visibility":"show","key":"Lgu9U3P4zx"},{"type":"output","id":"gDENkTQmtZWooA0boqC-s","data":[{"name":"stdout","output_type":"stream","text":"Image shape at 60 m resolution: (631, 1047) pixels\n"}],"visibility":"show","key":"VxpVtlEi0Q"}],"visibility":"show","key":"Plg3gU6Sz9"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.026438,"end_time":"2023-10-24T07:58:17.212596","exception":false,"start_time":"2023-10-24T07:58:17.186158","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 1: Request a true color (PNG) image on a specific date","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NvsyqTF4ih"}],"identifier":"example-1-request-a-true-color-png-image-on-a-specific-date","label":"Example 1: Request a true color (PNG) image on a specific date","html_id":"example-1-request-a-true-color-png-image-on-a-specific-date","implicit":true,"key":"uYhmk4QMXN"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We build the request according to the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"p6Bip79x1U"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/reference/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"API Reference","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GoPkyHAZ18"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/reference/","key":"t9fWCaoBwi"},{"type":"text","value":", using the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yBQ23MhQ7I"},{"type":"inlineCode","value":"SentinelHubRequest","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"b9YOnJsUOA"},{"type":"text","value":" class. Each Process API request also needs an ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UZiQ6vzd3M"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/Evalscript/V3/README","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"evalscript","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fS8vgAT0bm"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/Evalscript/V3/README","key":"hGCYTwhg8F"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uNFOJLaWvs"}],"key":"kHho22m36D"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The information that we specify in the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"guMu3quygD"},{"type":"inlineCode","value":"SentinelHubRequest","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RmhnHSu77Z"},{"type":"text","value":" object is:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Nv273h2AsM"}],"key":"XkfSXWJEwX"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"an evalscript,","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"mIY0dFIPNy"}],"key":"jIJZe77FMD"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"a list of input data collections with time interval,","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"zZpPXtOo9u"}],"key":"QSCgnqIzNK"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"a format of the response,","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"qtg1FlkbwY"}],"key":"RdWs5zbJcn"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"a bounding box and it’s size (size or resolution).","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"bx645cA02A"}],"key":"WaVAsMfVac"}],"key":"sv8frCg4S3"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The evalscript in the example is used to select the appropriate bands. We return the RGB (B04, B03, B02) Sentinel-2 L1C bands.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"oF6kpXkbJX"}],"key":"d8MRqJKnLX"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"The image from Jun 12th 2020 is downloaded. Without any additional parameters in the evalscript, the downloaded data will correspond to reflectance values in ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"MHqOXUjrQV"},{"type":"inlineCode","value":"UINT8","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"uJfD4ownHv"},{"type":"text","value":" format (values in 0-255 range).","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"scerMVvdxQ"}],"key":"B4BtHo7gKF"}],"visibility":"show","key":"I3k4rZCS0d"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:17.281579Z","iopub.status.busy":"2023-10-24T07:58:17.281352Z","iopub.status.idle":"2023-10-24T07:58:17.286230Z","shell.execute_reply":"2023-10-24T07:58:17.285747Z"},"papermill":{"duration":0.035807,"end_time":"2023-10-24T07:58:17.287179","exception":false,"start_time":"2023-10-24T07:58:17.251372","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_true_color = \"\"\"\n    //VERSION=3\n\n    function setup() {\n        return {\n            input: [{\n                bands: [\"B02\", \"B03\", \"B04\"]\n            }],\n            output: {\n                bands: 3\n            }\n        };\n    }\n\n    function evaluatePixel(sample) {\n        return [sample.B04, sample.B03, sample.B02];\n    }\n\"\"\"\n\nrequest_true_color = SentinelHubRequest(\n    evalscript=evalscript_true_color,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L1C,\n            time_interval=('2020-06-12', '2020-06-13'),\n        )\n    ],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.PNG)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"eZRckQZKw2"},{"type":"output","id":"5_BfFd3ZDJKDtZUBtUiBC","data":[],"visibility":"show","key":"FlW6MSZyzI"}],"visibility":"show","key":"TwNJF6mbUw"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:17.353393Z","iopub.status.busy":"2023-10-24T07:58:17.353043Z","iopub.status.idle":"2023-10-24T07:58:18.418103Z","shell.execute_reply":"2023-10-24T07:58:18.417366Z"},"papermill":{"duration":1.095641,"end_time":"2023-10-24T07:58:18.421078","exception":false,"start_time":"2023-10-24T07:58:17.325437","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"true_color_imgs = request_true_color.get_data()","visibility":"show","key":"UP3caa0NuO"},{"type":"output","id":"uZrTQmkcpE16-Y3Ucv2mt","data":[],"visibility":"show","key":"q2Hldmk3WA"}],"visibility":"show","key":"PjzkMVfiDv"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.044092,"end_time":"2023-10-24T07:58:18.521263","exception":false,"start_time":"2023-10-24T07:58:18.477171","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The method ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cXmZCycZl7"},{"type":"inlineCode","value":"get_data()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IZax2ms3We"},{"type":"text","value":" will always return a list of length 1 with the available image from the requested time interval in the form of numpy arrays.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u1InoDKHyw"}],"key":"nvTbX92BmC"}],"visibility":"show","key":"q21534wpse"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:18.592589Z","iopub.status.busy":"2023-10-24T07:58:18.592107Z","iopub.status.idle":"2023-10-24T07:58:18.595889Z","shell.execute_reply":"2023-10-24T07:58:18.595326Z"},"papermill":{"duration":0.032682,"end_time":"2023-10-24T07:58:18.597447","exception":false,"start_time":"2023-10-24T07:58:18.564765","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f'Returned data is of type = {type(true_color_imgs)} and length {len(true_color_imgs)}.')\nprint(f'Single element in the list is of type {type(true_color_imgs[-1])} and has shape {true_color_imgs[-1].shape}')","visibility":"show","key":"JPWeiMjeRU"},{"type":"output","id":"NOBize9pQ6LFa3MHu5Fy1","data":[{"name":"stdout","output_type":"stream","text":"Returned data is of type = <class 'list'> and length 1.\nSingle element in the list is of type <class 'numpy.ndarray'> and has shape (1047, 631, 3)\n"}],"visibility":"show","key":"g3DVHPPD2R"}],"visibility":"show","key":"mRYZNPbI5Z"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:18.667461Z","iopub.status.busy":"2023-10-24T07:58:18.666882Z","iopub.status.idle":"2023-10-24T07:58:19.387747Z","shell.execute_reply":"2023-10-24T07:58:19.387197Z"},"papermill":{"duration":0.758762,"end_time":"2023-10-24T07:58:19.397971","exception":false,"start_time":"2023-10-24T07:58:18.639209","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"image = true_color_imgs[0]\nprint(f'Image type: {image.dtype}')\n\n# plot function\n# factor 1/255 to scale between 0-1\n# factor 3.5 to increase brightness\nplot_image(image, factor=3.5/255, clip_range=(0,1))","visibility":"show","key":"qSDAuouByt"},{"type":"output","id":"pVYlnXGiquG1XSylcQ90E","data":[{"name":"stdout","output_type":"stream","text":"Image type: uint8\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a6ee3c4a1a25ec6db2dc04a521204869","path":"/notebooks_test/build/a6ee3c4a1a25ec6db2dc04a521204869.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"sfkungrgpo"}],"visibility":"show","key":"T0UPkve7nW"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.08628,"end_time":"2023-10-24T07:58:19.584640","exception":false,"start_time":"2023-10-24T07:58:19.498360","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 1.1 Adding cloud mask data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HDq0m79jil"}],"identifier":"example-1-1-adding-cloud-mask-data","label":"Example 1.1 Adding cloud mask data","html_id":"example-1-1-adding-cloud-mask-data","implicit":true,"key":"K7PTgMbktY"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"It is also possible to obtain cloud masks when requesting Sentinel-2 data by using the cloud mask band (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"F5YtuUGlQz"},{"type":"inlineCode","value":"CLM","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qJFs7wAXTp"},{"type":"text","value":") or the cloud probabilities band (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OUJ3U9FVYA"},{"type":"inlineCode","value":"CLP","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WoFZ8dh2cA"},{"type":"text","value":"). More info ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oEFlEHcSBI"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/API/data_access?id=cloud-masks-and-cloud-probabilities","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zyYQfOLjGt"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/API/data_access?id=cloud-masks-and-cloud-probabilities","key":"YbdssBkGGL"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lBZK5Z49tx"}],"key":"K3fsgzF639"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The factor for increasing the image brightness can already be provided in the evalscript.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wTZ0fkSXU0"}],"key":"kqnJ0WxabX"}],"visibility":"show","key":"ZIBfUx4QYy"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:19.768890Z","iopub.status.busy":"2023-10-24T07:58:19.768613Z","iopub.status.idle":"2023-10-24T07:58:19.772589Z","shell.execute_reply":"2023-10-24T07:58:19.772092Z"},"papermill":{"duration":0.092391,"end_time":"2023-10-24T07:58:19.773751","exception":false,"start_time":"2023-10-24T07:58:19.681360","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_clm = \"\"\"\n//VERSION=3\nfunction setup() {\n  return {\n    input: [\"B02\", \"B03\", \"B04\", \"CLM\"],\n    output: { bands: 3 }\n  }\n}\n\nfunction evaluatePixel(sample) {\n  if (sample.CLM == 1) {\n    return [0.75 + sample.B04, sample.B03, sample.B02]\n  }\n  return [3.5*sample.B04, 3.5*sample.B03, 3.5*sample.B02];\n}\n\"\"\"\n\nrequest_true_color = SentinelHubRequest(\n    evalscript=evalscript_clm,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L1C,\n            time_interval=('2020-06-12', '2020-06-13'),\n        )\n    ],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.PNG)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"BVA2uTjxRm"},{"type":"output","id":"JII1K0qlVffQTzcKDQxSl","data":[],"visibility":"show","key":"MmvapoeyIC"}],"visibility":"show","key":"akO5h0dy5O"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:19.960475Z","iopub.status.busy":"2023-10-24T07:58:19.960133Z","iopub.status.idle":"2023-10-24T07:58:21.035944Z","shell.execute_reply":"2023-10-24T07:58:21.035485Z"},"papermill":{"duration":1.168935,"end_time":"2023-10-24T07:58:21.037249","exception":false,"start_time":"2023-10-24T07:58:19.868314","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"data_with_cloud_mask = request_true_color.get_data()","visibility":"show","key":"LFvgT1KPX2"},{"type":"output","id":"EMZUQmdESRSHNhALlRibd","data":[],"visibility":"show","key":"bfhVPecZnF"}],"visibility":"show","key":"rGiADIBudK"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:21.221532Z","iopub.status.busy":"2023-10-24T07:58:21.221293Z","iopub.status.idle":"2023-10-24T07:58:21.948919Z","shell.execute_reply":"2023-10-24T07:58:21.948437Z"},"papermill":{"duration":0.822987,"end_time":"2023-10-24T07:58:21.956107","exception":false,"start_time":"2023-10-24T07:58:21.133120","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_image(data_with_cloud_mask[0], factor=1/255)","visibility":"show","key":"UdxCQkUtJI"},{"type":"output","id":"c79UrNROiL3oxKYVOhuED","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7cc2c750d55706b6c8b6428bb3b47567","path":"/notebooks_test/build/7cc2c750d55706b6c8b6428bb3b47567.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"IHTW6fquYd"}],"visibility":"show","key":"i85jQ5ROdJ"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.112788,"end_time":"2023-10-24T07:58:22.189616","exception":false,"start_time":"2023-10-24T07:58:22.076828","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 2: Request a true color mosaic of least cloudy acquisitions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zqlTJCuYCX"}],"identifier":"example-2-request-a-true-color-mosaic-of-least-cloudy-acquisitions","label":"Example 2: Request a true color mosaic of least cloudy acquisitions","html_id":"example-2-request-a-true-color-mosaic-of-least-cloudy-acquisitions","implicit":true,"key":"YJEX7EMVUo"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uuAhW3uD3W"},{"type":"inlineCode","value":"SentinelHubRequest","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AuV21PSa5m"},{"type":"text","value":" automatically creates a mosaic from all available images in the given time interval. By default, the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iXWemrIP8X"},{"type":"inlineCode","value":"mostRecent","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uGLNUHd0cS"},{"type":"text","value":" mosaicking order is used. More information available ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wrwYuiu1nR"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/data/Sentinel-2-L2A?id=mosaickingorder","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pHfQU4AF9V"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/data/Sentinel-2-L2A?id=mosaickingorder","key":"JcOsaQmtvs"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Gr6qjZIpEt"}],"key":"PhzbNPbYvl"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In this example we will provide a month long interval, order the images w.r.t. the cloud coverage on the tile level (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mXQdbVRwLs"},{"type":"inlineCode","value":"leastCC","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"UYKlzUF4Op"},{"type":"text","value":" parameter), and mosaic them in the specified order.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fBadPAqfbt"}],"key":"UtpFDFV3py"}],"visibility":"show","key":"T7pFhZf2FC"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:22.432871Z","iopub.status.busy":"2023-10-24T07:58:22.432433Z","iopub.status.idle":"2023-10-24T07:58:22.436060Z","shell.execute_reply":"2023-10-24T07:58:22.435588Z"},"papermill":{"duration":0.120449,"end_time":"2023-10-24T07:58:22.437037","exception":false,"start_time":"2023-10-24T07:58:22.316588","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"request_true_color = SentinelHubRequest(\n    evalscript=evalscript_true_color,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L1C,\n            time_interval=('2020-06-01', '2020-06-30'),\n            mosaicking_order='leastCC'\n        )\n    ],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.PNG)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"I2KtAMPPyy"},{"type":"output","id":"ucySCkb8Xsi_amK4BINh0","data":[],"visibility":"show","key":"kdwMApMjYp"}],"visibility":"show","key":"qWYSwGk10N"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:22.699732Z","iopub.status.busy":"2023-10-24T07:58:22.699318Z","iopub.status.idle":"2023-10-24T07:58:24.250156Z","shell.execute_reply":"2023-10-24T07:58:24.249669Z"},"papermill":{"duration":1.691195,"end_time":"2023-10-24T07:58:24.257346","exception":false,"start_time":"2023-10-24T07:58:22.566151","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_image(request_true_color.get_data()[0], factor=3.5/255, clip_range=(0,1))","visibility":"show","key":"L0fgqaDp7O"},{"type":"output","id":"bMMe8RriVTzUkeD9Fb8at","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9c3a0f7e7f03b678f292f3d756e7ebf4","path":"/notebooks_test/build/9c3a0f7e7f03b678f292f3d756e7ebf4.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"bGNGAYRvBg"}],"visibility":"show","key":"qs2nR30lX8"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.158495,"end_time":"2023-10-24T07:58:24.592486","exception":false,"start_time":"2023-10-24T07:58:24.433991","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 3: Request all Sentinel-2’s raw band values","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UvlC5FCILn"}],"identifier":"example-3-request-all-sentinel-2s-raw-band-values","label":"Example 3: Request all Sentinel-2’s raw band values","html_id":"example-3-request-all-sentinel-2s-raw-band-values","implicit":true,"key":"CkbsGfhmkT"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now let’s define an evalscript which will return all Sentinel-2 spectral bands with raw values.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"skLX1UsEWO"}],"key":"HHsr3CgheX"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In this example we are downloading already quite a big chunk of data, so optimization of the request is not out of the question. Downloading raw digital numbers in the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DNApZIDfus"},{"type":"inlineCode","value":"INT16","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GOOjdWWVKK"},{"type":"text","value":" format instead of reflectances in the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"vySEXhY9Ba"},{"type":"inlineCode","value":"FLOAT32","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CMMYKznDMR"},{"type":"text","value":" format means that much less data is downloaded, which results in a faster download and a smaller usage of SH processing units.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bmrLcMClXW"}],"key":"PqEoCALHDE"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"In order to achieve this, we have to set the input units in the evalscript to ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jmWQFTohli"},{"type":"inlineCode","value":"DN","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ko6u5KY72s"},{"type":"text","value":" (digital numbers) and the output ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"TZOAaxnQ3o"},{"type":"inlineCode","value":"sampleType","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"HsH3Q1VH2k"},{"type":"text","value":" argument to ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ciHPIT9G4t"},{"type":"inlineCode","value":"INT16","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mu3vzOjPA2"},{"type":"text","value":". Additionally, we can’t pack all Sentinel-2’s 13 bands into a ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"R1c4mYA0ME"},{"type":"inlineCode","value":"PNG","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"kK2tT40zFS"},{"type":"text","value":" image, so we have to set the output image type to the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"JNclek6Dzp"},{"type":"inlineCode","value":"TIFF","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"v3QlzararG"},{"type":"text","value":" format via ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mqJnUlObnz"},{"type":"inlineCode","value":"MimeType.TIFF","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Vy5thHH7nz"},{"type":"text","value":" in the request.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"kWlQsVHTqJ"}],"key":"rVPiQ2z293"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The digital numbers are in the range from 0-10000, so we have to scale the downloaded data appropriately.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"oxcGGzXbAI"}],"key":"JTBhfxPLHz"}],"visibility":"show","key":"THlyKwj2V7"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:24.930585Z","iopub.status.busy":"2023-10-24T07:58:24.930109Z","iopub.status.idle":"2023-10-24T07:58:24.934135Z","shell.execute_reply":"2023-10-24T07:58:24.933703Z"},"papermill":{"duration":0.177238,"end_time":"2023-10-24T07:58:24.935088","exception":false,"start_time":"2023-10-24T07:58:24.757850","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_all_bands = \"\"\"\n    //VERSION=3\n    function setup() {\n        return {\n            input: [{\n                bands: [\"B01\",\"B02\",\"B03\",\"B04\",\"B05\",\"B06\",\"B07\",\"B08\",\"B8A\",\"B09\",\"B10\",\"B11\",\"B12\"],\n                units: \"DN\"\n            }],\n            output: {\n                bands: 13,\n                sampleType: \"INT16\"\n            }\n        };\n    }\n\n    function evaluatePixel(sample) {\n        return [sample.B01,\n                sample.B02,\n                sample.B03,\n                sample.B04,\n                sample.B05,\n                sample.B06,\n                sample.B07,\n                sample.B08,\n                sample.B8A,\n                sample.B09,\n                sample.B10,\n                sample.B11,\n                sample.B12];\n    }\n\"\"\"\n\nrequest_all_bands = SentinelHubRequest(\n    evalscript=evalscript_all_bands,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L1C,\n            time_interval=('2020-06-01', '2020-06-30'),\n            mosaicking_order='leastCC'\n    )],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.TIFF)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"a2Isdkpt6x"},{"type":"output","id":"zU2lBAEeiU20e8EKi1-Hy","data":[],"visibility":"show","key":"FYBcVw5j4c"}],"visibility":"show","key":"fKAU9CMwxa"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:25.246449Z","iopub.status.busy":"2023-10-24T07:58:25.246139Z","iopub.status.idle":"2023-10-24T07:58:29.591562Z","shell.execute_reply":"2023-10-24T07:58:29.591058Z"},"papermill":{"duration":4.501737,"end_time":"2023-10-24T07:58:29.593006","exception":false,"start_time":"2023-10-24T07:58:25.091269","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"all_bands_response = request_all_bands.get_data()","visibility":"show","key":"FQzAC34Sy8"},{"type":"output","id":"juTqBAqFbIm0PDJs1m3-D","data":[],"visibility":"show","key":"fO7j0qPM0R"}],"visibility":"show","key":"Dwdpoio9gl"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:29.963501Z","iopub.status.busy":"2023-10-24T07:58:29.963043Z","iopub.status.idle":"2023-10-24T07:58:30.427331Z","shell.execute_reply":"2023-10-24T07:58:30.426858Z"},"papermill":{"duration":0.630095,"end_time":"2023-10-24T07:58:30.434315","exception":false,"start_time":"2023-10-24T07:58:29.804220","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Image showing the SWIR band B12\n# Factor 1/1e4 due to the DN band values in the range 0-10000\n# Factor 3.5 to increase the brightness\nplot_image(all_bands_response[0][:, :, 12], factor=3.5/1e4, vmax=1)","visibility":"show","key":"sLXzEQx7hW"},{"type":"output","id":"nsP54tIyusE-8D-IPcw6Q","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"69b20c649f17fdf2cf95a7dc0fccbce8","path":"/notebooks_test/build/69b20c649f17fdf2cf95a7dc0fccbce8.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"PqMgUdqTEO"}],"visibility":"show","key":"ROL6EDYQp7"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:30.862665Z","iopub.status.busy":"2023-10-24T07:58:30.862154Z","iopub.status.idle":"2023-10-24T07:58:31.482062Z","shell.execute_reply":"2023-10-24T07:58:31.481547Z"},"papermill":{"duration":0.839145,"end_time":"2023-10-24T07:58:31.491142","exception":false,"start_time":"2023-10-24T07:58:30.651997","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# From raw bands we can also construct a False-Color image\n# False color image is (B03, B04, B08)\nplot_image(all_bands_response[0][:, :, [2,3,7]], factor=3.5/1e4, clip_range=(0,1))","visibility":"show","key":"kVaJVxOZie"},{"type":"output","id":"fvAV0Oetr43cYi56QkrHm","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"331dd2d9e3f90301403aa18125282a6d","path":"/notebooks_test/build/331dd2d9e3f90301403aa18125282a6d.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"F3U0zLPKdv"}],"visibility":"show","key":"VWG8hUdEZc"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.20739,"end_time":"2023-10-24T07:58:31.947717","exception":false,"start_time":"2023-10-24T07:58:31.740327","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 4: Save downloaded data to disk and read it from disk","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DbN9qqT3Dv"}],"identifier":"example-4-save-downloaded-data-to-disk-and-read-it-from-disk","label":"Example 4: Save downloaded data to disk and read it from disk","html_id":"example-4-save-downloaded-data-to-disk-and-read-it-from-disk","implicit":true,"key":"wm4MzJBBWY"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"All downloaded data can be saved to disk and later read from it. Simply specify the location on disk where data should be saved (or loaded from) via the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TXiGLQWaYZ"},{"type":"inlineCode","value":"data_folder","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WvIpPE30Uz"},{"type":"text","value":" argument of the request’s constructor. When executing the request’s ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HRqRbNWqy9"},{"type":"inlineCode","value":"get_data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YiAwwZDoza"},{"type":"text","value":" method, set the argument ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IDlX0hltMf"},{"type":"inlineCode","value":"save_data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"v29402w9VZ"},{"type":"text","value":" to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mUmTQUDcMI"},{"type":"inlineCode","value":"True","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DkXPwJEGJc"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"q10mEzh3R5"}],"key":"FDDl4syMw4"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This also means that in all the future requests for data, the request will first check the provided location if the data is already there, unless you explicitly demand to redownload the data.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"J3ESp9oiAl"}],"key":"IyO0Asq2TL"}],"visibility":"show","key":"bOqVImpQHU"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:32.386579Z","iopub.status.busy":"2023-10-24T07:58:32.386242Z","iopub.status.idle":"2023-10-24T07:58:32.389771Z","shell.execute_reply":"2023-10-24T07:58:32.389307Z"},"papermill":{"duration":0.211012,"end_time":"2023-10-24T07:58:32.390802","exception":false,"start_time":"2023-10-24T07:58:32.179790","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"request_all_bands = SentinelHubRequest(\n    data_folder='test_dir',\n    evalscript=evalscript_all_bands,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L1C,\n            time_interval=('2020-06-01', '2020-06-30'),\n            mosaicking_order='leastCC'\n    )],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.TIFF)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"Ae36gNUCzo"},{"type":"output","id":"ifmb4lrk1l6V1XDIoyY3N","data":[],"visibility":"show","key":"rbpJYoG43N"}],"visibility":"show","key":"Gw2nGNlfVe"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:32.881602Z","iopub.status.busy":"2023-10-24T07:58:32.881346Z","iopub.status.idle":"2023-10-24T07:58:36.883113Z","shell.execute_reply":"2023-10-24T07:58:36.882692Z"},"papermill":{"duration":4.26001,"end_time":"2023-10-24T07:58:36.884678","exception":false,"start_time":"2023-10-24T07:58:32.624668","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nall_bands_img = request_all_bands.get_data(save_data=True)","visibility":"show","key":"oHprc4MLj3"},{"type":"output","id":"Og5weTMCNqUHpL_zT8r_q","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 141 ms, sys: 26 ms, total: 167 ms\nWall time: 4 s\n"}],"visibility":"show","key":"FgRrOEsHBW"}],"visibility":"show","key":"UuUQkEaZP8"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:37.363448Z","iopub.status.busy":"2023-10-24T07:58:37.363170Z","iopub.status.idle":"2023-10-24T07:58:37.372692Z","shell.execute_reply":"2023-10-24T07:58:37.372183Z"},"papermill":{"duration":0.226648,"end_time":"2023-10-24T07:58:37.373812","exception":false,"start_time":"2023-10-24T07:58:37.147164","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f'The output directory has been created and a tiff file with all 13 bands was saved into ' \\\n      'the following structure:\\n')\n\nfor folder, _, filenames in os.walk(request_all_bands.data_folder):\n    for filename in filenames:\n        print(os.path.join(folder, filename))","visibility":"show","key":"Ty8I3eGDH6"},{"type":"output","id":"EUHEmvl0lEzcNm049Dnwx","data":[{"name":"stdout","output_type":"stream","text":"The output directory has been created and a tiff file with all 13 bands was saved into the following structure:\n\ntest_dir/4d34ca44cf5505abbf2690c928df83fe/response.tiff\ntest_dir/4d34ca44cf5505abbf2690c928df83fe/request.json\n"}],"visibility":"show","key":"vgvpdOpbMj"}],"visibility":"show","key":"wTs9t7BgQ9"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:37.828388Z","iopub.status.busy":"2023-10-24T07:58:37.828122Z","iopub.status.idle":"2023-10-24T07:58:37.986498Z","shell.execute_reply":"2023-10-24T07:58:37.985920Z"},"papermill":{"duration":0.38535,"end_time":"2023-10-24T07:58:37.987513","exception":false,"start_time":"2023-10-24T07:58:37.602163","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# try to re-download the data\nall_bands_img_from_disk = request_all_bands.get_data()","visibility":"show","key":"pKgijGLIeS"},{"type":"output","id":"5qi8NWaJaeR6KKJGwGpuo","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 110 ms, sys: 15.3 ms, total: 125 ms\nWall time: 155 ms\n"}],"visibility":"show","key":"MNPc0oweM6"}],"visibility":"show","key":"x8VgKqniAQ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:38.456540Z","iopub.status.busy":"2023-10-24T07:58:38.456117Z","iopub.status.idle":"2023-10-24T07:58:43.895246Z","shell.execute_reply":"2023-10-24T07:58:43.894700Z"},"papermill":{"duration":5.672089,"end_time":"2023-10-24T07:58:43.896353","exception":false,"start_time":"2023-10-24T07:58:38.224264","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# force the redownload\nall_bands_img_redownload = request_all_bands.get_data(redownload=True)","visibility":"show","key":"t0wEDNlhiZ"},{"type":"output","id":"foUePB9y6w0Shctf1a7AW","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 153 ms, sys: 11.1 ms, total: 164 ms\nWall time: 5.44 s\n"}],"visibility":"show","key":"EOVTNdnQvS"}],"visibility":"show","key":"fo0vyQdP8c"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.241312,"end_time":"2023-10-24T07:58:44.417988","exception":false,"start_time":"2023-10-24T07:58:44.176676","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 4.1: Save downloaded data directly to disk","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dmfG5Rlhh0"}],"identifier":"example-4-1-save-downloaded-data-directly-to-disk","label":"Example 4.1: Save downloaded data directly to disk","html_id":"example-4-1-save-downloaded-data-directly-to-disk","implicit":true,"key":"SqyILD3fPk"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"I8x8xDwqy0"},{"type":"inlineCode","value":"get_data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gH5fZxpoI7"},{"type":"text","value":" method returns a list of numpy arrays and can save the downloaded data to disk, as we have seen in the previous example. Sometimes it is convenient to just save the data directly to disk. You can do that by using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ICaNitbiYf"},{"type":"inlineCode","value":"save_data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MPV3GyWQuf"},{"type":"text","value":" method instead.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lPHvg4JRvZ"}],"key":"H1uGj53TAz"}],"visibility":"show","key":"UHKZFpf92c"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:44.890483Z","iopub.status.busy":"2023-10-24T07:58:44.890067Z","iopub.status.idle":"2023-10-24T07:58:44.894451Z","shell.execute_reply":"2023-10-24T07:58:44.893926Z"},"papermill":{"duration":0.216491,"end_time":"2023-10-24T07:58:44.895703","exception":false,"start_time":"2023-10-24T07:58:44.679212","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%%time\nrequest_all_bands.save_data()","visibility":"show","key":"iiyvTpCD3C"},{"type":"output","id":"MhwfXTq7xMOthXQVdGvZh","data":[{"name":"stdout","output_type":"stream","text":"CPU times: user 1.39 ms, sys: 0 ns, total: 1.39 ms\nWall time: 1.35 ms\n"}],"visibility":"show","key":"KnpKXYwh6s"}],"visibility":"show","key":"YxhU6ODwfG"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:45.386767Z","iopub.status.busy":"2023-10-24T07:58:45.386500Z","iopub.status.idle":"2023-10-24T07:58:45.400043Z","shell.execute_reply":"2023-10-24T07:58:45.399372Z"},"papermill":{"duration":0.251393,"end_time":"2023-10-24T07:58:45.401218","exception":false,"start_time":"2023-10-24T07:58:45.149825","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f'The output directory has been created and a tiff file with all 13 bands was saved into ' \\\n      'the following structure:\\n')\n\nfor folder, _, filenames in os.walk(request_all_bands.data_folder):\n    for filename in filenames:\n        print(os.path.join(folder, filename))","visibility":"show","key":"FoI5cHPHHW"},{"type":"output","id":"2lA4NTh4NBaHpbaeE9OVf","data":[{"name":"stdout","output_type":"stream","text":"The output directory has been created and a tiff file with all 13 bands was saved into the following structure:\n\ntest_dir/4d34ca44cf5505abbf2690c928df83fe/response.tiff\ntest_dir/4d34ca44cf5505abbf2690c928df83fe/request.json\n"}],"visibility":"show","key":"FSSNIBzHIn"}],"visibility":"show","key":"z21Hr4zMey"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.234628,"end_time":"2023-10-24T07:58:45.871433","exception":false,"start_time":"2023-10-24T07:58:45.636805","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 5: Request other data collections supported by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CRaLUrdCjX"},{"type":"inlineCode","value":"sh-py","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rDqHDVqBKD"}],"identifier":"example-5-request-other-data-collections-supported-by-sh-py","label":"Example 5: Request other data collections supported by sh-py","html_id":"example-5-request-other-data-collections-supported-by-sh-py","implicit":true,"key":"rk9JnYHxea"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UbzBqbZ8qY"},{"type":"inlineCode","value":"sentinelhub-py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zFRdKWgZLD"},{"type":"text","value":" package supports various data collections. The example below is shown for one of them, but the process is the same for all of them.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xSDSrqufho"}],"key":"YkDh3WuCSF"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Note: For more examples and information check the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xef1xB3Ol3"},{"type":"link","url":"https://sentinelhub-py.readthedocs.io/en/latest/examples/data_collections.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"tutorial about data collections","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Q5x7Zjxstm"}],"urlSource":"https://sentinelhub-py.readthedocs.io/en/latest/examples/data_collections.html","key":"NrPGmj3kBT"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HYFS3TRCP9"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/data/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Sentinel Hub documentation about data collections","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"iK0nXvYAfc"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/data/","key":"C11LzWQy8m"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Ldw58PNerT"}],"key":"piKSC50OSO"}],"key":"nHWKVQDHUs"}],"visibility":"show","key":"nUq7dv7Bmd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:46.356779Z","iopub.status.busy":"2023-10-24T07:58:46.356191Z","iopub.status.idle":"2023-10-24T07:58:46.360157Z","shell.execute_reply":"2023-10-24T07:58:46.359619Z"},"papermill":{"duration":0.235303,"end_time":"2023-10-24T07:58:46.361427","exception":false,"start_time":"2023-10-24T07:58:46.126124","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"print('Supported DataCollections:\\n')\nfor collection in DataCollection.get_available_collections():\n    print(collection)","visibility":"show","key":"yXzdkI2HNh"},{"type":"output","id":"qxJPzNyMpNf2JFdEBIlv8","data":[{"name":"stdout","output_type":"stream","text":"Supported DataCollections:\n\nDataCollection.SENTINEL2_L1C\nDataCollection.SENTINEL2_L2A\nDataCollection.SENTINEL1\nDataCollection.SENTINEL1_IW\nDataCollection.SENTINEL1_IW_ASC\nDataCollection.SENTINEL1_IW_DES\nDataCollection.SENTINEL1_EW\nDataCollection.SENTINEL1_EW_ASC\nDataCollection.SENTINEL1_EW_DES\nDataCollection.SENTINEL1_EW_SH\nDataCollection.SENTINEL1_EW_SH_ASC\nDataCollection.SENTINEL1_EW_SH_DES\nDataCollection.DEM\nDataCollection.DEM_MAPZEN\nDataCollection.DEM_COPERNICUS_30\nDataCollection.DEM_COPERNICUS_90\nDataCollection.MODIS\nDataCollection.LANDSAT_MSS_L1\nDataCollection.LANDSAT_TM_L1\nDataCollection.LANDSAT_TM_L2\nDataCollection.LANDSAT_ETM_L1\nDataCollection.LANDSAT_ETM_L2\nDataCollection.LANDSAT_OT_L1\nDataCollection.LANDSAT_OT_L2\nDataCollection.SENTINEL5P\nDataCollection.SENTINEL3_OLCI\nDataCollection.SENTINEL3_SLSTR\nDataCollection.HARMONIZED_LANDSAT_SENTINEL\n"}],"visibility":"show","key":"U5cqYD93Kk"}],"visibility":"show","key":"inUHxfqK6h"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.240947,"end_time":"2023-10-24T07:58:46.861365","exception":false,"start_time":"2023-10-24T07:58:46.620418","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For this example let’s download the digital elevation model data (DEM). The process is similar as before, we just provide the evalscript and create the request. More data on the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mbcGDRsWuV"},{"type":"inlineCode","value":"DEM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IAPNKgv4Vd"},{"type":"text","value":" data collection is available ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OtzqLeOGPa"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/#/data/DEM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T01pWCz3mX"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/#/data/DEM","key":"gVuIHBuc8G"},{"type":"text","value":". ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vYLGGIHfpp"},{"type":"inlineCode","value":"DEM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z25XfPZKFE"},{"type":"text","value":" values are in meters and can be negative for areas which lie below sea level, so it is recommended to set the output format in your evalscript to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ee5xY8wT8J"},{"type":"inlineCode","value":"FLOAT32","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CWHaSBzU8B"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RlBeXzdNXp"}],"key":"AGftyZTjpt"}],"visibility":"show","key":"gOqY7HYMUf"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:47.339683Z","iopub.status.busy":"2023-10-24T07:58:47.339183Z","iopub.status.idle":"2023-10-24T07:58:47.342272Z","shell.execute_reply":"2023-10-24T07:58:47.341758Z"},"papermill":{"duration":0.236946,"end_time":"2023-10-24T07:58:47.343339","exception":false,"start_time":"2023-10-24T07:58:47.106393","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript_dem = '''\n//VERSION=3\nfunction setup() {\n  return {\n    input: [\"DEM\"],\n    output:{\n      id: \"default\",\n      bands: 1,\n      sampleType: SampleType.FLOAT32\n    }\n  }\n}\n\nfunction evaluatePixel(sample) {\n  return [sample.DEM]\n}\n'''","visibility":"show","key":"pN6mgIsFKp"},{"type":"output","id":"OtJIl7_ZNAho6U9y6skQ9","data":[],"visibility":"show","key":"XbaAYFwYwC"}],"visibility":"show","key":"WFSkFqNLj2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:47.827899Z","iopub.status.busy":"2023-10-24T07:58:47.827316Z","iopub.status.idle":"2023-10-24T07:58:47.831465Z","shell.execute_reply":"2023-10-24T07:58:47.831005Z"},"papermill":{"duration":0.240012,"end_time":"2023-10-24T07:58:47.832621","exception":false,"start_time":"2023-10-24T07:58:47.592609","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"dem_request = SentinelHubRequest(\n    evalscript=evalscript_dem,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.DEM,\n            time_interval=('2020-06-12', '2020-06-13'),\n    )\n    ],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.TIFF)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"V98fXK9EeG"},{"type":"output","id":"ujXKO8o0IaaJxqiNwVd8a","data":[],"visibility":"show","key":"B2GkhxLqtr"}],"visibility":"show","key":"iEUhIiCjLq"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:48.301435Z","iopub.status.busy":"2023-10-24T07:58:48.300968Z","iopub.status.idle":"2023-10-24T07:58:49.524209Z","shell.execute_reply":"2023-10-24T07:58:49.523751Z"},"papermill":{"duration":1.451687,"end_time":"2023-10-24T07:58:49.526186","exception":false,"start_time":"2023-10-24T07:58:48.074499","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"dem_data = dem_request.get_data()","visibility":"show","key":"PVX7dY1ElM"},{"type":"output","id":"AIiLrtpn7h0XvBNFxD64g","data":[],"visibility":"show","key":"cJfWfixje4"}],"visibility":"show","key":"SczTAAGihu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:49.991133Z","iopub.status.busy":"2023-10-24T07:58:49.990720Z","iopub.status.idle":"2023-10-24T07:58:50.317452Z","shell.execute_reply":"2023-10-24T07:58:50.317037Z"},"papermill":{"duration":0.548964,"end_time":"2023-10-24T07:58:50.320298","exception":false,"start_time":"2023-10-24T07:58:49.771334","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Plot DEM map\n# vmin = 0; cutoff at sea level (0 m)\n# vmax = 120; cutoff at high values (120 m)\nplot_image(dem_data[0], factor=1.0, cmap=plt.cm.Greys_r, vmin=0, vmax=120)","visibility":"show","key":"vyKGNKijsc"},{"type":"output","id":"l-WUcZFblW8lnlxe8hEtE","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2a682b1635f3c4a62e35abf11409f279","path":"/notebooks_test/build/2a682b1635f3c4a62e35abf11409f279.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"VcdpFWGKmt"}],"visibility":"show","key":"YFYHRz7XWZ"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.238989,"end_time":"2023-10-24T07:58:50.817639","exception":false,"start_time":"2023-10-24T07:58:50.578650","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 6: Multi-response request","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ePxuMRccuo"}],"identifier":"example-6-multi-response-request","label":"Example 6: Multi-response request","html_id":"example-6-multi-response-request","implicit":true,"key":"gFjf8hgNN5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Process API enables downloading multiple files in one response, packed together in a TAR archive.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fcOOmOSByM"}],"key":"S4rJz41Ojv"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We will get the same image as before, download in the form of digital numbers (DN) as a UINT16 TIFF file. Along with the image we will download the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Lx04zIUvQP"},{"type":"inlineCode","value":"inputMetadata","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XgII7xggJv"},{"type":"text","value":" which contains the normalization factor value in a JSON format.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zMNOHuLkvk"}],"key":"FaHAlxzmtt"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"After the download we will be able to convert the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xanrvgeYU4"},{"type":"inlineCode","value":"INT16","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jsqONdruON"},{"type":"text","value":" digital numbers to get the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"lucKXWcO69"},{"type":"inlineCode","value":"FLOAT32","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"M029c4I7e0"},{"type":"text","value":" reflectances.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"B6tU2NQQSg"}],"key":"kzycKmouCI"}],"visibility":"show","key":"e25j3BPtbp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:51.307893Z","iopub.status.busy":"2023-10-24T07:58:51.307468Z","iopub.status.idle":"2023-10-24T07:58:51.311224Z","shell.execute_reply":"2023-10-24T07:58:51.310809Z"},"papermill":{"duration":0.243238,"end_time":"2023-10-24T07:58:51.312640","exception":false,"start_time":"2023-10-24T07:58:51.069402","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript = \"\"\"\n    //VERSION=3\n\n    function setup() {\n        return {\n            input: [{\n                bands: [\"B02\", \"B03\", \"B04\"],\n                units: \"DN\"\n            }],\n            output: {\n                bands: 3,\n                sampleType: \"INT16\"\n            }\n        };\n    }\n\n    function updateOutputMetadata(scenes, inputMetadata, outputMetadata) {\n        outputMetadata.userData = { \"norm_factor\":  inputMetadata.normalizationFactor }\n    }\n\n    function evaluatePixel(sample) {\n        return [sample.B04, sample.B03, sample.B02];\n    }\n\"\"\"\n\nrequest_multitype = SentinelHubRequest(\n    evalscript=evalscript,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L1C,\n            time_interval=('2020-06-01', '2020-06-30'),\n            mosaicking_order='leastCC'\n        )\n    ],\n    responses=[\n        SentinelHubRequest.output_response('default', MimeType.TIFF),\n        SentinelHubRequest.output_response('userdata', MimeType.JSON)\n    ],\n    bbox=betsiboka_bbox,\n    size=betsiboka_size,\n    config=config\n)","visibility":"show","key":"inScgstv2z"},{"type":"output","id":"qDAQ_80GcyfMpVUkQft1R","data":[],"visibility":"show","key":"s53JQmGaX2"}],"visibility":"show","key":"JwF8u8T1w5"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:51.811918Z","iopub.status.busy":"2023-10-24T07:58:51.811393Z","iopub.status.idle":"2023-10-24T07:58:53.044049Z","shell.execute_reply":"2023-10-24T07:58:53.043553Z"},"papermill":{"duration":1.47041,"end_time":"2023-10-24T07:58:53.045218","exception":false,"start_time":"2023-10-24T07:58:51.574808","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# print out information\nmulti_data = request_multitype.get_data()[0]\nmulti_data.keys()","visibility":"show","key":"bffCBMZAlZ"},{"type":"output","id":"UbkZ1vcakNajzSwDhxgyr","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/plain":{"content":"dict_keys(['default.tif', 'userdata.json'])","content_type":"text/plain"}}}],"visibility":"show","key":"v4SobTZYBq"}],"visibility":"show","key":"Afri1N1Ywp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:53.571721Z","iopub.status.busy":"2023-10-24T07:58:53.571270Z","iopub.status.idle":"2023-10-24T07:58:53.575388Z","shell.execute_reply":"2023-10-24T07:58:53.574964Z"},"papermill":{"duration":0.28882,"end_time":"2023-10-24T07:58:53.576868","exception":false,"start_time":"2023-10-24T07:58:53.288048","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# normalize image\nimg = multi_data['default.tif']\nnorm_factor = multi_data['userdata.json']['norm_factor']\n\nimg_float32 = img * norm_factor","visibility":"show","key":"UY1TVfJJ6B"},{"type":"output","id":"KbuabXIyqgqNFCPhzRdaF","data":[],"visibility":"show","key":"Vd67PAyO2P"}],"visibility":"show","key":"L06lvcF7el"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:54.066725Z","iopub.status.busy":"2023-10-24T07:58:54.066112Z","iopub.status.idle":"2023-10-24T07:58:54.746026Z","shell.execute_reply":"2023-10-24T07:58:54.745572Z"},"papermill":{"duration":0.919051,"end_time":"2023-10-24T07:58:54.755429","exception":false,"start_time":"2023-10-24T07:58:53.836378","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_image(img_float32, factor=3.5, clip_range=(0, 1))","visibility":"show","key":"rpTQthH7Dg"},{"type":"output","id":"AlmwOvXNR7VmsuF6omilD","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3507c6173d8238b3fd0018b749a79dd9","path":"/notebooks_test/build/3507c6173d8238b3fd0018b749a79dd9.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"fU4jfNLbF2"}],"visibility":"show","key":"cbUdLXIJpx"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.26274,"end_time":"2023-10-24T07:58:55.310679","exception":false,"start_time":"2023-10-24T07:58:55.047939","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 7: Request with a raw dictionary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mgik8rr6uq"}],"identifier":"example-7-request-with-a-raw-dictionary","label":"Example 7: Request with a raw dictionary","html_id":"example-7-request-with-a-raw-dictionary","implicit":true,"key":"al5xTmSy3Y"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"All requests so far were built with some helper functions. We can also construct a raw dictionary as defined in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VjPEXLrPRV"},{"type":"link","url":"https://docs.sentinel-hub.com/api/latest/reference/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"API Reference","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"szaoO9Lnmp"}],"urlSource":"https://docs.sentinel-hub.com/api/latest/reference/","key":"LfMhs3WQmA"},{"type":"text","value":", without these helper functions, so we have full control over building the request body.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qcgwQz1laS"}],"key":"drbZPngp4u"}],"visibility":"show","key":"RGwZc3n7LG"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:55.895161Z","iopub.status.busy":"2023-10-24T07:58:55.894814Z","iopub.status.idle":"2023-10-24T07:58:55.898654Z","shell.execute_reply":"2023-10-24T07:58:55.898230Z"},"papermill":{"duration":0.28599,"end_time":"2023-10-24T07:58:55.899609","exception":false,"start_time":"2023-10-24T07:58:55.613619","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"request_raw_dict = {\n    \"input\": {\n        \"bounds\": {\n            \"properties\": {\n                \"crs\": betsiboka_bbox.crs.opengis_string\n            },\n            \"bbox\": list(betsiboka_bbox)\n        },\n        \"data\": [\n            {\n                \"type\": \"S2L1C\",\n                \"dataFilter\": {\n                    \"timeRange\": {\"from\": '2020-06-01T00:00:00Z', \"to\": '2020-06-30T00:00:00Z'},\n                    \"mosaickingOrder\": \"leastCC\",\n                }\n            }\n        ]\n    },\n    \"output\": {\n        \"width\": betsiboka_size[0],\n        \"height\": betsiboka_size[1],\n        \"responses\": [\n            {\n                \"identifier\": \"default\",\n                \"format\": {\n                    'type': MimeType.TIFF.get_string()\n                }\n            }\n        ]\n    },\n    \"evalscript\": evalscript_true_color\n}","visibility":"show","key":"HzNkh0dS22"},{"type":"output","id":"DtSonRRq6HQrUdr5yzwb0","data":[],"visibility":"show","key":"ayDn1o5s0S"}],"visibility":"show","key":"jbxaHbhPOC"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:56.424445Z","iopub.status.busy":"2023-10-24T07:58:56.423884Z","iopub.status.idle":"2023-10-24T07:58:57.276025Z","shell.execute_reply":"2023-10-24T07:58:57.275591Z"},"papermill":{"duration":1.104523,"end_time":"2023-10-24T07:58:57.277474","exception":false,"start_time":"2023-10-24T07:58:56.172951","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# create request\ndownload_request = DownloadRequest(\n    request_type='POST',\n    url=\"https://services.sentinel-hub.com/api/v1/process\",\n    post_values=request_raw_dict,\n    data_type=MimeType.TIFF,\n    headers={'content-type': 'application/json'},\n    use_session=True\n)\n\n# execute request\nclient = SentinelHubDownloadClient(config=config)\nimg = client.download(download_request)","visibility":"show","key":"u8oMUbWXAv"},{"type":"output","id":"Xmm4xkfzHQBKxwVuSCDnH","data":[{"name":"stderr","output_type":"stream","text":"/home/conda/20a41cef-8d63-4030-9e37-aa3412866cee/60a7fe77bf15cdba38ca795208c44847e274649eaaa525aeefa5bf7a3f7692e0-20231023-081922-894744-312-bm-test-edc-2023.10-01/lib/python3.11/site-packages/sentinelhub/download/client.py:78: SHDeprecationWarning: The parameter `download_requests` should be a sequence of requests. In future versions download of single requests will only be supported if provided as a singelton tuple or list.\n  warnings.warn(\n"}],"visibility":"show","key":"Kexe0Of2t9"}],"visibility":"show","key":"SslhGgm6g0"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:57.810223Z","iopub.status.busy":"2023-10-24T07:58:57.809843Z","iopub.status.idle":"2023-10-24T07:58:58.466505Z","shell.execute_reply":"2023-10-24T07:58:58.466084Z"},"papermill":{"duration":0.912216,"end_time":"2023-10-24T07:58:58.473503","exception":false,"start_time":"2023-10-24T07:58:57.561287","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_image(img, factor=3.5/255, clip_range=(0,1))","visibility":"show","key":"F8k7eNz3PH"},{"type":"output","id":"BmO0sT9WrQwXLqppyFvUU","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9c3a0f7e7f03b678f292f3d756e7ebf4","path":"/notebooks_test/build/9c3a0f7e7f03b678f292f3d756e7ebf4.png"},"text/plain":{"content":"<Figure size 1500x1500 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"swlM8y4l8M"}],"visibility":"show","key":"ETvqHS5qPG"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.281786,"end_time":"2023-10-24T07:58:59.064993","exception":false,"start_time":"2023-10-24T07:58:58.783207","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example 8: Request multiple timestamps data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EZoAV2eSka"}],"identifier":"example-8-request-multiple-timestamps-data","label":"Example 8: Request multiple timestamps data","html_id":"example-8-request-multiple-timestamps-data","implicit":true,"key":"YAnlBJz2Qw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"It is possible to construct some logic in order to return data for multiple timestamps. By defining the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rO8efYEb2o"},{"type":"inlineCode","value":"time_interval","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WnUtmblC2G"},{"type":"text","value":" parameter and some logic of splitting it, it is possible to create an SH reques per each “time slot” and then download the data from all the requests with the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PLj1fW6FwO"},{"type":"inlineCode","value":"SentinelHubDownloadClient","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TjrnVipcxv"},{"type":"text","value":" in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TwH0ntLjhA"},{"type":"inlineCode","value":"sentinelhub-py","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UGzVHJtUKl"},{"type":"text","value":". In this example we will create least cloudy monthly images for the year 2019.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dYUI5c8nsz"}],"key":"zBg3gfhHgR"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"However, this is already a functionality built on top of this SH API package. We have extended the support for such usage in our package ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GwFKVHGXLg"},{"type":"link","url":"https://github.com/sentinel-hub/eo-learn","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"eo-learn","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hZP52wwZnk"}],"urlSource":"https://github.com/sentinel-hub/eo-learn","error":true,"key":"YadNEc7CWO"},{"type":"text","value":". We recommend to use ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yJQpy5hhRR"},{"type":"inlineCode","value":"eo-learn","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dDG6DcOlB7"},{"type":"text","value":" for more complex cases where you need multiple timestamps or high-resolution data for larger areas.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YX394RebcO"}],"key":"s4eZdL1aO3"}],"visibility":"show","key":"VpPfh91EWi"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:58:59.708856Z","iopub.status.busy":"2023-10-24T07:58:59.708397Z","iopub.status.idle":"2023-10-24T07:58:59.715809Z","shell.execute_reply":"2023-10-24T07:58:59.715341Z"},"papermill":{"duration":0.287743,"end_time":"2023-10-24T07:58:59.717033","exception":false,"start_time":"2023-10-24T07:58:59.429290","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"start = datetime.datetime(2019,1,1)\nend = datetime.datetime(2019,12,31)\nn_chunks = 13\ntdelta = (end - start) / n_chunks\nedges = [(start + i*tdelta).date().isoformat() for i in range(n_chunks)]\nslots = [(edges[i], edges[i+1]) for i in range(len(edges)-1)]\n\nprint('Monthly time windows:\\n')\nfor slot in slots:\n    print(slot)","visibility":"show","key":"STUzCGOWXP"},{"type":"output","id":"FJayUN7yEUlYTzmVIiU6I","data":[{"name":"stdout","output_type":"stream","text":"Monthly time windows:\n\n('2019-01-01', '2019-01-29')\n('2019-01-29', '2019-02-26')\n('2019-02-26', '2019-03-26')\n('2019-03-26', '2019-04-23')\n('2019-04-23', '2019-05-21')\n('2019-05-21', '2019-06-18')\n('2019-06-18', '2019-07-16')\n('2019-07-16', '2019-08-13')\n('2019-08-13', '2019-09-10')\n('2019-09-10', '2019-10-08')\n('2019-10-08', '2019-11-05')\n('2019-11-05', '2019-12-03')\n"}],"visibility":"show","key":"QbV2Rbbs55"}],"visibility":"show","key":"v6OjJ2Blw0"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:59:00.342060Z","iopub.status.busy":"2023-10-24T07:59:00.341644Z","iopub.status.idle":"2023-10-24T07:59:00.344948Z","shell.execute_reply":"2023-10-24T07:59:00.344528Z"},"papermill":{"duration":0.285921,"end_time":"2023-10-24T07:59:00.345880","exception":false,"start_time":"2023-10-24T07:59:00.059959","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def get_true_color_request(time_interval):\n    return SentinelHubRequest(\n        evalscript=evalscript_true_color,\n        input_data=[\n            SentinelHubRequest.input_data(\n                data_collection=DataCollection.SENTINEL2_L1C,\n                time_interval=time_interval,\n                mosaicking_order='leastCC'\n            )\n        ],\n        responses=[\n            SentinelHubRequest.output_response('default', MimeType.PNG)\n        ],\n        bbox=betsiboka_bbox,\n        size=betsiboka_size,\n        config=config\n    )","visibility":"show","key":"XGUGQapp7q"},{"type":"output","id":"or-Z3TI4Z4FOce6abtIKk","data":[],"visibility":"show","key":"KGuZ48M9As"}],"visibility":"show","key":"kZmNCipVEa"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:59:00.987296Z","iopub.status.busy":"2023-10-24T07:59:00.986928Z","iopub.status.idle":"2023-10-24T07:59:06.109827Z","shell.execute_reply":"2023-10-24T07:59:06.109199Z"},"papermill":{"duration":5.406415,"end_time":"2023-10-24T07:59:06.111345","exception":false,"start_time":"2023-10-24T07:59:00.704930","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# create a list of requests\nlist_of_requests = [get_true_color_request(slot) for slot in slots]\nlist_of_requests = [request.download_list[0] for request in list_of_requests]\n\n# download data with multiple threads\ndata = SentinelHubDownloadClient(config=config).download(list_of_requests, max_threads=5)","visibility":"show","key":"a40dNwqbfp"},{"type":"output","id":"VrDmymwik7a4sgEVIR7RF","data":[],"visibility":"show","key":"IhkbAIrGkt"}],"visibility":"show","key":"BvPGE8bfV5"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-10-24T07:59:06.699774Z","iopub.status.busy":"2023-10-24T07:59:06.699285Z","iopub.status.idle":"2023-10-24T07:59:08.942736Z","shell.execute_reply":"2023-10-24T07:59:08.942242Z"},"papermill":{"duration":2.546323,"end_time":"2023-10-24T07:59:08.955558","exception":false,"start_time":"2023-10-24T07:59:06.409235","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# some stuff for pretty plots\nncols = 4\nnrows = 3\naspect_ratio = betsiboka_size[0] / betsiboka_size[1]\nsubplot_kw = {'xticks': [], 'yticks': [], 'frame_on': False}\n\nfig, axs = plt.subplots(ncols=ncols, nrows=nrows, figsize=(5 * ncols * aspect_ratio, 5 * nrows),\n                        subplot_kw=subplot_kw)\n\nfor idx, image in enumerate(data):\n    ax = axs[idx // ncols][idx % ncols]\n    ax.imshow(np.clip(image * 2.5/255, 0, 1))\n    ax.set_title(f'{slots[idx][0]}  -  {slots[idx][1]}', fontsize=10)\n\nplt.tight_layout()","visibility":"show","key":"yIKL5gZwaS"},{"type":"output","id":"HvLzvGXp-YMDnlPJ7g6Ol","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b10c454ccb423435bdc768f4b5d29050","path":"/notebooks_test/build/b10c454ccb423435bdc768f4b5d29050.png"},"text/plain":{"content":"<Figure size 1205.35x1500 with 12 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"aRkUQyiyBL"}],"visibility":"show","key":"Jv9PIP6IHu"}],"key":"SwgpJDPgPN"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"How to access DEM data through Sentinel Hub API","url":"/external-notebooks/eurodatacube/notebooks/notebooks/curated/how-to-access-dem-data-through-sentinel-hub-api","group":"Curated"},"next":{"title":"📘 Example Notebook 1","url":"/notebooks/example1","group":"Notebooks"}}},"domain":"http://localhost:3000"}