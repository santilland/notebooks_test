<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Truck Detection Exercise - Location for eodashboard notebooks</title><meta property="og:title" content="Truck Detection Exercise - Location for eodashboard notebooks"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><link rel="stylesheet" href="/notebooks_test/build/_assets/app-HG4THSM4.css"/><link rel="stylesheet" href="/notebooks_test/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/notebooks_test/favicon.ico"/><link rel="stylesheet" href="/notebooks_test/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/notebooks_test/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R3iop:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode." aria-label="Toggle theme between light and dark mode."><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><article class="article content article-grid grid-gap"><main class="article-grid subgrid-gap col-screen"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://github.com/eoxhub-workspaces/documentation/" title="GitHub Repository: eoxhub-workspaces/documentation/" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rd4fop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Truck Detection Exercise</h1></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="EBdmvhfXhw" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from edc import check_compatibility
check_compatibility(&quot;user-2022.10-14&quot;, dependencies=[&quot;SH&quot;])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Xpo9bWJzd6hECtQ8mIkDZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="qWnTA0ZVxW" class="relative group/block"><h1 id="truck-detection-exercise" class="relative group"><span class="heading-text">Truck Detection Exercise</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#truck-detection-exercise" title="Link to this Section" aria-label="Link to this Section">¶</a></h1></div><div id="K5eNH75l4A" class="relative group/block"><h1 id="detect-trucks-using-sentinel-2-data-user-guide" class="relative group"><span class="heading-text">Detect Trucks using Sentinel-2 data user guide</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#detect-trucks-using-sentinel-2-data-user-guide" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><h2 id="parallax-based-truck-detection" class="relative group"><span class="heading-text">Parallax-based truck detection</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#parallax-based-truck-detection" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><hr class="py-2 my-5 translate-y-2"/><p>This notebook is a comprehensive script for detecting trucks with Sentinel-2 data. In order to run the detection in your area of interest you will have to modify two cells:</p><ol start="1"><li>Area of Interest (specify the aoi as bounding box)</li><li>Date (specify an acquisition date)</li></ol><p>Afterwards, you may simply run all cells and check the result at the end of the script where you can also write the detections as points.</p><p>Ensure that you have access to the Sentinel Hub resources for retrieving Sentinel-2 data through its API (via xcube_sh).</p><p>Author: Henrik Fisser, 2020<br/>Explanations on the truck detection on GitHub: <a target="_blank" rel="noreferrer" href="https://github.com/hfisser/Truck_Detection_Sentinel2_COVID19" class="">https://<wbr/>github<wbr/>.com<wbr/>/hfisser<wbr/>/Truck<wbr/>_Detection<wbr/>_Sentinel2<wbr/>_COVID19</a></p></div><div id="L0ATrj2IfV" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import os
import subprocess
import sys

# installations
def install_package(pkg):
    subprocess.check_call([sys.executable, &quot;-m&quot;, &quot;pip&quot;, &quot;install&quot;, pkg])
install_package(&quot;OSMPythonTools&quot;)
install_package(&quot;geocube&quot;)

# OSM API
from OSMPythonTools.overpass import overpassQueryBuilder, Overpass

import numpy as np
import xarray as xr
import geocube
import geopandas as gpd
import pandas as pd
from xcube_sh.cube import open_cube
from xcube_sh.config import CubeConfig
from xcube.core.maskset import MaskSet
from rasterio import features
from affine import Affine
from shapely import geometry, coords
from shapely.geometry import Polygon, Point, box
from numba import jit

import IPython.display
%matplotlib inline</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="M86ojhl1h8ciTvaWJh0Y9" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Collecting OSMPythonTools
  Downloading OSMPythonTools-0.3.5.tar.gz (28 kB)
  Preparing metadata (setup.py): started
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  Preparing metadata (setup.py): finished with status &#x27;done&#x27;
Requirement already satisfied: beautifulsoup4 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from OSMPythonTools) (4.11.1)
Requirement already satisfied: geojson in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from OSMPythonTools) (2.5.0)
Requirement already satisfied: lxml in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from OSMPythonTools) (4.9.1)
Requirement already satisfied: matplotlib in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from OSMPythonTools) (3.6.1)
Requirement already satisfied: numpy in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from OSMPythonTools) (1.23.3)
Requirement already satisfied: pandas in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from OSMPythonTools) (1.5.0)
Collecting ujson
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  Downloading ujson-5.5.0-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (46 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 46.1/46.1 kB 8.3 MB/s eta 0:00:00
Requirement already satisfied: xarray in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from OSMPythonTools) (2022.9.0)
Requirement already satisfied: soupsieve&gt;1.2 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from beautifulsoup4-&gt;OSMPythonTools) (2.3.2.post1)
Requirement already satisfied: pillow&gt;=6.2.0 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from matplotlib-&gt;OSMPythonTools) (9.2.0)
Requirement already satisfied: fonttools&gt;=4.22.0 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from matplotlib-&gt;OSMPythonTools) (4.37.4)
Requirement already satisfied: cycler&gt;=0.10 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from matplotlib-&gt;OSMPythonTools) (0.11.0)
Requirement already satisfied: contourpy&gt;=1.0.1 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from matplotlib-&gt;OSMPythonTools) (1.0.5)
Requirement already satisfied: python-dateutil&gt;=2.7 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from matplotlib-&gt;OSMPythonTools) (2.8.2)
Requirement already satisfied: packaging&gt;=20.0 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from matplotlib-&gt;OSMPythonTools) (21.3)
Requirement already satisfied: pyparsing&gt;=2.2.1 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from matplotlib-&gt;OSMPythonTools) (3.0.9)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from matplotlib-&gt;OSMPythonTools) (1.4.4)
Requirement already satisfied: pytz&gt;=2020.1 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from pandas-&gt;OSMPythonTools) (2022.4)
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Requirement already satisfied: six&gt;=1.5 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib-&gt;OSMPythonTools) (1.16.0)
Building wheels for collected packages: OSMPythonTools
  Building wheel for OSMPythonTools (setup.py): started
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  Building wheel for OSMPythonTools (setup.py): finished with status &#x27;done&#x27;
  Created wheel for OSMPythonTools: filename=OSMPythonTools-0.3.5-py3-none-any.whl size=32717 sha256=1dd60ca069c3595d49c3dd814eeab6f9547671147edf2bdd369ebbbfe470cf94
  Stored in directory: /home/jovyan/.cache/pip/wheels/24/da/ad/aff21ba9e9c127c4997d1f9b0251f17c5c13373524297ae6bd
Successfully built OSMPythonTools
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Installing collected packages: ujson, OSMPythonTools
Successfully installed OSMPythonTools-0.3.5 ujson-5.5.0
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Collecting geocube
  Downloading geocube-0.3.3-py3-none-any.whl (20 kB)
Requirement already satisfied: numpy&gt;=1.20 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geocube) (1.23.3)
Requirement already satisfied: rasterio in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geocube) (1.3.2)
Requirement already satisfied: rioxarray&gt;=0.4 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geocube) (0.12.2)
Requirement already satisfied: click&gt;=6.0 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geocube) (8.0.4)
Requirement already satisfied: pyproj&gt;=2 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geocube) (3.4.0)
Requirement already satisfied: xarray&gt;=0.17 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geocube) (2022.9.0)
Requirement already satisfied: appdirs in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geocube) (1.4.4)
Requirement already satisfied: scipy in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geocube) (1.9.1)
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Collecting odc-geo
  Downloading odc_geo-0.3.0-py3-none-any.whl (114 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 114.0/114.0 kB 14.7 MB/s eta 0:00:00
Requirement already satisfied: geopandas&gt;=0.7 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geocube) (0.11.1)
Requirement already satisfied: packaging in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geopandas&gt;=0.7-&gt;geocube) (21.3)
Requirement already satisfied: shapely&lt;2,&gt;=1.7 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geopandas&gt;=0.7-&gt;geocube) (1.8.5)
Requirement already satisfied: pandas&gt;=1.0.0 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geopandas&gt;=0.7-&gt;geocube) (1.5.0)
Requirement already satisfied: fiona&gt;=1.8 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geopandas&gt;=0.7-&gt;geocube) (1.8.21)
Requirement already satisfied: certifi in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from pyproj&gt;=2-&gt;geocube) (2022.9.24)
Requirement already satisfied: attrs in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from rasterio-&gt;geocube) (22.1.0)
Requirement already satisfied: snuggs&gt;=1.4.1 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from rasterio-&gt;geocube) (1.4.7)
Requirement already satisfied: setuptools in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from rasterio-&gt;geocube) (65.4.1)
Requirement already satisfied: cligj&gt;=0.5 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from rasterio-&gt;geocube) (0.7.2)
Requirement already satisfied: affine in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from rasterio-&gt;geocube) (2.3.1)
Requirement already satisfied: click-plugins in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from rasterio-&gt;geocube) (1.1.1)
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Requirement already satisfied: cachetools in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from odc-geo-&gt;geocube) (5.2.0)
Requirement already satisfied: six&gt;=1.7 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from fiona&gt;=1.8-&gt;geopandas&gt;=0.7-&gt;geocube) (1.16.0)
Requirement already satisfied: munch in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from fiona&gt;=1.8-&gt;geopandas&gt;=0.7-&gt;geocube) (2.5.0)
Requirement already satisfied: pyparsing!=3.0.5,&gt;=2.0.2 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from packaging-&gt;geopandas&gt;=0.7-&gt;geocube) (3.0.9)
Requirement already satisfied: python-dateutil&gt;=2.8.1 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from pandas&gt;=1.0.0-&gt;geopandas&gt;=0.7-&gt;geocube) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from pandas&gt;=1.0.0-&gt;geopandas&gt;=0.7-&gt;geocube) (2022.4)
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Installing collected packages: odc-geo, geocube
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Successfully installed geocube-0.3.3 odc-geo-0.3.0
</span></code></pre></div></div></div><div id="j3P54gv5qR" class="relative group/block"><h2 id="area-of-interest" class="relative group"><span class="heading-text">Area of Interest</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#area-of-interest" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Specify an area of interest as bounding box in format:<br/>xmin, ymin, ymax, ymax</p></div><div id="he9xXl2fXR" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">bbox = 101.607,3.0500, 101.7507, 3.20, # Kuala Lumpur
kualalumpur_bbox = [101.607,3.0500, 101.7507, 3.20]
IPython.display.GeoJSON(box(*bbox).__geo_interface__)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Ei9b1huwr-I7_fzmZ8IaL" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="Djnr5jD5YE" class="relative group/block"><p>Other AOIs can be generated here, just remeber toc change bbox in the code accrodingly</p></div><div id="dbyJJERFSv" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># bbox = -3.85, 40.3, -3.55, 40.5 # Madrid
# Madrid_bbox = [-3.85, 40.3, -3.55, 40.5]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="kur0W4LCaVgegIq7CNbwc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="JRGmeKe01v" class="relative group/block"><h2 id="date" class="relative group"><span class="heading-text">Date</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#date" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Select a cloud-free acquisition and provide the date as “YYYY-MM-DD”.
You may select data e.g. here:<br/><strong>Copernicus Open Access Hub</strong>
<a target="_blank" rel="noreferrer" href="https://scihub.copernicus.eu/dhus/#/home" class="">https://<wbr/>scihub<wbr/>.copernicus<wbr/>.eu<wbr/>/dhus<wbr/>/<wbr/>#<wbr/>/home</a> <br/><strong>EO Browser</strong>
<a target="_blank" rel="noreferrer" href="https://apps.sentinel-hub.com/eo-browser/?zoom=10&amp;lat=41.9&amp;lng=12.5&amp;themeId=DEFAULT-THEME" class="">https://<wbr/>apps<wbr/>.sentinel<wbr/>-hub<wbr/>.com<wbr/>/eo<wbr/>-browser<wbr/>/<wbr/>?zoom<wbr/>=<wbr/>10<wbr/>&amp;<wbr/>lat<wbr/>=<wbr/>41<wbr/>.9<wbr/>&amp;<wbr/>lng<wbr/>=<wbr/>12<wbr/>.5<wbr/>&amp;<wbr/>themeId<wbr/>=<wbr/>DEFAULT<wbr/>-THEME</a></p></div><div id="sXH81Mwypf" class="relative group/block"><p>the identified date below is an almost cloud free image of Sentinel 2 over the area of Kuala Lumpur. In case of other AOI you need to identify a proper date as explained above and set here the updated one</p></div><div id="F1afEuTCHr" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Start and end date for Kuala Lumpur use case
date_start = &quot;2020-05-18&quot;
date_end = &quot;2020-05-18&quot;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="NL_d4Z6zyiRyZCVRwrRUD" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="B1N6WSyxRh" class="relative group/block"><h2 id="open-street-maps-osm" class="relative group"><span class="heading-text">Open Street Maps (OSM)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#open-street-maps-osm" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Trucks are only detected on roads obtained from OSM.
You may specify road types to include. Their descriptions can be found here:<br/><a target="_blank" rel="noreferrer" href="https://wiki.openstreetmap.org/wiki/Key:highway" class="">https://<wbr/>wiki<wbr/>.openstreetmap<wbr/>.org<wbr/>/wiki<wbr/>/Key:highway</a></p></div><div id="AAvlKIDwj8" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">osm_values = [&quot;motorway&quot;, &quot;trunk&quot;, &quot;primary&quot;] # all of key &quot;highway&quot;
roads_buffer = 0.00022 # degree, OSM road vectors are buffered, for motorway, the others lower</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JlQBio3da6Uy6kJQDqr89" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="P4OmqNU9oJ" class="relative group/block"><hr class="py-2 my-5 translate-y-2"/><h2 id="processing-methods" class="relative group"><span class="heading-text">Processing methods</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#processing-methods" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In the following cells all needed methods are defined. They will be invoked further below.</p></div><div id="JosSXPcGvw" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># re-order bbox from W,S,E,N to S,W,N,E, starting from the bbox defined at the beginning

def convert_bbox_osm(bbox):
    offset = 0.05 # add a buffer to bbox in order to be sure cube is entirely covered, pay attention to the signs before the adding the offset
    bbox_osm = [bbox[1], bbox[0], bbox[3], bbox[2]]
    bbox_osm[0] -= offset # min lat
    bbox_osm[1] -= offset # min lon
    bbox_osm[2] += offset # max lat
    bbox_osm[3] += offset # max lon
    return bbox_osm

# bbox List of four coords
# osm_value String OSM value
# osm_key String OSM key
# element_type List of String
# returns GeoDataFrame
def get_osm(bbox, 
            osm_value,
            element_type = [&quot;way&quot;, &quot;relation&quot;]):
    osm_key = &quot;highway&quot;
    bbox_osm = convert_bbox_osm(bbox)
    quot = &#x27;&quot;&#x27;
    select = quot+osm_key+quot + &#x27;=&#x27; + quot+osm_value+quot
    select_link = select.replace(osm_value, osm_value + &quot;_link&quot;) # also get road links
    select_junction = select.replace(osm_value, osm_value + &quot;_junction&quot;)
    geoms = []
    for selector in [select, select_link, select_junction]:  
        try:
            query = overpassQueryBuilder(bbox=bbox_osm, 
                                         elementType=element_type, 
                                         selector=selector, 
                                         out=&#x27;body&#x27;,
                                         includeGeometry=True)
            elements = Overpass().query(query, timeout=60).elements()
            # create multiline of all elements
            if len(elements) &gt; 0:
                for i in range(len(elements)):
                    elem = elements[i]
                    geoms.append(elem.geometry())
        except:
            Warning(&quot;Could not retrieve &quot; + select)
    try:
        lines = gpd.GeoDataFrame(crs = &quot;EPSG:4326&quot;, geometry = geoms)
        n = len(geoms)
        lines[&quot;osm_value&quot;] = [osm_value]*n # add road type
        return lines
    except:
        Warning(&quot;Could not merge &quot; + osm_value)
        
# buffer Float road buffer distance [m]
# bbox List of four coords
# bbox_id Integer processing id of bbox
# osm_values List of String OSM values
# osm_key String OSM key
# roads_buffer Float buffer width
# returns GeoDataFrame
def get_roads(bbox, osm_values, roads_buffer):
    osm_key = &quot;highway&quot;
    roads = []
    has_error = []
    offset = 0.00002
    buffer_dist = &quot;buffer_distance&quot;
    # buffer according to road type
    m,t,p,s,ter = &quot;motorway&quot;, &quot;trunk&quot;, &quot;primary&quot;, &quot;secondary&quot;, &quot;tertiary&quot;
    buffers = {m:roads_buffer, t:roads_buffer-offset, p:roads_buffer-(2*offset), s:roads_buffer-(3*offset), ter:roads_buffer-(4*offset)}
    osm_values_int = {m:1, t:2, p:3, s:4, ter:5}
    for osm_value in osm_values:
        roads_osm = get_osm(bbox, osm_value)
        try:
            roads_osm = get_osm(bbox, osm_value)
            roads_osm[buffer_dist] = [buffers[osm_value]] * len(roads_osm)
            roads_osm[&quot;osm_value_int&quot;] = osm_values_int[osm_value]
            roads.append(roads_osm)
        except:
            has_error.append(1)
            print(&quot;&#x27;get_osm&#x27;&quot; + &quot;failed for bbox_id osm_value &quot; + osm_value + &quot;osm_key&quot; + osm_key)
    if len(roads) &gt; len(has_error):
        roads_merge = gpd.GeoDataFrame(pd.concat(roads, ignore_index=True), crs=roads[0].crs)
        buffered = roads_merge.buffer(distance=roads_merge[buffer_dist])
        roads_merge.geometry = buffered
        return roads_merge

# osm geodataframe of polygons
# reference_raster xarray with lat and lon
# returns numpy array
def rasterize_osm(osm, reference_raster):
    osm_values = list(set(osm[&quot;osm_value&quot;]))
    nan_placeholder = 100
    road_rasters = []
    for osm_value in osm_values:
        osm_subset = osm[osm[&quot;osm_value&quot;] == osm_value]
        raster = rasterize(osm_subset, reference_raster.lat, reference_raster.lon)
        cond = np.isfinite(raster)
        raster_osm = np.where(cond, list(osm_subset.osm_value_int)[0], nan_placeholder) # use placeholder instead of nan first
        raster_osm = raster_osm.astype(np.float)
        road_rasters.append(raster_osm)        
    # merge road types in one layer
    road_raster_np = np.array(road_rasters).min(axis=0) # now use the lowest value (highest road level) because some intersect
    road_raster_np[road_raster_np == nan_placeholder] = 0
    return road_raster_np # 0=no_road 1=motorway, 2=trunk, ...

def transform_lat_lon(lat, lon):
    lat = np.asarray(lat)
    lon = np.asarray(lon)
    trans = Affine.translation(lon[0], lat[0])
    scale = Affine.scale(lon[1] - lon[0], lat[1] - lat[0])
    return trans * scale

def rasterize(polygons, lat, lon, fill=np.nan):
    transform = transform_lat_lon(lat, lon)
    out_shape = (len(lat), len(lon))
    raster = features.rasterize(polygons.geometry, out_shape=out_shape,
                                fill=fill, transform=transform,
                                dtype=float)
    return xr.DataArray(raster, coords={&quot;lat&quot;:lat, &quot;lon&quot;:lon}, dims=(&quot;lat&quot;, &quot;lon&quot;))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="TN_bxYMR3-7prqo_pB8VA" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="MHOsK8sBzl" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># TruckDetector detects trucks at acquisition-level
class TruckDetector():   
    def __init__(self, band_stack):
        is_none = band_stack is None
        self.band_stack = band_stack.chunk(band_stack.dims[&quot;lat&quot;], band_stack.dims[&quot;lon&quot;]) if not is_none else None
        self.no_truck_mask = None
        self.trucks = None
    
    def detect(self):
        B02 = self.band_stack.B02.persist().values
        B03 = self.band_stack.B03.persist().values
        B04 = self.band_stack.B04.persist().values
        B08 = self.band_stack.B08.persist().values
        B11 = self.band_stack.B11.persist().values
        no_truck_mask = calc_no_trucks(B02, B03, B04, B08, B11)
        trucks = detect_trucks(B02, B03, B04, no_truck_mask)
        lon_lat = {&quot;lat&quot;:self.band_stack.lat, &quot;lon&quot;:self.band_stack.lon}
        self.no_truck_mask = xr.DataArray(no_truck_mask, coords=lon_lat, dims=(&quot;lat&quot;, &quot;lon&quot;))
        self.trucks = xr.DataArray(trucks, coords=lon_lat, dims=(&quot;lat&quot;, &quot;lon&quot;)).astype(np.int)
        self.filter_trucks()
                            
    def filter_trucks(self):
        self.trucks = filter_spatial_3x3_extended(self.trucks)
        
# take xarray and ensure each value with 1 in data has no neighbor with 1 in an extended 3x3 block. Extended means: horizontally and vertically
# it is also checked for the second-next pixel
# Method checks only surrounding of values equal 1
# arr xarray DataArray with values and lat lon
def filter_spatial_3x3_extended(arr):
    values = arr.values
    lon = arr.lon
    lat = arr.lat
    valid = np.where(arr == 1)
    for y,x in zip(valid[0], valid[1]):
        y_above = y - 1
        y_above_next = y - 2
        x_left = x - 1
        x_right = x + 1
        x_left_next = x - 2
        space_left = x_left &gt;= 0
        space_right = x_right &gt;= 0 and x_right &lt; len(lon)
        space_above = y_above &gt;= 0
        val_left_above = values[y_above, x_left] if space_left and space_above else 0
        val_right_above = values[y_above, x_right] if space_right and space_above else 0
        val_left = values[y, x_left] if space_left else 0
        val_above = values[y_above, x] if space_above else 0
        val_left_next = values[y, x_left_next] if x_left_next &gt;= 0 else 0
        val_above_next = values[y_above_next, x] if y_above_next &gt;= 0 else 0
        # if any of the values left, above and left above has 1 set current value 0
        if (val_left_above + val_right_above + val_left + val_above + val_left_next + val_above_next) &gt;= 1:
            values[y,x] = 0
    arr.values = values
    return arr

# extracts coordinates at value in np array and returns points as GeoDataFrame
# data 2d np array
# match_value Float value in data where point coordinates are extracted
# lon_lat dict of:
### &quot;lon&quot;: np array longitude values&quot;
### &quot;lat&quot;: np array latitude values&quot;
# crs String EPSG:XXXX
def points_from_np(data, match_value, lon_lat, crs):
    indices = np.argwhere(data == match_value)
    if len(indices) &gt; 0:
        lat_indices = indices[:,[0]]
        lon_indices = indices[:,[1]]
        lat_coords = lon_lat[&quot;lat&quot;][lat_indices]
        lon_coords = lon_lat[&quot;lon&quot;][lon_indices]
        points = gpd.GeoDataFrame(geometry = gpd.points_from_xy(lon_coords, lat_coords))
        points.crs = crs
        return points
    
def raster_to_points(raster, lon_lat, field_name, crs):
    points_list = []
    match_values = np.unique(raster[(raster != 0) * ~np.isnan(raster)]) # by pixel value
    for x in match_values:
        points = points_from_np(raster, x, lon_lat, crs=crs)
        points[field_name] = [x] * len(points)
        points_list.append(points)
    return gpd.GeoDataFrame(pd.concat(points_list, ignore_index=True))
        
# Calculate a binary mask where pixels that are definitely no trucks are represented as 0. A dictionary with a set of trheshold values is required to reduce or avoid false detection on specific land cover types
# thresholds Dict with at least:
### max_ndvi Float above this val: no trucks. For Vegetation
### max_ndwi Float above this val: no trucks. For Water
### max_ndsi Float above this val: no_trucks. For Snow
### min_rgb Float above this val: no_trucks. For dark surfaces, e.g. shadows
### max_blue Float above this val: no_trucks
### max_green Float above this val: no trucks
### max_red Float above this val: no trucks
### min_b11 Float below this val: no trucks. For dark surfaces, e.g. shadows
### max_b11 Float below this val: no trucks. For bright (sealed) surfaces, e.g. buildings
@jit(nopython=True, parallel=True)
def calc_no_trucks(B02, B03, B04, B08, B11):
    th = {&quot;min_blue&quot;:0.06, 
          &quot;min_green&quot;:0.04, 
          &quot;min_red&quot;:0.04,
          &quot;max_red&quot;:0.15,
          &quot;max_green&quot;:0.15,
          &quot;max_blue&quot;:0.2,
          &quot;max_ndvi&quot;:0.5,
          &quot;max_ndwi&quot;:0.0001,
          &quot;max_ndsi&quot;:0.0001,
          &quot;min_blue_green_ratio&quot;:0.03,
          &quot;min_blue_red_ratio&quot;:0.05, 
          &quot;max_blue_green_ratio&quot;:0.17, 
          &quot;max_blue_red_ratio&quot;:0.2}
    ndvi_mask = ratio(B08, B04) &lt; th[&quot;max_ndvi&quot;]
    ndwi_mask = ratio(B02, B11) &lt; th[&quot;max_ndwi&quot;]
    ndsi_mask = ratio(B03, B11) &lt; th[&quot;max_ndsi&quot;]
    low_rgb_mask = (B02 &gt; th[&quot;min_blue&quot;]) * (B03 &gt; th[&quot;min_green&quot;]) * (B04 &gt; th[&quot;min_red&quot;])
    high_rgb_mask = (B02 &lt; th[&quot;max_blue&quot;]) * (B03 &lt; th[&quot;max_green&quot;]) * (B04 &lt; th[&quot;max_red&quot;])
    no_truck_mask = ndvi_mask * ndwi_mask * ndsi_mask * low_rgb_mask * high_rgb_mask
    return no_truck_mask

# Calculate a binary mask where trucks are represented as 1 and no trucks as 0.
# thresholds Dict with at least:
### min_green_ratio Float, minimum value of blue-green ratio
### min_red_ratio Float, minimum value of blue-red ratio
@jit(nopython=True, parallel=True)
def detect_trucks(B02, B03, B04, no_truck_mask):
    th = {&quot;min_blue&quot;:0.06, 
          &quot;min_green&quot;:0.04, 
          &quot;min_red&quot;:0.04,
          &quot;max_red&quot;:0.15,
          &quot;max_green&quot;:0.15,
          &quot;max_blue&quot;:0.2,
          &quot;max_ndvi&quot;:0.5,
          &quot;max_ndwi&quot;:0.0001,
          &quot;max_ndsi&quot;:0.0001,
          &quot;min_blue_green_ratio&quot;:0.03,
          &quot;min_blue_red_ratio&quot;:0.05, 
          &quot;max_blue_green_ratio&quot;:0.17, 
          &quot;max_blue_red_ratio&quot;:0.2}
    bg_ratio = ratio(B02, B03)
    br_ratio = ratio(B02, B04)
    bg = bg_ratio &gt; th[&quot;min_blue_green_ratio&quot;]
    br = br_ratio &gt; th[&quot;min_blue_red_ratio&quot;]
    bg_max = bg_ratio &lt; th[&quot;max_blue_green_ratio&quot;]
    br_max = br_ratio &lt; th[&quot;max_blue_red_ratio&quot;]
    trucks = (bg * br * bg_max * br_max) * no_truck_mask
    return trucks

@jit(nopython=True, parallel=True)
def ratio(a, b):
    return (a-b)/(a+b)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="8vxCDFNUFQY2Z7cEtx-_D" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="eDnsdq977N" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># AcquisitionProcessor processes all valid pixels of a single acquisition in cube
class AcquisitionProcessor():
    def __init__(self, date_np64, cube):
        self.date_np64 = date_np64
        self.cube = cube
        self.band_stack = cube.sel(time = date_np64)
        self.detector = None
        self.no_clouds = None
        self.osm_mask = None
           
    def mask_clouds(self):
        cloud_masking_thresholds = {&quot;rgb&quot;:0.25,&quot;blue_green&quot;:0.2,&quot;blue_red&quot;:0.2}
        scl = MaskSet(self.band_stack.SCL)
        high_prob = scl.clouds_high_probability
        med_prob = scl.clouds_medium_probability
        cirrus = scl.cirrus
        no_data = scl.no_data
        rgb_cloud_mask = calc_rgb_cloud_mask(self.band_stack, cloud_masking_thresholds)
        self.no_clouds = (high_prob + med_prob + cirrus + no_data + rgb_cloud_mask) == 0
        self.band_stack = self.band_stack.where(self.no_clouds)
    
    def mask_with_osm(self, osm_mask):
        self.osm_mask = osm_mask
        self.band_stack = self.band_stack.where(self.osm_mask != 0)
                
    def do_detection(self):
        self.detector = TruckDetector(self.band_stack)
        self.detector.detect()
        
def calc_rgb_cloud_mask(band_stack, cloud_masking_thresholds):
    B02, B03, B04 = band_stack.B02, band_stack.B03, band_stack.B04
    c = cloud_masking_thresholds[&quot;rgb&quot;]
    clouds_rgb = ((B02 &gt; c) + (B03 &gt; c) + (B04 &gt; c)) &gt;= 1
    # attempt to mask haze without masking out truck pixels (similar! higher blue than red and green)
    blue_green_ratio = (B02-B03) / (B02+B03)
    blue_red_ratio = (B02-B04) / (B02+B04)
    clouds_blue_green = blue_green_ratio &gt; cloud_masking_thresholds[&quot;blue_green&quot;]
    clouds_blue_red = blue_red_ratio &gt; cloud_masking_thresholds[&quot;blue_red&quot;]
    clouds = (clouds_rgb + clouds_blue_green + clouds_blue_red) &gt;= 1
    return clouds</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="X4KeuU1Qc743yp8Ysd1yZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="UrFw4CKWSc" class="relative group/block"><hr class="py-2 my-5 translate-y-2"/><h2 id="get-sentinel-2-l2a-xcube" class="relative group"><span class="heading-text">Get Sentinel-2 L2A xcube</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#get-sentinel-2-l2a-xcube" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="B5iyl1pjzq" class="relative group/block"><p>In the following cell you need to configure the cube and the interested bbox of the AOI, so please be careful in aligning the below bbox variable and the time range start and end dates with the one desidere at the beginning of the notebook</p></div><div id="ebJVaUOUlE" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">config = CubeConfig(dataset_name = &quot;S2L2A&quot;,
                    band_names = [&quot;B02&quot;, &quot;B03&quot;, &quot;B04&quot;, &quot;B08&quot;, &quot;B11&quot;, &quot;SCL&quot;],
                    tile_size = [512, 512],
                    bbox = bbox,
                    spatial_res = 0.00009,
                    time_range = [date_start, date_end],
                    time_period=&#x27;2D&#x27;)
cube = open_cube(config)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="tEC7PDVhwHlbexB4uDmZ8" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Yr0KIax4L0" class="relative group/block"><h3 id="acquisition" class="relative group"><span class="heading-text">Acquisition</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#acquisition" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="FIzWiO8Zkb" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">acquisition = AcquisitionProcessor(cube.time.values[0], cube)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="WydWT_ZU8KRxT8-7mqJSf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="hZ75FGc2IE" class="relative group/block"><h3 id="plot-rgb" class="relative group"><span class="heading-text">Plot RGB</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#plot-rgb" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="ER7KpznDdS" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">rgb_bands = [&quot;B04&quot;, &quot;B03&quot;, &quot;B02&quot;]
coords, dims = [rgb_bands, cube.lat, cube.lon], [&quot;bands&quot;, &quot;lat&quot;, &quot;lon&quot;]
rgb = np.vstack([cube.B04.persist().values, cube.B03.persist().values, cube.B02.persist().values])
rgb_xr = xr.DataArray(rgb, coords=coords, dims=dims)
rgb_xr.plot.imshow(figsize=[12,10], rgb=&quot;bands&quot;, vmin=0, vmax=0.4)
rgb, rgb_xr = None, None</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="fFh2-l680e1uGc0U6rNhJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/notebooks_test/build/deb46d05a9203f219375388bafe9a6f5.png" alt="&lt;Figure size 1200x1000 with 1 Axes&gt;"/></div></div><div id="VQUZ30yVju" class="relative group/block"><p>RGB reflectance</p></div><div id="yJFNhpQGIA" class="relative group/block"><h2 id="get-osm-roads" class="relative group"><span class="heading-text">Get OSM roads</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#get-osm-roads" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="w7uyAuO840" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">osm_roads = get_roads(bbox, osm_values, roads_buffer)
osm_roads.plot(figsize=[12,10])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2Alah3Yn_Y8MYvqCLiW8C" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>[overpass] downloading data: [timeout:60][out:json];(way[&quot;highway&quot;=&quot;motorway&quot;](3.0,101.557,3.25,101.80069999999999);relation[&quot;highway&quot;=&quot;motorway&quot;](3.0,101.557,3.25,101.80069999999999);); out body geom;
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>[overpass] downloading data: [timeout:60][out:json];(way[&quot;highway&quot;=&quot;motorway_link&quot;](3.0,101.557,3.25,101.80069999999999);relation[&quot;highway&quot;=&quot;motorway_link&quot;](3.0,101.557,3.25,101.80069999999999);); out body geom;
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>[overpass] downloading data: [timeout:60][out:json];(way[&quot;highway&quot;=&quot;motorway_junction&quot;](3.0,101.557,3.25,101.80069999999999);relation[&quot;highway&quot;=&quot;motorway_junction&quot;](3.0,101.557,3.25,101.80069999999999);); out body geom;
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>[overpass] downloading data: [timeout:60][out:json];(way[&quot;highway&quot;=&quot;trunk&quot;](3.0,101.557,3.25,101.80069999999999);relation[&quot;highway&quot;=&quot;trunk&quot;](3.0,101.557,3.25,101.80069999999999);); out body geom;
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>[OSMPythonTools.Element] Cannot build geometry: no outer rings found.
NoneType: None
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>[OSMPythonTools.Element] Cannot build geometry: no outer rings found. (relation/6110277)
Traceback (most recent call last):
  File &quot;/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages/OSMPythonTools/element.py&quot;, line 186, in __geometry
    self._raiseException(&#x27;Cannot build geometry: no outer rings found.&#x27;)
  File &quot;/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages/OSMPythonTools/element.py&quot;, line 50, in _raiseException
    OSMPythonTools._raiseException(&#x27;Element&#x27;, msg)
  File &quot;/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages/OSMPythonTools/__init__.py&quot;, line 13, in _raiseException
    raise(Exception(msgComplete))
Exception: [OSMPythonTools.Element] Cannot build geometry: no outer rings found.
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>[overpass] downloading data: [timeout:60][out:json];(way[&quot;highway&quot;=&quot;trunk_link&quot;](3.0,101.557,3.25,101.80069999999999);relation[&quot;highway&quot;=&quot;trunk_link&quot;](3.0,101.557,3.25,101.80069999999999);); out body geom;
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>[overpass] downloading data: [timeout:60][out:json];(way[&quot;highway&quot;=&quot;trunk_junction&quot;](3.0,101.557,3.25,101.80069999999999);relation[&quot;highway&quot;=&quot;trunk_junction&quot;](3.0,101.557,3.25,101.80069999999999);); out body geom;
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>[OSMPythonTools.Element] Cannot build geometry: no outer rings found.
NoneType: None
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>[OSMPythonTools.Element] Cannot build geometry: no outer rings found. (relation/6110277)
Traceback (most recent call last):
  File &quot;/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages/OSMPythonTools/element.py&quot;, line 186, in __geometry
    self._raiseException(&#x27;Cannot build geometry: no outer rings found.&#x27;)
  File &quot;/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages/OSMPythonTools/element.py&quot;, line 50, in _raiseException
    OSMPythonTools._raiseException(&#x27;Element&#x27;, msg)
  File &quot;/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages/OSMPythonTools/__init__.py&quot;, line 13, in _raiseException
    raise(Exception(msgComplete))
Exception: [OSMPythonTools.Element] Cannot build geometry: no outer rings found.
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>[overpass] downloading data: [timeout:60][out:json];(way[&quot;highway&quot;=&quot;primary&quot;](3.0,101.557,3.25,101.80069999999999);relation[&quot;highway&quot;=&quot;primary&quot;](3.0,101.557,3.25,101.80069999999999);); out body geom;
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>[overpass] downloading data: [timeout:60][out:json];(way[&quot;highway&quot;=&quot;primary_link&quot;](3.0,101.557,3.25,101.80069999999999);relation[&quot;highway&quot;=&quot;primary_link&quot;](3.0,101.557,3.25,101.80069999999999);); out body geom;
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>[overpass] downloading data: [timeout:60][out:json];(way[&quot;highway&quot;=&quot;primary_junction&quot;](3.0,101.557,3.25,101.80069999999999);relation[&quot;highway&quot;=&quot;primary_junction&quot;](3.0,101.557,3.25,101.80069999999999);); out body geom;
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>The requested data could not be downloaded. HTTP Error 504: Gateway Timeout
Traceback (most recent call last):
  File &quot;/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages/OSMPythonTools/internal/cacheObject.py&quot;, line 95, in __query
    response = urllib.request.urlopen(request)
  File &quot;/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/urllib/request.py&quot;, line 214, in urlopen
    return opener.open(url, data, timeout)
  File &quot;/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/urllib/request.py&quot;, line 523, in open
    response = meth(req, response)
  File &quot;/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/urllib/request.py&quot;, line 632, in http_response
    response = self.parent.error(
  File &quot;/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/urllib/request.py&quot;, line 561, in error
    return self._call_chain(*args)
  File &quot;/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/urllib/request.py&quot;, line 494, in _call_chain
    result = func(*args)
  File &quot;/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/urllib/request.py&quot;, line 641, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 504: Gateway Timeout
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>[overpass] downloading data: [timeout:60][out:json];(way[&quot;highway&quot;=&quot;primary_junction&quot;](3.0,101.557,3.25,101.80069999999999);relation[&quot;highway&quot;=&quot;primary_junction&quot;](3.0,101.557,3.25,101.80069999999999);); out body geom;
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/tmp/ipykernel_1994/1510730153.py:79: UserWarning: Geometry is in a geographic CRS. Results from &#x27;buffer&#x27; are likely incorrect. Use &#x27;GeoSeries.to_crs()&#x27; to re-project geometries to a projected CRS before this operation.

  buffered = roads_merge.buffer(distance=roads_merge[buffer_dist])
</span></code></pre></div><img src="/notebooks_test/build/dd62314b49a1d2bb7e274711fa1d1626.png" alt="&lt;Figure size 1200x1000 with 1 Axes&gt;"/></div></div><div id="cLnJHw0ywV" class="relative group/block"><p>The OSM road vectors are buffered, hence we see polygons here.</p></div><div id="GlpdTtk5oJ" class="relative group/block"><h3 id="rasterize-osm-roads-to-s2-cube" class="relative group"><span class="heading-text">Rasterize OSM roads to S2 cube</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#rasterize-osm-roads-to-s2-cube" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="T7MKppE6Zt" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">osm_roads_np = rasterize_osm(osm_roads, cube.B02)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="IWSieV7ciyyoIKlVTlaM2" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>/tmp/ipykernel_1994/1510730153.py:95: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  raster_osm = raster_osm.astype(np.float)
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/tmp/ipykernel_1994/1510730153.py:95: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  raster_osm = raster_osm.astype(np.float)
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/tmp/ipykernel_1994/1510730153.py:95: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  raster_osm = raster_osm.astype(np.float)
</span></code></pre></div></div></div><div id="ljK5zheSQj" class="relative group/block"><h2 id="mask" class="relative group"><span class="heading-text">Mask</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#mask" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In case there are clouds in the imagery, they are masked out here. Furthermore, the data is constrained to the OSM roads.</p></div><div id="X4O2CGSxs1" class="relative group/block"><h3 id="clouds" class="relative group"><span class="heading-text">Clouds</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#clouds" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="fZzfbr68SN" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">acquisition.mask_clouds()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="nj0ysuVxcdb4mWXXpDpn9" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="DwG8vZ9j2s" class="relative group/block"><h3 id="to-osm-roads" class="relative group"><span class="heading-text">To OSM roads</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#to-osm-roads" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Only pixels within the buffered OSM roads are considered.</p></div><div id="r5JRyLoMhL" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">acquisition.mask_with_osm(osm_roads_np)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="E98g5XRYNsU-lrfSdGet_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="tuHznoeJc7" class="relative group/block"><h2 id="detect-trucks" class="relative group"><span class="heading-text">Detect trucks</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#detect-trucks" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>This is the actual detection being invoked in the “do_detection” wrapper. The output is an xarray DataArray, which is afterwards converted to a GeoDataFrame of points.</p></div><div id="bRi5fOzw4r" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">acquisition.do_detection()
# raster detections to points
truck_points = raster_to_points(acquisition.detector.trucks.values, {&quot;lon&quot;:cube.lon.values, &quot;lat&quot;:cube.lat.values}, &quot;trucks&quot;, &quot;EPSG:4326&quot;)
truck_points.plot(figsize=[12,10])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="X9dIs46GEk0YQoiCI9qOv" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>/tmp/ipykernel_1994/2429981473.py:19: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  self.trucks = xr.DataArray(trucks, coords=lon_lat, dims=(&quot;lat&quot;, &quot;lon&quot;)).astype(np.int)
</span></code></pre></div><img src="/notebooks_test/build/39da16d695b5002c3a90f72edf054511.png" alt="&lt;Figure size 1200x1000 with 1 Axes&gt;"/></div></div><div id="cLv6PIV3Bh" class="relative group/block"><h2 id="write-detections" class="relative group"><span class="heading-text">Write detections</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#write-detections" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>If you would like to write the truck points, simply modify the file path here</p></div><div id="So6SMTkNhB" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">truck_points.to_file(&quot;trucks.gpkg&quot;, driver=&quot;GPKG&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="rbrbADilv1AM3hDJwyZ3R" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="v5gOorfK5S" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import geopandas</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Nev5aom7hB8LagqwGu8F8" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ezFKjIh6wt" class="relative group/block"><p>Could be interesting to have a look at the geopackage fields and values, so ise the geopandas read_file to get more information on the file generated.</p></div><div id="wG13jIIOfl" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">trucks_gpkg = geopandas.read_file(&quot;trucks.gpkg&quot;)
trucks_gpkg </code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="wdFcvJu7jPLaneOrC-gtd" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="jXeIvqlQuJ" class="relative group/block"><h2 id="download-the-sentinel-2-true-color-image-from-sentinel-hub" class="relative group"><span class="heading-text">Download the Sentinel 2 True color image from Sentinel hub</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#download-the-sentinel-2-true-color-image-from-sentinel-hub" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="Lee6mu9j0B" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from sentinelhub import SHConfig

config = SHConfig()

if not config.sh_client_id or not config.sh_client_secret:
    print(&quot;Warning! To use Process API, please provide the credentials (OAuth client ID and client secret).&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="KNLe7Rw7md8FMq9QvUmDA" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Warning! To use Process API, please provide the credentials (OAuth client ID and client secret).
</span></code></pre></div></div></div><div id="vRx7JSiMNU" class="relative group/block"><p>Injection of SH credentials to run the processing</p></div><div id="ggxmLlDNnm" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">config.sh_client_id = os.environ[&quot;SH_CLIENT_ID&quot;]
config.sh_client_secret = os.environ[&quot;SH_CLIENT_SECRET&quot;]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="NW8sernSlZzMFbNXLBgGn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="akirRkjnbp" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%reload_ext autoreload
%autoreload 2</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="k31ExjcIGwgg57FmWgBIN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Vrm5eLMuQs" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%matplotlib inline
import matplotlib.pyplot as plt
import rasterio
from rasterio import plot
from rasterio.plot import show
from rasterio.mask import mask</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="RZjQjn7Djd_sqXYPYWWza" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="cIUzfWXSCE" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import datetime
from sentinelhub import (
    CRS,
    BBox,
    DataCollection,
    DownloadRequest,
    MimeType,
    #MosaickingOrder,
    SentinelHubDownloadClient,
    SentinelHubRequest,
    bbox_to_dimensions,
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="iCU4AJ86qKet1FWUul-jP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="F7ElOeVSTH" class="relative group/block"><p>In the following  cell we need to set resolution of the image, the bbox and the CRS of reference. Please be careful in using the same CRS or EPSG used for the detection in order to execute the last cell properly. Currently the detections CRS has been set as:
“EPSG:4326” or “CRS:WGS84”</p></div><div id="a7bQUVj1lr" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">resolution = 10
kualalumpur_bbox = BBox(bbox=bbox, crs=CRS.WGS84)
kualalumpur_size = bbox_to_dimensions(kualalumpur_bbox, resolution=resolution)

print(f&quot;Image shape at {resolution} m resolution: {kualalumpur_size} pixels&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="06C-96dDJktSPpfyzrpHO" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Image shape at 10 m resolution: (1594, 1664) pixels
</span></code></pre></div></div></div><div id="FN1PAqmX0h" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">evalscript = &quot;&quot;&quot;
    //VERSION=3

    function setup() {
        return {
            input: [{
                bands: [&quot;B02&quot;, &quot;B03&quot;, &quot;B04&quot;],
               
            }],
            output: {
                bands: 3,
                sampleType: &quot;AUTO&quot;
                
            }
        };
    }

    
    function evaluatePixel(sample) {
        return [sample.B04*2, sample.B03*2, sample.B02*2];
    }
&quot;&quot;&quot;

request_true_colour = SentinelHubRequest(
    data_folder= &quot;./Outputs&quot;,
    evalscript=evalscript,
    input_data=[
        SentinelHubRequest.input_data(
            data_collection=DataCollection.SENTINEL2_L2A,
            time_interval=(date_start, date_end)
            
        )
    ],
    responses=[
        SentinelHubRequest.output_response(&quot;default&quot;, MimeType.TIFF)
        
    ],
    bbox=kualalumpur_bbox,
    size=kualalumpur_size,
    config=config,
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="rGnXruFSOSsvA1gCycDOm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="kLTFWq002I" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">tiff_image = request_true_colour.get_data(save_data=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ecmh1mOC6eiA_A-2UJqo0" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="cM9Zr31hFg" class="relative group/block"><p>In order to plot the image downloaded we need first to define the plot_image function as follow. In case of mage too dark or too bright yuo could play with the</p><p>“”“function evaluatePixel(sample) {
return [sample.B04<em>2, sample.B03</em>2, sample.B02*2];”“”</p><p>you can find in the evalscript above</p></div><div id="Dj1jNxdEKh" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Define the plot_image function
def plot_image(image, factor=1.0, clip_range = None, **kwargs):
    &quot;&quot;&quot;
    Utility function for plotting RGB images.
    &quot;&quot;&quot;
    fig, ax = plt.subplots(nrows=1, ncols=1, figsize=(15, 15))
    if clip_range is not None:
        ax.imshow(np.clip(image * factor, *clip_range), **kwargs)
    else:
        ax.imshow(image * factor, **kwargs)
    
    ax.set_xticks([])
    ax.set_yticks([])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="UcU5BD2jLh8H6OGUvYfTE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="YVpHk44nIA" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">plot_image(tiff_image[0], factor=1/255, clip_range=(0,1))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ZihRoVXWXxBebVDiffIEy" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/notebooks_test/build/de86bf6add38ad21c7f4a2721227a4ec.png" alt="&lt;Figure size 1500x1500 with 1 Axes&gt;"/></div></div><div id="mVqKXOdm4K" class="relative group/block"><p>In order to set the location of the tiff requesteed via SentinelHub, you need to identify the folder and set it in the input image path.</p></div><div id="d6L0sxTWbC" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#input_image = &quot;Downloaded_S2_TCI/2020-05-18-00_00_2020-05-18-23_59_Sentinel-2_L2A_True_color (1).tiff&quot;
input_image = &quot;./Outputs/a308013e4b1539348e30b3393836e689/response.tiff&quot;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="KiQeIgibbV7EJCC0IHQzQ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="X8qr7vkgmu" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">input_image_png = rasterio.open(input_image) </code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="gbcU6GtBmImoe13_Dn2fP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="KIqDxbXNso" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">plt.figure(figsize=(15, 15))
show(input_image_png.read(), transform=input_image_png.transform)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="h5gRzcGmG29n0gGTM5ZQm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/notebooks_test/build/4de4b3423ddebd801686f6435864a838.png" alt="&lt;Figure size 1500x1500 with 1 Axes&gt;"/></div></div><div id="h3rXQQmPBY" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">trucks_gpkg.plot()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="8bkgbodORSscRdcjgO2cE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/notebooks_test/build/b55becd65a1305ac4dbbe220bcb8d0c8.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/></div></div><div id="f2N7KqQRY0" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(&#x27;vector data projection is:&#x27;, trucks_gpkg.crs)
print(&#x27;raster data projection is:&#x27;, input_image_png.crs)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="P0MU-FYF5h_OYwrhbTCzO" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>vector data projection is: epsg:4326
raster data projection is: EPSG:4326
</span></code></pre></div></div></div><div id="eaSijj7bN1" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%matplotlib inline</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="feoxn-LMG0-5VM3xcF50J" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="u7HZLWfpo7" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig, ax = plt.subplots(figsize=(100, 50))
show(input_image_png.read(), transform=input_image_png.transform, ax=ax)
trucks_gpkg.plot(ax=ax, color=&#x27;yellow&#x27;, alpha=.30) ## alpha is the transparency setting
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Nj1GtAk-nlwAkb6JKNgcX" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/notebooks_test/build/ec6f79462ff16fad67259fc46bd22967.png" alt="&lt;Figure size 10000x5000 with 1 Axes&gt;"/></div></div><div></div></main></article><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/notebooks_test/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/notebooks_test/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/notebooks_test/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/notebooks_test/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/notebooks_test/build/_shared/chunk-IZFMW3M4.js"/><link rel="modulepreload" href="/notebooks_test/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/notebooks_test/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/notebooks_test/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/notebooks_test/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/notebooks_test/build/_shared/chunk-CPTH56EW.js"/><link rel="modulepreload" href="/notebooks_test/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/notebooks_test/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/notebooks_test/build/_shared/chunk-S4SWV34C.js"/><link rel="modulepreload" href="/notebooks_test/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/notebooks_test/build/root-QGLRP2PL.js"/><link rel="modulepreload" href="/notebooks_test/build/_shared/chunk-CB3BH7WY.js"/><link rel="modulepreload" href="/notebooks_test/build/routes/$-7JYT5576.js"/><script>window.__remixContext = {"url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/igarss2022/igarss-22-detect-trucks-sentinel2","state":{"loaderData":{"root":{"config":{"version":1,"myst":"1.3.25","options":{"hide_toc":true,"hide_footer_links":true,"folders":true},"nav":[],"actions":[],"projects":[{"github":"https://github.com/eoxhub-workspaces/documentation/","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"title":"Location for eodashboard notebooks","index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Eurodatacube","level":2},{"title":"Notebooks","level":3},{"slug":"external-notebooks.eurodatacube.notebooks.readme","title":"Jupyter notebooks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebooks","level":4},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.readme","title":"Euro Data Cube Notebooks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Contributions","level":5},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.aireo-pilot-dataset-ai4arctic-sea-ice","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.aireo-pilot-dataset-biomass-forest-observation-sys","title":"AIREO pilot dataset - Biomass (Forest Observation System)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.aireo-pilot-dataset-cap","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.aireo-pilot-dataset-spacenet7","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.aot-covid19","title":"Aerosol Optical Thickness (AOT) Anomaly Detection Using Sentinel-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.batch-zarr-output","title":"Generating Zarr data cubes with Sentinel Hub Batch API","description":"","date":"","thumbnail":"/notebooks_test/build/68dffbf744fa42f4bf3d35e55684984e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.client-side-processing-using-mass-sh","title":"Important notes","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.cmems-data-download","title":"Cmems Data Download","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.detect-trucks-sentinel2","title":"Detect Trucks using Sentinel-2 data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.drought-monitoring","title":"Drought impact monitoring platform","description":"","date":"","thumbnail":"/notebooks_test/build/ad5c19782b006f72352ae57794305840.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-africa-cube-africa-custom-contest","title":"Custom Script Contest – Urban Growth in Africa","description":"","date":"","thumbnail":"/notebooks_test/build/e9275f3fe80a704e2f5aa1ec1220e48a.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-byoc-tutorial","title":"How to bring your own data to EDC: Using Sentinel Hub Python package","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-demo-phi-week-v2","title":"xcube-gen and xcube-geodb Hands-On Workshop Φ-Week 2020","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-geodb-4-eurocrops-demo","title":"Demonstration of Eurocrops data use in geoDB","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-notebook-lstm","title":"South Africa Crop Type Classification on Euro Data Cube (EDC)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-usecase-lpis-crop-type-classification","title":"Important notes","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.eurocrops-crop-classification-example","title":"Crop-classification using Sentinel-2 time-series","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.ghsl-urban-delineation","title":"\u003cb\u003eUrban delineation\u003cb\u003e","description":"","date":"","thumbnail":"/notebooks_test/build/7bbf545a5eae1d9ebdb91ae42b261063.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.globalearthmonitor-example","title":"Pre-requisites","description":"","date":"","thumbnail":"/notebooks_test/build/205c1ded6bd59771975a9fbd3753fd3b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.gpu-support-eoxhub","title":"GPU-Support on EOxHub","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.gran-chaco-phiweek","title":"ESA EO \\phi- week 2020","description":"","date":"","thumbnail":"/notebooks_test/build/80cee7db6cdc7002ceedda5689f889fa.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.howtolulc-batch-updated-210621","title":"How To: Land-Use-Land-Cover Prediction for Slovenia - using the Batch Processing API","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.lpis-lulc-slo","title":"LPIS Use Case for Land Use / Land Cover Classification","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.lps2022-leverage-euro-data-cube-services","title":"Living Planet Symposium 2022 Training Session","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.no2-analysis-covid19-lockdowns","title":"Impact of Covid19 induced lockdown on NO2 levels","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.no2-so2-trend-veda-api-igarss-2023","title":"Using the NASA VEDA EOAPI","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.ogc-edc","title":"Important notes","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.openeo-client-demo","title":"openEO Client Demo","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.race-finishedgoodsinventory-inidcator","title":"Finished Goods Inventory indicator for RACE","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.third-party-planetscope","title":"Third Party Data Import - PlanetScope","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.xcube-access-datasets","title":"Using xcube to access non-commercial and commercial data sets","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.xcube-viewer-as-a-service-in-edc1","title":"Visualizing data with xcube viewer in EuroDataCube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.dapa.dapa-evaluation-workshop","title":"DAPA Evaluation Workshop: Introduction \u0026 Documentation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.dapa.dapa-tutorial-1-cube-sentinel-2","title":"DAPA Tutorial #1: Cube - Sentinel-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.dapa.dapa-tutorial-2-area-sentinel-2","title":"DAPA Tutorial #2: Area - Sentinel-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.dapa.dapa-tutorial-3-timeseries-sentinel-2","title":"DAPA Tutorial #3: Timeseries - Sentinel-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.dapa.dapa-tutorial-4-value-sentinel-2","title":"DAPA Tutorial #4: Value - Sentinel-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.dapa.dapa-tutorial-5-dem","title":"DAPA Tutorial #5: DEM","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.fairicube.fairicube-data-access-demonstration","title":"EDC Sentinel Hub - data access using xcube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-australian-bushfires","title":"Australian Bushfires","description":"","date":"","thumbnail":"/notebooks_test/build/ab194b4f8c40a2b9d64d8a85e37ce1fd.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":["IGARSS-22","EO Dashboard"],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-data-access","title":"Data Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-detect-trucks-sentinel2","title":"Truck Detection Exercise","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-lockdown-in-venice","title":"Environmental Impacts of Lockdown in Venice, Italy during 2020","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-nasa-api-lockdown-in-venice","title":"Lockdown in Venice","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-no2-timeseries-analysis","title":"NO2 timeseries analysis","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-timeseries-stac-api-single-vs-multi","title":"Time series using STAC API statistics endpoints","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"title":"Curated","level":5},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.access-iacs-data","title":"How to access IACS Spatial Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-access-cci-data","title":"Access CCI data with xcube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-first-steps","title":"First steps on the Euro Data Cube platform","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-geodb-1-manage-datasets-v11","title":"Manage Collections in your GeoDB","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-geodb-2-explore-datasets-2","title":"Exploring Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-geodb-3-share-datasets1","title":"Sharing Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-geodb-access-urban-atlas-data-v1","title":"[xcube-geodb] How to accesss EEA Urban Atlas Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinel-hub-data-access","title":"EDC Sentinel Hub - data access using xcube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinelhub-datafusion-basic","title":"EDC Sentinel Hub: Data Fusion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinelhub-datafusion-ndvi","title":"EDC Sentinel Hub: Data Fusion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinel-hub-datasets","title":"EDC Sentinel Hub - using xcube to access different data sets in Sentinel Hub","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinel-hub-setup","title":"Setup for EDC core API access using xcube client library","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinel-hub-xcube-integration","title":"EDC Sentinel Hub - XCUBE integration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-usecase-ndvi-timeline","title":"NDVI timeline","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.eo-learn","title":"Using eo-learn in EDC: a starter’s guide.","description":"","date":"","thumbnail":"/notebooks_test/build/5a1f8475f0c3652f4630d03d72891b98.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.esdl-edc-v0-2","title":"Earth System Data Lab Tutorial @ Euro Data Cube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.exploring-time-and-space-with-edc","title":"Exploring Time and Space: A guide to accessing, analysing and visualising data in the Euro Data Cube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.how-to-access-dem-data-through-sentinel-hub-api","title":"How to access DEM data through Sentinel Hub API","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.sentinelhub-py","title":"Using Sentinel Hub Process API in EDC: a starter’s guide.","description":"","date":"","thumbnail":"/notebooks_test/build/01e22903839391bc356ac886ec2b2fa7.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"title":"Notebooks","level":1},{"slug":"notebooks.example1","title":"📘 Example Notebook 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.example2","title":"📘 Example Notebook 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/notebooks_test"},"routes/$":{"config":{"version":1,"myst":"1.3.25","options":{"hide_toc":true,"hide_footer_links":true,"folders":true},"nav":[],"actions":[],"projects":[{"github":"https://github.com/eoxhub-workspaces/documentation/","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"title":"Location for eodashboard notebooks","index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Eurodatacube","level":2},{"title":"Notebooks","level":3},{"slug":"external-notebooks.eurodatacube.notebooks.readme","title":"Jupyter notebooks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebooks","level":4},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.readme","title":"Euro Data Cube Notebooks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Contributions","level":5},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.aireo-pilot-dataset-ai4arctic-sea-ice","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.aireo-pilot-dataset-biomass-forest-observation-sys","title":"AIREO pilot dataset - Biomass (Forest Observation System)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.aireo-pilot-dataset-cap","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.aireo-pilot-dataset-spacenet7","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.aot-covid19","title":"Aerosol Optical Thickness (AOT) Anomaly Detection Using Sentinel-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.batch-zarr-output","title":"Generating Zarr data cubes with Sentinel Hub Batch API","description":"","date":"","thumbnail":"/notebooks_test/build/68dffbf744fa42f4bf3d35e55684984e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.client-side-processing-using-mass-sh","title":"Important notes","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.cmems-data-download","title":"Cmems Data Download","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.detect-trucks-sentinel2","title":"Detect Trucks using Sentinel-2 data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.drought-monitoring","title":"Drought impact monitoring platform","description":"","date":"","thumbnail":"/notebooks_test/build/ad5c19782b006f72352ae57794305840.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-africa-cube-africa-custom-contest","title":"Custom Script Contest – Urban Growth in Africa","description":"","date":"","thumbnail":"/notebooks_test/build/e9275f3fe80a704e2f5aa1ec1220e48a.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-byoc-tutorial","title":"How to bring your own data to EDC: Using Sentinel Hub Python package","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-demo-phi-week-v2","title":"xcube-gen and xcube-geodb Hands-On Workshop Φ-Week 2020","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-geodb-4-eurocrops-demo","title":"Demonstration of Eurocrops data use in geoDB","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-notebook-lstm","title":"South Africa Crop Type Classification on Euro Data Cube (EDC)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-usecase-lpis-crop-type-classification","title":"Important notes","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.eurocrops-crop-classification-example","title":"Crop-classification using Sentinel-2 time-series","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.ghsl-urban-delineation","title":"\u003cb\u003eUrban delineation\u003cb\u003e","description":"","date":"","thumbnail":"/notebooks_test/build/7bbf545a5eae1d9ebdb91ae42b261063.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.globalearthmonitor-example","title":"Pre-requisites","description":"","date":"","thumbnail":"/notebooks_test/build/205c1ded6bd59771975a9fbd3753fd3b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.gpu-support-eoxhub","title":"GPU-Support on EOxHub","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.gran-chaco-phiweek","title":"ESA EO \\phi- week 2020","description":"","date":"","thumbnail":"/notebooks_test/build/80cee7db6cdc7002ceedda5689f889fa.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.howtolulc-batch-updated-210621","title":"How To: Land-Use-Land-Cover Prediction for Slovenia - using the Batch Processing API","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.lpis-lulc-slo","title":"LPIS Use Case for Land Use / Land Cover Classification","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.lps2022-leverage-euro-data-cube-services","title":"Living Planet Symposium 2022 Training Session","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.no2-analysis-covid19-lockdowns","title":"Impact of Covid19 induced lockdown on NO2 levels","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.no2-so2-trend-veda-api-igarss-2023","title":"Using the NASA VEDA EOAPI","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.ogc-edc","title":"Important notes","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.openeo-client-demo","title":"openEO Client Demo","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.race-finishedgoodsinventory-inidcator","title":"Finished Goods Inventory indicator for RACE","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.third-party-planetscope","title":"Third Party Data Import - PlanetScope","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.xcube-access-datasets","title":"Using xcube to access non-commercial and commercial data sets","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.xcube-viewer-as-a-service-in-edc1","title":"Visualizing data with xcube viewer in EuroDataCube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.dapa.dapa-evaluation-workshop","title":"DAPA Evaluation Workshop: Introduction \u0026 Documentation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.dapa.dapa-tutorial-1-cube-sentinel-2","title":"DAPA Tutorial #1: Cube - Sentinel-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.dapa.dapa-tutorial-2-area-sentinel-2","title":"DAPA Tutorial #2: Area - Sentinel-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.dapa.dapa-tutorial-3-timeseries-sentinel-2","title":"DAPA Tutorial #3: Timeseries - Sentinel-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.dapa.dapa-tutorial-4-value-sentinel-2","title":"DAPA Tutorial #4: Value - Sentinel-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.dapa.dapa-tutorial-5-dem","title":"DAPA Tutorial #5: DEM","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.fairicube.fairicube-data-access-demonstration","title":"EDC Sentinel Hub - data access using xcube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-australian-bushfires","title":"Australian Bushfires","description":"","date":"","thumbnail":"/notebooks_test/build/ab194b4f8c40a2b9d64d8a85e37ce1fd.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":["IGARSS-22","EO Dashboard"],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-data-access","title":"Data Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-detect-trucks-sentinel2","title":"Truck Detection Exercise","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-lockdown-in-venice","title":"Environmental Impacts of Lockdown in Venice, Italy during 2020","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-nasa-api-lockdown-in-venice","title":"Lockdown in Venice","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-no2-timeseries-analysis","title":"NO2 timeseries analysis","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-timeseries-stac-api-single-vs-multi","title":"Time series using STAC API statistics endpoints","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"title":"Curated","level":5},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.access-iacs-data","title":"How to access IACS Spatial Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-access-cci-data","title":"Access CCI data with xcube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-first-steps","title":"First steps on the Euro Data Cube platform","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-geodb-1-manage-datasets-v11","title":"Manage Collections in your GeoDB","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-geodb-2-explore-datasets-2","title":"Exploring Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-geodb-3-share-datasets1","title":"Sharing Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-geodb-access-urban-atlas-data-v1","title":"[xcube-geodb] How to accesss EEA Urban Atlas Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinel-hub-data-access","title":"EDC Sentinel Hub - data access using xcube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinelhub-datafusion-basic","title":"EDC Sentinel Hub: Data Fusion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinelhub-datafusion-ndvi","title":"EDC Sentinel Hub: Data Fusion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinel-hub-datasets","title":"EDC Sentinel Hub - using xcube to access different data sets in Sentinel Hub","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinel-hub-setup","title":"Setup for EDC core API access using xcube client library","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinel-hub-xcube-integration","title":"EDC Sentinel Hub - XCUBE integration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-usecase-ndvi-timeline","title":"NDVI timeline","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.eo-learn","title":"Using eo-learn in EDC: a starter’s guide.","description":"","date":"","thumbnail":"/notebooks_test/build/5a1f8475f0c3652f4630d03d72891b98.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.esdl-edc-v0-2","title":"Earth System Data Lab Tutorial @ Euro Data Cube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.exploring-time-and-space-with-edc","title":"Exploring Time and Space: A guide to accessing, analysing and visualising data in the Euro Data Cube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.how-to-access-dem-data-through-sentinel-hub-api","title":"How to access DEM data through Sentinel Hub API","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.sentinelhub-py","title":"Using Sentinel Hub Process API in EDC: a starter’s guide.","description":"","date":"","thumbnail":"/notebooks_test/build/01e22903839391bc356ac886ec2b2fa7.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"title":"Notebooks","level":1},{"slug":"notebooks.example1","title":"📘 Example Notebook 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.example2","title":"📘 Example Notebook 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":1,"kind":"Notebook","sha256":"31ec959ff1fd44a2db75d5b067aa2bca04f53692065a7aba2f0b764d3958e6a4","slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-detect-trucks-sentinel2","location":"/external_notebooks/eurodatacube/notebooks/notebooks/contributions/IGARSS2022/IGARSS-22_Detect_Trucks_Sentinel2.ipynb","dependencies":[],"frontmatter":{"title":"Truck Detection Exercise","content_includes_title":true,"kernelspec":{"name":"conda-env-edc-default-2022.07-00-py","display_name":"python3 (edc-default-2022.07-00)","language":"python"},"github":"https://github.com/eoxhub-workspaces/documentation/","numbering":{"title":{"offset":5}},"edit_url":"https://github.com/eoxhub-workspaces/documentation//blob/main/external_notebooks/eurodatacube/notebooks/notebooks/contributions/IGARSS2022/IGARSS-22_Detect_Trucks_Sentinel2.ipynb","exports":[{"format":"ipynb","filename":"IGARSS-22_Detect_Trucks_Sentinel2.ipynb","url":"/notebooks_test/build/IGARSS-22_Detect_Tru-5a7fcec75d99bf5984f94dfe9c5ecf7f.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:28:35.725426Z","iopub.status.busy":"2022-10-13T12:28:35.724314Z","iopub.status.idle":"2022-10-13T12:28:35.864258Z","shell.execute_reply":"2022-10-13T12:28:35.862910Z"},"papermill":{"duration":0.174516,"end_time":"2022-10-13T12:28:35.869689","exception":false,"start_time":"2022-10-13T12:28:35.695173","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from edc import check_compatibility\ncheck_compatibility(\"user-2022.10-14\", dependencies=[\"SH\"])","visibility":"show","key":"JQvLi5E1Ex"},{"type":"output","id":"Xpo9bWJzd6hECtQ8mIkDZ","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"\u003cscript type=\"text/javascript\"\u003e\n        function toggle(id) {\n            el = document.getElementById(id);\n            el.style.display = el.style.display === \"none\" ? \"block\" : \"none\";\n        }\n    \u003c/script\u003e","content_type":"text/html"},"text/plain":{"content":"\u003cIPython.core.display.HTML object\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"This notebook is compatible with this base image version (user-2022.10-14).","content_type":"text/html"},"text/plain":{"content":"\u003cIPython.core.display.HTML object\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/markdown":{"content":"\n\n---------\n\nThe following environment variables are available:\n\n* `SH_CLIENT_ID`, `SH_INSTANCE_ID`, `SH_CLIENT_NAME`, `SH_CLIENT_SECRET`\n","content_type":"text/markdown"},"text/plain":{"content":"\u003cIPython.core.display.Markdown object\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"POxFxbAEhs"}],"visibility":"show","key":"EBdmvhfXhw"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.015623,"end_time":"2022-10-13T12:28:35.925979","exception":false,"start_time":"2022-10-13T12:28:35.910356","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Truck Detection Exercise","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"orom2WLHJv"}],"identifier":"truck-detection-exercise","label":"Truck Detection Exercise","html_id":"truck-detection-exercise","implicit":true,"key":"cxIDflymXO"}],"visibility":"show","key":"qWnTA0ZVxW"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.015134,"end_time":"2022-10-13T12:28:35.964826","exception":false,"start_time":"2022-10-13T12:28:35.949692","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Detect Trucks using Sentinel-2 data user guide","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"syIqHjuFaD"}],"identifier":"detect-trucks-using-sentinel-2-data-user-guide","label":"Detect Trucks using Sentinel-2 data user guide","html_id":"detect-trucks-using-sentinel-2-data-user-guide","implicit":true,"key":"aMRm7ZpXK8"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Parallax-based truck detection","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ZZ7Ic7FuqL"}],"identifier":"parallax-based-truck-detection","label":"Parallax-based truck detection","html_id":"parallax-based-truck-detection","implicit":true,"key":"QZ8nelBZK2"},{"type":"thematicBreak","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QruXh6EGTq"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"This notebook is a comprehensive script for detecting trucks with Sentinel-2 data. In order to run the detection in your area of interest you will have to modify two cells:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"XPe8KKhZTo"}],"key":"NIb2ioX4Ef"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Area of Interest (specify the aoi as bounding box)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SAnbNmSFvr"}],"key":"l15Xyn6dkR"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Date (specify an acquisition date)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"NlzsvkI729"}],"key":"aS5rn6S5Jm"}],"key":"kSHgKHU2rc"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Afterwards, you may simply run all cells and check the result at the end of the script where you can also write the detections as points.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"qa1Zox6RiX"}],"key":"DJuozNftbl"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Ensure that you have access to the Sentinel Hub resources for retrieving Sentinel-2 data through its API (via xcube_sh).","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"c3MbDy6inv"}],"key":"dMlVRCHMa5"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Author: Henrik Fisser, 2020","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"tKTplZpYV5"},{"type":"break","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"StyxmR1b9I"},{"type":"text","value":"Explanations on the truck detection on GitHub: ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"k2V0eKfMXo"},{"type":"link","url":"https://github.com/hfisser/Truck_Detection_Sentinel2_COVID19","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"https://​github​.com​/hfisser​/Truck​_Detection​_Sentinel2​_COVID19","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"WGCoH2qlxr"}],"urlSource":"https://github.com/hfisser/Truck_Detection_Sentinel2_COVID19","error":true,"key":"X6TStLgaRj"}],"key":"h7oKg4eHoq"}],"visibility":"show","key":"K5eNH75l4A"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:28:35.999261Z","iopub.status.busy":"2022-10-13T12:28:35.998744Z","iopub.status.idle":"2022-10-13T12:28:49.583357Z","shell.execute_reply":"2022-10-13T12:28:49.582038Z"},"papermill":{"duration":13.605848,"end_time":"2022-10-13T12:28:49.585994","exception":false,"start_time":"2022-10-13T12:28:35.980146","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import os\nimport subprocess\nimport sys\n\n# installations\ndef install_package(pkg):\n    subprocess.check_call([sys.executable, \"-m\", \"pip\", \"install\", pkg])\ninstall_package(\"OSMPythonTools\")\ninstall_package(\"geocube\")\n\n# OSM API\nfrom OSMPythonTools.overpass import overpassQueryBuilder, Overpass\n\nimport numpy as np\nimport xarray as xr\nimport geocube\nimport geopandas as gpd\nimport pandas as pd\nfrom xcube_sh.cube import open_cube\nfrom xcube_sh.config import CubeConfig\nfrom xcube.core.maskset import MaskSet\nfrom rasterio import features\nfrom affine import Affine\nfrom shapely import geometry, coords\nfrom shapely.geometry import Polygon, Point, box\nfrom numba import jit\n\nimport IPython.display\n%matplotlib inline","visibility":"show","key":"FNnTwDdzlT"},{"type":"output","id":"M86ojhl1h8ciTvaWJh0Y9","data":[{"name":"stdout","output_type":"stream","text":"Collecting OSMPythonTools\n  Downloading OSMPythonTools-0.3.5.tar.gz (28 kB)\n  Preparing metadata (setup.py): started\n"},{"name":"stdout","output_type":"stream","text":"  Preparing metadata (setup.py): finished with status 'done'\nRequirement already satisfied: beautifulsoup4 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from OSMPythonTools) (4.11.1)\nRequirement already satisfied: geojson in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from OSMPythonTools) (2.5.0)\nRequirement already satisfied: lxml in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from OSMPythonTools) (4.9.1)\nRequirement already satisfied: matplotlib in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from OSMPythonTools) (3.6.1)\nRequirement already satisfied: numpy in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from OSMPythonTools) (1.23.3)\nRequirement already satisfied: pandas in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from OSMPythonTools) (1.5.0)\nCollecting ujson\n"},{"name":"stdout","output_type":"stream","text":"  Downloading ujson-5.5.0-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (46 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 46.1/46.1 kB 8.3 MB/s eta 0:00:00\nRequirement already satisfied: xarray in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from OSMPythonTools) (2022.9.0)\nRequirement already satisfied: soupsieve\u003e1.2 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from beautifulsoup4-\u003eOSMPythonTools) (2.3.2.post1)\nRequirement already satisfied: pillow\u003e=6.2.0 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from matplotlib-\u003eOSMPythonTools) (9.2.0)\nRequirement already satisfied: fonttools\u003e=4.22.0 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from matplotlib-\u003eOSMPythonTools) (4.37.4)\nRequirement already satisfied: cycler\u003e=0.10 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from matplotlib-\u003eOSMPythonTools) (0.11.0)\nRequirement already satisfied: contourpy\u003e=1.0.1 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from matplotlib-\u003eOSMPythonTools) (1.0.5)\nRequirement already satisfied: python-dateutil\u003e=2.7 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from matplotlib-\u003eOSMPythonTools) (2.8.2)\nRequirement already satisfied: packaging\u003e=20.0 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from matplotlib-\u003eOSMPythonTools) (21.3)\nRequirement already satisfied: pyparsing\u003e=2.2.1 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from matplotlib-\u003eOSMPythonTools) (3.0.9)\nRequirement already satisfied: kiwisolver\u003e=1.0.1 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from matplotlib-\u003eOSMPythonTools) (1.4.4)\nRequirement already satisfied: pytz\u003e=2020.1 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from pandas-\u003eOSMPythonTools) (2022.4)\n"},{"name":"stdout","output_type":"stream","text":"Requirement already satisfied: six\u003e=1.5 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from python-dateutil\u003e=2.7-\u003ematplotlib-\u003eOSMPythonTools) (1.16.0)\nBuilding wheels for collected packages: OSMPythonTools\n  Building wheel for OSMPythonTools (setup.py): started\n"},{"name":"stdout","output_type":"stream","text":"  Building wheel for OSMPythonTools (setup.py): finished with status 'done'\n  Created wheel for OSMPythonTools: filename=OSMPythonTools-0.3.5-py3-none-any.whl size=32717 sha256=1dd60ca069c3595d49c3dd814eeab6f9547671147edf2bdd369ebbbfe470cf94\n  Stored in directory: /home/jovyan/.cache/pip/wheels/24/da/ad/aff21ba9e9c127c4997d1f9b0251f17c5c13373524297ae6bd\nSuccessfully built OSMPythonTools\n"},{"name":"stdout","output_type":"stream","text":"Installing collected packages: ujson, OSMPythonTools\nSuccessfully installed OSMPythonTools-0.3.5 ujson-5.5.0\n"},{"name":"stdout","output_type":"stream","text":"Collecting geocube\n  Downloading geocube-0.3.3-py3-none-any.whl (20 kB)\nRequirement already satisfied: numpy\u003e=1.20 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geocube) (1.23.3)\nRequirement already satisfied: rasterio in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geocube) (1.3.2)\nRequirement already satisfied: rioxarray\u003e=0.4 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geocube) (0.12.2)\nRequirement already satisfied: click\u003e=6.0 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geocube) (8.0.4)\nRequirement already satisfied: pyproj\u003e=2 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geocube) (3.4.0)\nRequirement already satisfied: xarray\u003e=0.17 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geocube) (2022.9.0)\nRequirement already satisfied: appdirs in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geocube) (1.4.4)\nRequirement already satisfied: scipy in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geocube) (1.9.1)\n"},{"name":"stdout","output_type":"stream","text":"Collecting odc-geo\n  Downloading odc_geo-0.3.0-py3-none-any.whl (114 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 114.0/114.0 kB 14.7 MB/s eta 0:00:00\nRequirement already satisfied: geopandas\u003e=0.7 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geocube) (0.11.1)\nRequirement already satisfied: packaging in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geopandas\u003e=0.7-\u003egeocube) (21.3)\nRequirement already satisfied: shapely\u003c2,\u003e=1.7 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geopandas\u003e=0.7-\u003egeocube) (1.8.5)\nRequirement already satisfied: pandas\u003e=1.0.0 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geopandas\u003e=0.7-\u003egeocube) (1.5.0)\nRequirement already satisfied: fiona\u003e=1.8 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from geopandas\u003e=0.7-\u003egeocube) (1.8.21)\nRequirement already satisfied: certifi in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from pyproj\u003e=2-\u003egeocube) (2022.9.24)\nRequirement already satisfied: attrs in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from rasterio-\u003egeocube) (22.1.0)\nRequirement already satisfied: snuggs\u003e=1.4.1 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from rasterio-\u003egeocube) (1.4.7)\nRequirement already satisfied: setuptools in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from rasterio-\u003egeocube) (65.4.1)\nRequirement already satisfied: cligj\u003e=0.5 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from rasterio-\u003egeocube) (0.7.2)\nRequirement already satisfied: affine in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from rasterio-\u003egeocube) (2.3.1)\nRequirement already satisfied: click-plugins in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from rasterio-\u003egeocube) (1.1.1)\n"},{"name":"stdout","output_type":"stream","text":"Requirement already satisfied: cachetools in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from odc-geo-\u003egeocube) (5.2.0)\nRequirement already satisfied: six\u003e=1.7 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from fiona\u003e=1.8-\u003egeopandas\u003e=0.7-\u003egeocube) (1.16.0)\nRequirement already satisfied: munch in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from fiona\u003e=1.8-\u003egeopandas\u003e=0.7-\u003egeocube) (2.5.0)\nRequirement already satisfied: pyparsing!=3.0.5,\u003e=2.0.2 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from packaging-\u003egeopandas\u003e=0.7-\u003egeocube) (3.0.9)\nRequirement already satisfied: python-dateutil\u003e=2.8.1 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from pandas\u003e=1.0.0-\u003egeopandas\u003e=0.7-\u003egeocube) (2.8.2)\nRequirement already satisfied: pytz\u003e=2020.1 in /opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages (from pandas\u003e=1.0.0-\u003egeopandas\u003e=0.7-\u003egeocube) (2022.4)\n"},{"name":"stdout","output_type":"stream","text":"Installing collected packages: odc-geo, geocube\n"},{"name":"stdout","output_type":"stream","text":"Successfully installed geocube-0.3.3 odc-geo-0.3.0\n"}],"visibility":"show","key":"HlTSBVJI2y"}],"visibility":"show","key":"L0ATrj2IfV"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.01392,"end_time":"2022-10-13T12:28:49.613473","exception":false,"start_time":"2022-10-13T12:28:49.599553","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Area of Interest","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YYQtzaEYEn"}],"identifier":"area-of-interest","label":"Area of Interest","html_id":"area-of-interest","implicit":true,"key":"U8QdWjgeAD"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Specify an area of interest as bounding box in format:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"TlLUffSyvd"},{"type":"break","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"f0fcfFEvb4"},{"type":"text","value":"xmin, ymin, ymax, ymax","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"uiAGFBRpK4"}],"key":"hWE2yMpMMD"}],"visibility":"show","key":"j3P54gv5qR"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:28:49.643153Z","iopub.status.busy":"2022-10-13T12:28:49.642285Z","iopub.status.idle":"2022-10-13T12:28:49.669763Z","shell.execute_reply":"2022-10-13T12:28:49.668344Z"},"papermill":{"duration":0.045774,"end_time":"2022-10-13T12:28:49.672880","exception":false,"start_time":"2022-10-13T12:28:49.627106","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"bbox = 101.607,3.0500, 101.7507, 3.20, # Kuala Lumpur\nkualalumpur_bbox = [101.607,3.0500, 101.7507, 3.20]\nIPython.display.GeoJSON(box(*bbox).__geo_interface__)","visibility":"show","key":"TorV7UBv9a"},{"type":"output","id":"Ei9b1huwr-I7_fzmZ8IaL","data":[{"output_type":"display_data","metadata":{"application/geo+json":{"expanded":false,"root":"root"}},"data":{"application/geo+json":{"content":"{\"coordinates\":[[[101.7507,3.05],[101.7507,3.2],[101.607,3.2],[101.607,3.05],[101.7507,3.05]]],\"type\":\"Polygon\"}","content_type":"application/geo+json"},"text/plain":{"content":"\u003cIPython.display.GeoJSON object\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"yd3erRhQmB"}],"visibility":"show","key":"he9xXl2fXR"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.016932,"end_time":"2022-10-13T12:28:49.710878","exception":false,"start_time":"2022-10-13T12:28:49.693946","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Other AOIs can be generated here, just remeber toc change bbox in the code accrodingly","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ha7t2BlpR2"}],"key":"C9xFyU26Xa"}],"visibility":"show","key":"Djnr5jD5YE"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:28:49.749009Z","iopub.status.busy":"2022-10-13T12:28:49.748486Z","iopub.status.idle":"2022-10-13T12:28:49.755405Z","shell.execute_reply":"2022-10-13T12:28:49.753958Z"},"papermill":{"duration":0.033822,"end_time":"2022-10-13T12:28:49.760973","exception":false,"start_time":"2022-10-13T12:28:49.727151","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# bbox = -3.85, 40.3, -3.55, 40.5 # Madrid\n# Madrid_bbox = [-3.85, 40.3, -3.55, 40.5]","visibility":"show","key":"m2F61wMglP"},{"type":"output","id":"kur0W4LCaVgegIq7CNbwc","data":[],"visibility":"show","key":"NdPWQ70fpg"}],"visibility":"show","key":"dbyJJERFSv"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.027844,"end_time":"2022-10-13T12:28:49.808190","exception":false,"start_time":"2022-10-13T12:28:49.780346","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Date","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zr9x8jf9l6"}],"identifier":"date","label":"Date","html_id":"date","implicit":true,"key":"MK1Mx1ufex"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Select a cloud-free acquisition and provide the date as “YYYY-MM-DD”.\nYou may select data e.g. here:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"u70f35hb9y"},{"type":"break","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"DDMwsgGMRO"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Copernicus Open Access Hub","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"t6ldmisCL2"}],"key":"bSViV4rckV"},{"type":"text","value":"\n","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"meZWJRuEcU"},{"type":"link","url":"https://scihub.copernicus.eu/dhus/#/home","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"https://​scihub​.copernicus​.eu​/dhus​/​#​/home","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zCFjdJefjY"}],"urlSource":"https://scihub.copernicus.eu/dhus/#/home","key":"UTqVW3eyLI"},{"type":"text","value":" ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"j60iuxisX8"},{"type":"break","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ttNhGQggUl"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"EO Browser","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"eSRMT56Kks"}],"key":"i1trl6cbL1"},{"type":"text","value":"\n","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"s4ynixO0iF"},{"type":"link","url":"https://apps.sentinel-hub.com/eo-browser/?zoom=10\u0026lat=41.9\u0026lng=12.5\u0026themeId=DEFAULT-THEME","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"https://​apps​.sentinel​-hub​.com​/eo​-browser​/​?zoom​=​10​\u0026​lat​=​41​.9​\u0026​lng​=​12​.5​\u0026​themeId​=​DEFAULT​-THEME","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rco34mt1QX"}],"urlSource":"https://apps.sentinel-hub.com/eo-browser/?zoom=10\u0026lat=41.9\u0026lng=12.5\u0026themeId=DEFAULT-THEME","key":"P81q8wV1sk"}],"key":"rSNgXs3DYm"}],"visibility":"show","key":"JRGmeKe01v"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.018196,"end_time":"2022-10-13T12:28:49.849753","exception":false,"start_time":"2022-10-13T12:28:49.831557","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"the identified date below is an almost cloud free image of Sentinel 2 over the area of Kuala Lumpur. In case of other AOI you need to identify a proper date as explained above and set here the updated one","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hLihBx2EFe"}],"key":"iFrJ5fX7O3"}],"visibility":"show","key":"sXH81Mwypf"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:28:49.907170Z","iopub.status.busy":"2022-10-13T12:28:49.906717Z","iopub.status.idle":"2022-10-13T12:28:49.926347Z","shell.execute_reply":"2022-10-13T12:28:49.925122Z"},"papermill":{"duration":0.056189,"end_time":"2022-10-13T12:28:49.928516","exception":false,"start_time":"2022-10-13T12:28:49.872327","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Start and end date for Kuala Lumpur use case\ndate_start = \"2020-05-18\"\ndate_end = \"2020-05-18\"","visibility":"show","key":"I0v7Uxs2kD"},{"type":"output","id":"NL_d4Z6zyiRyZCVRwrRUD","data":[],"visibility":"show","key":"jj2rvfod3F"}],"visibility":"show","key":"F1afEuTCHr"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.014624,"end_time":"2022-10-13T12:28:49.960811","exception":false,"start_time":"2022-10-13T12:28:49.946187","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Open Street Maps (OSM)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GLRfC9m0bS"}],"identifier":"open-street-maps-osm","label":"Open Street Maps (OSM)","html_id":"open-street-maps-osm","implicit":true,"key":"Y0TUEyXrYg"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Trucks are only detected on roads obtained from OSM.\nYou may specify road types to include. Their descriptions can be found here:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Qx2H0Y8Ca9"},{"type":"break","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"eCNrDcWFZD"},{"type":"link","url":"https://wiki.openstreetmap.org/wiki/Key:highway","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"https://​wiki​.openstreetmap​.org​/wiki​/Key:highway","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"U6UgeWB3SY"}],"urlSource":"https://wiki.openstreetmap.org/wiki/Key:highway","key":"VBz2UijrqH"}],"key":"PmV25r1PNs"}],"visibility":"show","key":"B1N6WSyxRh"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:28:49.991442Z","iopub.status.busy":"2022-10-13T12:28:49.990496Z","iopub.status.idle":"2022-10-13T12:28:50.000636Z","shell.execute_reply":"2022-10-13T12:28:49.997940Z"},"papermill":{"duration":0.028425,"end_time":"2022-10-13T12:28:50.003607","exception":false,"start_time":"2022-10-13T12:28:49.975182","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"osm_values = [\"motorway\", \"trunk\", \"primary\"] # all of key \"highway\"\nroads_buffer = 0.00022 # degree, OSM road vectors are buffered, for motorway, the others lower","visibility":"show","key":"w8JA5NtMEa"},{"type":"output","id":"JlQBio3da6Uy6kJQDqr89","data":[],"visibility":"show","key":"zavxYcb3Oa"}],"visibility":"show","key":"AAvlKIDwj8"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.01477,"end_time":"2022-10-13T12:28:50.032851","exception":false,"start_time":"2022-10-13T12:28:50.018081","status":"completed"},"tags":[]},"children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HisVo0GKVS"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Processing methods","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"z1NAO4LW5x"}],"identifier":"processing-methods","label":"Processing methods","html_id":"processing-methods","implicit":true,"key":"lO9kWKqsCr"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In the following cells all needed methods are defined. They will be invoked further below.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"V8DfrT9NHl"}],"key":"im9GBPezvj"}],"visibility":"show","key":"P4OmqNU9oJ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:28:50.076593Z","iopub.status.busy":"2022-10-13T12:28:50.076010Z","iopub.status.idle":"2022-10-13T12:28:50.123886Z","shell.execute_reply":"2022-10-13T12:28:50.122514Z"},"papermill":{"duration":0.074278,"end_time":"2022-10-13T12:28:50.128373","exception":false,"start_time":"2022-10-13T12:28:50.054095","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# re-order bbox from W,S,E,N to S,W,N,E, starting from the bbox defined at the beginning\n\ndef convert_bbox_osm(bbox):\n    offset = 0.05 # add a buffer to bbox in order to be sure cube is entirely covered, pay attention to the signs before the adding the offset\n    bbox_osm = [bbox[1], bbox[0], bbox[3], bbox[2]]\n    bbox_osm[0] -= offset # min lat\n    bbox_osm[1] -= offset # min lon\n    bbox_osm[2] += offset # max lat\n    bbox_osm[3] += offset # max lon\n    return bbox_osm\n\n# bbox List of four coords\n# osm_value String OSM value\n# osm_key String OSM key\n# element_type List of String\n# returns GeoDataFrame\ndef get_osm(bbox, \n            osm_value,\n            element_type = [\"way\", \"relation\"]):\n    osm_key = \"highway\"\n    bbox_osm = convert_bbox_osm(bbox)\n    quot = '\"'\n    select = quot+osm_key+quot + '=' + quot+osm_value+quot\n    select_link = select.replace(osm_value, osm_value + \"_link\") # also get road links\n    select_junction = select.replace(osm_value, osm_value + \"_junction\")\n    geoms = []\n    for selector in [select, select_link, select_junction]:  \n        try:\n            query = overpassQueryBuilder(bbox=bbox_osm, \n                                         elementType=element_type, \n                                         selector=selector, \n                                         out='body',\n                                         includeGeometry=True)\n            elements = Overpass().query(query, timeout=60).elements()\n            # create multiline of all elements\n            if len(elements) \u003e 0:\n                for i in range(len(elements)):\n                    elem = elements[i]\n                    geoms.append(elem.geometry())\n        except:\n            Warning(\"Could not retrieve \" + select)\n    try:\n        lines = gpd.GeoDataFrame(crs = \"EPSG:4326\", geometry = geoms)\n        n = len(geoms)\n        lines[\"osm_value\"] = [osm_value]*n # add road type\n        return lines\n    except:\n        Warning(\"Could not merge \" + osm_value)\n        \n# buffer Float road buffer distance [m]\n# bbox List of four coords\n# bbox_id Integer processing id of bbox\n# osm_values List of String OSM values\n# osm_key String OSM key\n# roads_buffer Float buffer width\n# returns GeoDataFrame\ndef get_roads(bbox, osm_values, roads_buffer):\n    osm_key = \"highway\"\n    roads = []\n    has_error = []\n    offset = 0.00002\n    buffer_dist = \"buffer_distance\"\n    # buffer according to road type\n    m,t,p,s,ter = \"motorway\", \"trunk\", \"primary\", \"secondary\", \"tertiary\"\n    buffers = {m:roads_buffer, t:roads_buffer-offset, p:roads_buffer-(2*offset), s:roads_buffer-(3*offset), ter:roads_buffer-(4*offset)}\n    osm_values_int = {m:1, t:2, p:3, s:4, ter:5}\n    for osm_value in osm_values:\n        roads_osm = get_osm(bbox, osm_value)\n        try:\n            roads_osm = get_osm(bbox, osm_value)\n            roads_osm[buffer_dist] = [buffers[osm_value]] * len(roads_osm)\n            roads_osm[\"osm_value_int\"] = osm_values_int[osm_value]\n            roads.append(roads_osm)\n        except:\n            has_error.append(1)\n            print(\"'get_osm'\" + \"failed for bbox_id osm_value \" + osm_value + \"osm_key\" + osm_key)\n    if len(roads) \u003e len(has_error):\n        roads_merge = gpd.GeoDataFrame(pd.concat(roads, ignore_index=True), crs=roads[0].crs)\n        buffered = roads_merge.buffer(distance=roads_merge[buffer_dist])\n        roads_merge.geometry = buffered\n        return roads_merge\n\n# osm geodataframe of polygons\n# reference_raster xarray with lat and lon\n# returns numpy array\ndef rasterize_osm(osm, reference_raster):\n    osm_values = list(set(osm[\"osm_value\"]))\n    nan_placeholder = 100\n    road_rasters = []\n    for osm_value in osm_values:\n        osm_subset = osm[osm[\"osm_value\"] == osm_value]\n        raster = rasterize(osm_subset, reference_raster.lat, reference_raster.lon)\n        cond = np.isfinite(raster)\n        raster_osm = np.where(cond, list(osm_subset.osm_value_int)[0], nan_placeholder) # use placeholder instead of nan first\n        raster_osm = raster_osm.astype(np.float)\n        road_rasters.append(raster_osm)        \n    # merge road types in one layer\n    road_raster_np = np.array(road_rasters).min(axis=0) # now use the lowest value (highest road level) because some intersect\n    road_raster_np[road_raster_np == nan_placeholder] = 0\n    return road_raster_np # 0=no_road 1=motorway, 2=trunk, ...\n\ndef transform_lat_lon(lat, lon):\n    lat = np.asarray(lat)\n    lon = np.asarray(lon)\n    trans = Affine.translation(lon[0], lat[0])\n    scale = Affine.scale(lon[1] - lon[0], lat[1] - lat[0])\n    return trans * scale\n\ndef rasterize(polygons, lat, lon, fill=np.nan):\n    transform = transform_lat_lon(lat, lon)\n    out_shape = (len(lat), len(lon))\n    raster = features.rasterize(polygons.geometry, out_shape=out_shape,\n                                fill=fill, transform=transform,\n                                dtype=float)\n    return xr.DataArray(raster, coords={\"lat\":lat, \"lon\":lon}, dims=(\"lat\", \"lon\"))","visibility":"show","key":"obukJMlzQC"},{"type":"output","id":"TN_bxYMR3-7prqo_pB8VA","data":[],"visibility":"show","key":"kiHDyrG4Cc"}],"visibility":"show","key":"JosSXPcGvw"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:28:50.167983Z","iopub.status.busy":"2022-10-13T12:28:50.166447Z","iopub.status.idle":"2022-10-13T12:28:50.241216Z","shell.execute_reply":"2022-10-13T12:28:50.240004Z"},"papermill":{"duration":0.09808,"end_time":"2022-10-13T12:28:50.243750","exception":false,"start_time":"2022-10-13T12:28:50.145670","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# TruckDetector detects trucks at acquisition-level\nclass TruckDetector():   \n    def __init__(self, band_stack):\n        is_none = band_stack is None\n        self.band_stack = band_stack.chunk(band_stack.dims[\"lat\"], band_stack.dims[\"lon\"]) if not is_none else None\n        self.no_truck_mask = None\n        self.trucks = None\n    \n    def detect(self):\n        B02 = self.band_stack.B02.persist().values\n        B03 = self.band_stack.B03.persist().values\n        B04 = self.band_stack.B04.persist().values\n        B08 = self.band_stack.B08.persist().values\n        B11 = self.band_stack.B11.persist().values\n        no_truck_mask = calc_no_trucks(B02, B03, B04, B08, B11)\n        trucks = detect_trucks(B02, B03, B04, no_truck_mask)\n        lon_lat = {\"lat\":self.band_stack.lat, \"lon\":self.band_stack.lon}\n        self.no_truck_mask = xr.DataArray(no_truck_mask, coords=lon_lat, dims=(\"lat\", \"lon\"))\n        self.trucks = xr.DataArray(trucks, coords=lon_lat, dims=(\"lat\", \"lon\")).astype(np.int)\n        self.filter_trucks()\n                            \n    def filter_trucks(self):\n        self.trucks = filter_spatial_3x3_extended(self.trucks)\n        \n# take xarray and ensure each value with 1 in data has no neighbor with 1 in an extended 3x3 block. Extended means: horizontally and vertically\n# it is also checked for the second-next pixel\n# Method checks only surrounding of values equal 1\n# arr xarray DataArray with values and lat lon\ndef filter_spatial_3x3_extended(arr):\n    values = arr.values\n    lon = arr.lon\n    lat = arr.lat\n    valid = np.where(arr == 1)\n    for y,x in zip(valid[0], valid[1]):\n        y_above = y - 1\n        y_above_next = y - 2\n        x_left = x - 1\n        x_right = x + 1\n        x_left_next = x - 2\n        space_left = x_left \u003e= 0\n        space_right = x_right \u003e= 0 and x_right \u003c len(lon)\n        space_above = y_above \u003e= 0\n        val_left_above = values[y_above, x_left] if space_left and space_above else 0\n        val_right_above = values[y_above, x_right] if space_right and space_above else 0\n        val_left = values[y, x_left] if space_left else 0\n        val_above = values[y_above, x] if space_above else 0\n        val_left_next = values[y, x_left_next] if x_left_next \u003e= 0 else 0\n        val_above_next = values[y_above_next, x] if y_above_next \u003e= 0 else 0\n        # if any of the values left, above and left above has 1 set current value 0\n        if (val_left_above + val_right_above + val_left + val_above + val_left_next + val_above_next) \u003e= 1:\n            values[y,x] = 0\n    arr.values = values\n    return arr\n\n# extracts coordinates at value in np array and returns points as GeoDataFrame\n# data 2d np array\n# match_value Float value in data where point coordinates are extracted\n# lon_lat dict of:\n### \"lon\": np array longitude values\"\n### \"lat\": np array latitude values\"\n# crs String EPSG:XXXX\ndef points_from_np(data, match_value, lon_lat, crs):\n    indices = np.argwhere(data == match_value)\n    if len(indices) \u003e 0:\n        lat_indices = indices[:,[0]]\n        lon_indices = indices[:,[1]]\n        lat_coords = lon_lat[\"lat\"][lat_indices]\n        lon_coords = lon_lat[\"lon\"][lon_indices]\n        points = gpd.GeoDataFrame(geometry = gpd.points_from_xy(lon_coords, lat_coords))\n        points.crs = crs\n        return points\n    \ndef raster_to_points(raster, lon_lat, field_name, crs):\n    points_list = []\n    match_values = np.unique(raster[(raster != 0) * ~np.isnan(raster)]) # by pixel value\n    for x in match_values:\n        points = points_from_np(raster, x, lon_lat, crs=crs)\n        points[field_name] = [x] * len(points)\n        points_list.append(points)\n    return gpd.GeoDataFrame(pd.concat(points_list, ignore_index=True))\n        \n# Calculate a binary mask where pixels that are definitely no trucks are represented as 0. A dictionary with a set of trheshold values is required to reduce or avoid false detection on specific land cover types\n# thresholds Dict with at least:\n### max_ndvi Float above this val: no trucks. For Vegetation\n### max_ndwi Float above this val: no trucks. For Water\n### max_ndsi Float above this val: no_trucks. For Snow\n### min_rgb Float above this val: no_trucks. For dark surfaces, e.g. shadows\n### max_blue Float above this val: no_trucks\n### max_green Float above this val: no trucks\n### max_red Float above this val: no trucks\n### min_b11 Float below this val: no trucks. For dark surfaces, e.g. shadows\n### max_b11 Float below this val: no trucks. For bright (sealed) surfaces, e.g. buildings\n@jit(nopython=True, parallel=True)\ndef calc_no_trucks(B02, B03, B04, B08, B11):\n    th = {\"min_blue\":0.06, \n          \"min_green\":0.04, \n          \"min_red\":0.04,\n          \"max_red\":0.15,\n          \"max_green\":0.15,\n          \"max_blue\":0.2,\n          \"max_ndvi\":0.5,\n          \"max_ndwi\":0.0001,\n          \"max_ndsi\":0.0001,\n          \"min_blue_green_ratio\":0.03,\n          \"min_blue_red_ratio\":0.05, \n          \"max_blue_green_ratio\":0.17, \n          \"max_blue_red_ratio\":0.2}\n    ndvi_mask = ratio(B08, B04) \u003c th[\"max_ndvi\"]\n    ndwi_mask = ratio(B02, B11) \u003c th[\"max_ndwi\"]\n    ndsi_mask = ratio(B03, B11) \u003c th[\"max_ndsi\"]\n    low_rgb_mask = (B02 \u003e th[\"min_blue\"]) * (B03 \u003e th[\"min_green\"]) * (B04 \u003e th[\"min_red\"])\n    high_rgb_mask = (B02 \u003c th[\"max_blue\"]) * (B03 \u003c th[\"max_green\"]) * (B04 \u003c th[\"max_red\"])\n    no_truck_mask = ndvi_mask * ndwi_mask * ndsi_mask * low_rgb_mask * high_rgb_mask\n    return no_truck_mask\n\n# Calculate a binary mask where trucks are represented as 1 and no trucks as 0.\n# thresholds Dict with at least:\n### min_green_ratio Float, minimum value of blue-green ratio\n### min_red_ratio Float, minimum value of blue-red ratio\n@jit(nopython=True, parallel=True)\ndef detect_trucks(B02, B03, B04, no_truck_mask):\n    th = {\"min_blue\":0.06, \n          \"min_green\":0.04, \n          \"min_red\":0.04,\n          \"max_red\":0.15,\n          \"max_green\":0.15,\n          \"max_blue\":0.2,\n          \"max_ndvi\":0.5,\n          \"max_ndwi\":0.0001,\n          \"max_ndsi\":0.0001,\n          \"min_blue_green_ratio\":0.03,\n          \"min_blue_red_ratio\":0.05, \n          \"max_blue_green_ratio\":0.17, \n          \"max_blue_red_ratio\":0.2}\n    bg_ratio = ratio(B02, B03)\n    br_ratio = ratio(B02, B04)\n    bg = bg_ratio \u003e th[\"min_blue_green_ratio\"]\n    br = br_ratio \u003e th[\"min_blue_red_ratio\"]\n    bg_max = bg_ratio \u003c th[\"max_blue_green_ratio\"]\n    br_max = br_ratio \u003c th[\"max_blue_red_ratio\"]\n    trucks = (bg * br * bg_max * br_max) * no_truck_mask\n    return trucks\n\n@jit(nopython=True, parallel=True)\ndef ratio(a, b):\n    return (a-b)/(a+b)","visibility":"show","key":"NT02BTuzKb"},{"type":"output","id":"8vxCDFNUFQY2Z7cEtx-_D","data":[],"visibility":"show","key":"K3vCtz4Fqv"}],"visibility":"show","key":"MHOsK8sBzl"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:28:50.278600Z","iopub.status.busy":"2022-10-13T12:28:50.277141Z","iopub.status.idle":"2022-10-13T12:28:50.297519Z","shell.execute_reply":"2022-10-13T12:28:50.295873Z"},"papermill":{"duration":0.042165,"end_time":"2022-10-13T12:28:50.301186","exception":false,"start_time":"2022-10-13T12:28:50.259021","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# AcquisitionProcessor processes all valid pixels of a single acquisition in cube\nclass AcquisitionProcessor():\n    def __init__(self, date_np64, cube):\n        self.date_np64 = date_np64\n        self.cube = cube\n        self.band_stack = cube.sel(time = date_np64)\n        self.detector = None\n        self.no_clouds = None\n        self.osm_mask = None\n           \n    def mask_clouds(self):\n        cloud_masking_thresholds = {\"rgb\":0.25,\"blue_green\":0.2,\"blue_red\":0.2}\n        scl = MaskSet(self.band_stack.SCL)\n        high_prob = scl.clouds_high_probability\n        med_prob = scl.clouds_medium_probability\n        cirrus = scl.cirrus\n        no_data = scl.no_data\n        rgb_cloud_mask = calc_rgb_cloud_mask(self.band_stack, cloud_masking_thresholds)\n        self.no_clouds = (high_prob + med_prob + cirrus + no_data + rgb_cloud_mask) == 0\n        self.band_stack = self.band_stack.where(self.no_clouds)\n    \n    def mask_with_osm(self, osm_mask):\n        self.osm_mask = osm_mask\n        self.band_stack = self.band_stack.where(self.osm_mask != 0)\n                \n    def do_detection(self):\n        self.detector = TruckDetector(self.band_stack)\n        self.detector.detect()\n        \ndef calc_rgb_cloud_mask(band_stack, cloud_masking_thresholds):\n    B02, B03, B04 = band_stack.B02, band_stack.B03, band_stack.B04\n    c = cloud_masking_thresholds[\"rgb\"]\n    clouds_rgb = ((B02 \u003e c) + (B03 \u003e c) + (B04 \u003e c)) \u003e= 1\n    # attempt to mask haze without masking out truck pixels (similar! higher blue than red and green)\n    blue_green_ratio = (B02-B03) / (B02+B03)\n    blue_red_ratio = (B02-B04) / (B02+B04)\n    clouds_blue_green = blue_green_ratio \u003e cloud_masking_thresholds[\"blue_green\"]\n    clouds_blue_red = blue_red_ratio \u003e cloud_masking_thresholds[\"blue_red\"]\n    clouds = (clouds_rgb + clouds_blue_green + clouds_blue_red) \u003e= 1\n    return clouds","visibility":"show","key":"n3PBXQcQRc"},{"type":"output","id":"X4KeuU1Qc743yp8Ysd1yZ","data":[],"visibility":"show","key":"SpkHoXkTvZ"}],"visibility":"show","key":"eDnsdq977N"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.018542,"end_time":"2022-10-13T12:28:50.340181","exception":false,"start_time":"2022-10-13T12:28:50.321639","status":"completed"},"tags":[]},"children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZpwzmxLspS"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Get Sentinel-2 L2A xcube","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"tvdYwA2EB8"}],"identifier":"get-sentinel-2-l2a-xcube","label":"Get Sentinel-2 L2A xcube","html_id":"get-sentinel-2-l2a-xcube","implicit":true,"key":"td5OzX3e2v"}],"visibility":"show","key":"UrFw4CKWSc"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.0184,"end_time":"2022-10-13T12:28:50.376972","exception":false,"start_time":"2022-10-13T12:28:50.358572","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the following cell you need to configure the cube and the interested bbox of the AOI, so please be careful in aligning the below bbox variable and the time range start and end dates with the one desidere at the beginning of the notebook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jzp4surRfF"}],"key":"w8K1ehSj8l"}],"visibility":"show","key":"B5iyl1pjzq"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:28:50.432408Z","iopub.status.busy":"2022-10-13T12:28:50.432027Z","iopub.status.idle":"2022-10-13T12:28:50.705997Z","shell.execute_reply":"2022-10-13T12:28:50.704190Z"},"papermill":{"duration":0.298156,"end_time":"2022-10-13T12:28:50.708975","exception":false,"start_time":"2022-10-13T12:28:50.410819","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"config = CubeConfig(dataset_name = \"S2L2A\",\n                    band_names = [\"B02\", \"B03\", \"B04\", \"B08\", \"B11\", \"SCL\"],\n                    tile_size = [512, 512],\n                    bbox = bbox,\n                    spatial_res = 0.00009,\n                    time_range = [date_start, date_end],\n                    time_period='2D')\ncube = open_cube(config)","visibility":"show","key":"CsdiVtQByk"},{"type":"output","id":"tEC7PDVhwHlbexB4uDmZ8","data":[],"visibility":"show","key":"NHDvGBmYo8"}],"visibility":"show","key":"ebJVaUOUlE"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.017201,"end_time":"2022-10-13T12:28:50.742504","exception":false,"start_time":"2022-10-13T12:28:50.725303","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Acquisition","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tnTyWzMVfL"}],"identifier":"acquisition","label":"Acquisition","html_id":"acquisition","implicit":true,"key":"IW7ICO4BiJ"}],"visibility":"show","key":"Yr0KIax4L0"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:28:50.806669Z","iopub.status.busy":"2022-10-13T12:28:50.806183Z","iopub.status.idle":"2022-10-13T12:28:50.823263Z","shell.execute_reply":"2022-10-13T12:28:50.820595Z"},"papermill":{"duration":0.048946,"end_time":"2022-10-13T12:28:50.828337","exception":false,"start_time":"2022-10-13T12:28:50.779391","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"acquisition = AcquisitionProcessor(cube.time.values[0], cube)","visibility":"show","key":"RalmeNTyNR"},{"type":"output","id":"WydWT_ZU8KRxT8-7mqJSf","data":[],"visibility":"show","key":"rKdC8hrc2K"}],"visibility":"show","key":"FIzWiO8Zkb"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.015457,"end_time":"2022-10-13T12:28:50.863251","exception":false,"start_time":"2022-10-13T12:28:50.847794","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot RGB","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ni01nuj2Q1"}],"identifier":"plot-rgb","label":"Plot RGB","html_id":"plot-rgb","implicit":true,"key":"GUkQa6edui"}],"visibility":"show","key":"hZ75FGc2IE"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:28:50.902491Z","iopub.status.busy":"2022-10-13T12:28:50.901711Z","iopub.status.idle":"2022-10-13T12:29:19.535264Z","shell.execute_reply":"2022-10-13T12:29:19.533957Z"},"papermill":{"duration":28.693716,"end_time":"2022-10-13T12:29:19.574936","exception":false,"start_time":"2022-10-13T12:28:50.881220","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"rgb_bands = [\"B04\", \"B03\", \"B02\"]\ncoords, dims = [rgb_bands, cube.lat, cube.lon], [\"bands\", \"lat\", \"lon\"]\nrgb = np.vstack([cube.B04.persist().values, cube.B03.persist().values, cube.B02.persist().values])\nrgb_xr = xr.DataArray(rgb, coords=coords, dims=dims)\nrgb_xr.plot.imshow(figsize=[12,10], rgb=\"bands\", vmin=0, vmax=0.4)\nrgb, rgb_xr = None, None","visibility":"show","key":"FPfIZHwG6G"},{"type":"output","id":"fFh2-l680e1uGc0U6rNhJ","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"deb46d05a9203f219375388bafe9a6f5","path":"/notebooks_test/build/deb46d05a9203f219375388bafe9a6f5.png"},"text/plain":{"content":"\u003cFigure size 1200x1000 with 1 Axes\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"n8VDcy0le9"}],"visibility":"show","key":"ER7KpznDdS"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.063014,"end_time":"2022-10-13T12:29:19.700087","exception":false,"start_time":"2022-10-13T12:29:19.637073","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"RGB reflectance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UC8tx5H5cS"}],"key":"u6nA3Vy22y"}],"visibility":"show","key":"VQUZ30yVju"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.0578,"end_time":"2022-10-13T12:29:19.809337","exception":false,"start_time":"2022-10-13T12:29:19.751537","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Get OSM roads","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VHrghEyF1X"}],"identifier":"get-osm-roads","label":"Get OSM roads","html_id":"get-osm-roads","implicit":true,"key":"IFGjfGFbgr"}],"visibility":"show","key":"yJFNhpQGIA"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:29:19.933011Z","iopub.status.busy":"2022-10-13T12:29:19.931918Z","iopub.status.idle":"2022-10-13T12:31:07.490240Z","shell.execute_reply":"2022-10-13T12:31:07.487858Z"},"papermill":{"duration":107.611349,"end_time":"2022-10-13T12:31:07.492789","exception":false,"start_time":"2022-10-13T12:29:19.881440","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"osm_roads = get_roads(bbox, osm_values, roads_buffer)\nosm_roads.plot(figsize=[12,10])","visibility":"show","key":"vfmBHbtLrU"},{"type":"output","id":"2Alah3Yn_Y8MYvqCLiW8C","data":[{"name":"stderr","output_type":"stream","text":"[overpass] downloading data: [timeout:60][out:json];(way[\"highway\"=\"motorway\"](3.0,101.557,3.25,101.80069999999999);relation[\"highway\"=\"motorway\"](3.0,101.557,3.25,101.80069999999999);); out body geom;\n"},{"name":"stderr","output_type":"stream","text":"[overpass] downloading data: [timeout:60][out:json];(way[\"highway\"=\"motorway_link\"](3.0,101.557,3.25,101.80069999999999);relation[\"highway\"=\"motorway_link\"](3.0,101.557,3.25,101.80069999999999);); out body geom;\n"},{"name":"stderr","output_type":"stream","text":"[overpass] downloading data: [timeout:60][out:json];(way[\"highway\"=\"motorway_junction\"](3.0,101.557,3.25,101.80069999999999);relation[\"highway\"=\"motorway_junction\"](3.0,101.557,3.25,101.80069999999999);); out body geom;\n"},{"name":"stderr","output_type":"stream","text":"[overpass] downloading data: [timeout:60][out:json];(way[\"highway\"=\"trunk\"](3.0,101.557,3.25,101.80069999999999);relation[\"highway\"=\"trunk\"](3.0,101.557,3.25,101.80069999999999);); out body geom;\n"},{"name":"stderr","output_type":"stream","text":"[OSMPythonTools.Element] Cannot build geometry: no outer rings found.\nNoneType: None\n"},{"name":"stderr","output_type":"stream","text":"[OSMPythonTools.Element] Cannot build geometry: no outer rings found. (relation/6110277)\nTraceback (most recent call last):\n  File \"/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages/OSMPythonTools/element.py\", line 186, in __geometry\n    self._raiseException('Cannot build geometry: no outer rings found.')\n  File \"/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages/OSMPythonTools/element.py\", line 50, in _raiseException\n    OSMPythonTools._raiseException('Element', msg)\n  File \"/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages/OSMPythonTools/__init__.py\", line 13, in _raiseException\n    raise(Exception(msgComplete))\nException: [OSMPythonTools.Element] Cannot build geometry: no outer rings found.\n"},{"name":"stderr","output_type":"stream","text":"[overpass] downloading data: [timeout:60][out:json];(way[\"highway\"=\"trunk_link\"](3.0,101.557,3.25,101.80069999999999);relation[\"highway\"=\"trunk_link\"](3.0,101.557,3.25,101.80069999999999);); out body geom;\n"},{"name":"stderr","output_type":"stream","text":"[overpass] downloading data: [timeout:60][out:json];(way[\"highway\"=\"trunk_junction\"](3.0,101.557,3.25,101.80069999999999);relation[\"highway\"=\"trunk_junction\"](3.0,101.557,3.25,101.80069999999999);); out body geom;\n"},{"name":"stderr","output_type":"stream","text":"[OSMPythonTools.Element] Cannot build geometry: no outer rings found.\nNoneType: None\n"},{"name":"stderr","output_type":"stream","text":"[OSMPythonTools.Element] Cannot build geometry: no outer rings found. (relation/6110277)\nTraceback (most recent call last):\n  File \"/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages/OSMPythonTools/element.py\", line 186, in __geometry\n    self._raiseException('Cannot build geometry: no outer rings found.')\n  File \"/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages/OSMPythonTools/element.py\", line 50, in _raiseException\n    OSMPythonTools._raiseException('Element', msg)\n  File \"/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages/OSMPythonTools/__init__.py\", line 13, in _raiseException\n    raise(Exception(msgComplete))\nException: [OSMPythonTools.Element] Cannot build geometry: no outer rings found.\n"},{"name":"stderr","output_type":"stream","text":"[overpass] downloading data: [timeout:60][out:json];(way[\"highway\"=\"primary\"](3.0,101.557,3.25,101.80069999999999);relation[\"highway\"=\"primary\"](3.0,101.557,3.25,101.80069999999999);); out body geom;\n"},{"name":"stderr","output_type":"stream","text":"[overpass] downloading data: [timeout:60][out:json];(way[\"highway\"=\"primary_link\"](3.0,101.557,3.25,101.80069999999999);relation[\"highway\"=\"primary_link\"](3.0,101.557,3.25,101.80069999999999);); out body geom;\n"},{"name":"stderr","output_type":"stream","text":"[overpass] downloading data: [timeout:60][out:json];(way[\"highway\"=\"primary_junction\"](3.0,101.557,3.25,101.80069999999999);relation[\"highway\"=\"primary_junction\"](3.0,101.557,3.25,101.80069999999999);); out body geom;\n"},{"name":"stderr","output_type":"stream","text":"The requested data could not be downloaded. HTTP Error 504: Gateway Timeout\nTraceback (most recent call last):\n  File \"/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/site-packages/OSMPythonTools/internal/cacheObject.py\", line 95, in __query\n    response = urllib.request.urlopen(request)\n  File \"/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/urllib/request.py\", line 214, in urlopen\n    return opener.open(url, data, timeout)\n  File \"/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/urllib/request.py\", line 523, in open\n    response = meth(req, response)\n  File \"/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/urllib/request.py\", line 632, in http_response\n    response = self.parent.error(\n  File \"/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/urllib/request.py\", line 561, in error\n    return self._call_chain(*args)\n  File \"/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/urllib/request.py\", line 494, in _call_chain\n    result = func(*args)\n  File \"/opt/conda/envs/edc-default-2022.10-14/lib/python3.9/urllib/request.py\", line 641, in http_error_default\n    raise HTTPError(req.full_url, code, msg, hdrs, fp)\nurllib.error.HTTPError: HTTP Error 504: Gateway Timeout\n"},{"name":"stderr","output_type":"stream","text":"[overpass] downloading data: [timeout:60][out:json];(way[\"highway\"=\"primary_junction\"](3.0,101.557,3.25,101.80069999999999);relation[\"highway\"=\"primary_junction\"](3.0,101.557,3.25,101.80069999999999);); out body geom;\n"},{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_1994/1510730153.py:79: UserWarning: Geometry is in a geographic CRS. Results from 'buffer' are likely incorrect. Use 'GeoSeries.to_crs()' to re-project geometries to a projected CRS before this operation.\n\n  buffered = roads_merge.buffer(distance=roads_merge[buffer_dist])\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"dd62314b49a1d2bb7e274711fa1d1626","path":"/notebooks_test/build/dd62314b49a1d2bb7e274711fa1d1626.png"},"text/plain":{"content":"\u003cFigure size 1200x1000 with 1 Axes\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"Ur6e7q7y4r"}],"visibility":"show","key":"w7uyAuO840"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.050224,"end_time":"2022-10-13T12:31:07.602194","exception":false,"start_time":"2022-10-13T12:31:07.551970","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The OSM road vectors are buffered, hence we see polygons here.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ypnEUW3q7r"}],"key":"KArLJkplFn"}],"visibility":"show","key":"cLnJHw0ywV"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.046799,"end_time":"2022-10-13T12:31:07.706914","exception":false,"start_time":"2022-10-13T12:31:07.660115","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Rasterize OSM roads to S2 cube","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yx4J5px1dr"}],"identifier":"rasterize-osm-roads-to-s2-cube","label":"Rasterize OSM roads to S2 cube","html_id":"rasterize-osm-roads-to-s2-cube","implicit":true,"key":"oipwMxMB6Q"}],"visibility":"show","key":"GlpdTtk5oJ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:07.804880Z","iopub.status.busy":"2022-10-13T12:31:07.804413Z","iopub.status.idle":"2022-10-13T12:31:09.469225Z","shell.execute_reply":"2022-10-13T12:31:09.468260Z"},"papermill":{"duration":1.717294,"end_time":"2022-10-13T12:31:09.473573","exception":false,"start_time":"2022-10-13T12:31:07.756279","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"osm_roads_np = rasterize_osm(osm_roads, cube.B02)","visibility":"show","key":"HCLuPhKRmM"},{"type":"output","id":"IWSieV7ciyyoIKlVTlaM2","data":[{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_1994/1510730153.py:95: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.\nDeprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations\n  raster_osm = raster_osm.astype(np.float)\n"},{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_1994/1510730153.py:95: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.\nDeprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations\n  raster_osm = raster_osm.astype(np.float)\n"},{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_1994/1510730153.py:95: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.\nDeprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations\n  raster_osm = raster_osm.astype(np.float)\n"}],"visibility":"show","key":"ti1hJ9bBEF"}],"visibility":"show","key":"T7MKppE6Zt"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.053111,"end_time":"2022-10-13T12:31:09.594043","exception":false,"start_time":"2022-10-13T12:31:09.540932","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Mask","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YRPD2qZnw6"}],"identifier":"mask","label":"Mask","html_id":"mask","implicit":true,"key":"xgCRz34Bzt"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In case there are clouds in the imagery, they are masked out here. Furthermore, the data is constrained to the OSM roads.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BOZQ0reuKS"}],"key":"BgOPhGBIAu"}],"visibility":"show","key":"ljK5zheSQj"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.05156,"end_time":"2022-10-13T12:31:09.713426","exception":false,"start_time":"2022-10-13T12:31:09.661866","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Clouds","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"arnSzbhN9E"}],"identifier":"clouds","label":"Clouds","html_id":"clouds","implicit":true,"key":"Ar8mSpuSgh"}],"visibility":"show","key":"X4O2CGSxs1"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:09.830398Z","iopub.status.busy":"2022-10-13T12:31:09.829805Z","iopub.status.idle":"2022-10-13T12:31:09.956936Z","shell.execute_reply":"2022-10-13T12:31:09.955727Z"},"papermill":{"duration":0.192997,"end_time":"2022-10-13T12:31:09.959427","exception":false,"start_time":"2022-10-13T12:31:09.766430","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"acquisition.mask_clouds()","visibility":"show","key":"caZmYkw5Y7"},{"type":"output","id":"nj0ysuVxcdb4mWXXpDpn9","data":[],"visibility":"show","key":"Lz7kylrtGu"}],"visibility":"show","key":"fZzfbr68SN"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.048948,"end_time":"2022-10-13T12:31:10.065908","exception":false,"start_time":"2022-10-13T12:31:10.016960","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To OSM roads","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QKb2fJdhwO"}],"identifier":"to-osm-roads","label":"To OSM roads","html_id":"to-osm-roads","implicit":true,"key":"ku8kagm6ey"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Only pixels within the buffered OSM roads are considered.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"u5GRlQJjtU"}],"key":"o4Fla7zzRj"}],"visibility":"show","key":"DwG8vZ9j2s"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:10.173261Z","iopub.status.busy":"2022-10-13T12:31:10.172770Z","iopub.status.idle":"2022-10-13T12:31:10.241702Z","shell.execute_reply":"2022-10-13T12:31:10.240702Z"},"papermill":{"duration":0.120114,"end_time":"2022-10-13T12:31:10.244233","exception":false,"start_time":"2022-10-13T12:31:10.124119","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"acquisition.mask_with_osm(osm_roads_np)","visibility":"show","key":"uT9jPnjdy8"},{"type":"output","id":"E98g5XRYNsU-lrfSdGet_","data":[],"visibility":"show","key":"wzx2a8Daz9"}],"visibility":"show","key":"r5JRyLoMhL"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.050594,"end_time":"2022-10-13T12:31:10.342836","exception":false,"start_time":"2022-10-13T12:31:10.292242","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Detect trucks","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BIm4INOdn3"}],"identifier":"detect-trucks","label":"Detect trucks","html_id":"detect-trucks","implicit":true,"key":"v35Sqmrq3h"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This is the actual detection being invoked in the “do_detection” wrapper. The output is an xarray DataArray, which is afterwards converted to a GeoDataFrame of points.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"b72tHSHWTm"}],"key":"mzvIqFVhwG"}],"visibility":"show","key":"tuHznoeJc7"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:10.462115Z","iopub.status.busy":"2022-10-13T12:31:10.461069Z","iopub.status.idle":"2022-10-13T12:31:44.237645Z","shell.execute_reply":"2022-10-13T12:31:44.235942Z"},"papermill":{"duration":33.843165,"end_time":"2022-10-13T12:31:44.240501","exception":false,"start_time":"2022-10-13T12:31:10.397336","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"acquisition.do_detection()\n# raster detections to points\ntruck_points = raster_to_points(acquisition.detector.trucks.values, {\"lon\":cube.lon.values, \"lat\":cube.lat.values}, \"trucks\", \"EPSG:4326\")\ntruck_points.plot(figsize=[12,10])","visibility":"show","key":"pGjBlZ6fVY"},{"type":"output","id":"X9dIs46GEk0YQoiCI9qOv","data":[{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_1994/2429981473.py:19: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.\nDeprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations\n  self.trucks = xr.DataArray(trucks, coords=lon_lat, dims=(\"lat\", \"lon\")).astype(np.int)\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"39da16d695b5002c3a90f72edf054511","path":"/notebooks_test/build/39da16d695b5002c3a90f72edf054511.png"},"text/plain":{"content":"\u003cFigure size 1200x1000 with 1 Axes\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"GE807o5cFj"}],"visibility":"show","key":"bRi5fOzw4r"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.047713,"end_time":"2022-10-13T12:31:44.365681","exception":false,"start_time":"2022-10-13T12:31:44.317968","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Write detections","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PQCX1zGoLU"}],"identifier":"write-detections","label":"Write detections","html_id":"write-detections","implicit":true,"key":"WJdFWdtTJh"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"If you would like to write the truck points, simply modify the file path here","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"DH42vVTu7M"}],"key":"yEeecv7fXy"}],"visibility":"show","key":"cLv6PIV3Bh"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:44.477192Z","iopub.status.busy":"2022-10-13T12:31:44.476677Z","iopub.status.idle":"2022-10-13T12:31:44.600874Z","shell.execute_reply":"2022-10-13T12:31:44.599479Z"},"papermill":{"duration":0.183446,"end_time":"2022-10-13T12:31:44.603478","exception":false,"start_time":"2022-10-13T12:31:44.420032","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"truck_points.to_file(\"trucks.gpkg\", driver=\"GPKG\")","visibility":"show","key":"m8sSVyKnWD"},{"type":"output","id":"rbrbADilv1AM3hDJwyZ3R","data":[],"visibility":"show","key":"wCnkfvDrsx"}],"visibility":"show","key":"So6SMTkNhB"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:44.706641Z","iopub.status.busy":"2022-10-13T12:31:44.705394Z","iopub.status.idle":"2022-10-13T12:31:44.711620Z","shell.execute_reply":"2022-10-13T12:31:44.710399Z"},"papermill":{"duration":0.067009,"end_time":"2022-10-13T12:31:44.716770","exception":false,"start_time":"2022-10-13T12:31:44.649761","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import geopandas","visibility":"show","key":"cyE1UWciES"},{"type":"output","id":"Nev5aom7hB8LagqwGu8F8","data":[],"visibility":"show","key":"MV4vozglOC"}],"visibility":"show","key":"v5gOorfK5S"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.058935,"end_time":"2022-10-13T12:31:44.831362","exception":false,"start_time":"2022-10-13T12:31:44.772427","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Could be interesting to have a look at the geopackage fields and values, so ise the geopandas read_file to get more information on the file generated.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xKOCCBvsGA"}],"key":"rBNYbFNO9b"}],"visibility":"show","key":"ezFKjIh6wt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:44.952994Z","iopub.status.busy":"2022-10-13T12:31:44.951317Z","iopub.status.idle":"2022-10-13T12:31:45.010974Z","shell.execute_reply":"2022-10-13T12:31:45.008451Z"},"papermill":{"duration":0.122704,"end_time":"2022-10-13T12:31:45.015227","exception":false,"start_time":"2022-10-13T12:31:44.892523","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"trucks_gpkg = geopandas.read_file(\"trucks.gpkg\")\ntrucks_gpkg ","visibility":"show","key":"HIvweIEEpq"},{"type":"output","id":"wdFcvJu7jPLaneOrC-gtd","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003etrucks\u003c/th\u003e\n      \u003cth\u003egeometry\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0\u003c/th\u003e\n      \u003ctd\u003e1\u003c/td\u003e\n      \u003ctd\u003ePOINT (101.70758 3.23409)\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1\u003c/th\u003e\n      \u003ctd\u003e1\u003c/td\u003e\n      \u003ctd\u003ePOINT (101.68895 3.23328)\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2\u003c/th\u003e\n      \u003ctd\u003e1\u003c/td\u003e\n      \u003ctd\u003ePOINT (101.72441 3.23310)\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3\u003c/th\u003e\n      \u003ctd\u003e1\u003c/td\u003e\n      \u003ctd\u003ePOINT (101.67239 3.23292)\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e4\u003c/th\u003e\n      \u003ctd\u003e1\u003c/td\u003e\n      \u003ctd\u003ePOINT (101.67239 3.23265)\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e284\u003c/th\u003e\n      \u003ctd\u003e1\u003c/td\u003e\n      \u003ctd\u003ePOINT (101.68778 3.05950)\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e285\u003c/th\u003e\n      \u003ctd\u003e1\u003c/td\u003e\n      \u003ctd\u003ePOINT (101.63818 3.05877)\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e286\u003c/th\u003e\n      \u003ctd\u003e1\u003c/td\u003e\n      \u003ctd\u003ePOINT (101.68868 3.05509)\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e287\u003c/th\u003e\n      \u003ctd\u003e1\u003c/td\u003e\n      \u003ctd\u003ePOINT (101.70578 3.05382)\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e288\u003c/th\u003e\n      \u003ctd\u003e1\u003c/td\u003e\n      \u003ctd\u003ePOINT (101.69660 3.05041)\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e289 rows × 2 columns\u003c/p\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"     trucks                   geometry\n0         1  POINT (101.70758 3.23409)\n1         1  POINT (101.68895 3.23328)\n2         1  POINT (101.72441 3.23310)\n3         1  POINT (101.67239 3.23292)\n4         1  POINT (101.67239 3.23265)\n..      ...                        ...\n284       1  POINT (101.68778 3.05950)\n285       1  POINT (101.63818 3.05877)\n286       1  POINT (101.68868 3.05509)\n287       1  POINT (101.70578 3.05382)\n288       1  POINT (101.69660 3.05041)\n\n[289 rows x 2 columns]","content_type":"text/plain"}}}],"visibility":"show","key":"XsYk6AWkhM"}],"visibility":"show","key":"wG13jIIOfl"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.086874,"end_time":"2022-10-13T12:31:45.172736","exception":false,"start_time":"2022-10-13T12:31:45.085862","status":"completed"},"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Download the Sentinel 2 True color image from Sentinel hub","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cTNYnp1490"}],"identifier":"download-the-sentinel-2-true-color-image-from-sentinel-hub","label":"Download the Sentinel 2 True color image from Sentinel hub","html_id":"download-the-sentinel-2-true-color-image-from-sentinel-hub","implicit":true,"key":"csVQcKL5Cr"}],"visibility":"show","key":"jXeIvqlQuJ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:45.276136Z","iopub.status.busy":"2022-10-13T12:31:45.275230Z","iopub.status.idle":"2022-10-13T12:31:45.428141Z","shell.execute_reply":"2022-10-13T12:31:45.425908Z"},"papermill":{"duration":0.209098,"end_time":"2022-10-13T12:31:45.431880","exception":false,"start_time":"2022-10-13T12:31:45.222782","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from sentinelhub import SHConfig\n\nconfig = SHConfig()\n\nif not config.sh_client_id or not config.sh_client_secret:\n    print(\"Warning! To use Process API, please provide the credentials (OAuth client ID and client secret).\")","visibility":"show","key":"thJrXacbdc"},{"type":"output","id":"KNLe7Rw7md8FMq9QvUmDA","data":[{"name":"stdout","output_type":"stream","text":"Warning! To use Process API, please provide the credentials (OAuth client ID and client secret).\n"}],"visibility":"show","key":"mLUQ1VvLqM"}],"visibility":"show","key":"Lee6mu9j0B"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.047416,"end_time":"2022-10-13T12:31:45.530525","exception":false,"start_time":"2022-10-13T12:31:45.483109","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Injection of SH credentials to run the processing","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n6wn6724VK"}],"key":"v20XzkVYAp"}],"visibility":"show","key":"vRx7JSiMNU"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:45.634844Z","iopub.status.busy":"2022-10-13T12:31:45.633880Z","iopub.status.idle":"2022-10-13T12:31:45.641833Z","shell.execute_reply":"2022-10-13T12:31:45.639998Z"},"papermill":{"duration":0.061901,"end_time":"2022-10-13T12:31:45.646672","exception":false,"start_time":"2022-10-13T12:31:45.584771","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"config.sh_client_id = os.environ[\"SH_CLIENT_ID\"]\nconfig.sh_client_secret = os.environ[\"SH_CLIENT_SECRET\"]","visibility":"show","key":"JIUXQffwoQ"},{"type":"output","id":"NW8sernSlZzMFbNXLBgGn","data":[],"visibility":"show","key":"uPsyeFGjlx"}],"visibility":"show","key":"ggxmLlDNnm"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:45.771395Z","iopub.status.busy":"2022-10-13T12:31:45.770418Z","iopub.status.idle":"2022-10-13T12:31:45.814956Z","shell.execute_reply":"2022-10-13T12:31:45.814127Z"},"papermill":{"duration":0.115452,"end_time":"2022-10-13T12:31:45.817385","exception":false,"start_time":"2022-10-13T12:31:45.701933","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%reload_ext autoreload\n%autoreload 2","visibility":"show","key":"VJu3ysjX7i"},{"type":"output","id":"k31ExjcIGwgg57FmWgBIN","data":[],"visibility":"show","key":"gCuypTOFI0"}],"visibility":"show","key":"akirRkjnbp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:45.921286Z","iopub.status.busy":"2022-10-13T12:31:45.920602Z","iopub.status.idle":"2022-10-13T12:31:45.959417Z","shell.execute_reply":"2022-10-13T12:31:45.957771Z"},"papermill":{"duration":0.092326,"end_time":"2022-10-13T12:31:45.962471","exception":false,"start_time":"2022-10-13T12:31:45.870145","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib inline\nimport matplotlib.pyplot as plt\nimport rasterio\nfrom rasterio import plot\nfrom rasterio.plot import show\nfrom rasterio.mask import mask","visibility":"show","key":"g3Y1BDVNAE"},{"type":"output","id":"RZjQjn7Djd_sqXYPYWWza","data":[],"visibility":"show","key":"lwZjRCYdNJ"}],"visibility":"show","key":"Vrm5eLMuQs"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:46.059604Z","iopub.status.busy":"2022-10-13T12:31:46.058903Z","iopub.status.idle":"2022-10-13T12:31:46.095234Z","shell.execute_reply":"2022-10-13T12:31:46.093801Z"},"papermill":{"duration":0.087956,"end_time":"2022-10-13T12:31:46.097658","exception":false,"start_time":"2022-10-13T12:31:46.009702","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import datetime\nfrom sentinelhub import (\n    CRS,\n    BBox,\n    DataCollection,\n    DownloadRequest,\n    MimeType,\n    #MosaickingOrder,\n    SentinelHubDownloadClient,\n    SentinelHubRequest,\n    bbox_to_dimensions,\n)","visibility":"show","key":"oO9INDtI10"},{"type":"output","id":"iCU4AJ86qKet1FWUul-jP","data":[],"visibility":"show","key":"Rvn05dqASj"}],"visibility":"show","key":"cIUzfWXSCE"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.080317,"end_time":"2022-10-13T12:31:46.226272","exception":false,"start_time":"2022-10-13T12:31:46.145955","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In the following  cell we need to set resolution of the image, the bbox and the CRS of reference. Please be careful in using the same CRS or EPSG used for the detection in order to execute the last cell properly. Currently the detections CRS has been set as:\n“EPSG:4326” or “CRS:WGS84”","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NXsAqYM5Zl"}],"key":"dIECpXwhs3"}],"visibility":"show","key":"F7ElOeVSTH"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:46.339864Z","iopub.status.busy":"2022-10-13T12:31:46.339445Z","iopub.status.idle":"2022-10-13T12:31:46.424188Z","shell.execute_reply":"2022-10-13T12:31:46.421493Z"},"papermill":{"duration":0.138347,"end_time":"2022-10-13T12:31:46.427371","exception":false,"start_time":"2022-10-13T12:31:46.289024","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"resolution = 10\nkualalumpur_bbox = BBox(bbox=bbox, crs=CRS.WGS84)\nkualalumpur_size = bbox_to_dimensions(kualalumpur_bbox, resolution=resolution)\n\nprint(f\"Image shape at {resolution} m resolution: {kualalumpur_size} pixels\")","visibility":"show","key":"RkVnXTUSSU"},{"type":"output","id":"06C-96dDJktSPpfyzrpHO","data":[{"name":"stdout","output_type":"stream","text":"Image shape at 10 m resolution: (1594, 1664) pixels\n"}],"visibility":"show","key":"MA2JggX8Ma"}],"visibility":"show","key":"a7bQUVj1lr"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:46.533540Z","iopub.status.busy":"2022-10-13T12:31:46.532959Z","iopub.status.idle":"2022-10-13T12:31:46.583674Z","shell.execute_reply":"2022-10-13T12:31:46.582947Z"},"papermill":{"duration":0.105216,"end_time":"2022-10-13T12:31:46.586085","exception":false,"start_time":"2022-10-13T12:31:46.480869","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"evalscript = \"\"\"\n    //VERSION=3\n\n    function setup() {\n        return {\n            input: [{\n                bands: [\"B02\", \"B03\", \"B04\"],\n               \n            }],\n            output: {\n                bands: 3,\n                sampleType: \"AUTO\"\n                \n            }\n        };\n    }\n\n    \n    function evaluatePixel(sample) {\n        return [sample.B04*2, sample.B03*2, sample.B02*2];\n    }\n\"\"\"\n\nrequest_true_colour = SentinelHubRequest(\n    data_folder= \"./Outputs\",\n    evalscript=evalscript,\n    input_data=[\n        SentinelHubRequest.input_data(\n            data_collection=DataCollection.SENTINEL2_L2A,\n            time_interval=(date_start, date_end)\n            \n        )\n    ],\n    responses=[\n        SentinelHubRequest.output_response(\"default\", MimeType.TIFF)\n        \n    ],\n    bbox=kualalumpur_bbox,\n    size=kualalumpur_size,\n    config=config,\n)","visibility":"show","key":"LekYGAxtFO"},{"type":"output","id":"rGnXruFSOSsvA1gCycDOm","data":[],"visibility":"show","key":"ix2j8IvvIv"}],"visibility":"show","key":"FN1PAqmX0h"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:46.688376Z","iopub.status.busy":"2022-10-13T12:31:46.687657Z","iopub.status.idle":"2022-10-13T12:31:49.815652Z","shell.execute_reply":"2022-10-13T12:31:49.814716Z"},"papermill":{"duration":3.184763,"end_time":"2022-10-13T12:31:49.818326","exception":false,"start_time":"2022-10-13T12:31:46.633563","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"tiff_image = request_true_colour.get_data(save_data=True)","visibility":"show","key":"Fy1D3XrsXd"},{"type":"output","id":"ecmh1mOC6eiA_A-2UJqo0","data":[],"visibility":"show","key":"lt3MyaRKu6"}],"visibility":"show","key":"kLTFWq002I"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.050417,"end_time":"2022-10-13T12:31:49.933506","exception":false,"start_time":"2022-10-13T12:31:49.883089","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In order to plot the image downloaded we need first to define the plot_image function as follow. In case of mage too dark or too bright yuo could play with the","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ls9W1PNcyV"}],"key":"Jo7gfEvArO"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"“”“function evaluatePixel(sample) {\nreturn [sample.B04","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KkQwZcDhqt"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"2, sample.B03","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ow3HFhw07O"}],"key":"Bbd8LLVJh8"},{"type":"text","value":"2, sample.B02*2];”“”","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XnaFZ45RiI"}],"key":"Gnr6XzCOn8"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"you can find in the evalscript above","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"WpObe7hzP6"}],"key":"QyRRxyZ6eA"}],"visibility":"show","key":"cM9Zr31hFg"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:50.038695Z","iopub.status.busy":"2022-10-13T12:31:50.038314Z","iopub.status.idle":"2022-10-13T12:31:50.092939Z","shell.execute_reply":"2022-10-13T12:31:50.091884Z"},"papermill":{"duration":0.11034,"end_time":"2022-10-13T12:31:50.095655","exception":false,"start_time":"2022-10-13T12:31:49.985315","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define the plot_image function\ndef plot_image(image, factor=1.0, clip_range = None, **kwargs):\n    \"\"\"\n    Utility function for plotting RGB images.\n    \"\"\"\n    fig, ax = plt.subplots(nrows=1, ncols=1, figsize=(15, 15))\n    if clip_range is not None:\n        ax.imshow(np.clip(image * factor, *clip_range), **kwargs)\n    else:\n        ax.imshow(image * factor, **kwargs)\n    \n    ax.set_xticks([])\n    ax.set_yticks([])","visibility":"show","key":"gjqy4m0xW6"},{"type":"output","id":"UcU5BD2jLh8H6OGUvYfTE","data":[],"visibility":"show","key":"FHnzWGspG6"}],"visibility":"show","key":"Dj1jNxdEKh"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:50.206471Z","iopub.status.busy":"2022-10-13T12:31:50.205059Z","iopub.status.idle":"2022-10-13T12:31:52.343509Z","shell.execute_reply":"2022-10-13T12:31:52.338861Z"},"papermill":{"duration":2.239576,"end_time":"2022-10-13T12:31:52.386669","exception":false,"start_time":"2022-10-13T12:31:50.147093","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plot_image(tiff_image[0], factor=1/255, clip_range=(0,1))","visibility":"show","key":"XODWvgHT2f"},{"type":"output","id":"ZihRoVXWXxBebVDiffIEy","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"de86bf6add38ad21c7f4a2721227a4ec","path":"/notebooks_test/build/de86bf6add38ad21c7f4a2721227a4ec.png"},"text/plain":{"content":"\u003cFigure size 1500x1500 with 1 Axes\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"h7tBR0yfO3"}],"visibility":"show","key":"YVpHk44nIA"},{"type":"block","kind":"notebook-content","data":{"papermill":{"duration":0.109077,"end_time":"2022-10-13T12:31:52.609474","exception":false,"start_time":"2022-10-13T12:31:52.500397","status":"completed"},"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In order to set the location of the tiff requesteed via SentinelHub, you need to identify the folder and set it in the input image path.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CVq7EQwYsC"}],"key":"Z9GdDdCG5n"}],"visibility":"show","key":"mVqKXOdm4K"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:52.826111Z","iopub.status.busy":"2022-10-13T12:31:52.825591Z","iopub.status.idle":"2022-10-13T12:31:52.863691Z","shell.execute_reply":"2022-10-13T12:31:52.862344Z"},"papermill":{"duration":0.148476,"end_time":"2022-10-13T12:31:52.866382","exception":false,"start_time":"2022-10-13T12:31:52.717906","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"#input_image = \"Downloaded_S2_TCI/2020-05-18-00_00_2020-05-18-23_59_Sentinel-2_L2A_True_color (1).tiff\"\ninput_image = \"./Outputs/a308013e4b1539348e30b3393836e689/response.tiff\"","visibility":"show","key":"hp0rXTAZe0"},{"type":"output","id":"KiQeIgibbV7EJCC0IHQzQ","data":[],"visibility":"show","key":"X9mnPU1a6h"}],"visibility":"show","key":"d6L0sxTWbC"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:53.081173Z","iopub.status.busy":"2022-10-13T12:31:53.080605Z","iopub.status.idle":"2022-10-13T12:31:53.117546Z","shell.execute_reply":"2022-10-13T12:31:53.116803Z"},"papermill":{"duration":0.14729,"end_time":"2022-10-13T12:31:53.119970","exception":false,"start_time":"2022-10-13T12:31:52.972680","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"input_image_png = rasterio.open(input_image) ","visibility":"show","key":"dnVSmfoIaq"},{"type":"output","id":"gbcU6GtBmImoe13_Dn2fP","data":[],"visibility":"show","key":"lirP5PP7Li"}],"visibility":"show","key":"X8qr7vkgmu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:53.334921Z","iopub.status.busy":"2022-10-13T12:31:53.334431Z","iopub.status.idle":"2022-10-13T12:31:55.087629Z","shell.execute_reply":"2022-10-13T12:31:55.086034Z"},"papermill":{"duration":1.964911,"end_time":"2022-10-13T12:31:55.188737","exception":false,"start_time":"2022-10-13T12:31:53.223826","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(figsize=(15, 15))\nshow(input_image_png.read(), transform=input_image_png.transform)\nplt.show()","visibility":"show","key":"dfYsY6PX2Z"},{"type":"output","id":"h5gRzcGmG29n0gGTM5ZQm","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4de4b3423ddebd801686f6435864a838","path":"/notebooks_test/build/4de4b3423ddebd801686f6435864a838.png"},"text/plain":{"content":"\u003cFigure size 1500x1500 with 1 Axes\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"nePeQ4QE7a"}],"visibility":"show","key":"KIqDxbXNso"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:55.652792Z","iopub.status.busy":"2022-10-13T12:31:55.652344Z","iopub.status.idle":"2022-10-13T12:31:56.195857Z","shell.execute_reply":"2022-10-13T12:31:56.195047Z"},"papermill":{"duration":0.759885,"end_time":"2022-10-13T12:31:56.198788","exception":false,"start_time":"2022-10-13T12:31:55.438903","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"trucks_gpkg.plot()","visibility":"show","key":"H2FLzgqfgh"},{"type":"output","id":"8bkgbodORSscRdcjgO2cE","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b55becd65a1305ac4dbbe220bcb8d0c8","path":"/notebooks_test/build/b55becd65a1305ac4dbbe220bcb8d0c8.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"H8XfxhxpR8"}],"visibility":"show","key":"h3rXQQmPBY"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:56.567674Z","iopub.status.busy":"2022-10-13T12:31:56.567213Z","iopub.status.idle":"2022-10-13T12:31:56.617782Z","shell.execute_reply":"2022-10-13T12:31:56.615337Z"},"papermill":{"duration":0.250767,"end_time":"2022-10-13T12:31:56.621671","exception":false,"start_time":"2022-10-13T12:31:56.370904","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"print('vector data projection is:', trucks_gpkg.crs)\nprint('raster data projection is:', input_image_png.crs)","visibility":"show","key":"cQVyS4vDyV"},{"type":"output","id":"P0MU-FYF5h_OYwrhbTCzO","data":[{"name":"stdout","output_type":"stream","text":"vector data projection is: epsg:4326\nraster data projection is: EPSG:4326\n"}],"visibility":"show","key":"l59cYE4PhE"}],"visibility":"show","key":"f2N7KqQRY0"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:57.033134Z","iopub.status.busy":"2022-10-13T12:31:57.032444Z","iopub.status.idle":"2022-10-13T12:31:57.070904Z","shell.execute_reply":"2022-10-13T12:31:57.069935Z"},"papermill":{"duration":0.248824,"end_time":"2022-10-13T12:31:57.074090","exception":false,"start_time":"2022-10-13T12:31:56.825266","status":"completed"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib inline","visibility":"show","key":"TUgjZx3f4K"},{"type":"output","id":"feoxn-LMG0-5VM3xcF50J","data":[],"visibility":"show","key":"RkOaPJMN4J"}],"visibility":"show","key":"eaSijj7bN1"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2022-10-13T12:31:57.468299Z","iopub.status.busy":"2022-10-13T12:31:57.467923Z","iopub.status.idle":"2022-10-13T12:32:09.291195Z","shell.execute_reply":"2022-10-13T12:32:09.288167Z"},"papermill":{"duration":12.300531,"end_time":"2022-10-13T12:32:09.555582","exception":false,"start_time":"2022-10-13T12:31:57.255051","status":"completed"},"scrolled":true,"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(100, 50))\nshow(input_image_png.read(), transform=input_image_png.transform, ax=ax)\ntrucks_gpkg.plot(ax=ax, color='yellow', alpha=.30) ## alpha is the transparency setting\nplt.show()","visibility":"show","key":"kq0xmVcPvZ"},{"type":"output","id":"Nj1GtAk-nlwAkb6JKNgcX","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ec6f79462ff16fad67259fc46bd22967","path":"/notebooks_test/build/ec6f79462ff16fad67259fc46bd22967.png"},"text/plain":{"content":"\u003cFigure size 10000x5000 with 1 Axes\u003e","content_type":"text/plain"}}}],"visibility":"show","key":"LrFEcIhdoS"}],"visibility":"show","key":"u7HZLWfpo7"}],"key":"pOEScHVRa0"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Data Access","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/igarss2022/igarss-22-data-access","group":"Contributions"},"next":{"title":"Environmental Impacts of Lockdown in Venice, Italy during 2020","url":"/external-notebooks/eurodatacube/notebooks/notebooks/contributions/igarss2022/igarss-22-lockdown-in-venice","group":"Contributions"}}},"domain":"http://localhost:3000"},"project":{"github":"https://github.com/eoxhub-workspaces/documentation/","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"title":"Location for eodashboard notebooks","index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Eurodatacube","level":2},{"title":"Notebooks","level":3},{"slug":"external-notebooks.eurodatacube.notebooks.readme","title":"Jupyter notebooks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebooks","level":4},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.readme","title":"Euro Data Cube Notebooks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Contributions","level":5},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.aireo-pilot-dataset-ai4arctic-sea-ice","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.aireo-pilot-dataset-biomass-forest-observation-sys","title":"AIREO pilot dataset - Biomass (Forest Observation System)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.aireo-pilot-dataset-cap","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.aireo-pilot-dataset-spacenet7","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.aot-covid19","title":"Aerosol Optical Thickness (AOT) Anomaly Detection Using Sentinel-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.batch-zarr-output","title":"Generating Zarr data cubes with Sentinel Hub Batch API","description":"","date":"","thumbnail":"/notebooks_test/build/68dffbf744fa42f4bf3d35e55684984e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.client-side-processing-using-mass-sh","title":"Important notes","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.cmems-data-download","title":"Cmems Data Download","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.detect-trucks-sentinel2","title":"Detect Trucks using Sentinel-2 data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.drought-monitoring","title":"Drought impact monitoring platform","description":"","date":"","thumbnail":"/notebooks_test/build/ad5c19782b006f72352ae57794305840.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-africa-cube-africa-custom-contest","title":"Custom Script Contest – Urban Growth in Africa","description":"","date":"","thumbnail":"/notebooks_test/build/e9275f3fe80a704e2f5aa1ec1220e48a.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-byoc-tutorial","title":"How to bring your own data to EDC: Using Sentinel Hub Python package","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-demo-phi-week-v2","title":"xcube-gen and xcube-geodb Hands-On Workshop Φ-Week 2020","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-geodb-4-eurocrops-demo","title":"Demonstration of Eurocrops data use in geoDB","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-notebook-lstm","title":"South Africa Crop Type Classification on Euro Data Cube (EDC)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.edc-usecase-lpis-crop-type-classification","title":"Important notes","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.eurocrops-crop-classification-example","title":"Crop-classification using Sentinel-2 time-series","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.ghsl-urban-delineation","title":"\u003cb\u003eUrban delineation\u003cb\u003e","description":"","date":"","thumbnail":"/notebooks_test/build/7bbf545a5eae1d9ebdb91ae42b261063.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.globalearthmonitor-example","title":"Pre-requisites","description":"","date":"","thumbnail":"/notebooks_test/build/205c1ded6bd59771975a9fbd3753fd3b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.gpu-support-eoxhub","title":"GPU-Support on EOxHub","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.gran-chaco-phiweek","title":"ESA EO \\phi- week 2020","description":"","date":"","thumbnail":"/notebooks_test/build/80cee7db6cdc7002ceedda5689f889fa.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.howtolulc-batch-updated-210621","title":"How To: Land-Use-Land-Cover Prediction for Slovenia - using the Batch Processing API","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.lpis-lulc-slo","title":"LPIS Use Case for Land Use / Land Cover Classification","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.lps2022-leverage-euro-data-cube-services","title":"Living Planet Symposium 2022 Training Session","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.no2-analysis-covid19-lockdowns","title":"Impact of Covid19 induced lockdown on NO2 levels","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.no2-so2-trend-veda-api-igarss-2023","title":"Using the NASA VEDA EOAPI","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.ogc-edc","title":"Important notes","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.openeo-client-demo","title":"openEO Client Demo","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.race-finishedgoodsinventory-inidcator","title":"Finished Goods Inventory indicator for RACE","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.third-party-planetscope","title":"Third Party Data Import - PlanetScope","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.xcube-access-datasets","title":"Using xcube to access non-commercial and commercial data sets","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.xcube-viewer-as-a-service-in-edc1","title":"Visualizing data with xcube viewer in EuroDataCube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.dapa.dapa-evaluation-workshop","title":"DAPA Evaluation Workshop: Introduction \u0026 Documentation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.dapa.dapa-tutorial-1-cube-sentinel-2","title":"DAPA Tutorial #1: Cube - Sentinel-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.dapa.dapa-tutorial-2-area-sentinel-2","title":"DAPA Tutorial #2: Area - Sentinel-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.dapa.dapa-tutorial-3-timeseries-sentinel-2","title":"DAPA Tutorial #3: Timeseries - Sentinel-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.dapa.dapa-tutorial-4-value-sentinel-2","title":"DAPA Tutorial #4: Value - Sentinel-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.dapa.dapa-tutorial-5-dem","title":"DAPA Tutorial #5: DEM","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.fairicube.fairicube-data-access-demonstration","title":"EDC Sentinel Hub - data access using xcube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-australian-bushfires","title":"Australian Bushfires","description":"","date":"","thumbnail":"/notebooks_test/build/ab194b4f8c40a2b9d64d8a85e37ce1fd.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":["IGARSS-22","EO Dashboard"],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-data-access","title":"Data Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-detect-trucks-sentinel2","title":"Truck Detection Exercise","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-lockdown-in-venice","title":"Environmental Impacts of Lockdown in Venice, Italy during 2020","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-nasa-api-lockdown-in-venice","title":"Lockdown in Venice","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-no2-timeseries-analysis","title":"NO2 timeseries analysis","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.contributions.igarss2022.igarss-22-timeseries-stac-api-single-vs-multi","title":"Time series using STAC API statistics endpoints","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"title":"Curated","level":5},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.access-iacs-data","title":"How to access IACS Spatial Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-access-cci-data","title":"Access CCI data with xcube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-first-steps","title":"First steps on the Euro Data Cube platform","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-geodb-1-manage-datasets-v11","title":"Manage Collections in your GeoDB","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-geodb-2-explore-datasets-2","title":"Exploring Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-geodb-3-share-datasets1","title":"Sharing Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-geodb-access-urban-atlas-data-v1","title":"[xcube-geodb] How to accesss EEA Urban Atlas Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinel-hub-data-access","title":"EDC Sentinel Hub - data access using xcube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinelhub-datafusion-basic","title":"EDC Sentinel Hub: Data Fusion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinelhub-datafusion-ndvi","title":"EDC Sentinel Hub: Data Fusion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinel-hub-datasets","title":"EDC Sentinel Hub - using xcube to access different data sets in Sentinel Hub","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinel-hub-setup","title":"Setup for EDC core API access using xcube client library","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-sentinel-hub-xcube-integration","title":"EDC Sentinel Hub - XCUBE integration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.edc-usecase-ndvi-timeline","title":"NDVI timeline","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.eo-learn","title":"Using eo-learn in EDC: a starter’s guide.","description":"","date":"","thumbnail":"/notebooks_test/build/5a1f8475f0c3652f4630d03d72891b98.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.esdl-edc-v0-2","title":"Earth System Data Lab Tutorial @ Euro Data Cube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.exploring-time-and-space-with-edc","title":"Exploring Time and Space: A guide to accessing, analysing and visualising data in the Euro Data Cube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.how-to-access-dem-data-through-sentinel-hub-api","title":"How to access DEM data through Sentinel Hub API","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.eurodatacube.notebooks.notebooks.curated.sentinelhub-py","title":"Using Sentinel Hub Process API in EDC: a starter’s guide.","description":"","date":"","thumbnail":"/notebooks_test/build/01e22903839391bc356ac886ec2b2fa7.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"title":"Notebooks","level":1},{"slug":"notebooks.example1","title":"📘 Example Notebook 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.example2","title":"📘 Example Notebook 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/notebooks_test/build/manifest-B4831781.js";
import * as route0 from "/notebooks_test/build/root-QGLRP2PL.js";
import * as route1 from "/notebooks_test/build/routes/$-7JYT5576.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/notebooks_test/build/entry.client-UNPC4GT3.js");</script></body></html>